package net.doge.utils;

import cn.hutool.core.util.ReUtil;
import cn.hutool.http.Header;
import cn.hutool.http.HttpRequest;
import cn.hutool.http.HttpResponse;
import cn.hutool.http.HttpStatus;
import net.doge.constants.*;
import net.doge.models.*;
import net.doge.models.entities.*;
import net.doge.ui.components.panel.LoadingPanel;
import net.sf.json.JSONArray;
import net.sf.json.JSONObject;
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;

import java.awt.*;
import java.awt.image.BufferedImage;
import java.io.*;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.List;
import java.util.*;
import java.util.concurrent.Callable;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.Future;
import java.util.concurrent.atomic.AtomicInteger;
import java.util.concurrent.atomic.AtomicReference;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

/**
 * @author yzx
 * @description
 * @date 2020/12/19
 */
public class MusicServerUtil {
    public static void main(String[] args) {
        String body = HttpRequest.get("http://api.bilibili.com/x/web-interface/search/type?keyword=%E2%91%A8%E2%91%A8%E2%91%A8%EF%BC%8C%E5%A4%A9%E9%95%BF%E5%9C%B0%E4%B9%85%E8%88%AC%E7%9A%84%E5%85%B1%E8%8D%A3&search_type=video")
                .cookie("buvid3=1F81D80F-98ED-1A44-D019-B5B98D4A91B713086infoc; b_nut=1664112813; i-wanna-go-back=-1; _uuid=2446C104D-D6DB-47CE-6CA6-B1A6510C76A5676353infoc; rpdid=|(um~Rkm||lR0J'uYYRuuk)l); nostalgia_conf=-1; fingerprint3=c37218800089711141f536512b0d4abf; hit-dyn-v2=1; PVID=2; fingerprint=a6b332179ad74583e2899679560168f7; buvid_fp=1F81D80F-98ED-1A44-D019-B5B98D4A91B713086infoc; buvid_fp_plain=undefined; buvid4=417866CC-0EF2-FC4F-C4FD-275ED105CFD814423-022092521-wTMxKM%2BXYt90NrLH2h7Mow%3D%3D; blackside_state=1; sid=7osld2ei; CURRENT_FNVAL=4048; theme_style=light; b_lsid=AD6B642F_183AD5B12FD; innersign=0; bp_video_offset_381984701=713920738394898400; b_ut=7")
                .execute()
                .body();
        System.out.println(body);
    }

    /**
     * 生成酷狗 url
     *
     * @return
     */
    public static String buildKgUrl(String s) {
        // 参数顺序按照 ASCII 码顺序
        String secret = "NVPh5oo715z5DIWAeQlhMDsWXXQV4hwt";
        String params = s.substring(s.indexOf('?') + 1).replace("&", "");
        // 将参数解码
        params = StringUtil.decode(params);
        String sign = StringUtil.toMD5(secret + params + secret);
        return s + "&signature=" + sign;
    }

    /**
     * 生成千千音乐 url
     *
     * @return
     */
    public static String buildQianUrl(String s) {
        // 参数顺序按照 ASCII 码顺序
        String secret = "0b50b02fd0d73a9c4c8c3a781c30845f";
        String params = s.substring(s.indexOf('?') + 1);
        // 将参数解码
        params = StringUtil.decode(params);
        String sign = StringUtil.toMD5(params + secret);
        return s + "&sign=" + sign;
    }

    // 最大等待时间(ms)
    private static final int TIME_OUT = 6000;

    static {
        HttpRequest.setGlobalTimeout(TIME_OUT);
    }

    // 请求头
    private static final String USER_AGENT = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.141 Safari/537.36 Edg/87.0.664.75";
    private static final String COOKIE = "kg_mid=eb822d765480e1e3e6b8c6f2322019c8; kg_dfid=11TWHr0cp8jq4YKe9P3fosEo; kg_dfid_collect=d41d8cd98f00b204e9800998ecf8427e; musicwo17=kugou";
    static final String HK_COOKIE = "BIDUPSID=BE696A0D51D343798228BD61F26D5647; PSTM=1658997928; BAIDUID=41719925BFDA6FB8DAD817BC8CA07B28:SL=0:NR=10:FG=1; Hm_lvt_4aadd610dfd2f5972f1efee2653a2bc5=1659086001; BAIDUID_BFESS=41719925BFDA6FB8DAD817BC8CA07B28:SL=0:NR=10:FG=1; delPer=0; PSINO=1; BA_HECTOR=20ag2g0ha42galagaga7ko601hgorth16; ZFY=gy2NQKWk6ZhA6AuDxoMpPQs6Og5GSSS7oA7XUkOHKeg:C; PC_TAB_LOG=video_details_page; COMMON_LID=2c19ef6811cbc39c8bbfaafcfcaeba64; BDRCVFR[fb3VbsUruOn]=I67x6TjHwwYf0; hkpcSearch=%u7FDF%u8000%24%24%24hello; H_PS_PSSID=36561_36461_36979_36885_37267_37135_26350_37205; ariaDefaultTheme=undefined; RT=\"z=1&dm=baidu.com&si=fxuvi7wxq45&ss=l7egnei6&sl=17&tt=19ph&bcn=https%3A%2F%2Ffclog.baidu.com%2Flog%2Fweirwood%3Ftype%3Dperf&ld=1xs54&cl=1xt27&ul=1xt6x&hd=1xtb4\"";
    static final String HF_COOKIE = "bbs_sid=b49bvrs3efj99kui5ogaipp1gv";
    private static final String BI_COOKIE = "buvid3=1F81D80F-98ED-1A44-D019-B5B98D4A91B713086infoc; b_nut=1664112813; i-wanna-go-back=-1; _uuid=2446C104D-D6DB-47CE-6CA6-B1A6510C76A5676353infoc; rpdid=|(um~Rkm||lR0J'uYYRuuk)l); nostalgia_conf=-1; fingerprint3=c37218800089711141f536512b0d4abf; hit-dyn-v2=1; PVID=2; fingerprint=a6b332179ad74583e2899679560168f7; buvid_fp=1F81D80F-98ED-1A44-D019-B5B98D4A91B713086infoc; buvid_fp_plain=undefined; buvid4=417866CC-0EF2-FC4F-C4FD-275ED105CFD814423-022092521-wTMxKM%2BXYt90NrLH2h7Mow%3D%3D; blackside_state=1; sid=7osld2ei; CURRENT_FNVAL=4048; theme_style=light; b_lsid=AD6B642F_183AD5B12FD; innersign=0; bp_video_offset_381984701=713920738394898400; b_ut=7";

    // 域名
    private static final String host = "localhost";

    private static final String prefix = String.format("http://%s:3000", host);
    private static final String prefixQQ33 = String.format("http://%s:3300", host);
    private static final String qqSearchApi = "https://u.y.qq.com/cgi-bin/musicu.fcg";
    private static final String qqSearchJson = "{\"music.search.SearchCgiService\": {\"method\": \"DoSearchForQQMusicDesktop\",\"module\": \"music.search.SearchCgiService\",\"param\":{\"page_num\": %s,\"num_per_page\": %s,\"query\": \"%s\",\"search_type\": %s}}}";
    //    private static final String prefixKw = "http://localhost:7002";
    private static final String prefixMg = String.format("http://%s:3400", host);

    // 构造酷我音乐请求
    private static HttpRequest kwRequest(String url) {
        return HttpRequest.get(url)
                .header(Header.COOKIE, "Hm_lvt_cdb524f42f0ce19b169a8071123a4797=1623339177,1623339183; _ga=GA1.2.1195980605.1579367081" +
                        "; Hm_lpvt_cdb524f42f0ce19b169a8071123a4797=1623339982; kw_token=3E7JFQ7MRPL; _gid=GA1.2.747985028.1623339179; _gat=1")
                .header("csrf", "3E7JFQ7MRPL")
                .header(Header.HOST, "www.kuwo.cn")
                .header(Header.REFERER, "https://www.kuwo.cn/")
                .header(Header.USER_AGENT, "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.77 Safari/537.36");
    }

    // 热搜 API
    private static final String HOT_SEARCH_API
            = prefix + "/search/hot";
    // 热搜 API (酷狗)
    private static final String HOT_SEARCH_KG_API
            = "http://gateway.kugou.com/api/v3/search/hot_tab?signature=ee44edb9d7155821412d220bcaf509dd&appid=1005&clientver=10026&plat=0";
    // 热搜 API (QQ)
    private static final String HOT_SEARCH_QQ_API
            = "https://u.y.qq.com/cgi-bin/musicu.fcg";
    // 热搜 API (酷我)
    private static final String HOT_SEARCH_KW_API
            = "http://hotword.kuwo.cn/hotword.s?prod=kwplayer_ar_9.3.0.1&corp=kuwo&newver=2&vipver=9.3.0.1" +
            "&source=kwplayer_ar_9.3.0.1_40.apk&p2p=1&notrace=0&uid=0&plat=kwplayer_ar&rformat=json&encoding=utf8&tabid=1";
    // 热搜 API (咪咕)
    private static final String HOT_SEARCH_MG_API
            = "http://jadeite.migu.cn:7090/music_search/v2/search/hotword";

    // 搜索建议(简单) API
    private static final String SIMPLE_SEARCH_SUGGESTION_API
            = prefix + "/search/suggest?keywords=%s&type=mobile";
    // 搜索建议 API
    private static final String SEARCH_SUGGESTION_API
            = prefix + "/search/suggest?keywords=%s";
    // 搜索建议 API (酷狗)
    private static final String SEARCH_SUGGESTION_KG_API
            = "http://msearchcdn.kugou.com/new/app/i/search.php?cmd=302&keyword=%s";
    // 搜索建议 API (QQ)
    private static final String SEARCH_SUGGESTION_QQ_API
            = "https://c.y.qq.com/splcloud/fcgi-bin/smartbox_new.fcg?is_xml=0&format=json&key=%s" +
            "&loginUin=0&hostUin=0&format=json&inCharset=utf8&outCharset=utf-8&notice=0&platform=yqq&needNewCode=0";
    // 搜索建议 API (酷我)
//    private static final String SEARCH_SUGGESTION_KW_API = prefixKw + "/kuwo/search/searchKey?key=%s";
    private static final String SEARCH_SUGGESTION_KW_API = "http://www.kuwo.cn/api/www/search/searchKey?key=%s&httpsStatus=1";
    // 搜索建议 API (千千)
    private static final String SEARCH_SUGGESTION_QI_API
            = "https://music.91q.com/v1/search/sug?appid=16073360&timestamp=%s&type=&word=%s";

    // 搜索子标签 (猫耳)
    private static final String PROGRAM_SEARCH_TAG_ME_API
            = "https://www.missevan.com/sound/getcatalogleaves";

    /**
     * 加载节目搜索子标签
     *
     * @return
     */
    public static void initProgramSearchTag() {
        // 猫耳
        Tags.programSearchTag.put("默认", new String[]{" "});

        final int c = 1;
        // 猫耳
        Runnable initProgramSearchTagMe = () -> {
            String playlistTagBody = HttpRequest.get(String.format(PROGRAM_SEARCH_TAG_ME_API))
                    .execute()
                    .body();
            JSONArray tags = JSONArray.fromObject(playlistTagBody);
            for (int i = 0, len = tags.size(); i < len; i++) {
                JSONObject son = tags.getJSONObject(i).getJSONObject("son");
                Iterator<String> keys = son.keys();
                while (keys.hasNext()) {
                    String key = keys.next();
                    JSONObject obj = son.getJSONObject(key);

                    String name = obj.getString("catalog_name");
                    String id = obj.getString("id");

                    if (!Tags.programSearchTag.containsKey(name)) Tags.programSearchTag.put(name, new String[c]);
                    Tags.programSearchTag.get(name)[0] = id;
                }
            }
        };

        List<Future<?>> taskList = new LinkedList<>();

        taskList.add(GlobalExecutors.requestExecutor.submit(initProgramSearchTagMe));

        taskList.forEach(task -> {
            try {
                task.get();
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
    }

    // 关键词搜索歌曲 API
    private static final String SEARCH_MUSIC_API
            = prefix + "/cloudsearch?keywords=%s&limit=%s&offset=%s";
    // 关键词搜索声音 API
    private static final String SEARCH_VOICE_API
            = prefix + "/search?type=2000&keywords=%s&limit=%s&offset=%s";
    // 关键词搜索歌曲 API (搜歌词)
    private static final String SEARCH_MUSIC_BY_LYRIC_API
            = prefix + "/search?type=1006&keywords=%s&limit=%s&offset=%s";
    // 关键词搜索歌曲 API (酷狗)
    private static final String SEARCH_MUSIC_KG_API
            = "http://mobilecdn.kugou.com/api/v3/search/song?format=json&keyword=%s&page=%s&pagesize=%s&showtype=1";
    // 关键词搜索歌曲 API (搜歌词) (酷狗)
    private static final String SEARCH_MUSIC_BY_LYRIC_KG_API
            = "http://mobileservice.kugou.com/api/v3/lyric/search?keyword=%s&page=%s&pagesize=%s";
    // 关键词搜索歌曲 API (QQ 音乐)
//    private static final String SEARCH_MUSIC_QQ_API
//            = prefixQQ33 + "/search?key=%s&pageNo=%s&pageSize=%s";
    // 关键词搜索歌曲 API (搜歌词) (QQ 音乐)
//    private static final String SEARCH_MUSIC_BY_LYRIC_QQ_API
//            = prefixQQ33 + "/search?t=7&key=%s&pageNo=%s&pageSize=%s";
    // 关键词搜索歌曲 API (酷我)
//    private static final String SEARCH_MUSIC_KW_API = prefixKw + "/kuwo/search/searchMusicBykeyWord?key=%s&pn=%s&rn=%s";
    private static final String SEARCH_MUSIC_KW_API = "http://www.kuwo.cn/api/www/search/searchMusicBykeyWord?key=%s&pn=%s&rn=%s&httpsStatus=1";
    // 关键词搜索歌曲 API (咪咕)
    private static final String SEARCH_MUSIC_MG_API = prefixMg + "/search?keyword=%s&pageNo=%s&pageSize=%s";
    // 关键词搜索歌曲 API (千千)
    private static final String SEARCH_MUSIC_QI_API
            = "https://music.91q.com/v1/search?appid=16073360&pageNo=%s&pageSize=%s&timestamp=%s&type=1&word=%s";
    // 关键词搜索歌曲 API (音乐磁场)
    private static final String SEARCH_MUSIC_HF_API = "https://www.hifini.com/search-%s-1-%s.htm";
    // 关键词搜索歌曲 API (咕咕咕音乐)
    private static final String SEARCH_MUSIC_GG_API = "http://www.gggmusic.com/search-%s-1-%s.htm";
    // 关键词搜索节目 API (喜马拉雅)
    private static final String SEARCH_MUSIC_XM_API
            = "https://www.ximalaya.com/revision/search/main?kw=%s&page=%s&spellchecker=true&condition=relation&rows=%s&device=iPhone&core=track&fq=&paidFilter=false";
    // 关键词搜索节目 API (猫耳)
    private static final String SEARCH_PROGRAM_ME_API
            = "https://www.missevan.com/sound/getsearch?cid=%s&s=%s&p=%s&type=3&page_size=%s";

    // 关键词搜索歌单 API
    private static final String SEARCH_PLAYLIST_API
            = prefix + "/cloudsearch?type=1000&keywords=%s&limit=%s&offset=%s";
    // 关键词搜索歌单 API (酷狗)
    private static final String SEARCH_PLAYLIST_KG_API
            = "http://mobilecdnbj.kugou.com/api/v3/search/special?filter=0&keyword=%s&page=%s&pagesize=%s";
    // 关键词搜索歌单 API (QQ)
//    private static final String SEARCH_PLAYLIST_QQ_API
//            = prefixQQ33 + "/search?t=2&key=%s&pageNo=%s&pageSize=%s";
    // 关键词搜索歌单 API (酷我)
//    private static final String SEARCH_PLAYLIST_KW_API = prefixKw + "/kuwo/search/searchPlayListBykeyWord?key=%s&pn=%s&rn=%s";
    private static final String SEARCH_PLAYLIST_KW_API = "http://www.kuwo.cn/api/www/search/searchPlayListBykeyWord?key=%s&pn=%s&rn=%s&httpsStatus=1";
    // 关键词搜索歌单 API (咪咕)
    private static final String SEARCH_PLAYLIST_MG_API
            = prefixMg + "/search?type=playlist&keyword=%s&pageNo=%s&pageSize=%s";

    // 关键词搜索专辑 API
    private static final String SEARCH_ALBUM_API
            = prefix + "/cloudsearch?type=10&keywords=%s&limit=%s&offset=%s";
    // 关键词搜索专辑 API (酷狗)
    private static final String SEARCH_ALBUM_KG_API
            = "http://msearch.kugou.com/api/v3/search/album?keyword=%s&page=%s&pagesize=%s";
    // 关键词搜索专辑 API (QQ)
//    private static final String SEARCH_ALBUM_QQ_API
//            = prefixQQ33 + "/search?t=8&key=%s&pageNo=%s&pageSize=%s";
    // 关键词搜索专辑 API (酷我)
//    private static final String SEARCH_ALBUM_KW_API = prefixKw + "/kuwo/search/searchAlbumBykeyWord?key=%s&pn=%s&rn=%s";
    private static final String SEARCH_ALBUM_KW_API = "http://www.kuwo.cn/api/www/search/searchAlbumBykeyWord?key=%s&pn=%s&rn=%s&httpsStatus=1";
    // 关键词搜索专辑 API (咪咕)
    private static final String SEARCH_ALBUM_MG_API
            = prefixMg + "/search?type=album&keyword=%s&pageNo=%s&pageSize=%s";
    // 关键词搜索专辑 API (千千)
    private static final String SEARCH_ALBUM_QI_API
            = "https://music.91q.com/v1/search?appid=16073360&pageNo=%s&pageSize=%s&timestamp=%s&type=3&word=%s";
    // 关键词搜索专辑 API (豆瓣)
    private static final String SEARCH_ALBUM_DB_API
            = "https://www.douban.com/j/search?q=%s&start=%s&cat=1003";
    // 关键词搜索专辑 API (堆糖)
    private static final String SEARCH_ALBUM_DT_API
            = "https://www.duitang.com/napi/album/list/by_search/?include_fields=is_root,source_link,item,buyable,root_id,status,like_count,sender,album,cover" +
            "&kw=%s&start=%s&limit=%s&type=album&_type=&_=%s";
    // 关键词搜索专辑 API 2 (堆糖)
    private static final String SEARCH_ALBUM_DT_API_2
            = "https://www.duitang.com/napi/blogv2/list/by_search/?include_fields=is_root,source_link,item,buyable,root_id,status,like_count,sender,album,cover" +
            "&kw=%s&start=%s&limit=%s&type=feed&_type=&_=%s";

    // 关键词搜索歌手 API
    private static final String SEARCH_ARTIST_API
            = prefix + "/cloudsearch?type=100&keywords=%s&limit=%s&offset=%s";
    // 关键词搜索歌手 API (QQ)
//    private static final String SEARCH_ARTIST_QQ_API
//            = prefixQQ33 + "/search?t=9&key=%s&pageNo=%s&pageSize=%s";
    // 关键词搜索歌手 API (酷我)
//    private static final String SEARCH_ARTIST_KW_API = prefixKw + "/kuwo/search/searchArtistBykeyWord?key=%s&pn=%s&rn=%s";
    private static final String SEARCH_ARTIST_KW_API = "http://www.kuwo.cn/api/www/search/searchArtistBykeyWord?key=%s&pn=%s&rn=%s&httpsStatus=1";
    // 关键词搜索歌手 API (咪咕)
    private static final String SEARCH_ARTIST_MG_API
            = prefixMg + "/search?type=singer&keyword=%s&pageNo=%s&pageSize=%s";
    // 关键词搜索歌手 API (千千)
    private static final String SEARCH_ARTIST_QI_API
            = "https://music.91q.com/v1/search?appid=16073360&pageNo=%s&pageSize=%s&timestamp=%s&type=2&word=%s";
    // 关键词搜索声优 API (猫耳)
    private static final String SEARCH_CV_ME_API = "https://www.missevan.com/sound/getsearch?s=%s&type=4&p=%s&page_size=%s";
    // 关键词搜索歌手 API (豆瓣)
    private static final String SEARCH_ARTIST_DB_API
            = "https://movie.douban.com/celebrities/search?search_text=%s&start=%s";

    // 关键词搜索电台 API
    private static final String SEARCH_RADIO_API
            = prefix + "/cloudsearch?type=1009&keywords=%s&offset=%s&limit=%s";
    // 关键词搜索电台 API(喜马拉雅)
    private static final String SEARCH_RADIO_XM_API
            = "https://www.ximalaya.com/revision/search/main?core=album&kw=%s&page=%s&spellchecker=true&rows=%s&condition=relation&device=iPhone&fq=&paidFilter=false";
    // 关键词搜索电台 API(猫耳)
    private static final String SEARCH_RADIO_ME_API
            = "https://www.missevan.com/dramaapi/search?s=%s&page=%s&page_size=%s";
    // 关键词搜索电台 API(豆瓣)
    private static final String SEARCH_RADIO_DB_API
            = "https://www.douban.com/j/search?q=%s&start=%s&cat=1002";
    // 关键词搜索图书电台 API(豆瓣)
    private static final String SEARCH_BOOK_RADIO_DB_API
            = "https://www.douban.com/j/search?q=%s&start=%s&cat=1001";
    // 关键词搜索游戏电台 API(豆瓣)
    private static final String SEARCH_GAME_RADIO_DB_API
            = "https://www.douban.com/j/search?q=%s&start=%s&cat=3114";

    // 关键词搜索 MV API
    private static final String SEARCH_MV_API
            = prefix + "/cloudsearch?type=1004&keywords=%s&limit=%s&offset=%s";
    // 关键词搜索视频 API
    private static final String SEARCH_VIDEO_API
            = prefix + "/cloudsearch?type=1014&keywords=%s&limit=%s&offset=%s";
    // 关键词搜索 MV API (酷狗)
    private static final String SEARCH_MV_KG_API
            = "http://msearch.kugou.com/api/v3/search/mv?version=9108&keyword=%s&page=%s&pagesize=%s&sver=2";
    // 关键词搜索 MV API (QQ)
//    private static final String SEARCH_MV_QQ_API
//            = prefixQQ33 + "/search?t=12&key=%s&pageNo=%s&pageSize=%s";
    // 关键词搜索 MV API (酷我)
//    private static final String SEARCH_MV_KW_API = prefixKw + "/kuwo/search/searchMvBykeyWord?key=%s&pn=%s&rn=%s";
    private static final String SEARCH_MV_KW_API = "http://www.kuwo.cn/api/www/search/searchMvBykeyWord?key=%s&pn=%s&rn=%s&httpsStatus=1";
    // 关键词搜索 MV API (好看)
    private static final String SEARCH_MV_HK_API = "https://haokan.baidu.com/web/search/api?query=%s&pn=%s&rn=%s&type=video";
    // 关键词搜索 MV API (哔哩哔哩)
    private static final String SEARCH_MV_BI_API
            = "http://api.bilibili.com/x/web-interface/search/type?search_type=video&keyword=%s&page=%s";

    // 获取榜单 API
    private static final String GET_RANKING_API
            = prefix + "/toplist";
    // 获取榜单 API (酷狗)
    private static final String GET_RANKING_KG_API
            = "http://mobilecdnbj.kugou.com/api/v3/rank/list?apiver=6&area_code=1";
    // 获取榜单 API (QQ)
    private static final String GET_RANKING_QQ_API
            = prefixQQ33 + "/top/category";
    // 获取榜单 API 2 (QQ)
    private static final String GET_RANKING_QQ_API_2
            = "https://c.y.qq.com/v8/fcg-bin/fcg_myqq_toplist.fcg?g_tk=1928093487&inCharset=utf-8&outCharset=utf-8&notice=0&format=json&uin=0&needNewCode=1&platform=h5";
    // 获取榜单 API (酷我)
//    private static final String GET_RANKING_KW_API = prefixKw + "/kuwo/rank";
    private static final String GET_RANKING_KW_API = "http://www.kuwo.cn/api/www/bang/bang/bangMenu?&httpsStatus=1";
    // 获取榜单 API 2 (酷我)
    private static final String GET_RANKING_KW_API_2
            = "http://qukudata.kuwo.cn/q.k?op=query&cont=tree&node=2&pn=0&rn=1000&fmt=json&level=2";
    // 获取推荐榜单 API (酷我)
//    private static final String GET_REC_RANKING_KW_API = "http://www.kuwo.cn/api/www/bang/index/bangList?&httpsStatus=1";
    // 获取榜单 API (咪咕)
    private static final String GET_RANKING_MG_API = "https://app.c.nf.migu.cn/MIGUM3.0/v1.0/template/rank-list";
    // 获取榜单 API (千千)
    private static final String GET_RANKING_QI_API = "https://music.91q.com/v1/bd/category?appid=16073360&timestamp=%s";
    // 获取榜单 API (猫耳)
    private static final String GET_RANKING_ME_API = "https://www.missevan.com/mobileWeb/albumList";

    // 关键词搜索用户 API
    private static final String SEARCH_USER_API
            = prefix + "/cloudsearch?type=1002&keywords=%s&offset=%s&limit=%s";
    // 关键词搜索用户 API (喜马拉雅)
    private static final String SEARCH_USER_XM_API
            = "https://www.ximalaya.com/revision/search/main?kw=%s&page=%s&spellchecker=true&condition=relation&rows=%s&core=user&device=iPhone";
    // 关键词搜索用户 API (猫耳)
    private static final String SEARCH_USER_ME_API
            = "https://www.missevan.com/sound/getsearch?s=%s&type=1&p=%s&page_size=%s";
    // 关键词搜索用户 API (好看)
    private static final String SEARCH_USER_HK_API
            = "https://haokan.baidu.com/web/search/api?query=%s&pn=%s&rn=%s&type=author";
    // 关键词搜索用户 API (豆瓣)
    private static final String SEARCH_USER_DB_API
            = "https://www.douban.com/j/search?q=%s&start=%s&cat=1005";
    // 关键词搜索用户 API (堆糖)
    private static final String SEARCH_USER_DT_API
            = "https://www.duitang.com/napi/people/list/by_search/?kw=%s&start=%s&limit=%s&type=people&_type=&_=%s";
    // 关键词搜索用户 API (哔哩哔哩)
    private static final String SEARCH_USER_BI_API
            = "http://api.bilibili.com/x/web-interface/search/type?search_type=bili_user&keyword=%s&page=%s";

    // 获取评论 API
    private static final String GET_COMMENTS_API = prefix + "/comment/new?type=%s&id=%s&pageNo=%s&pageSize=%s&sortType=%s&cursor=%s";
    // 获取评论 API (酷狗)
    private static final String GET_COMMENTS_KG_API
            = "https://mcomment.kugou.com/index.php?r=commentsv2/getCommentWithLike&code=fc4be23b4e972707f36b8a828a93ba8a&extdata=%s&p=%s&pagesize=%s";
    // 获取评论 API (QQ)
    private static final String GET_COMMENTS_QQ_API
            = prefixQQ33 + "/comment?type=%s&biztype=%s&id=%s&pageNo=%s&pageSize=%s";
    // 获取热门评论 API (酷我)
//    private static final String GET_HOT_COMMENTS_KW_API = prefixKw + "/kuwo/comment?digest=%s&sid=%s&type=get_rec_comment&page=%s&rows=%s";
    private static final String GET_HOT_COMMENTS_KW_API = "http://www.kuwo.cn/comment?digest=%s&sid=%s&&type=get_rec_comment&f=web&page=%s&rows=%s" +
            "&uid=0&prod=newWeb&httpsStatus=1";
    // 获取最新评论 API (酷我)
//    private static final String GET_NEW_COMMENTS_KW_API = prefixKw + "/kuwo/comment?digest=%s&sid=%s&type=get_comment&page=%s&rows=%s";
    private static final String GET_NEW_COMMENTS_KW_API = "http://www.kuwo.cn/comment?digest=%s&sid=%s&&type=get_comment&f=web&page=%s&rows=%s" +
            "&uid=0&prod=newWeb&httpsStatus=1";
    // 获取电台热门评论 API (喜马拉雅)
    private static final String GET_HOT_RADIO_COMMENTS_XM_API
            = "https://mobile.ximalaya.com/album-comment-mobile/web/album/comment/list/query/1?albumId=%s&order=content-score-desc&pageId=%s&pageSize=%s";
    // 获取电台最新评论 API (喜马拉雅)
    private static final String GET_NEW_RADIO_COMMENTS_XM_API
            = "https://mobile.ximalaya.com/album-comment-mobile/web/album/comment/list/query/1?albumId=%s&order=time-desc&pageId=%s&pageSize=%s";
    // 获取节目评论 API (喜马拉雅)
    private static final String GET_COMMENTS_XM_API = "https://www.ximalaya.com/revision/comment/queryComments?trackId=%s&page=%s&pageSize=%s";
    // 获取评论 API (音乐磁场)
    private static final String GET_COMMENTS_HF_API = "https://www.hifini.com/thread-%s-%s.htm?sort=desc";
    // 获取评论 API (咕咕咕音乐)
    private static final String GET_COMMENTS_GG_API = "http://www.gggmusic.com/thread-%s-%s.htm?sort=desc";
    // 获取节目评论 API (猫耳)
    private static final String GET_COMMENTS_ME_API
            = "https://www.missevan.com/site/getcomment?type=%s&order=%s&eId=%s&p=%s&pagesize=%s";
    // 获取评论 API (好看)
    private static final String GET_COMMENTS_HK_API
            = "https://haokan.baidu.com/videoui/api/commentget?url_key=%s&pn=%s&rn=%s&child_rn=1";
    // 获取电台评论 API (豆瓣)
    private static final String GET_RADIO_COMMENTS_DB_API
            = "https://movie.douban.com/subject/%s/comments/?sort=%s&start=%s&limit=%s&status=P";
    // 获取图书电台评论 API (豆瓣)
    private static final String GET_BOOK_RADIO_COMMENTS_DB_API
            = "https://book.douban.com/subject/%s/comments/?sort=%s&start=%s&limit=%s&status=P";
    // 获取游戏电台评论 API (豆瓣)
    private static final String GET_GAME_RADIO_COMMENTS_DB_API
            = "https://www.douban.com/game/%s/comments?sort=%s&start=%s";
    // 获取专辑评论 API (豆瓣)
    private static final String GET_ALBUM_COMMENTS_DB_API
            = "https://music.douban.com/subject/%s/comments/?sort=%s&start=%s&limit=%s&status=P";
    // 获取视频评论 API (哔哩哔哩)
    private static final String GET_VIDEO_COMMENTS_BI_API
            = "http://api.bilibili.com/x/v2/reply?type=1&oid=%s&sort=%s&pn=%s&ps=%s";
    // 获取音频评论 API (哔哩哔哩)
    private static final String GET_SONG_COMMENTS_BI_API
            = "http://api.bilibili.com/x/v2/reply?type=14&oid=%s&sort=%s&pn=%s&ps=%s";

    // 获取乐谱 API
    private static final String GET_SHEETS_API = prefix + "/sheet/list?id=%s";
    // 获取乐谱图片 API
    private static final String GET_SHEETS_IMG_API = prefix + "/sheet/preview?id=%s";

    // 获取专辑照片 API (堆糖)
    private static final String GET_ALBUMS_IMG_DT_API
            = "https://www.duitang.com/napi/vienna/blog/by_album/?album_id=%s&after_id=%s&limit=%s&_=%s";
    // 获取歌手照片 API (豆瓣)
    private static final String GET_ARTISTS_IMG_DB_API
            = "https://movie.douban.com/celebrity/%s/photos/?type=C&start=%s&sortby=like&size=a&subtype=a";
    // 获取电台照片 API (豆瓣)
    private static final String GET_RADIO_IMG_DB_API
            = "https://movie.douban.com/subject/%s/photos?type=S&start=%s&sortby=like&size=a&subtype=a";
    // 获取电台海报 API (豆瓣)
    private static final String GET_RADIO_POSTER_DB_API
            = "https://movie.douban.com/subject/%s/photos?type=R&start=%s&sortby=like&size=a&subtype=a";
    // 获取游戏电台照片 API (豆瓣)
    private static final String GET_GAME_RADIO_IMG_DB_API
            = "https://www.douban.com/game/%s/photos/?type=all&start=%s&sortby=hot";

    /**
     * 加载推荐歌单标签
     *
     * @return
     */
    public static void initRecPlaylistTag() {
        // 网易云 酷狗 QQ 猫耳
        Tags.recPlaylistTag.put("默认", new String[]{"", " ", "10000000", " "});

        final int c = 4;
        // 网易云曲风
        Runnable initRecPlaylistTag = () -> {
            String tagBody = HttpRequest.get(String.format(STYLE_API))
                    .execute()
                    .body();
            JSONObject tagJson = JSONObject.fromObject(tagBody);
            JSONArray tags = tagJson.getJSONArray("data");
            for (int i = 0, len = tags.size(); i < len; i++) {
                JSONObject tag = tags.getJSONObject(i);

                String name = tag.getString("tagName");
                String id = tag.getString("tagId");

                if (!Tags.recPlaylistTag.containsKey(name)) Tags.recPlaylistTag.put(name, new String[c]);
                Tags.recPlaylistTag.get(name)[0] = id;
                // 子标签
                JSONArray subTags = tag.optJSONArray("childrenTags");
                if (subTags == null) continue;
                for (int j = 0, s = subTags.size(); j < s; j++) {
                    JSONObject subTag = subTags.getJSONObject(j);

                    String subName = subTag.getString("tagName");
                    String subId = subTag.getString("tagId");

                    if (!Tags.recPlaylistTag.containsKey(subName)) Tags.recPlaylistTag.put(subName, new String[c]);
                    Tags.recPlaylistTag.get(subName)[0] = subId;
                    // 孙子标签
                    JSONArray ssTags = subTag.optJSONArray("childrenTags");
                    if (ssTags == null) continue;
                    for (int k = 0, l = ssTags.size(); k < l; k++) {
                        JSONObject ssTag = ssTags.getJSONObject(k);

                        String ssName = ssTag.getString("tagName");
                        String ssId = ssTag.getString("tagId");

                        if (!Tags.recPlaylistTag.containsKey(ssName)) Tags.recPlaylistTag.put(ssName, new String[c]);
                        Tags.recPlaylistTag.get(ssName)[0] = ssId;
                    }
                }
            }
        };

        // 酷狗
        Runnable initRecPlaylistTagKg = () -> {
            String playlistTagBody = HttpRequest.get(String.format(PLAYLIST_TAG_KG_API))
                    .execute()
                    .body();
            JSONObject playlistTagJson = JSONObject.fromObject(playlistTagBody);
            JSONObject tagIds = playlistTagJson.getJSONObject("data").getJSONObject("tagids");
            final String[] cats = new String[]{"主题", "语种", "风格", "年代", "心情", "场景"};
            for (int i = 0, len = cats.length; i < len; i++) {
                JSONArray tagArray = tagIds.getJSONObject(cats[i]).getJSONArray("data");
                for (int j = 0, s = tagArray.size(); j < s; j++) {
                    JSONObject tagJson = tagArray.getJSONObject(j);

                    String name = tagJson.getString("name");
                    String id = tagJson.getString("id");

                    if (!Tags.recPlaylistTag.containsKey(name)) Tags.recPlaylistTag.put(name, new String[c]);
                    Tags.recPlaylistTag.get(name)[1] = id;
                }
            }
        };

        // QQ
        Runnable initRecPlaylistTagQq = () -> {
            String playlistTagBody = HttpRequest.get(PLAYLIST_TAG_QQ_API)
                    .execute()
                    .body();
            JSONObject playlistTagJson = JSONObject.fromObject(playlistTagBody);
            JSONArray tags = playlistTagJson.getJSONObject("tags").getJSONObject("data").getJSONArray("v_group");
            for (int i = 0, len = tags.size(); i < len; i++) {
                JSONArray tagArray = tags.getJSONObject(i).getJSONArray("v_item");
                for (int j = 0, s = tagArray.size(); j < s; j++) {
                    JSONObject tagJson = tagArray.getJSONObject(j);

                    String name = tagJson.getString("name");
                    String id = tagJson.getString("id");

                    if (!Tags.recPlaylistTag.containsKey(name)) Tags.recPlaylistTag.put(name, new String[c]);
                    Tags.recPlaylistTag.get(name)[2] = id;
                }
            }
        };

        // 猫耳
        Runnable initRecPlaylistTagMe = () -> {
            String playlistTagBody = HttpRequest.get(String.format(PLAYLIST_TAG_ME_API))
                    .execute()
                    .body();
            JSONObject playlistTagJson = JSONObject.fromObject(playlistTagBody);
            JSONObject tags = playlistTagJson.getJSONObject("info");
            final String[] cats = new String[]{"主题", "场景", "情感"};
            for (int i = 0, len = tags.size(); i < len; i++) {
                JSONArray tagArray = tags.getJSONArray(cats[i]);
                for (int j = 0, s = tagArray.size(); j < s; j++) {
                    JSONArray tagJsonArray = tagArray.getJSONArray(j);

                    String name = tagJsonArray.getString(1);
                    String id = tagJsonArray.getString(0);

                    if (!Tags.recPlaylistTag.containsKey(name)) Tags.recPlaylistTag.put(name, new String[c]);
                    Tags.recPlaylistTag.get(name)[3] = id;
                }
            }
        };

        List<Future<?>> taskList = new LinkedList<>();

        taskList.add(GlobalExecutors.requestExecutor.submit(initRecPlaylistTag));
        taskList.add(GlobalExecutors.requestExecutor.submit(initRecPlaylistTagKg));
        taskList.add(GlobalExecutors.requestExecutor.submit(initRecPlaylistTagQq));
        taskList.add(GlobalExecutors.requestExecutor.submit(initRecPlaylistTagMe));

        taskList.forEach(task -> {
            try {
                task.get();
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
    }

    // 推荐歌单 API
    private static final String RECOMMEND_PLAYLIST_API = prefix + "/personalized?limit=100";
    // 发现歌单 API
    private static final String DISCOVER_PLAYLIST_API = "https://music.163.com/discover/playlist/?order=hot&offset=%s&limit=%s";
    // 曲风歌单 API
    private static final String STYLE_PLAYLIST_API = prefix + "/style/playlist?tagId=%s&cursor=%s&size=%s";
    // 推荐歌单 API (每页固定 30 条)(酷狗)
    private static final String RECOMMEND_PLAYLIST_KG_API
            = "http://m.kugou.com/plist/index?json=true&page=%s";
    // 推荐分类歌单(推荐) API (酷狗)
    private static final String RECOMMEND_CAT_PLAYLIST_KG_API
            = "http://www2.kugou.kugou.com/yueku/v9/special/getSpecial?is_ajax=1&cdn=cdn&t=5&c=%s&p=%s";
    // 推荐分类歌单(最新) API (酷狗)
    private static final String NEW_CAT_PLAYLIST_KG_API
            = "http://www2.kugou.kugou.com/yueku/v9/special/getSpecial?is_ajax=1&cdn=cdn&t=7&c=%s&p=%s";
    // 每日推荐歌单 API (QQ)
    private static final String DAILY_RECOMMEND_PLAYLIST_QQ_API
            = prefixQQ33 + "/recommend/playlist/u";
    // 推荐歌单 API (QQ)
    private static final String RECOMMEND_PLAYLIST_QQ_API
            = prefixQQ33 + "/recommend/playlist?id=%s&pageNo=1&pageSize=120";
    // 推荐歌单(最新) API (QQ)
    private static final String NEW_PLAYLIST_QQ_API
            = "https://u.y.qq.com/cgi-bin/musicu.fcg?loginUin=0&hostUin=0&format=json&inCharset=utf-8&outCharset=utf-8&notice=0&platform=wk_v15.json&needNewCode=0&data=";
    // 推荐歌单 API (酷我)
//    private static final String RECOMMEND_PLAYLIST_KW_API = prefixKw + "/kuwo/rec_gedan";
    private static final String RECOMMEND_PLAYLIST_KW_API = "https://kuwo.cn/api/www/rcm/index/playlist?loginUid=0&httpsStatus=1";
    // 推荐歌单(最新) API (酷我)
    private static final String NEW_PLAYLIST_KW_API
            = "http://wapi.kuwo.cn/api/pc/classify/playlist/getRcmPlayList?pn=%s&rn=%s&order=new";
    // 推荐歌单 API(最新) (咪咕)
    private static final String REC_NEW_PLAYLIST_MG_API
            = "https://app.c.nf.migu.cn/MIGUM2.0/v2.0/content/getMusicData.do?start=%s&count=%s&templateVersion=5&type=2";
    // 最新歌单 API (咪咕)
    private static final String NEW_PLAYLIST_MG_API
            = "https://m.music.migu.cn/migu/remoting/playlist_bycolumnid_tag?playListType=2&type=1&columnId=15127272&startIndex=%s";
    // 推荐歌单 API (千千)
    private static final String REC_PLAYLIST_QI_API
            = "https://music.91q.com/v1/index?appid=16073360&pageSize=12&timestamp=%s&type=song";
    // 推荐歌单 API (猫耳)
    private static final String REC_PLAYLIST_ME_API
            = "https://www.missevan.com/site/homepage";
    // 分类歌单(最新) API (猫耳)
    private static final String NEW_PLAYLIST_ME_API
            = "https://www.missevan.com/explore/tagalbum?order=1&tid=%s&p=%s&pagesize=%s";
    // 推荐歌单 API (哔哩哔哩)
    private static final String NEW_PLAYLIST_BI_API
            = "https://www.bilibili.com/audio/music-service-c/web/menu/hit?pn=%s&ps=%s";

    // 精品歌单标签 API
    private static final String HIGH_QUALITY_PLAYLIST_TAG_API
            = prefix + "/playlist/highquality/tags";
    // 网友精选碟标签 API
    private static final String PICKED_PLAYLIST_TAG_API
            = prefix + "/playlist/catlist";
    // 歌单标签 API (酷狗)
    private static final String PLAYLIST_TAG_KG_API
            = "http://www2.kugou.kugou.com/yueku/v9/special/getSpecial?is_smarty=1";
    // 歌单标签 API (QQ)
    private static final String PLAYLIST_TAG_QQ_API
            = "https://u.y.qq.com/cgi-bin/musicu.fcg?loginUin=0&hostUin=0&format=json&inCharset=utf-8&outCharset=utf-8" +
            "&notice=0&platform=wk_v15.json&needNewCode=0&data=%7B%22tags%22%3A%7B%22method%22%3A%22get_all_categories" +
            "%22%2C%22param%22%3A%7B%22qq%22%3A%22%22%7D%2C%22module%22%3A%22playlist.PlaylistAllCategoriesServer%22%7D%7D";
    // 歌单标签 API (酷我)
    private static final String PLAYLIST_TAG_KW_API
            = "http://wapi.kuwo.cn/api/pc/classify/playlist/getTagList?cmd=rcm_keyword_playlist&user=0" +
            "&prod=kwplayer_pc_9.0.5.0&vipver=9.0.5.0&source=kwplayer_pc_9.0.5.0&loginUid=0&loginSid=0&appUid=76039576";
    // 歌单标签 API (咪咕)
    private static final String PLAYLIST_TAG_MG_API = "https://app.c.nf.migu.cn/MIGUM3.0/v1.0/template/musiclistplaza-taglist/release";
    // 歌单标签 API (千千)
    private static final String PLAYLIST_TAG_QI_API
            = "https://music.91q.com/v1/tracklist/category?appid=16073360&timestamp=%s";
    // 歌单标签 API (猫耳)
    private static final String PLAYLIST_TAG_ME_API
            = "https://www.missevan.com/malbum/recommand";
    // 探索歌单标签 API (猫耳)
    private static final String EXP_PLAYLIST_TAG_ME_API
            = "https://www.missevan.com/explore";

    /**
     * 加载歌单标签
     *
     * @return
     */
    public static void initPlaylistTag() {
        // 网易云精品歌单 网易云网友精选碟 酷狗 QQ 酷我 咪咕 千千 猫耳 猫耳探索
        Tags.playlistTag.put("默认", new String[]{"全部", "全部", " ", "10000000", "", "", " ", " ", ""});

        final int c = 9;
        // 网易云
        // 精品歌单标签
        Runnable initHighQualityPlaylistTag = () -> {
            String playlistTagBody = HttpRequest.get(String.format(HIGH_QUALITY_PLAYLIST_TAG_API))
                    .execute()
                    .body();
            JSONObject playlistTagJson = JSONObject.fromObject(playlistTagBody);
            JSONArray tags = playlistTagJson.getJSONArray("tags");
            for (int i = 0, len = tags.size(); i < len; i++) {
                JSONObject tagJson = tags.getJSONObject(i);

                String name = tagJson.getString("name");

                if (!Tags.playlistTag.containsKey(name)) Tags.playlistTag.put(name, new String[c]);
                Tags.playlistTag.get(name)[0] = StringUtil.encode(name);
            }
        };
        // 网友精选碟标签
        Runnable initPickedPlaylistTag = () -> {
            String playlistTagBody = HttpRequest.get(String.format(PICKED_PLAYLIST_TAG_API))
                    .execute()
                    .body();
            JSONObject playlistTagJson = JSONObject.fromObject(playlistTagBody);
            JSONArray tags = playlistTagJson.getJSONArray("sub");
            for (int i = 0, len = tags.size(); i < len; i++) {
                JSONObject tagJson = tags.getJSONObject(i);

                String name = tagJson.getString("name");

                if (!Tags.playlistTag.containsKey(name)) Tags.playlistTag.put(name, new String[c]);
                Tags.playlistTag.get(name)[1] = StringUtil.encode(name);
            }
        };

        // 酷狗
        Runnable initPlaylistTagKg = () -> {
            String playlistTagBody = HttpRequest.get(String.format(PLAYLIST_TAG_KG_API))
                    .execute()
                    .body();
            JSONObject playlistTagJson = JSONObject.fromObject(playlistTagBody);
            JSONObject tagIds = playlistTagJson.getJSONObject("data").getJSONObject("tagids");
            final String[] cats = new String[]{"主题", "语种", "风格", "年代", "心情", "场景"};
            for (int i = 0, len = cats.length; i < len; i++) {
                JSONArray tagArray = tagIds.getJSONObject(cats[i]).getJSONArray("data");
                for (int j = 0, s = tagArray.size(); j < s; j++) {
                    JSONObject tagJson = tagArray.getJSONObject(j);

                    String name = tagJson.getString("name");
                    String id = tagJson.getString("id");

                    if (!Tags.playlistTag.containsKey(name)) Tags.playlistTag.put(name, new String[c]);
                    Tags.playlistTag.get(name)[2] = id;
                }
            }
        };

        // QQ
        Runnable initPlaylistTagQq = () -> {
            String playlistTagBody = HttpRequest.get(PLAYLIST_TAG_QQ_API)
                    .execute()
                    .body();
            JSONObject playlistTagJson = JSONObject.fromObject(playlistTagBody);
            JSONArray tags = playlistTagJson.getJSONObject("tags").getJSONObject("data").getJSONArray("v_group");
            for (int i = 0, len = tags.size(); i < len; i++) {
                JSONArray tagArray = tags.getJSONObject(i).getJSONArray("v_item");
                for (int j = 0, s = tagArray.size(); j < s; j++) {
                    JSONObject tagJson = tagArray.getJSONObject(j);

                    String name = tagJson.getString("name");
                    String id = tagJson.getString("id");

                    if (!Tags.playlistTag.containsKey(name)) Tags.playlistTag.put(name, new String[c]);
                    Tags.playlistTag.get(name)[3] = id;
                }
            }
        };

        // 酷我
        Runnable initPlaylistTagKw = () -> {
            String playlistTagBody = HttpRequest.get(String.format(PLAYLIST_TAG_KW_API))
                    .execute()
                    .body();
            JSONObject playlistTagJson = JSONObject.fromObject(playlistTagBody);
            JSONArray tags = playlistTagJson.getJSONArray("data");
            for (int i = 0, len = tags.size(); i < len; i++) {
                JSONArray tagArray = tags.getJSONObject(i).getJSONArray("data");
                for (int j = 0, s = tagArray.size(); j < s; j++) {
                    JSONObject tagJson = tagArray.getJSONObject(j);

                    String name = tagJson.getString("name");
                    String id = String.format("%s %s", tagJson.getString("id"), tagJson.getString("digest"));

                    if (!Tags.playlistTag.containsKey(name)) Tags.playlistTag.put(name, new String[c]);
                    Tags.playlistTag.get(name)[4] = id;
                }
            }
        };

        // 咪咕
        Runnable initPlaylistTagMg = () -> {
            String playlistTagBody = HttpRequest.get(String.format(PLAYLIST_TAG_MG_API))
                    .execute()
                    .body();
            JSONObject playlistTagJson = JSONObject.fromObject(playlistTagBody);
            JSONArray tags = playlistTagJson.getJSONArray("data");
            for (int i = 0, len = tags.size(); i < len; i++) {
                JSONArray tagArray = tags.getJSONObject(i).getJSONArray("content");
                for (int j = 0, s = tagArray.size(); j < s; j++) {
                    JSONArray tagJsonArray = tagArray.getJSONObject(j).getJSONArray("texts");

                    String name = tagJsonArray.getString(0);
                    String id = tagJsonArray.getString(1);

                    if (!Tags.playlistTag.containsKey(name)) Tags.playlistTag.put(name, new String[c]);
                    Tags.playlistTag.get(name)[5] = id;
                }
            }
        };

        // 千千
        Runnable initPlaylistTagQi = () -> {
            String playlistTagBody = HttpRequest.get(buildQianUrl(String.format(PLAYLIST_TAG_QI_API, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject playlistTagJson = JSONObject.fromObject(playlistTagBody);
            JSONArray tags = playlistTagJson.getJSONArray("data");
            for (int i = 0, len = tags.size(); i < len; i++) {
                JSONArray tagArray = tags.getJSONObject(i).getJSONArray("subCate");
                for (int j = 0, s = tagArray.size(); j < s; j++) {
                    JSONObject tagJson = tagArray.getJSONObject(j);

                    String name = tagJson.getString("categoryName");
                    String id = tagJson.getString("id");

                    if (!Tags.playlistTag.containsKey(name)) Tags.playlistTag.put(name, new String[c]);
                    Tags.playlistTag.get(name)[6] = id;
                }
            }
        };

        // 猫耳
        Runnable initPlaylistTagMe = () -> {
            String playlistTagBody = HttpRequest.get(String.format(PLAYLIST_TAG_ME_API))
                    .execute()
                    .body();
            JSONObject playlistTagJson = JSONObject.fromObject(playlistTagBody);
            JSONObject tags = playlistTagJson.getJSONObject("info");
            final String[] cats = new String[]{"主题", "场景", "情感"};
            for (int i = 0, len = tags.size(); i < len; i++) {
                JSONArray tagArray = tags.getJSONArray(cats[i]);
                for (int j = 0, s = tagArray.size(); j < s; j++) {
                    JSONArray tagJsonArray = tagArray.getJSONArray(j);

                    String name = tagJsonArray.getString(1);
                    String id = tagJsonArray.getString(0);

                    if (!Tags.playlistTag.containsKey(name)) Tags.playlistTag.put(name, new String[c]);
                    Tags.playlistTag.get(name)[7] = id;
                }
            }
        };
        // 猫耳探索
        Runnable initExpPlaylistTagMe = () -> {
            String playlistTagBody = HttpRequest.get(String.format(EXP_PLAYLIST_TAG_ME_API))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(playlistTagBody);

            Elements tags = doc.select(".explore-tag");
            for (int i = 0, len = tags.size(); i < len; i++) {
                Element t = tags.get(i);

                String id = t.attr("data-tagid");
                String name = t.getElementsByTag("a").text().trim();

                if (!Tags.playlistTag.containsKey(name)) Tags.playlistTag.put(name, new String[c]);
                Tags.playlistTag.get(name)[8] = id;
            }
        };

        List<Future<?>> taskList = new LinkedList<>();

        taskList.add(GlobalExecutors.requestExecutor.submit(initHighQualityPlaylistTag));
        taskList.add(GlobalExecutors.requestExecutor.submit(initPickedPlaylistTag));
        taskList.add(GlobalExecutors.requestExecutor.submit(initPlaylistTagKg));
        taskList.add(GlobalExecutors.requestExecutor.submit(initPlaylistTagQq));
        taskList.add(GlobalExecutors.requestExecutor.submit(initPlaylistTagKw));
        taskList.add(GlobalExecutors.requestExecutor.submit(initPlaylistTagMg));
        taskList.add(GlobalExecutors.requestExecutor.submit(initPlaylistTagQi));
        taskList.add(GlobalExecutors.requestExecutor.submit(initPlaylistTagMe));
        taskList.add(GlobalExecutors.requestExecutor.submit(initExpPlaylistTagMe));

        taskList.forEach(task -> {
            try {
                task.get();
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
    }

    // 精品歌单 API
    private static final String HIGH_QUALITY_PLAYLIST_API
            = prefix + "/top/playlist/highquality?cat=%s&limit=100";
    // 网友精选碟(最热) API
    private static final String HOT_PICKED_PLAYLIST_API
            = prefix + "/top/playlist?cat=%s&limit=%s&offset=%s";
    // 网友精选碟(最新) API
    private static final String NEW_PICKED_PLAYLIST_API
            = prefix + "/top/playlist?order=new&cat=%s&limit=%s&offset=%s";
    // 推荐分类歌单(最热) API (酷狗)
    private static final String CAT_PLAYLIST_KG_API
            = "http://www2.kugou.kugou.com/yueku/v9/special/getSpecial?is_ajax=1&cdn=cdn&t=6&c=%s&p=%s";
    // 推荐分类歌单(热藏) API (酷狗)
    private static final String HOT_COLLECTED_CAT_PLAYLIST_KG_API
            = "http://www2.kugou.kugou.com/yueku/v9/special/getSpecial?is_ajax=1&cdn=cdn&t=3&c=%s&p=%s";
    // 推荐分类歌单(飙升) API (酷狗)
    private static final String UP_CAT_PLAYLIST_KG_API
            = "http://www2.kugou.kugou.com/yueku/v9/special/getSpecial?is_ajax=1&cdn=cdn&t=8&c=%s&p=%s";
    // 热门歌单 API (酷狗)
    private static final String HOT_PLAYLIST_KG_API
            = "http://mobilecdnbj.kugou.com/api/v5/special/recommend?recommend_expire=0&sign=52186982747e1404d426fa3f2a1e8ee4&plat=0&uid=0&version=9108&page=1&area_code=1&appid=1005&mid=286974383886022203545511837994020015101&_t=1545746286";
    // 分类歌单 API (QQ)
    private static final String CAT_PLAYLIST_QQ_API
            = "https://u.y.qq.com/cgi-bin/musicu.fcg?loginUin=0&hostUin=0&format=json&inCharset=utf-8&outCharset=utf-8&notice=0&platform=wk_v15.json&needNewCode=0&data=";
    // 热门歌单 API (酷我)
    private static final String HOT_PLAYLIST_KW_API
            = "https://www.kuwo.cn/api/pc/classify/playlist/getRcmPlayList?pn=%s&rn=%s&order=hot&httpsStatus=1";
    // 默认歌单(热门) API (酷我)
    private static final String DEFAULT_PLAYLIST_KW_API
            = "http://wapi.kuwo.cn/api/pc/classify/playlist/getRcmPlayList?pn=%s&rn=%s&order=hot";
    // 分类歌单 API (酷我)
    private static final String CAT_PLAYLIST_KW_API
            = "http://wapi.kuwo.cn/api/pc/classify/playlist/getTagPlayList?loginUid=0&loginSid=0&appUid=76039576&id=%s&pn=%s&rn=%s";
    // 分类歌单 API 2 (酷我)
    private static final String CAT_PLAYLIST_KW_API_2
            = "http://mobileinterfaces.kuwo.cn/er.s?type=get_pc_qz_data&f=web&id=%s&prod=pc";
    // 推荐歌单 API(最热) (咪咕)
    private static final String REC_HOT_PLAYLIST_MG_API
            = "https://app.c.nf.migu.cn/MIGUM2.0/v2.0/content/getMusicData.do?start=%s&count=%s&templateVersion=5&type=1";
    // 推荐歌单(最热) API (咪咕)
    private static final String RECOMMEND_PLAYLIST_MG_API
            = "https://m.music.migu.cn/migu/remoting/playlist_bycolumnid_tag?playListType=2&type=1&columnId=15127315&startIndex=%s";
    // 分类歌单 API (咪咕)
    private static final String CAT_PLAYLIST_MG_API
            = "https://app.c.nf.migu.cn/MIGUM3.0/v1.0/template/musiclistplaza-listbytag?tagId=%s&pageNumber=%s&templateVersion=1";
    // 分类歌单 API (千千)
    private static final String CAT_PLAYLIST_QI_API
            = "https://music.91q.com/v1/tracklist/list?appid=16073360&pageNo=%s&pageSize=%s&subCateId=%s&timestamp=%s";
    // 分类歌单 API (猫耳)
    private static final String CAT_PLAYLIST_ME_API
            = "https://www.missevan.com/explore/tagalbum?order=0&tid=%s&p=%s&pagesize=%s";
    // 探索歌单 API (猫耳)
    private static final String EXP_PLAYLIST_ME_API
            = "https://www.missevan.com/explore/getAlbumFromTag/%s";

    /**
     * 加载飙升歌曲标签
     *
     * @return
     */
    public static void initHotSongTag() {
        Tags.hotSongTag.put("默认", new String[]{"", "index", "index"});

        // 音乐磁场
        Tags.hotSongTag.put("热门", new String[]{"", "index-0-2", "index-0-hot"});
        Tags.hotSongTag.put("月榜", new String[]{"", "index-0-3", ""});
        Tags.hotSongTag.put("周榜", new String[]{"", "index-0-4", ""});
        Tags.hotSongTag.put("日榜", new String[]{"", "index-0-5", ""});
        Tags.hotSongTag.put("华语", new String[]{"", "forum-1", "forum-1"});
        Tags.hotSongTag.put("日韩", new String[]{"", "forum-15", "forum-7"});
        Tags.hotSongTag.put("欧美", new String[]{"", "forum-10", "forum-3"});
        Tags.hotSongTag.put("Remix", new String[]{"", "forum-11", ""});
        Tags.hotSongTag.put("纯音乐", new String[]{"", "forum-12", "forum-6"});
        Tags.hotSongTag.put("异次元", new String[]{"", "forum-13", ""});
        Tags.hotSongTag.put("特供", new String[]{"", "forum-17", ""});
        Tags.hotSongTag.put("百科", new String[]{"", "forum-18", ""});
        Tags.hotSongTag.put("站务", new String[]{"", "forum-9", ""});

        // 咕咕咕音乐
        Tags.hotSongTag.put("音乐分享区", new String[]{"", "", "forum-12"});
        Tags.hotSongTag.put("伤感", new String[]{"", "", "forum-8"});
        Tags.hotSongTag.put("粤语", new String[]{"", "", "forum-2"});
        Tags.hotSongTag.put("青春", new String[]{"", "", "forum-5"});
        Tags.hotSongTag.put("分享", new String[]{"", "", "forum-11"});
        Tags.hotSongTag.put("温柔男友音", new String[]{"", "", "forum-10"});
        Tags.hotSongTag.put("DJ", new String[]{"", "", "forum-9"});

        final int c = 3;
        // 网易云曲风
        Runnable initHotSongTag = () -> {
            String tagBody = HttpRequest.get(String.format(STYLE_API))
                    .execute()
                    .body();
            JSONObject tagJson = JSONObject.fromObject(tagBody);
            JSONArray tags = tagJson.getJSONArray("data");
            for (int i = 0, len = tags.size(); i < len; i++) {
                JSONObject tag = tags.getJSONObject(i);

                String name = tag.getString("tagName");
                String id = tag.getString("tagId");

                if (!Tags.hotSongTag.containsKey(name)) Tags.hotSongTag.put(name, new String[c]);
                Tags.hotSongTag.get(name)[0] = id;
                // 子标签
                JSONArray subTags = tag.optJSONArray("childrenTags");
                if (subTags == null) continue;
                for (int j = 0, s = subTags.size(); j < s; j++) {
                    JSONObject subTag = subTags.getJSONObject(j);

                    String subName = subTag.getString("tagName");
                    String subId = subTag.getString("tagId");

                    if (!Tags.hotSongTag.containsKey(subName)) Tags.hotSongTag.put(subName, new String[c]);
                    Tags.hotSongTag.get(subName)[0] = subId;
                    // 孙子标签
                    JSONArray ssTags = subTag.optJSONArray("childrenTags");
                    if (ssTags == null) continue;
                    for (int k = 0, l = ssTags.size(); k < l; k++) {
                        JSONObject ssTag = ssTags.getJSONObject(k);

                        String ssName = ssTag.getString("tagName");
                        String ssId = ssTag.getString("tagId");

                        if (!Tags.hotSongTag.containsKey(ssName)) Tags.hotSongTag.put(ssName, new String[c]);
                        Tags.hotSongTag.get(ssName)[0] = ssId;
                    }
                }
            }
        };

        List<Future<?>> taskList = new LinkedList<>();

        taskList.add(GlobalExecutors.requestExecutor.submit(initHotSongTag));

        taskList.forEach(task -> {
            try {
                task.get();
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
    }

    // 飙升榜 API (酷狗)
    private static final String UP_MUSIC_KG_API
            = "http://mobilecdnbj.kugou.com/api/v3/rank/song?volid=35050&rankid=6666&page=%s&pagesize=%s";
    // TOP500 API (酷狗)
    private static final String TOP500_KG_API
            = "http://mobilecdnbj.kugou.com/api/v3/rank/song?volid=35050&rankid=8888&page=%s&pagesize=%s";
    // 流行指数榜 API (QQ)
    private static final String POPULAR_MUSIC_QQ_API
            = prefixQQ33 + "/top?id=4&pageNo=%s&pageSize=%s";
    // 热歌榜 API (QQ)
    private static final String HOT_MUSIC_QQ_API
            = prefixQQ33 + "/top?id=26&pageNo=%s&pageSize=%s";
    // 飙升榜 API (酷我)
//    private static final String UP_MUSIC_KW_API = prefixKw + "/kuwo/rank/musicList?bangId=93&pn=%s&rn=%s";
    private static final String UP_MUSIC_KW_API = "http://www.kuwo.cn/api/www/bang/bang/musicList?bangId=93&pn=%s&rn=%s&httpsStatus=1";
    // 热歌榜 API (酷我)
//    private static final String HOT_MUSIC_KW_API = prefixKw + "/kuwo/rank/musicList?bangId=16&pn=%s&rn=%s";
    private static final String HOT_MUSIC_KW_API = "http://www.kuwo.cn/api/www/bang/bang/musicList?bangId=16&pn=%s&rn=%s&httpsStatus=1";
    // 尖叫热歌榜 API (咪咕)
    private static final String HOT_MUSIC_MG_API = "https://app.c.nf.migu.cn/MIGUM2.0/v1.0/content/querycontentbyId.do?columnId=27186466";
    // 热歌 API (音乐磁场)
    private static final String HOT_MUSIC_HF_API = "https://www.hifini.com/%s-%s.htm";
    // 热歌 API (咕咕咕音乐)
    private static final String HOT_MUSIC_GG_API = "http://www.gggmusic.com/%s-%s.htm";

    // 曲风 API
    private static final String STYLE_API = prefix + "/style/list";

    /**
     * 加载新歌标签
     *
     * @return
     */
    public static void initNewSongTag() {
        // 网易云 网易云 酷狗 QQ 音乐磁场 咕咕咕音乐
        Tags.newSongTag.put("默认", new String[]{"0", "", "1", "0", "", ""});

        Tags.newSongTag.put("华语", new String[]{"7", "", "1", "0", "forum-1", "forum-1"});
        Tags.newSongTag.put("内地", new String[]{"", "", "", "1", "", ""});
        Tags.newSongTag.put("港台", new String[]{"", "", "", "2", "", ""});
        Tags.newSongTag.put("欧美", new String[]{"96", "", "2", "3", "forum-10", "forum-3"});
        Tags.newSongTag.put("韩国", new String[]{"16", "", "4", "4", "", ""});
        Tags.newSongTag.put("日本", new String[]{"8", "", "5", "5", "", ""});
        Tags.newSongTag.put("日韩", new String[]{"", "", "3", "", "forum-15", "forum-7"});

        // 音乐磁场
        Tags.newSongTag.put("Remix", new String[]{"", "", "", "", "forum-11", ""});
        Tags.newSongTag.put("纯音乐", new String[]{"", "", "", "", "forum-12", ""});
        Tags.newSongTag.put("异次元", new String[]{"", "", "", "", "forum-13", ""});
        Tags.newSongTag.put("特供", new String[]{"", "", "", "", "forum-17", ""});
        Tags.newSongTag.put("百科", new String[]{"", "", "", "", "forum-18", ""});
        Tags.newSongTag.put("站务", new String[]{"", "", "", "", "forum-9", ""});

        // 咕咕咕音乐
        Tags.newSongTag.put("音乐分享区", new String[]{"", "", "", "", "", "forum-12"});
        Tags.newSongTag.put("伤感", new String[]{"", "", "", "", "", "forum-8"});
        Tags.newSongTag.put("粤语", new String[]{"", "", "", "", "", "forum-2"});
        Tags.newSongTag.put("青春", new String[]{"", "", "", "", "", "forum-5"});
        Tags.newSongTag.put("分享", new String[]{"", "", "", "", "", "forum-11"});
        Tags.newSongTag.put("温柔男友音", new String[]{"", "", "", "", "", "forum-10"});
        Tags.newSongTag.put("DJ", new String[]{"", "", "", "", "", "forum-9"});

        final int c = 6;
        // 网易云曲风
        Runnable initNewSongTag = () -> {
            String tagBody = HttpRequest.get(String.format(STYLE_API))
                    .execute()
                    .body();
            JSONObject tagJson = JSONObject.fromObject(tagBody);
            JSONArray tags = tagJson.getJSONArray("data");
            for (int i = 0, len = tags.size(); i < len; i++) {
                JSONObject tag = tags.getJSONObject(i);

                String name = tag.getString("tagName");
                String id = tag.getString("tagId");

                if (!Tags.newSongTag.containsKey(name)) Tags.newSongTag.put(name, new String[c]);
                Tags.newSongTag.get(name)[1] = id;
                // 子标签
                JSONArray subTags = tag.optJSONArray("childrenTags");
                if (subTags == null) continue;
                for (int j = 0, s = subTags.size(); j < s; j++) {
                    JSONObject subTag = subTags.getJSONObject(j);

                    String subName = subTag.getString("tagName");
                    String subId = subTag.getString("tagId");

                    if (!Tags.newSongTag.containsKey(subName)) Tags.newSongTag.put(subName, new String[c]);
                    Tags.newSongTag.get(subName)[1] = subId;
                    // 孙子标签
                    JSONArray ssTags = subTag.optJSONArray("childrenTags");
                    if (ssTags == null) continue;
                    for (int k = 0, l = ssTags.size(); k < l; k++) {
                        JSONObject ssTag = ssTags.getJSONObject(k);

                        String ssName = ssTag.getString("tagName");
                        String ssId = ssTag.getString("tagId");

                        if (!Tags.newSongTag.containsKey(ssName)) Tags.newSongTag.put(ssName, new String[c]);
                        Tags.newSongTag.get(ssName)[1] = ssId;
                    }
                }
            }
        };

        List<Future<?>> taskList = new LinkedList<>();

        taskList.add(GlobalExecutors.requestExecutor.submit(initNewSongTag));

        taskList.forEach(task -> {
            try {
                task.get();
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
    }

    // 曲风歌曲(最热) API
    private static final String STYLE_HOT_SONG_API = prefix + "/style/song?tagId=%s&sort=0&cursor=%s&size=%s";

    // 推荐新歌 API
    private static final String RECOMMEND_NEW_SONG_API = prefix + "/personalized/newsong?limit=100";
    // 曲风歌曲(最新) API
    private static final String STYLE_NEW_SONG_API = prefix + "/style/song?tagId=%s&sort=1&cursor=%s&size=%s";
    // 新歌速递 API
    private static final String FAST_NEW_SONG_API = prefix + "/top/song?type=%s";
    // 推荐新歌(华语) API (酷狗)
    private static final String RECOMMEND_NEW_SONG_KG_API
            = "http://mobilecdnbj.kugou.com/api/v3/rank/newsong?version=9108&type=%s&page=%s&pagesize=%s";
    // 推荐新歌 API (QQ)
    private static final String RECOMMEND_NEW_SONG_QQ_API
            = prefixQQ33 + "/new/songs?type=%s";
    // 新歌榜 API (酷我)
//    private static final String NEW_SONG_KW_API = prefixKw + "/kuwo/rank/musicList?bangId=16&pn=%s&rn=%s";
    private static final String NEW_SONG_KW_API = "http://www.kuwo.cn/api/www/bang/bang/musicList?bangId=16&pn=%s&rn=%s&httpsStatus=1";
    // 推荐新歌 API (咪咕)
    private static final String RECOMMEND_NEW_SONG_MG_API
            = prefixMg + "/new/songs?pageNo=%s&pageSize=%s";
    // 推荐新歌 API (千千)
    private static final String RECOMMEND_NEW_SONG_QI_API
            = "https://music.91q.com/v1/index?appid=16073360&pageSize=12&timestamp=%s&type=song";
    // 推荐新歌 API (音乐磁场)
    private static final String RECOMMEND_NEW_MUSIC_HF_API = "https://www.hifini.com/%s-%s.htm?orderby=tid";
    // 推荐新歌 API (咕咕咕音乐)
    private static final String RECOMMEND_NEW_MUSIC_GG_API = "http://www.gggmusic.com/%s-%s.htm?orderby=tid";

    // 专辑标签 API (豆瓣)
    private static final String ALBUM_TAG_DB_API
            = "https://music.douban.com/tag/";

    /**
     * 加载新碟标签
     *
     * @return
     */
    public static void initNewAlbumTag() {
        // 网易云 网易云 网易云 QQ 豆瓣 堆糖
        Tags.newAlbumTag.put("默认", new String[]{"ALL", "", "", "1", "", ""});

        Tags.newAlbumTag.put("华语", new String[]{"ZH", "Z_H", "", "", "", ""});
        Tags.newAlbumTag.put("内地", new String[]{"", "", "", "1", "", ""});
        Tags.newAlbumTag.put("港台", new String[]{"", "", "", "2", "", ""});
        Tags.newAlbumTag.put("欧美", new String[]{"EA", "E_A", "", "3", "", ""});
        Tags.newAlbumTag.put("韩国", new String[]{"KR", "KR", "", "4", "", ""});
        Tags.newAlbumTag.put("日本", new String[]{"JP", "JP", "", "5", "", ""});
        Tags.newAlbumTag.put("其他", new String[]{"", "", "", "6", "", ""});

        // 堆糖
        Tags.newAlbumTag.put("家居生活", new String[]{"", "", "", "", "", "家居生活"});
        Tags.newAlbumTag.put("家居生活 - 客厅", new String[]{"", "", "", "", "", "家居生活_客厅"});
        Tags.newAlbumTag.put("家居生活 - 卧室", new String[]{"", "", "", "", "", "家居生活_卧室"});
        Tags.newAlbumTag.put("家居生活 - 楼梯", new String[]{"", "", "", "", "", "家居生活_楼梯"});
        Tags.newAlbumTag.put("家居生活 - 阁楼", new String[]{"", "", "", "", "", "家居生活_阁楼"});
        Tags.newAlbumTag.put("家居生活 - 儿童房", new String[]{"", "", "", "", "", "家居生活_儿童房"});
        Tags.newAlbumTag.put("家居生活 - 厨房", new String[]{"", "", "", "", "", "家居生活_厨房"});
        Tags.newAlbumTag.put("家居生活 - 浴室", new String[]{"", "", "", "", "", "家居生活_浴室"});
        Tags.newAlbumTag.put("家居生活 - 阳台", new String[]{"", "", "", "", "", "家居生活_阳台"});
        Tags.newAlbumTag.put("家居生活 - 飘窗", new String[]{"", "", "", "", "", "家居生活_飘窗"});
        Tags.newAlbumTag.put("家居生活 - 工作间", new String[]{"", "", "", "", "", "家居生活_工作间"});
        Tags.newAlbumTag.put("家居生活 - 沙发", new String[]{"", "", "", "", "", "家居生活_沙发"});
        Tags.newAlbumTag.put("家居生活 - 椅子", new String[]{"", "", "", "", "", "家居生活_椅子"});
        Tags.newAlbumTag.put("家居生活 - 桌子", new String[]{"", "", "", "", "", "家居生活_桌子"});
        Tags.newAlbumTag.put("家居生活 - 柜子", new String[]{"", "", "", "", "", "家居生活_柜子"});
        Tags.newAlbumTag.put("家居生活 - 灯饰", new String[]{"", "", "", "", "", "家居生活_灯饰"});
        Tags.newAlbumTag.put("家居生活 - 收纳", new String[]{"", "", "", "", "", "家居生活_收纳"});
        Tags.newAlbumTag.put("家居生活 - 置物架", new String[]{"", "", "", "", "", "家居生活_置物架"});
        Tags.newAlbumTag.put("家居生活 - 照片墙", new String[]{"", "", "", "", "", "家居生活_照片墙"});
        Tags.newAlbumTag.put("家居生活 - zakka", new String[]{"", "", "", "", "", "家居生活_zakka"});
        Tags.newAlbumTag.put("家居生活 - 北欧", new String[]{"", "", "", "", "", "家居生活_北欧"});
        Tags.newAlbumTag.put("家居生活 - 地中海", new String[]{"", "", "", "", "", "家居生活_地中海"});
        Tags.newAlbumTag.put("家居生活 - 简约", new String[]{"", "", "", "", "", "家居生活_简约"});
        Tags.newAlbumTag.put("家居生活 - 宜家", new String[]{"", "", "", "", "", "家居生活_宜家"});
        Tags.newAlbumTag.put("家居生活 - 田园", new String[]{"", "", "", "", "", "家居生活_田园"});
        Tags.newAlbumTag.put("美食菜谱", new String[]{"", "", "", "", "", "美食菜谱"});
        Tags.newAlbumTag.put("美食菜谱 - 菜谱", new String[]{"", "", "", "", "", "美食菜谱_菜谱"});
        Tags.newAlbumTag.put("美食菜谱 - 家常菜", new String[]{"", "", "", "", "", "美食菜谱_家常菜"});
        Tags.newAlbumTag.put("美食菜谱 - 主食", new String[]{"", "", "", "", "", "美食菜谱_主食"});
        Tags.newAlbumTag.put("美食菜谱 - 汤粥羹", new String[]{"", "", "", "", "", "美食菜谱_汤粥羹"});
        Tags.newAlbumTag.put("美食菜谱 - 西餐", new String[]{"", "", "", "", "", "美食菜谱_西餐"});
        Tags.newAlbumTag.put("美食菜谱 - 日料", new String[]{"", "", "", "", "", "美食菜谱_日料"});
        Tags.newAlbumTag.put("美食菜谱 - 早餐", new String[]{"", "", "", "", "", "美食菜谱_早餐"});
        Tags.newAlbumTag.put("美食菜谱 - 便当", new String[]{"", "", "", "", "", "美食菜谱_便当"});
        Tags.newAlbumTag.put("美食菜谱 - 甜点", new String[]{"", "", "", "", "", "美食菜谱_甜点"});
        Tags.newAlbumTag.put("美食菜谱 - 糖果", new String[]{"", "", "", "", "", "美食菜谱_糖果"});
        Tags.newAlbumTag.put("美食菜谱 - 饼干", new String[]{"", "", "", "", "", "美食菜谱_饼干"});
        Tags.newAlbumTag.put("美食菜谱 - 蛋糕", new String[]{"", "", "", "", "", "美食菜谱_蛋糕"});
        Tags.newAlbumTag.put("美食菜谱 - 翻糖", new String[]{"", "", "", "", "", "美食菜谱_翻糖"});
        Tags.newAlbumTag.put("美食菜谱 - 马卡龙", new String[]{"", "", "", "", "", "美食菜谱_马卡龙"});
        Tags.newAlbumTag.put("美食菜谱 - 冰淇淋", new String[]{"", "", "", "", "", "美食菜谱_冰淇淋"});
        Tags.newAlbumTag.put("美食菜谱 - 水果", new String[]{"", "", "", "", "", "美食菜谱_水果"});
        Tags.newAlbumTag.put("美食菜谱 - 冰品", new String[]{"", "", "", "", "", "美食菜谱_冰品"});
        Tags.newAlbumTag.put("美食菜谱 - 咖啡", new String[]{"", "", "", "", "", "美食菜谱_咖啡"});
        Tags.newAlbumTag.put("美食菜谱 - 调酒", new String[]{"", "", "", "", "", "美食菜谱_调酒"});
        Tags.newAlbumTag.put("手工DIY", new String[]{"", "", "", "", "", "手工DIY"});
        Tags.newAlbumTag.put("手工DIY - 废物利用", new String[]{"", "", "", "", "", "手工DIY_废物利用"});
        Tags.newAlbumTag.put("手工DIY - 手工本子", new String[]{"", "", "", "", "", "手工DIY_手工本子"});
        Tags.newAlbumTag.put("手工DIY - 橡皮章", new String[]{"", "", "", "", "", "手工DIY_橡皮章"});
        Tags.newAlbumTag.put("手工DIY - 粘土", new String[]{"", "", "", "", "", "手工DIY_粘土"});
        Tags.newAlbumTag.put("手工DIY - 羊毛毡", new String[]{"", "", "", "", "", "手工DIY_羊毛毡"});
        Tags.newAlbumTag.put("手工DIY - 纽扣", new String[]{"", "", "", "", "", "手工DIY_纽扣"});
        Tags.newAlbumTag.put("手工DIY - 拼豆", new String[]{"", "", "", "", "", "手工DIY_拼豆"});
        Tags.newAlbumTag.put("手工DIY - 石绘", new String[]{"", "", "", "", "", "手工DIY_石绘"});
        Tags.newAlbumTag.put("手工DIY - 针织钩花", new String[]{"", "", "", "", "", "手工DIY_针织钩花"});
        Tags.newAlbumTag.put("手工DIY - 刺绣", new String[]{"", "", "", "", "", "手工DIY_刺绣"});
        Tags.newAlbumTag.put("手工DIY - 十字绣", new String[]{"", "", "", "", "", "手工DIY_十字绣"});
        Tags.newAlbumTag.put("手工DIY - 拼布", new String[]{"", "", "", "", "", "手工DIY_拼布"});
        Tags.newAlbumTag.put("手工DIY - 不织布", new String[]{"", "", "", "", "", "手工DIY_不织布"});
        Tags.newAlbumTag.put("手工DIY - 绳结", new String[]{"", "", "", "", "", "手工DIY_绳结"});
        Tags.newAlbumTag.put("手工DIY - 串珠", new String[]{"", "", "", "", "", "手工DIY_串珠"});
        Tags.newAlbumTag.put("手工DIY - 绕线", new String[]{"", "", "", "", "", "手工DIY_绕线"});
        Tags.newAlbumTag.put("手工DIY - 折纸", new String[]{"", "", "", "", "", "手工DIY_折纸"});
        Tags.newAlbumTag.put("手工DIY - 剪纸", new String[]{"", "", "", "", "", "手工DIY_剪纸"});
        Tags.newAlbumTag.put("手工DIY - 衍纸", new String[]{"", "", "", "", "", "手工DIY_衍纸"});
        Tags.newAlbumTag.put("手工DIY - 纸模", new String[]{"", "", "", "", "", "手工DIY_纸模"});
        Tags.newAlbumTag.put("手工DIY - 卡片", new String[]{"", "", "", "", "", "手工DIY_卡片"});
        Tags.newAlbumTag.put("时尚搭配", new String[]{"", "", "", "", "", "时尚搭配"});
        Tags.newAlbumTag.put("时尚搭配 - 搭配达人", new String[]{"", "", "", "", "", "时尚搭配_搭配达人"});
        Tags.newAlbumTag.put("时尚搭配 - 街拍", new String[]{"", "", "", "", "", "时尚搭配_街拍"});
        Tags.newAlbumTag.put("时尚搭配 - 穿搭", new String[]{"", "", "", "", "", "时尚搭配_穿搭"});
        Tags.newAlbumTag.put("时尚搭配 - 秀场", new String[]{"", "", "", "", "", "时尚搭配_秀场"});
        Tags.newAlbumTag.put("时尚搭配 - 大片", new String[]{"", "", "", "", "", "时尚搭配_大片"});
        Tags.newAlbumTag.put("时尚搭配 - 模特", new String[]{"", "", "", "", "", "时尚搭配_模特"});
        Tags.newAlbumTag.put("时尚搭配 - 时尚博主", new String[]{"", "", "", "", "", "时尚搭配_时尚博主"});
        Tags.newAlbumTag.put("时尚搭配 - 型男搭配", new String[]{"", "", "", "", "", "时尚搭配_型男搭配"});
        Tags.newAlbumTag.put("时尚搭配 - 奢侈品", new String[]{"", "", "", "", "", "时尚搭配_奢侈品"});
        Tags.newAlbumTag.put("时尚搭配 - 韩风", new String[]{"", "", "", "", "", "时尚搭配_韩风"});
        Tags.newAlbumTag.put("时尚搭配 - 日系", new String[]{"", "", "", "", "", "时尚搭配_日系"});
        Tags.newAlbumTag.put("时尚搭配 - 欧美", new String[]{"", "", "", "", "", "时尚搭配_欧美"});
        Tags.newAlbumTag.put("时尚搭配 - 文艺", new String[]{"", "", "", "", "", "时尚搭配_文艺"});
        Tags.newAlbumTag.put("时尚搭配 - 简约", new String[]{"", "", "", "", "", "时尚搭配_简约"});
        Tags.newAlbumTag.put("时尚搭配 - 英伦", new String[]{"", "", "", "", "", "时尚搭配_英伦"});
        Tags.newAlbumTag.put("时尚搭配 - 混搭", new String[]{"", "", "", "", "", "时尚搭配_混搭"});
        Tags.newAlbumTag.put("时尚搭配 - 复古", new String[]{"", "", "", "", "", "时尚搭配_复古"});
        Tags.newAlbumTag.put("时尚搭配 - 朋克", new String[]{"", "", "", "", "", "时尚搭配_朋克"});
        Tags.newAlbumTag.put("时尚搭配 - 森系", new String[]{"", "", "", "", "", "时尚搭配_森系"});
        Tags.newAlbumTag.put("时尚搭配 - 中性", new String[]{"", "", "", "", "", "时尚搭配_中性"});
        Tags.newAlbumTag.put("时尚搭配 - OL", new String[]{"", "", "", "", "", "时尚搭配_OL"});
        Tags.newAlbumTag.put("时尚搭配 - 民族风", new String[]{"", "", "", "", "", "时尚搭配_民族风"});
        Tags.newAlbumTag.put("时尚搭配 - 明星款", new String[]{"", "", "", "", "", "时尚搭配_明星款"});
        Tags.newAlbumTag.put("时尚搭配 - 碎花", new String[]{"", "", "", "", "", "时尚搭配_碎花"});
        Tags.newAlbumTag.put("时尚搭配 - 蕾丝", new String[]{"", "", "", "", "", "时尚搭配_蕾丝"});
        Tags.newAlbumTag.put("时尚搭配 - 豹纹", new String[]{"", "", "", "", "", "时尚搭配_豹纹"});
        Tags.newAlbumTag.put("时尚搭配 - 波点", new String[]{"", "", "", "", "", "时尚搭配_波点"});
        Tags.newAlbumTag.put("时尚搭配 - 条纹", new String[]{"", "", "", "", "", "时尚搭配_条纹"});
        Tags.newAlbumTag.put("时尚搭配 - 撞色", new String[]{"", "", "", "", "", "时尚搭配_撞色"});
        Tags.newAlbumTag.put("时尚搭配 - 黑色", new String[]{"", "", "", "", "", "时尚搭配_黑色"});
        Tags.newAlbumTag.put("时尚搭配 - 红色", new String[]{"", "", "", "", "", "时尚搭配_红色"});
        Tags.newAlbumTag.put("时尚搭配 - 紫色", new String[]{"", "", "", "", "", "时尚搭配_紫色"});
        Tags.newAlbumTag.put("时尚搭配 - 粉色", new String[]{"", "", "", "", "", "时尚搭配_粉色"});
        Tags.newAlbumTag.put("时尚搭配 - 彩色", new String[]{"", "", "", "", "", "时尚搭配_彩色"});
        Tags.newAlbumTag.put("时尚搭配 - 渐变色", new String[]{"", "", "", "", "", "时尚搭配_渐变色"});
        Tags.newAlbumTag.put("美妆造型", new String[]{"", "", "", "", "", "美妆造型"});
        Tags.newAlbumTag.put("美妆造型 - 彩妆", new String[]{"", "", "", "", "", "美妆造型_彩妆"});
        Tags.newAlbumTag.put("美妆造型 - 眼妆", new String[]{"", "", "", "", "", "美妆造型_眼妆"});
        Tags.newAlbumTag.put("美妆造型 - 唇妆", new String[]{"", "", "", "", "", "美妆造型_唇妆"});
        Tags.newAlbumTag.put("美妆造型 - 美甲", new String[]{"", "", "", "", "", "美妆造型_美甲"});
        Tags.newAlbumTag.put("美妆造型 - 香水", new String[]{"", "", "", "", "", "美妆造型_香水"});
        Tags.newAlbumTag.put("美妆造型 - 文身", new String[]{"", "", "", "", "", "美妆造型_文身"});
        Tags.newAlbumTag.put("美妆造型 - 发型", new String[]{"", "", "", "", "", "美妆造型_发型"});
        Tags.newAlbumTag.put("美妆造型 - 编发", new String[]{"", "", "", "", "", "美妆造型_编发"});
        Tags.newAlbumTag.put("美妆造型 - 马尾", new String[]{"", "", "", "", "", "美妆造型_马尾"});
        Tags.newAlbumTag.put("美妆造型 - 长发", new String[]{"", "", "", "", "", "美妆造型_长发"});
        Tags.newAlbumTag.put("美妆造型 - 短发", new String[]{"", "", "", "", "", "美妆造型_短发"});
        Tags.newAlbumTag.put("美妆造型 - 卷发", new String[]{"", "", "", "", "", "美妆造型_卷发"});
        Tags.newAlbumTag.put("美妆造型 - 染发", new String[]{"", "", "", "", "", "美妆造型_染发"});
        Tags.newAlbumTag.put("婚纱婚礼", new String[]{"", "", "", "", "", "婚纱婚礼"});
        Tags.newAlbumTag.put("婚纱婚礼 - 婚礼布置", new String[]{"", "", "", "", "", "婚纱婚礼_婚礼布置"});
        Tags.newAlbumTag.put("婚纱婚礼 - 结婚蛋糕", new String[]{"", "", "", "", "", "婚纱婚礼_结婚蛋糕"});
        Tags.newAlbumTag.put("婚纱婚礼 - 请柬", new String[]{"", "", "", "", "", "婚纱婚礼_请柬"});
        Tags.newAlbumTag.put("婚纱婚礼 - 喜糖", new String[]{"", "", "", "", "", "婚纱婚礼_喜糖"});
        Tags.newAlbumTag.put("婚纱婚礼 - 捧花", new String[]{"", "", "", "", "", "婚纱婚礼_捧花"});
        Tags.newAlbumTag.put("婚纱婚礼 - 结婚照", new String[]{"", "", "", "", "", "婚纱婚礼_结婚照"});
        Tags.newAlbumTag.put("婚纱婚礼 - 婚纱", new String[]{"", "", "", "", "", "婚纱婚礼_婚纱"});
        Tags.newAlbumTag.put("婚纱婚礼 - 伴娘服", new String[]{"", "", "", "", "", "婚纱婚礼_伴娘服"});
        Tags.newAlbumTag.put("婚纱婚礼 - 新娘发型", new String[]{"", "", "", "", "", "婚纱婚礼_新娘发型"});
        Tags.newAlbumTag.put("婚纱婚礼 - 婚戒", new String[]{"", "", "", "", "", "婚纱婚礼_婚戒"});
        Tags.newAlbumTag.put("婚纱婚礼 - 婚鞋", new String[]{"", "", "", "", "", "婚纱婚礼_婚鞋"});
        Tags.newAlbumTag.put("文字句子", new String[]{"", "", "", "", "", "文字句子"});
        Tags.newAlbumTag.put("文字句子 - 手写", new String[]{"", "", "", "", "", "文字句子_手写"});
        Tags.newAlbumTag.put("文字句子 - 语录", new String[]{"", "", "", "", "", "文字句子_语录"});
        Tags.newAlbumTag.put("文字句子 - 情感", new String[]{"", "", "", "", "", "文字句子_情感"});
        Tags.newAlbumTag.put("文字句子 - 英文", new String[]{"", "", "", "", "", "文字句子_英文"});
        Tags.newAlbumTag.put("插画绘画", new String[]{"", "", "", "", "", "插画绘画"});
        Tags.newAlbumTag.put("插画绘画 - 手绘", new String[]{"", "", "", "", "", "插画绘画_手绘"});
        Tags.newAlbumTag.put("插画绘画 - 素描", new String[]{"", "", "", "", "", "插画绘画_素描"});
        Tags.newAlbumTag.put("插画绘画 - 水彩", new String[]{"", "", "", "", "", "插画绘画_水彩"});
        Tags.newAlbumTag.put("插画绘画 - 彩铅", new String[]{"", "", "", "", "", "插画绘画_彩铅"});
        Tags.newAlbumTag.put("插画绘画 - 油画", new String[]{"", "", "", "", "", "插画绘画_油画"});
        Tags.newAlbumTag.put("插画绘画 - 版画", new String[]{"", "", "", "", "", "插画绘画_版画"});
        Tags.newAlbumTag.put("插画绘画 - 绘画教程", new String[]{"", "", "", "", "", "插画绘画_绘画教程"});
        Tags.newAlbumTag.put("插画绘画 - Q版", new String[]{"", "", "", "", "", "插画绘画_Q版"});
        Tags.newAlbumTag.put("插画绘画 - CG", new String[]{"", "", "", "", "", "插画绘画_CG"});
        Tags.newAlbumTag.put("插画绘画 - 人物", new String[]{"", "", "", "", "", "插画绘画_人物"});
        Tags.newAlbumTag.put("插画绘画 - 时装", new String[]{"", "", "", "", "", "插画绘画_时装"});
        Tags.newAlbumTag.put("插画绘画 - 动物", new String[]{"", "", "", "", "", "插画绘画_动物"});
        Tags.newAlbumTag.put("插画绘画 - 植物", new String[]{"", "", "", "", "", "插画绘画_植物"});
        Tags.newAlbumTag.put("插画绘画 - 美食", new String[]{"", "", "", "", "", "插画绘画_美食"});
        Tags.newAlbumTag.put("插画绘画 - 风景", new String[]{"", "", "", "", "", "插画绘画_风景"});
        Tags.newAlbumTag.put("影音书籍", new String[]{"", "", "", "", "", "影音书籍"});
        Tags.newAlbumTag.put("影音书籍 - 冰雪奇缘", new String[]{"", "", "", "", "", "影音书_冰雪奇缘"});
        Tags.newAlbumTag.put("影音书籍 - 来自星星的你", new String[]{"", "", "", "", "", "影音书_来自星星的你"});
        Tags.newAlbumTag.put("影音书籍 - 神偷奶爸", new String[]{"", "", "", "", "", "影音书_神偷奶爸"});
        Tags.newAlbumTag.put("影音书籍 - 破产姐妹", new String[]{"", "", "", "", "", "影音书_破产姐妹"});
        Tags.newAlbumTag.put("影音书籍 - 小时代", new String[]{"", "", "", "", "", "影音书_小时代"});
        Tags.newAlbumTag.put("影音书籍 - 继承者们", new String[]{"", "", "", "", "", "影音书_继承者们"});
        Tags.newAlbumTag.put("影音书籍 - 生活大爆炸", new String[]{"", "", "", "", "", "影音书_生活大爆炸"});
        Tags.newAlbumTag.put("影音书籍 - 神探夏洛克", new String[]{"", "", "", "", "", "影音书_神探夏洛克"});
        Tags.newAlbumTag.put("影音书籍 - 电影", new String[]{"", "", "", "", "", "影音书_电影"});
        Tags.newAlbumTag.put("影音书籍 - 电视剧", new String[]{"", "", "", "", "", "影音书_电视剧"});
        Tags.newAlbumTag.put("影音书籍 - 台词", new String[]{"", "", "", "", "", "影音书_台词"});
        Tags.newAlbumTag.put("影音书籍 - 电影海报", new String[]{"", "", "", "", "", "影音书_电影海报"});
        Tags.newAlbumTag.put("影音书籍 - 剧照", new String[]{"", "", "", "", "", "搞笑萌宠_奥莉"});
        Tags.newAlbumTag.put("影音书籍 - 截图", new String[]{"", "", "", "", "", "影音书_截图"});
        Tags.newAlbumTag.put("人物明星", new String[]{"", "", "", "", "", "人物明星"});
        Tags.newAlbumTag.put("人物明星 - 美女", new String[]{"", "", "", "", "", "人物明星_美女"});
        Tags.newAlbumTag.put("人物明星 - 美男", new String[]{"", "", "", "", "", "人物明星_美男"});
        Tags.newAlbumTag.put("人物明星 - 演员", new String[]{"", "", "", "", "", "人物明星_演员"});
        Tags.newAlbumTag.put("人物明星 - 赫本", new String[]{"", "", "", "", "", "人物明星_赫本"});
        Tags.newAlbumTag.put("人物明星 - 安妮海瑟薇", new String[]{"", "", "", "", "", "人物明星_安妮海瑟薇"});
        Tags.newAlbumTag.put("人物明星 - Taylor Swift", new String[]{"", "", "", "", "", "人物明星_Taylor Swift"});
        Tags.newAlbumTag.put("人物明星 - 范冰冰", new String[]{"", "", "", "", "", "人物明星_范冰冰"});
        Tags.newAlbumTag.put("人物明星 - Angelababy", new String[]{"", "", "", "", "", "人物明星_Angelababy"});
        Tags.newAlbumTag.put("人物明星 - 水原希子", new String[]{"", "", "", "", "", "人物明星_水原希子"});
        Tags.newAlbumTag.put("人物明星 - 张辛苑", new String[]{"", "", "", "", "", "人物明星_张辛苑"});
        Tags.newAlbumTag.put("人物明星 - 张国荣", new String[]{"", "", "", "", "", "人物明星_张国荣"});
        Tags.newAlbumTag.put("人物明星 - 张根硕", new String[]{"", "", "", "", "", "人物明星_张根硕"});
        Tags.newAlbumTag.put("人物明星 - 李敏镐", new String[]{"", "", "", "", "", "人物明星_李敏镐"});
        Tags.newAlbumTag.put("植物多肉", new String[]{"", "", "", "", "", "植物多肉"});
        Tags.newAlbumTag.put("植物多肉 - 图鉴", new String[]{"", "", "", "", "", "植物多肉_图鉴"});
        Tags.newAlbumTag.put("植物多肉 - 花卉", new String[]{"", "", "", "", "", "植物多肉_花卉"});
        Tags.newAlbumTag.put("植物多肉 - 多肉", new String[]{"", "", "", "", "", "植物多肉_多肉"});
        Tags.newAlbumTag.put("植物多肉 - 苔藓", new String[]{"", "", "", "", "", "植物多肉_苔藓"});
        Tags.newAlbumTag.put("植物多肉 - 园艺", new String[]{"", "", "", "", "", "植物多肉_园艺"});
        Tags.newAlbumTag.put("植物多肉 - 盆栽", new String[]{"", "", "", "", "", "植物多肉_盆栽"});
        Tags.newAlbumTag.put("生活百科", new String[]{"", "", "", "", "", "生活百科"});
        Tags.newAlbumTag.put("生活百科 - 小妙招", new String[]{"", "", "", "", "", "生活百科_小妙招"});
        Tags.newAlbumTag.put("生活百科 - 日常清洁", new String[]{"", "", "", "", "", "生活百科_日常清洁"});
        Tags.newAlbumTag.put("生活百科 - 孕产", new String[]{"", "", "", "", "", "生活百科_孕产"});
        Tags.newAlbumTag.put("生活百科 - 育儿", new String[]{"", "", "", "", "", "生活百科_育儿"});
        Tags.newAlbumTag.put("生活百科 - 养生", new String[]{"", "", "", "", "", "生活百科_养生"});
        Tags.newAlbumTag.put("生活百科 - 美容保养", new String[]{"", "", "", "", "", "生活百科_美白"});
        Tags.newAlbumTag.put("生活百科 - 健身", new String[]{"", "", "", "", "", "生活百科_健身"});
        Tags.newAlbumTag.put("搞笑萌宠", new String[]{"", "", "", "", "", "搞笑萌宠"});
        Tags.newAlbumTag.put("搞笑萌宠 - 汪星人", new String[]{"", "", "", "", "", "搞笑萌宠_汪星人"});
        Tags.newAlbumTag.put("搞笑萌宠 - 喵星人", new String[]{"", "", "", "", "", "搞笑萌宠_喵星人"});
        Tags.newAlbumTag.put("搞笑萌宠 - 熊猫", new String[]{"", "", "", "", "", "搞笑萌宠_熊猫"});
        Tags.newAlbumTag.put("搞笑萌宠 - 刺猬", new String[]{"", "", "", "", "", "搞笑萌宠_刺猬"});
        Tags.newAlbumTag.put("搞笑萌宠 - 考拉", new String[]{"", "", "", "", "", "搞笑萌宠_考拉"});
        Tags.newAlbumTag.put("搞笑萌宠 - 长颈鹿", new String[]{"", "", "", "", "", "搞笑萌宠_长颈鹿"});
        Tags.newAlbumTag.put("搞笑萌宠 - 吱星人", new String[]{"", "", "", "", "", "搞笑萌宠_吱星人"});
        Tags.newAlbumTag.put("搞笑萌宠 - 袋鼠", new String[]{"", "", "", "", "", "搞笑萌宠_袋鼠"});
        Tags.newAlbumTag.put("搞笑萌宠 - 大象", new String[]{"", "", "", "", "", "搞笑萌宠_大象"});
        Tags.newAlbumTag.put("搞笑萌宠 - 鸟", new String[]{"", "", "", "", "", "搞笑萌宠_鸟"});
        Tags.newAlbumTag.put("搞笑萌宠 - 干脆面", new String[]{"", "", "", "", "", "搞笑萌宠_干脆面"});
        Tags.newAlbumTag.put("搞笑萌宠 - 兔子", new String[]{"", "", "", "", "", "搞笑萌宠_兔子"});
        Tags.newAlbumTag.put("搞笑萌宠 - 鱼", new String[]{"", "", "", "", "", "搞笑萌宠_鱼"});
        Tags.newAlbumTag.put("搞笑萌宠 - 萌娃", new String[]{"", "", "", "", "", "搞笑萌宠_萌娃"});
        Tags.newAlbumTag.put("搞笑萌宠 - 萝莉", new String[]{"", "", "", "", "", "搞笑萌宠_萝莉"});
        Tags.newAlbumTag.put("搞笑萌宠 - 正太", new String[]{"", "", "", "", "", "搞笑萌宠_正太"});
        Tags.newAlbumTag.put("搞笑萌宠 - 嘎蒙", new String[]{"", "", "", "", "", "搞笑萌宠_嘎蒙"});
        Tags.newAlbumTag.put("搞笑萌宠 - 奥莉", new String[]{"", "", "", "", "", "搞笑萌宠_奥莉"});
        Tags.newAlbumTag.put("搞笑萌宠 - 爸爸去哪儿", new String[]{"", "", "", "", "", "搞笑萌宠_爸爸去哪儿"});
        Tags.newAlbumTag.put("搞笑萌宠 - 萨摩耶", new String[]{"", "", "", "", "", "搞笑萌宠_萨摩耶"});
        Tags.newAlbumTag.put("搞笑萌宠 - 哈士奇", new String[]{"", "", "", "", "", "搞笑萌宠_哈士奇"});
        Tags.newAlbumTag.put("搞笑萌宠 - 治愈", new String[]{"", "", "", "", "", "搞笑萌宠_治愈"});
        Tags.newAlbumTag.put("搞笑萌宠 - 金毛", new String[]{"", "", "", "", "", "搞笑萌宠_金毛"});
        Tags.newAlbumTag.put("搞笑萌宠 - 折耳", new String[]{"", "", "", "", "", "搞笑萌宠_折耳"});
        Tags.newAlbumTag.put("搞笑萌宠 - 加菲猫", new String[]{"", "", "", "", "", "搞笑萌宠_加菲猫"});
        Tags.newAlbumTag.put("搞笑萌宠 - grace", new String[]{"", "", "", "", "", "搞笑萌宠_grace"});
        Tags.newAlbumTag.put("搞笑萌宠 - feynman", new String[]{"", "", "", "", "", "搞笑萌宠_feynman"});
        Tags.newAlbumTag.put("搞笑萌宠 - 鹿", new String[]{"", "", "", "", "", "搞笑萌宠_鹿"});
        Tags.newAlbumTag.put("人文艺术", new String[]{"", "", "", "", "", "人文艺术"});
        Tags.newAlbumTag.put("人文艺术 - 打字机", new String[]{"", "", "", "", "", "人文艺术_打字机"});
        Tags.newAlbumTag.put("人文艺术 - 老爷车", new String[]{"", "", "", "", "", "人文艺术_老爷车"});
        Tags.newAlbumTag.put("人文艺术 - 铁皮", new String[]{"", "", "", "", "", "人文艺术_铁皮"});
        Tags.newAlbumTag.put("人文艺术 - 音乐盒", new String[]{"", "", "", "", "", "人文艺术_音乐盒"});
        Tags.newAlbumTag.put("人文艺术 - 招贴画", new String[]{"", "", "", "", "", "人文艺术_招贴画"});
        Tags.newAlbumTag.put("人文艺术 - 国画", new String[]{"", "", "", "", "", "人文艺术_国画"});
        Tags.newAlbumTag.put("人文艺术 - 书法", new String[]{"", "", "", "", "", "人文艺术_书法"});
        Tags.newAlbumTag.put("人文艺术 - 戏曲", new String[]{"", "", "", "", "", "人文艺术_戏曲"});
        Tags.newAlbumTag.put("人文艺术 - 陶艺", new String[]{"", "", "", "", "", "人文艺术_陶艺"});
        Tags.newAlbumTag.put("人文艺术 - 文物", new String[]{"", "", "", "", "", "人文艺术_文物"});
        Tags.newAlbumTag.put("人文艺术 - 珠宝", new String[]{"", "", "", "", "", "人文艺术_珠宝"});
        Tags.newAlbumTag.put("人文艺术 - 人偶", new String[]{"", "", "", "", "", "人文艺术_人偶"});
        Tags.newAlbumTag.put("设计", new String[]{"", "", "", "", "", "设计"});
        Tags.newAlbumTag.put("设计 - 平面设计", new String[]{"", "", "", "", "", "设计_平面设计"});
        Tags.newAlbumTag.put("设计 - 海报设计", new String[]{"", "", "", "", "", "设计_海报设计"});
        Tags.newAlbumTag.put("设计 - 广告设计", new String[]{"", "", "", "", "", "设计_广告设计"});
        Tags.newAlbumTag.put("设计 - 包装设计", new String[]{"", "", "", "", "", "设计_包装设计"});
        Tags.newAlbumTag.put("设计 - VI设计", new String[]{"", "", "", "", "", "设计_VI设计"});
        Tags.newAlbumTag.put("设计 - 雕塑", new String[]{"", "", "", "", "", "设计_雕塑"});
        Tags.newAlbumTag.put("设计 - 建筑", new String[]{"", "", "", "", "", "设计_建筑"});
        Tags.newAlbumTag.put("设计 - 配色", new String[]{"", "", "", "", "", "设计_配色"});
        Tags.newAlbumTag.put("设计 - LOGO", new String[]{"", "", "", "", "", "设计_LOGO"});
        Tags.newAlbumTag.put("设计 - 字体", new String[]{"", "", "", "", "", "设计_字体"});
        Tags.newAlbumTag.put("设计 - 矢量素材", new String[]{"", "", "", "", "", "设计_矢量素材"});
        Tags.newAlbumTag.put("古风", new String[]{"", "", "", "", "", "古风"});
        Tags.newAlbumTag.put("古风 - 汉服", new String[]{"", "", "", "", "", "古风_汉服"});
        Tags.newAlbumTag.put("古风 - 发簪", new String[]{"", "", "", "", "", "古风_发簪"});
        Tags.newAlbumTag.put("古风 - 仕女", new String[]{"", "", "", "", "", "古风_仕女"});
        Tags.newAlbumTag.put("古风 - 美男", new String[]{"", "", "", "", "", "古风_美男"});
        Tags.newAlbumTag.put("古风 - 京剧", new String[]{"", "", "", "", "", "古风_京剧"});
        Tags.newAlbumTag.put("古风 - 古建筑", new String[]{"", "", "", "", "", "古风_古建筑"});
        Tags.newAlbumTag.put("壁纸", new String[]{"", "", "", "", "", "壁纸"});
        Tags.newAlbumTag.put("壁纸 - 颜色", new String[]{"", "", "", "", "", "壁纸-颜色"});
        Tags.newAlbumTag.put("壁纸 - 渐变", new String[]{"", "", "", "", "", "壁纸-渐变"});
        Tags.newAlbumTag.put("壁纸 - 可爱", new String[]{"", "", "", "", "", "壁纸-可爱"});
        Tags.newAlbumTag.put("壁纸 - 情侣", new String[]{"", "", "", "", "", "壁纸-情侣"});
        Tags.newAlbumTag.put("壁纸 - 少女心", new String[]{"", "", "", "", "", "壁纸-少女心"});
        Tags.newAlbumTag.put("壁纸 - 小清新", new String[]{"", "", "", "", "", "壁纸-小清新"});
        Tags.newAlbumTag.put("壁纸 - 动漫", new String[]{"", "", "", "", "", "壁纸-动漫"});
        Tags.newAlbumTag.put("壁纸 - 文字", new String[]{"", "", "", "", "", "壁纸-文字"});
        Tags.newAlbumTag.put("壁纸 - 锁屏", new String[]{"", "", "", "", "", "壁纸-锁屏"});
        Tags.newAlbumTag.put("壁纸 - 朋友圈", new String[]{"", "", "", "", "", "壁纸-朋友圈背景"});
        Tags.newAlbumTag.put("壁纸 - 爱豆", new String[]{"", "", "", "", "", "壁纸-爱豆"});
        Tags.newAlbumTag.put("壁纸 - 影视剧", new String[]{"", "", "", "", "", "壁纸-影视剧"});
        Tags.newAlbumTag.put("壁纸 - 三屏壁纸", new String[]{"", "", "", "", "", "壁纸-三屏"});
        Tags.newAlbumTag.put("壁纸 - 考试", new String[]{"", "", "", "", "", "壁纸-考试"});
        Tags.newAlbumTag.put("壁纸 - 电脑", new String[]{"", "", "", "", "", "壁纸_电脑壁纸"});
        Tags.newAlbumTag.put("壁纸 - 减肥", new String[]{"", "", "", "", "", "壁纸-减肥"});
        Tags.newAlbumTag.put("旅行", new String[]{"", "", "", "", "", "旅行"});
        Tags.newAlbumTag.put("旅行 - 城堡", new String[]{"", "", "", "", "", "旅行_城堡"});
        Tags.newAlbumTag.put("旅行 - 岛屿", new String[]{"", "", "", "", "", "旅行_岛屿"});
        Tags.newAlbumTag.put("旅行 - 教堂", new String[]{"", "", "", "", "", "旅行_教堂"});
        Tags.newAlbumTag.put("旅行 - 小镇", new String[]{"", "", "", "", "", "旅行_小镇"});
        Tags.newAlbumTag.put("旅行 - 夜景", new String[]{"", "", "", "", "", "旅行_夜景"});
        Tags.newAlbumTag.put("旅行 - 森林", new String[]{"", "", "", "", "", "旅行_森林"});
        Tags.newAlbumTag.put("旅行 - 赏花", new String[]{"", "", "", "", "", "旅行_赏花"});
        Tags.newAlbumTag.put("旅行 - 欧洲", new String[]{"", "", "", "", "", "旅行_欧洲"});
        Tags.newAlbumTag.put("旅行 - 日本", new String[]{"", "", "", "", "", "旅行_日本"});
        Tags.newAlbumTag.put("旅行 - 马尔代夫", new String[]{"", "", "", "", "", "旅行_马尔代夫"});
        Tags.newAlbumTag.put("旅行 - 西藏", new String[]{"", "", "", "", "", "旅行_西藏"});
        Tags.newAlbumTag.put("旅行 - 云南", new String[]{"", "", "", "", "", "旅行_云南"});
        Tags.newAlbumTag.put("旅行 - 四川", new String[]{"", "", "", "", "", "旅行_四川"});
        Tags.newAlbumTag.put("旅行 - 厦门", new String[]{"", "", "", "", "", "旅行_厦门"});
        Tags.newAlbumTag.put("头像", new String[]{"", "", "", "", "", "头像"});
        Tags.newAlbumTag.put("头像 - 沙雕", new String[]{"", "", "", "", "", "表情-沙雕"});
        Tags.newAlbumTag.put("头像 - 文字", new String[]{"", "", "", "", "", "表情包-文字"});
        Tags.newAlbumTag.put("头像 - 可爱", new String[]{"", "", "", "", "", "表情包-可爱"});
        Tags.newAlbumTag.put("头像 - 萌宠", new String[]{"", "", "", "", "", "表情包-萌宠"});
        Tags.newAlbumTag.put("头像 - gif", new String[]{"", "", "", "", "", "表情包-gif"});
        Tags.newAlbumTag.put("头像 - emoji", new String[]{"", "", "", "", "", "表情包-emoji"});
        Tags.newAlbumTag.put("头像 - 女生", new String[]{"", "", "", "", "", "头像_女生"});
        Tags.newAlbumTag.put("头像 - 男生", new String[]{"", "", "", "", "", "头像_男生"});
        Tags.newAlbumTag.put("头像 - 情侣", new String[]{"", "", "", "", "", "头像_情侣"});
        Tags.newAlbumTag.put("头像 - 欧美", new String[]{"", "", "", "", "", "头像_欧美"});
        Tags.newAlbumTag.put("头像 - 文字", new String[]{"", "", "", "", "", "头像_文字"});
        Tags.newAlbumTag.put("头像 - 个性", new String[]{"", "", "", "", "", "头像_个性"});
        Tags.newAlbumTag.put("头像 - 卡通", new String[]{"", "", "", "", "", "头像_卡通"});
        Tags.newAlbumTag.put("头像 - 沙雕", new String[]{"", "", "", "", "", "头像-沙雕"});
        Tags.newAlbumTag.put("头像 - 欧美", new String[]{"", "", "", "", "", "头像-欧美"});
        Tags.newAlbumTag.put("头像 - 团体", new String[]{"", "", "", "", "", "头像-团体"});
        Tags.newAlbumTag.put("头像 - 想念熊", new String[]{"", "", "", "", "", "表情_想念熊"});
        Tags.newAlbumTag.put("头像 - 炉石娘", new String[]{"", "", "", "", "", "表情_炉石娘"});
        Tags.newAlbumTag.put("头像 - 牛轰轰", new String[]{"", "", "", "", "", "表情_牛轰轰"});
        Tags.newAlbumTag.put("头像 - 偶系小Q", new String[]{"", "", "", "", "", "表情_偶系小Q"});
        Tags.newAlbumTag.put("头像 - 小希与阿树", new String[]{"", "", "", "", "", "表情_小希与阿树"});
        Tags.newAlbumTag.put("头像 - 长草的颜文字君", new String[]{"", "", "", "", "", "表情_长草的颜文字君"});
        Tags.newAlbumTag.put("头像 - 豆包兔", new String[]{"", "", "", "", "", "表情_豆包兔"});
        Tags.newAlbumTag.put("头像 - 梁阿渣", new String[]{"", "", "", "", "", "表情_梁阿渣"});
        Tags.newAlbumTag.put("头像 - 冷先森漫画", new String[]{"", "", "", "", "", "表情_冷先森漫画"});
        Tags.newAlbumTag.put("头像 - 贱婊情", new String[]{"", "", "", "", "", "表情_贱婊情"});
        Tags.newAlbumTag.put("头像 - 小崽子", new String[]{"", "", "", "", "", "表情_小崽子"});
        Tags.newAlbumTag.put("头像 - 肥志", new String[]{"", "", "", "", "", "表情_肥志"});
        Tags.newAlbumTag.put("头像 - 花园夜", new String[]{"", "", "", "", "", "表情_花园夜"});
        Tags.newAlbumTag.put("头像 - 制冷少女", new String[]{"", "", "", "", "", "表情_制冷少女"});
        Tags.newAlbumTag.put("头像 - 虽虽酱", new String[]{"", "", "", "", "", "表情_虽虽酱"});
        Tags.newAlbumTag.put("摄影", new String[]{"", "", "", "", "", "摄影"});
        Tags.newAlbumTag.put("摄影 - 胶片", new String[]{"", "", "", "", "", "摄影_胶片"});
        Tags.newAlbumTag.put("摄影 - LOMO", new String[]{"", "", "", "", "", "摄影_LOMO"});
        Tags.newAlbumTag.put("摄影 - 移轴", new String[]{"", "", "", "", "", "摄影_移轴"});
        Tags.newAlbumTag.put("摄影 - 创意", new String[]{"", "", "", "", "", "摄影_创意"});
        Tags.newAlbumTag.put("摄影 - 人像", new String[]{"", "", "", "", "", "摄影_人像"});
        Tags.newAlbumTag.put("摄影 - 静物", new String[]{"", "", "", "", "", "摄影_静物"});
        Tags.newAlbumTag.put("摄影 - 风光", new String[]{"", "", "", "", "", "摄影_风光"});
        Tags.newAlbumTag.put("摄影 - 黑白", new String[]{"", "", "", "", "", "摄影_黑白"});
        Tags.newAlbumTag.put("摄影 - 水下摄影", new String[]{"", "", "", "", "", "摄影_水下摄影"});
        Tags.newAlbumTag.put("表情", new String[]{"", "", "", "", "", "表情"});
        Tags.newAlbumTag.put("素材", new String[]{"", "", "", "", "", "素材"});
        Tags.newAlbumTag.put("动图", new String[]{"", "", "", "", "", "动图"});

        final int c = 6;
        // 网易云曲风
        Runnable initAlbumTag = () -> {
            String tagBody = HttpRequest.get(String.format(STYLE_API))
                    .execute()
                    .body();
            JSONObject tagJson = JSONObject.fromObject(tagBody);
            JSONArray tags = tagJson.getJSONArray("data");
            for (int i = 0, len = tags.size(); i < len; i++) {
                JSONObject tag = tags.getJSONObject(i);

                String name = tag.getString("tagName");
                String id = tag.getString("tagId");

                if (!Tags.newAlbumTag.containsKey(name)) Tags.newAlbumTag.put(name, new String[c]);
                Tags.newAlbumTag.get(name)[2] = id;
                // 子标签
                JSONArray subTags = tag.optJSONArray("childrenTags");
                if (subTags == null) continue;
                for (int j = 0, s = subTags.size(); j < s; j++) {
                    JSONObject subTag = subTags.getJSONObject(j);

                    String subName = subTag.getString("tagName");
                    String subId = subTag.getString("tagId");

                    if (!Tags.newAlbumTag.containsKey(subName)) Tags.newAlbumTag.put(subName, new String[c]);
                    Tags.newAlbumTag.get(subName)[2] = subId;
                    // 孙子标签
                    JSONArray ssTags = subTag.optJSONArray("childrenTags");
                    if (ssTags == null) continue;
                    for (int k = 0, l = ssTags.size(); k < l; k++) {
                        JSONObject ssTag = ssTags.getJSONObject(k);

                        String ssName = ssTag.getString("tagName");
                        String ssId = ssTag.getString("tagId");

                        if (!Tags.newAlbumTag.containsKey(ssName)) Tags.newAlbumTag.put(ssName, new String[c]);
                        Tags.newAlbumTag.get(ssName)[2] = ssId;
                    }
                }
            }
        };

        // 豆瓣
        // 分类专辑标签
        Runnable initAlbumTagDb = () -> {
            String albumTagBody = HttpRequest.get(String.format(ALBUM_TAG_DB_API))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(albumTagBody);
            Elements tags = doc.select("tbody tr td a");
            for (int i = 0, len = tags.size(); i < len; i++) {
                Element tag = tags.get(i);

                String name = tag.text();
                String id = tag.text();

                if (!Tags.newAlbumTag.containsKey(name)) Tags.newAlbumTag.put(name, new String[c]);
                Tags.newAlbumTag.get(name)[4] = id;
            }
        };

        List<Future<?>> taskList = new LinkedList<>();

        taskList.add(GlobalExecutors.requestExecutor.submit(initAlbumTag));
        taskList.add(GlobalExecutors.requestExecutor.submit(initAlbumTagDb));

        taskList.forEach(task -> {
            try {
                task.get();
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
    }

    // 新碟上架 API
    private static final String NEW_ALBUM_API = prefix + "/top/album?area=%s";
    // 新碟上架(热门) API
//    private static final String HOT_ALBUM_API = prefix + "/top/album?type=hot&area=%s";
    // 全部新碟 API
    private static final String ALL_NEW_ALBUM_API = prefix + "/album/new?area=%s&offset=%s&limit=%s";
    // 最新专辑 API
    private static final String NEWEST_ALBUM_API = prefix + "/album/newest";
    // 数字新碟上架 API
    private static final String NEWEST_DI_ALBUM_API = prefix + "/album/list?limit=200";
    // 数字专辑语种风格馆 API
    private static final String LANG_DI_ALBUM_API = prefix + "/album/list/style?area=%s&limit=50";
    // 曲风专辑 API
    private static final String STYLE_ALBUM_API = prefix + "/style/album?tagId=%s&cursor=%s&size=%s";
    // 新碟推荐 API (QQ)
    private static final String NEW_ALBUM_QQ_API
            = prefixQQ33 + "/new/album?type=%s&num=100";
    // 新碟推荐 API (咪咕)
    private static final String NEW_ALBUM_MG_API
            = prefixMg + "/new/albums?pageNo=%s&pageSize=%s";
    // 新专辑榜 API (咪咕)
    private static final String NEW_ALBUM_RANKING_MG_API
            = "https://app.c.nf.migu.cn/MIGUM2.0/v1.0/content/querycontentbyId.do?columnId=23218151";
    // 首页最新专辑 API (千千)
    private static final String INDEX_NEW_ALBUM_QI_API
            = "https://music.91q.com/v1/index?appid=16073360&pageSize=12&timestamp=%s&type=song";
    // 秀动发行 API (千千)
    private static final String XD_ALBUM_QI_API
            = "https://music.91q.com/v1//album/xdpublish?appid=16073360&module_name=秀动发行&moreApi=v1%%2Falbum%%2Fxdpublish" +
            "&pageNo=%s&pageSize=%s&timestamp=%s&type=showstart";
    // 新专辑推荐 API (千千)
    private static final String NEW_ALBUM_QI_API
            = "https://music.91q.com/v1/album/list?appid=16073360&pageNo=%s&pageSize=%s&timestamp=%s";
    // 热门推荐专辑 API (堆糖)
    private static final String REC_ALBUM_DT_API
            = "https://www.duitang.com/napi/index/hot/?include_fields=top_comments,is_root,source_link,item,buyable,root_id,status,like_count,sender,album" +
            "&start=%s&limit=%s&_=%s";
    // 分类专辑 API (堆糖)
    private static final String CAT_ALBUM_DT_API
            = "https://www.duitang.com/napi/blog/list/by_filter_id/?include_fields=top_comments,is_root,source_link,item,buyable,root_id,status,like_count,sender,album,reply_count" +
            "&filter_id=%s&start=%s&limit=%s&_=%s";
    // Top 250 专辑 API (豆瓣)
    private static final String TOP_ALBUM_DB_API
            = "https://music.douban.com/top250?start=%s";
    // 分类专辑 API (豆瓣)
    private static final String CAT_ALBUM_DB_API
            = "https://music.douban.com/tag/%s?start=%s&type=T";

    // 歌手标签 API (QQ)
    private static final String ARTIST_TAG_QQ_API
            = prefixQQ33 + "/singer/category";

    /**
     * 加载歌手标签
     *
     * @return
     */
    public static void initArtistTag() {
        // 网易云 网易云 网易云 酷狗 QQ 酷我 酷我 千千 猫耳
        Tags.artistTag.put("默认", new String[]{"1", "", "", "0 0", "-100 -100 -100 -100", "11", "0 ", "  ", " "});

        Tags.artistTag.put("男", new String[]{"", "1 -1 -1", "", "1 0", "0 -100 -100 -100", "", "", "  男", ""});
        Tags.artistTag.put("女", new String[]{"", "2 -1 -1", "", "2 0", "1 -100 -100 -100", "", "", "  女", ""});
        Tags.artistTag.put("组合", new String[]{"", "3 -1 -1", "", "3 0", "2 -100 -100 -100", "16", "", "  组合", ""});
        Tags.artistTag.put("乐队", new String[]{"", "", "", "", "", "", "", "  乐队", ""});
        Tags.artistTag.put("华语", new String[]{"1", "-1 7 -1", "", "0 1", "", "11", "", "", ""});
        Tags.artistTag.put("华语男", new String[]{"", "1 7 -1", "", "1 1", "", "", "1 ", "", ""});
        Tags.artistTag.put("华语女", new String[]{"", "2 7 -1", "", "2 1", "", "", "2 ", "", ""});
        Tags.artistTag.put("华语组合", new String[]{"", "3 7 -1", "", "3 1", "", "", "3 ", "", ""});
        Tags.artistTag.put("内地", new String[]{"", "", "", "", "-100 -100 -100 200", "", "", " 内地 ", ""});
        Tags.artistTag.put("内地男", new String[]{"", "", "", "", "0 -100 -100 200", "", "", " 内地 男", ""});
        Tags.artistTag.put("内地女", new String[]{"", "", "", "", "1 -100 -100 200", "", "", " 内地 女", ""});
        Tags.artistTag.put("内地组合", new String[]{"", "", "", "", "2 -100 -100 200", "", "", " 内地 组合", ""});
        Tags.artistTag.put("内地乐队", new String[]{"", "", "", "", "", "", "", " 内地 乐队", ""});
        Tags.artistTag.put("港台", new String[]{"", "", "", "", "-100 -100 -100 2", "", "", " 港台 ", ""});
        Tags.artistTag.put("港台男", new String[]{"", "", "", "", "0 -100 -100 2", "", "", " 港台 男", ""});
        Tags.artistTag.put("港台女", new String[]{"", "", "", "", "1 -100 -100 2", "", "", " 港台 女", ""});
        Tags.artistTag.put("港台组合", new String[]{"", "", "", "", "2 -100 -100 2", "", "", " 港台 组合", ""});
        Tags.artistTag.put("港台乐队", new String[]{"", "", "", "", "", "", "", " 港台 乐队", ""});
        Tags.artistTag.put("欧美", new String[]{"2", "-1 96 -1", "", "0 2", "-100 -100 -100 5", "13", "", " 欧美 ", ""});
        Tags.artistTag.put("欧美男", new String[]{"", "1 96 -1", "", "1 2", "0 -100 -100 5", "", "7 ", " 欧美 男", ""});
        Tags.artistTag.put("欧美女", new String[]{"", "2 96 -1", "", "2 2", "1 -100 -100 5", "", "8 ", " 欧美 女", ""});
        Tags.artistTag.put("欧美组合", new String[]{"", "3 96 -1", "", "3 2", "2 -100 -100 5", "", "9 ", " 欧美 组合", ""});
        Tags.artistTag.put("欧美乐队", new String[]{"", "", "", "", "", "", "", " 欧美 乐队", ""});
        Tags.artistTag.put("韩国", new String[]{"3", "-1 16 -1", "", "0 6", "-100 -100 -100 3", "", "", " 韩国 ", ""});
        Tags.artistTag.put("韩国男", new String[]{"", "1 16 -1", "", "1 6", "0 -100 -100 3", "", "", " 韩国 男", ""});
        Tags.artistTag.put("韩国女", new String[]{"", "2 16 -1", "", "2 6", "1 -100 -100 3", "", "", " 韩国 女", ""});
        Tags.artistTag.put("韩国组合", new String[]{"", "3 16 -1", "", "3 6", "2 -100 -100 3", "", "", " 韩国 组合", ""});
        Tags.artistTag.put("韩国乐队", new String[]{"", "", "", "", "", "", "", " 韩国 乐队", ""});
        Tags.artistTag.put("日本", new String[]{"4", "-1 8 -1", "", "0 5", "-100 -100 -100 4", "", "", " 日本 ", ""});
        Tags.artistTag.put("日本男", new String[]{"", "1 8 -1", "", "1 5", "0 -100 -100 4", "", "", " 日本 男", ""});
        Tags.artistTag.put("日本女", new String[]{"", "2 8 -1", "", "2 5", "1 -100 -100 4", "", "", " 日本 女", ""});
        Tags.artistTag.put("日本组合", new String[]{"", "3 8 -1", "", "3 5", "2 -100 -100 4", "", "", " 日本 组合", ""});
        Tags.artistTag.put("日本乐队", new String[]{"", "", "", "", "", "", "", " 日本 乐队", ""});
        Tags.artistTag.put("日韩", new String[]{"", "", "", "0 3", "", "12", "", "", ""});
        Tags.artistTag.put("日韩男", new String[]{"", "", "", "1 3", "", "", "4 ", "", ""});
        Tags.artistTag.put("日韩女", new String[]{"", "", "", "2 3", "", "", "5 ", "", ""});
        Tags.artistTag.put("日韩组合", new String[]{"", "", "", "3 3", "", "", "6 ", "", ""});
        Tags.artistTag.put("其他", new String[]{"", "-1 0 -1", "", "0 4", "-100 -100 -100 6", "", "10 ", " 其他 ", ""});
        Tags.artistTag.put("其他男", new String[]{"", "1 0 -1", "", "1 4", "0 -100 -100 6", "", "", " 其他 男", ""});
        Tags.artistTag.put("其他女", new String[]{"", "2 0 -1", "", "2 4", "1 -100 -100 6", "", "", " 其他 女", ""});
        Tags.artistTag.put("其他组合", new String[]{"", "3 0 -1", "", "3 4", "2 -100 -100 6", "", "", " 其他 组合", ""});
        Tags.artistTag.put("其他乐队", new String[]{"", "", "", "", "", "", "", " 其他 乐队", ""});

        final int c = 9;
        // 网易云曲风
        Runnable initStyleArtistTag = () -> {
            String tagBody = HttpRequest.get(String.format(STYLE_API))
                    .execute()
                    .body();
            JSONObject tagJson = JSONObject.fromObject(tagBody);
            JSONArray tags = tagJson.getJSONArray("data");
            for (int i = 0, len = tags.size(); i < len; i++) {
                JSONObject tag = tags.getJSONObject(i);

                String name = tag.getString("tagName");
                String id = tag.getString("tagId");

                if (!Tags.artistTag.containsKey(name)) Tags.artistTag.put(name, new String[c]);
                Tags.artistTag.get(name)[2] = id;
                // 子标签
                JSONArray subTags = tag.optJSONArray("childrenTags");
                if (subTags == null) continue;
                for (int j = 0, s = subTags.size(); j < s; j++) {
                    JSONObject subTag = subTags.getJSONObject(j);

                    String subName = subTag.getString("tagName");
                    String subId = subTag.getString("tagId");

                    if (!Tags.artistTag.containsKey(subName)) Tags.artistTag.put(subName, new String[c]);
                    Tags.artistTag.get(subName)[2] = subId;
                    // 孙子标签
                    JSONArray ssTags = subTag.optJSONArray("childrenTags");
                    if (ssTags == null) continue;
                    for (int k = 0, l = ssTags.size(); k < l; k++) {
                        JSONObject ssTag = ssTags.getJSONObject(k);

                        String ssName = ssTag.getString("tagName");
                        String ssId = ssTag.getString("tagId");

                        if (!Tags.artistTag.containsKey(ssName)) Tags.artistTag.put(ssName, new String[c]);
                        Tags.artistTag.get(ssName)[2] = ssId;
                    }
                }
            }
        };

        // QQ + 网易云 + 千千
        // 分类歌手标签
        Runnable initArtistTagQq = () -> {
            String artistTagBody = HttpRequest.get(String.format(ARTIST_TAG_QQ_API))
                    .execute()
                    .body();
            JSONObject artistTagJson = JSONObject.fromObject(artistTagBody);
            JSONObject data = artistTagJson.getJSONObject("data");
            // 流派
            JSONArray genre = data.getJSONArray("genre");
            for (int i = 0, len = genre.size(); i < len; i++) {
                JSONObject tagJson = genre.getJSONObject(i);

                String name = tagJson.getString("name");
                if ("全部".equals(name)) continue;
                String id = tagJson.getString("id");

                if (!Tags.artistTag.containsKey(name)) Tags.artistTag.put(name, new String[c]);
                Tags.artistTag.get(name)[4] = String.format("-100 %s -100 -100", id);
            }
            // 首字母
            JSONArray index = data.getJSONArray("index");
            for (int i = 0, len = index.size(); i < len; i++) {
                JSONObject tagJson = index.getJSONObject(i);

                String name = tagJson.getString("name");
                if ("热门".equals(name)) continue;
                String id = tagJson.getString("id");

                if (!Tags.artistTag.containsKey(name)) Tags.artistTag.put(name, new String[c]);
                Tags.artistTag.get(name)[4] = String.format("-100 -100 %s -100", id);

                // 网易云
                Tags.artistTag.get(name)[1] = String.format("-1 -1 %s", "#".equals(name) ? "0" : name);

                // 酷我
                if (!"#".equals(name)) Tags.artistTag.get(name)[6] = String.format("0 %s", name);

                // 千千
                Tags.artistTag.get(name)[7] = String.format("%s  ", "#".equals(name) ? "other" : name);

                // 猫耳
                Tags.artistTag.get(name)[8] = String.format("%s", "#".equals(name) ? "0" : String.valueOf(name.charAt(0) - 64));
            }
        };

        List<Future<?>> taskList = new LinkedList<>();

        taskList.add(GlobalExecutors.requestExecutor.submit(initStyleArtistTag));
        taskList.add(GlobalExecutors.requestExecutor.submit(initArtistTagQq));

        taskList.forEach(task -> {
            try {
                task.get();
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
    }

    // 歌手榜 API
    private static final String ARTIST_RANKING_LIST_API = prefix + "/toplist/artist?type=%s";
    // 热门歌手 API
    private static final String HOT_ARTIST_LIST_API = prefix + "/top/artists?offset=%s&limit=%s";
    // 分类歌手 API
    private static final String CAT_ARTIST_API = prefix + "/artist/list?type=%s&area=%s&initial=%s&offset=%s&limit=%s";
    // 曲风歌手 API
    private static final String STYLE_ARTIST_API = prefix + "/style/artist?tagId=%s&cursor=%s&size=%s";
    // 热门歌手推荐 API (酷狗)
    private static final String HOT_ARTIST_LIST_KG_API = "http://mobilecdnbj.kugou.com/api/v5/singer/list?sextype=%s&type=%s&sort=1&page=%s&pagesize=%s";
    // 飙升歌手推荐 API (酷狗)
    private static final String UP_ARTIST_LIST_KG_API = "http://mobilecdnbj.kugou.com/api/v5/singer/list?sextype=%s&type=%s&sort=2&page=%s&pagesize=%s";
    // 推荐歌手 API (QQ)
    private static final String ARTIST_LIST_QQ_API = prefixQQ33 + "/singer/list?sex=%s&genre=%s&index=%s&area=%s&pageNo=%s";
    // 歌手推荐 API (酷我)
//    private static final String ARTIST_LIST_KW_API = prefixKw + "/kuwo/rec_singer?category=%s&pn=%s&rn=%s";
    private static final String ARTIST_LIST_KW_API = "http://www.kuwo.cn/api/www/artist/artistInfo?category=%s&pn=%s&rn=%s&httpsStatus=1";
    // 全部歌手 API (酷我)
//    private static final String ALL_ARTISTS_LIST_KW_API = prefixKw + "/kuwo/singer?category=%s&pn=%s&rn=%s";
    private static final String ALL_ARTISTS_LIST_KW_API = "http://www.kuwo.cn/api/www/artist/artistInfo?category=%s&prefix=%s&pn=%s&rn=%s&httpsStatus=1";
    // 来电新声榜 API (咪咕)
    private static final String ARTIST_LIST_MG_API = "https://app.c.nf.migu.cn/MIGUM2.0/v1.0/content/querycontentbyId.do?columnId=22425062";
    // 来电唱作榜 API (咪咕)
    private static final String ARTIST_LIST_MG_API_2 = "https://app.c.nf.migu.cn/MIGUM2.0/v1.0/content/querycontentbyId.do?columnId=22425072";
    // 推荐歌手 API (千千)
    private static final String REC_ARTISTS_LIST_QI_API = "https://music.91q.com/v1/index?appid=16073360&pageSize=12&timestamp=%s&type=song";
    // 分类歌手 API (千千)
    private static final String CAT_ARTISTS_LIST_QI_API = "https://music.91q.com/v1/artist/list?appid=16073360&" +
            "artistFristLetter=%s&artistGender=%s&artistRegion=%s&pageNo=%s&pageSize=%s&timestamp=%s";
    // CV 广场 API (猫耳)
    private static final String CAT_CV_ME_API = "https://www.missevan.com/organization/getseiys?initial=%s&p=%s&page_size=%s";
    // 社团广场 API (猫耳)
    private static final String CAT_ORGANIZATIONS_ME_API = "https://www.missevan.com/organization/getorganizations?initial=%s&p=%s&page_size=%s";

    // 新晋电台 API
    private static final String NEW_RADIO_API = prefix + "/dj/toplist?type=new&limit=200";
    // 推荐个性电台 API
    private static final String PERSONALIZED_RADIO_API = prefix + "/personalized/djprogram";
    // 推荐电台 API
    private static final String RECOMMEND_RADIO_API = prefix + "/dj/recommend";
    // 付费精品电台 API
    private static final String PAY_RADIO_API = prefix + "/dj/toplist/pay?limit=100";
    // 付费精选电台 API
    private static final String PAY_GIFT_RADIO_API = prefix + "/dj/paygift?offset=%s&limit=%s";
    // 推荐电台 API (QQ)
    private static final String RECOMMEND_RADIO_QQ_API = prefixQQ33 + "/radio/category";
    // 推荐广播剧 API (猫耳)
    private static final String REC_RADIO_ME_API = "https://www.missevan.com/drama/site/recommend";
    // 夏日推荐 API (猫耳)
    private static final String SUMMER_RADIO_ME_API = "https://www.missevan.com/dramaapi/summerdrama";
    // 频道 API (猫耳)
//    private static final String CHANNEL_ME_API = "https://www.missevan.com/explore/channels?type=0";


    // 分类热门电台标签 API
    private static final String HOT_RADIO_TAG_API
            = prefix + "/dj/category/recommend";
    // 分类推荐电台标签 API
    private static final String REC_RADIO_TAG_API
            = prefix + "/dj/catelist";
    // 电台分类标签 API (喜马拉雅)
    private static final String RADIO_TAG_XM_API
            = "https://www.ximalaya.com/revision/category/allCategoryInfo";
    // 排行榜标签 API (喜马拉雅)
    private static final String RADIO_RANKING_TAG_XM_API
            = "https://www.ximalaya.com/revision/rank/v3/cluster";
    // 广播剧标签 API (猫耳)
    private static final String RADIO_TAG_ME_API
            = "https://www.missevan.com/dramaapi/tag";
    // 电台标签 API (豆瓣)
    private static final String RADIO_TAG_DB_API
            = "https://movie.douban.com/chart";
    // 游戏电台标签 API (豆瓣)
    private static final String GAME_RADIO_TAG_DB_API
            = "https://www.douban.com/game/explore";

    /**
     * 加载电台标签
     *
     * @return
     */
    public static void initRadioTag() {
        // 网易云 网易云 喜马拉雅 喜马拉雅 喜马拉雅 猫耳 豆瓣 豆瓣
        Tags.radioTag.put("默认", new String[]{"", "", "", "", "", "0 0 0", "", " "});

        // 喜马拉雅频道
        Tags.radioTag.put("小说", new String[]{"", "", "", "", "7", "", "", ""});
        Tags.radioTag.put("儿童", new String[]{"", "", "", "", "11", "", "", ""});
        Tags.radioTag.put("相声小品", new String[]{"", "", "", "", "9", "", "", ""});
        Tags.radioTag.put("评书", new String[]{"", "", "", "", "10", "", "", ""});
        Tags.radioTag.put("娱乐", new String[]{"", "", "", "", "13", "", "", ""});
        Tags.radioTag.put("悬疑", new String[]{"", "", "", "", "14", "", "", ""});
        Tags.radioTag.put("人文", new String[]{"", "", "", "", "17", "", "", ""});
        Tags.radioTag.put("国学", new String[]{"", "", "", "", "18", "", "", ""});
        Tags.radioTag.put("头条", new String[]{"", "", "", "", "24", "", "", ""});
        Tags.radioTag.put("音乐", new String[]{"", "", "", "", "19", "", "", ""});
        Tags.radioTag.put("历史", new String[]{"", "", "", "", "16", "", "", ""});
        Tags.radioTag.put("情感", new String[]{"", "", "", "", "20", "", "", ""});
        Tags.radioTag.put("投资理财", new String[]{"", "", "", "", "26", "", "", ""});
        Tags.radioTag.put("个人提升", new String[]{"", "", "", "", "31", "", "", ""});
        Tags.radioTag.put("健康", new String[]{"", "", "", "", "22", "", "", ""});
        Tags.radioTag.put("生活", new String[]{"", "", "", "", "21", "", "", ""});
        Tags.radioTag.put("影视", new String[]{"", "", "", "", "15", "", "", ""});
        Tags.radioTag.put("商业管理", new String[]{"", "", "", "", "27", "", "", ""});
        Tags.radioTag.put("英语", new String[]{"", "", "", "", "29", "", "", ""});
        Tags.radioTag.put("少儿素养", new String[]{"", "", "", "", "12", "", "", ""});
        Tags.radioTag.put("科技", new String[]{"", "", "", "", "28", "", "", ""});
        Tags.radioTag.put("教育考试", new String[]{"", "", "", "", "32", "", "", ""});
        Tags.radioTag.put("体育", new String[]{"", "", "", "", "25", "", "", ""});
        Tags.radioTag.put("小语种", new String[]{"", "", "", "", "30", "", "", ""});
        Tags.radioTag.put("广播剧", new String[]{"", "", "", "", "8", "", "", ""});
        Tags.radioTag.put("汽车", new String[]{"", "", "", "", "23", "", "", ""});

        final int c = 8;
        // 网易云
        // 分类热门电台标签
        Runnable initHotRadioTag = () -> {
            String radioTagBody = HttpRequest.get(String.format(HOT_RADIO_TAG_API))
                    .execute()
                    .body();
            JSONObject radioTagJson = JSONObject.fromObject(radioTagBody);
            JSONArray tags = radioTagJson.getJSONArray("data");
            for (int i = 0, len = tags.size(); i < len; i++) {
                JSONObject tagJson = tags.getJSONObject(i);

                String name = tagJson.getString("categoryName");
                String id = tagJson.getString("categoryId");

                if (!Tags.radioTag.containsKey(name)) Tags.radioTag.put(name, new String[c]);
                Tags.radioTag.get(name)[0] = id;
            }
        };
        // 分类推荐电台标签
        Runnable initRecRadioTag = () -> {
            String radioTagBody = HttpRequest.get(String.format(REC_RADIO_TAG_API))
                    .execute()
                    .body();
            JSONObject radioTagJson = JSONObject.fromObject(radioTagBody);
            JSONArray tags = radioTagJson.getJSONArray("categories");
            for (int i = 0, len = tags.size(); i < len; i++) {
                JSONObject tagJson = tags.getJSONObject(i);

                String name = tagJson.getString("name");
                String id = tagJson.getString("id");

                if (!Tags.radioTag.containsKey(name)) Tags.radioTag.put(name, new String[c]);
                Tags.radioTag.get(name)[1] = id;
            }
        };

        // 喜马拉雅
        // 电台分类标签
        Runnable initRadioTagXm = () -> {
            String radioTagBody = HttpRequest.get(String.format(RADIO_TAG_XM_API))
                    .execute()
                    .body();
            JSONObject radioTagJson = JSONObject.fromObject(radioTagBody);
            JSONArray fTags = radioTagJson.getJSONArray("data");
            for (int i = 0, len = fTags.size(); i < len; i++) {
                JSONArray sTags = fTags.getJSONObject(i).getJSONArray("categories");
                // 大标签
                for (int j = 0, size = sTags.size(); j < size; j++) {
                    JSONObject tagJson = sTags.getJSONObject(j);

                    String name = tagJson.getString("displayName");
                    String pinyin = tagJson.getString("pinyin");

                    if (!Tags.radioTag.containsKey(name)) Tags.radioTag.put(name, new String[c]);
                    Tags.radioTag.get(name)[3] = pinyin + " ";

                    // 子标签
                    JSONArray ssTags = tagJson.getJSONArray("subcategories");
                    for (int k = 0, s = ssTags.size(); k < s; k++) {
                        JSONObject ssTagJson = ssTags.getJSONObject(k);

                        String ssName = name + " - " + ssTagJson.getString("displayValue");
                        String ssId = String.format("%s %s", pinyin, ssTagJson.getString("code"));

                        if (!Tags.radioTag.containsKey(ssName)) Tags.radioTag.put(ssName, new String[c]);
                        Tags.radioTag.get(ssName)[3] = ssId;
                    }
                }
            }
        };
        // 排行榜标签
        Runnable initRankingTagXm = () -> {
            String radioTagBody = HttpRequest.get(String.format(RADIO_RANKING_TAG_XM_API))
                    .execute()
                    .body();
            JSONObject radioTagJson = JSONObject.fromObject(radioTagBody);
            JSONArray fTags = radioTagJson.getJSONObject("data").getJSONArray("clusterType");
            for (int i = 0, len = fTags.size(); i < len; i++) {
                JSONObject sJson = fTags.getJSONObject(i);
                if (sJson.getInt("rankType") != 2) continue;
                String n = sJson.getString("rankClusterTypeTitle") + " - ";
                String t = sJson.getString("rankClusterTypeId") + " ";
                JSONArray sTags = sJson.getJSONArray("rankClusterCategories");
                for (int j = 0, s = sTags.size(); j < s; j++) {
                    JSONObject tagJson = sTags.getJSONObject(j);

                    String name = n + tagJson.getString("rankClusterTitle");
                    String id = t + tagJson.getString("rankClusterId");

                    if (!Tags.radioTag.containsKey(name)) Tags.radioTag.put(name, new String[c]);
                    Tags.radioTag.get(name)[2] = id;
                }
            }
        };

        // 猫耳
        // 广播剧标签
        Runnable initRadioTagMe = () -> {
            String radioTagBody = HttpRequest.get(String.format(RADIO_TAG_ME_API))
                    .execute()
                    .body();
            JSONObject radioTagJson = JSONObject.fromObject(radioTagBody);
            JSONObject tags = radioTagJson.getJSONObject("info");
            final String[] cats = {"integrity", "age", "tags"};
            for (int i = 0, len = cats.length; i < len; i++) {
                JSONArray tagArray = tags.getJSONArray(cats[i]);
                for (int j = 0, s = tagArray.size(); j < s; j++) {
                    JSONObject tagJson = tagArray.getJSONObject(j);

                    String name = tagJson.getString("name");
                    String id = tagJson.getString("id");

                    if (!Tags.radioTag.containsKey(name)) Tags.radioTag.put(name, new String[c]);
                    if (i == 0) id = String.format("%s 0 0", id);
                    else if (i == 1) id = String.format("0 %s 0", id);
                    else id = String.format("0 0 %s", id);
                    Tags.radioTag.get(name)[5] = id;
                }
            }
        };

        // 豆瓣
        // 分类电台标签
        Runnable initRadioTagDb = () -> {
            String radioTagBody = HttpRequest.get(String.format(RADIO_TAG_DB_API))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(radioTagBody);
            Elements tags = doc.select("div.types span a");
            for (int i = 0, len = tags.size(); i < len; i++) {
                Element tag = tags.get(i);

                String name = tag.text();
                String id = ReUtil.get("type=(\\d+)", tag.attr("href"), 1);

                if (!Tags.radioTag.containsKey(name)) Tags.radioTag.put(name, new String[c]);
                Tags.radioTag.get(name)[6] = id;
            }
        };
        // 分类游戏电台标签
        Runnable initGameRadioTagDb = () -> {
            String radioTagBody = HttpRequest.get(String.format(GAME_RADIO_TAG_DB_API))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(radioTagBody);
            Elements fieldset = doc.select("form.filters fieldset");
            Elements tags = fieldset.first().select("label:not(.is-active)");
            for (int i = 0, len = tags.size(); i < len; i++) {
                Element tag = tags.get(i);

                String name = tag.text();
                String id = tag.getElementsByTag("input").attr("value");

                if (!Tags.radioTag.containsKey(name)) Tags.radioTag.put(name, new String[c]);
                Tags.radioTag.get(name)[7] = id + " ";
            }
            tags = fieldset.last().select("label:not(.is-active)");
            for (int i = 0, len = tags.size(); i < len; i++) {
                Element tag = tags.get(i);

                String name = tag.text();
                String id = tag.getElementsByTag("input").attr("value");

                if (!Tags.radioTag.containsKey(name)) Tags.radioTag.put(name, new String[c]);
                Tags.radioTag.get(name)[7] = " " + id;
            }
        };

        List<Future<?>> taskList = new LinkedList<>();

        taskList.add(GlobalExecutors.requestExecutor.submit(initHotRadioTag));
        taskList.add(GlobalExecutors.requestExecutor.submit(initRecRadioTag));
        taskList.add(GlobalExecutors.requestExecutor.submit(initRadioTagXm));
        taskList.add(GlobalExecutors.requestExecutor.submit(initRankingTagXm));
        taskList.add(GlobalExecutors.requestExecutor.submit(initRadioTagMe));
        taskList.add(GlobalExecutors.requestExecutor.submit(initRadioTagDb));
        taskList.add(GlobalExecutors.requestExecutor.submit(initGameRadioTagDb));

        taskList.forEach(task -> {
            try {
                task.get();
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
    }

    //    // 个性电台推荐 API
//    private static final String PERSONAL_RADIO_API
//            = prefix + "/dj/personalize/recommend";
    // 今日优选电台 API
    private static final String DAILY_RADIO_API
            = prefix + "/dj/today/perfered";
    // 热门电台 API
    private static final String HOT_RADIO_API
            = prefix + "/dj/hot?limit=1000";
    // 热门电台榜 API
    private static final String RADIO_TOPLIST_API
            = prefix + "/dj/toplist?type=hot&limit=200";
    // 推荐电台 API
    private static final String REC_RADIO_API
            = prefix + "/dj/recommend";
    // 分类热门电台 API
    private static final String CAT_HOT_RADIO_API
            = prefix + "/dj/radio/hot?cateId=%s&offset=%s&limit=%s";
    // 分类推荐电台 API
    private static final String CAT_REC_RADIO_API
            = prefix + "/dj/recommend/type?type=%s";
    // 分类电台榜 API (喜马拉雅)
    private static final String CAT_RADIO_RANKING_XM_API
            = "https://www.ximalaya.com/revision/rank/v3/element?typeId=%s&clusterId=%s";
    // 分类电台 API (喜马拉雅)
    private static final String CAT_RADIO_XM_API
            = "https://www.ximalaya.com/revision/category/queryCategoryPageAlbums?category=%s&subcategory=%s&meta=&sort=0&page=%s&perPage=%s&useCache=false";
    // 频道电台 API (喜马拉雅)
    private static final String CHANNEL_RADIO_XM_API
            = "https://www.ximalaya.com/revision/metadata/v2/channel/albums?groupId=%s&pageNum=%s&pageSize=%s&sort=1&metadata=";
    // 周榜电台 API (猫耳)
    private static final String WEEK_RADIO_ME_API
            = "https://www.missevan.com/reward/drama-reward-rank?period=1&page=%s&page_size=%s";
    // 月榜电台 API (猫耳)
    private static final String MONTH_RADIO_ME_API
            = "https://www.missevan.com/reward/drama-reward-rank?period=2&page=%s&page_size=%s";
    // 总榜电台 API (猫耳)
    private static final String ALL_TIME_RADIO_ME_API
            = "https://www.missevan.com/reward/drama-reward-rank?period=3&page=%s&page_size=%s";
    // 广播剧分类电台 API (猫耳)
    private static final String CAT_RADIO_ME_API
            = "https://www.missevan.com/dramaapi/filter?filters=%s_0_%s_%s_0&page=%s&order=1&page_size=%s";
    // Top 250 电台 API (豆瓣)
    private static final String TOP_RADIO_DB_API
            = "https://movie.douban.com/top250?start=%s&filter=";
    // 分类电台 API (豆瓣)
    private static final String CAT_RADIO_DB_API
            = "https://movie.douban.com/j/chart/top_list?type=%s&interval_id=100:90&action=&start=%s&limit=%s";
    // 分类电台总数 API (豆瓣)
    private static final String CAT_RADIO_TOTAL_DB_API
            = "https://movie.douban.com/j/chart/top_list_count?type=%s&interval_id=100:90";
    // 分类游戏电台 API (豆瓣)
    private static final String CAT_GAME_RADIO_DB_API
            = "https://www.douban.com/j/ilmen/game/search?genres=%s&platforms=%s&more=%s&sort=rating";

    // 探索节目标签 API (猫耳)
    private static final String EXP_PROGRAM_TAG_ME_API
            = "https://www.missevan.com/explore";
    // 首页子标签 API (猫耳)
    private static final String PROGRAM_SUB_TAG_ME_API
            = "https://www.missevan.com";

    /**
     * 加载节目标签
     *
     * @return
     */
    public static void initProgramTag() {
        // 猫耳 猫耳
        Tags.programTag.put("默认", new String[]{"", ""});

        final int c = 2;
        // 猫耳
        // 猫耳探索
        Runnable initExpProgramTagMe = () -> {
            String playlistTagBody = HttpRequest.get(String.format(EXP_PROGRAM_TAG_ME_API))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(playlistTagBody);

            Elements tags = doc.select(".explore-tag");
            for (int i = 0, len = tags.size(); i < len; i++) {
                Element t = tags.get(i);

                String id = t.attr("data-tagid");
                String name = t.getElementsByTag("a").text().trim();

                if (!Tags.programTag.containsKey(name)) Tags.programTag.put(name, new String[c]);
                Tags.programTag.get(name)[0] = id;
            }
        };
        // 首页标签
        Runnable initProgramIndexTagMe = () -> {
            String radioTagBody = HttpRequest.get(String.format(PROGRAM_SUB_TAG_ME_API))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(radioTagBody);

            // 大标签
            Elements tags = doc.select(".vw-topcatalog-item.fc-topcatalog-item");
            for (int i = 0, len = tags.size(); i < len; i++) {
                Element tag = tags.get(i);
                Element t = tag.getElementsByTag("a").first();

                String name = t.attr("title");
                String href = t.attr("href");
                // 排除广播剧标签
                if (href.contains("drama")) continue;
                String id = href.replaceFirst("/sound/m/", "");

                if (!Tags.programTag.containsKey(name)) Tags.programTag.put(name, new String[c]);
                Tags.programTag.get(name)[1] = id;

                // 子标签
                Elements subTags = tag.select(".vw-topcatalog-subitem-container.fc-topcatalog-subitem-container a");
                for (int j = 0, size = subTags.size(); j < size; j++) {
                    Element subTag = subTags.get(j);

                    String subName = String.format("%s - %s", name, subTag.attr("title"));
                    String subId = subTag.attr("href").replaceFirst("/sound/m/", "");

                    if (!Tags.programTag.containsKey(subName)) Tags.programTag.put(subName, new String[c]);
                    Tags.programTag.get(subName)[1] = subId;
                }
            }
        };

        List<Future<?>> taskList = new LinkedList<>();

        taskList.add(GlobalExecutors.requestExecutor.submit(initExpProgramTagMe));
        taskList.add(GlobalExecutors.requestExecutor.submit(initProgramIndexTagMe));

        taskList.forEach(task -> {
            try {
                task.get();
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
    }

    // 推荐节目 API
    private static final String RECOMMEND_PROGRAM_API
            = prefix + "/program/recommend";
    // 推荐个性节目 API
    private static final String PERSONALIZED_PROGRAM_API
            = prefix + "/personalized/djprogram";
    // 24 小时节目榜 API
    private static final String PROGRAM_24_HOURS_TOPLIST_API
            = prefix + "/dj/program/toplist/hours";
    // 节目榜 API
    private static final String PROGRAM_TOPLIST_API
            = prefix + "/dj/program/toplist?limit=200";
    // 推荐节目 API (猫耳)
    private static final String REC_PROGRAM_ME_API
            = "https://www.missevan.com/site/homepage";
    // 探索节目 API (猫耳)
    private static final String EXP_PROGRAM_ME_API
            = "https://www.missevan.com/explore/%s?p=%s&pagesize=%s";
    // 首页分类节目 API (猫耳)
    private static final String INDEX_CAT_PROGRAM_ME_API
            = "https://www.missevan.com/sound/m?order=1&id=%s&p=%s&pagesize=%s";
    // 首页分类节目 API (最新)(猫耳)
    private static final String INDEX_CAT_NEW_PROGRAM_ME_API
            = "https://www.missevan.com/sound/m?order=0&id=%s&p=%s&pagesize=%s";

    // MV 标签 API (KG)
    private static final String MV_TAG_KG_API
            = "http://mobileservice.kugou.com/api/v5/video/recommend_channel?version=9108&type=2";
    // MV 标签 API (QQ)
    private static final String MV_TAG_QQ_API
            = prefixQQ33 + "/mv/category";

    /**
     * 加载 MV 标签
     *
     * @return
     */
    public static void initMvTag() {
        // 网易云 网易云 酷狗 QQ QQ QQ 酷我 好看 哔哩哔哩
        Tags.mvTag.put("默认", new String[]{"全部", "全部", "0", "15", "7", "0", "236682871", "", ""});

        Tags.mvTag.put("精选", new String[]{"", "", "", "", "", "0", "", "", ""});
        Tags.mvTag.put("内地", new String[]{"内地", "全部", "", "16", "7", "1", "", "", ""});
        Tags.mvTag.put("港台", new String[]{"港台", "全部", "", "17", "7", "2", "", "", ""});
        Tags.mvTag.put("欧美", new String[]{"欧美", "全部", "", "18", "7", "3", "", "", ""});
        Tags.mvTag.put("韩国", new String[]{"韩国", "全部", "", "19", "7", "4", "", "", ""});
        Tags.mvTag.put("日本", new String[]{"日本", "全部", "", "20", "7", "5", "", "", ""});
        Tags.mvTag.put("官方版", new String[]{"", "官方版", "", "", "", "", "", "", ""});
//        Tags.mvTag.put("原生", new String[]{"", "原生", "", "", "", "","", "", ""});
        Tags.mvTag.put("现场版", new String[]{"", "现场版", "", "", "", "", "", "", ""});
        Tags.mvTag.put("网易出品", new String[]{"", "网易出品", "", "", "", "", "", "", ""});

        // 酷我
        Tags.mvTag.put("华语", new String[]{"", "", "", "", "", "", "236682731", "", ""});
        Tags.mvTag.put("日韩", new String[]{"", "", "", "", "", "", "236742444", "", ""});
        Tags.mvTag.put("网络", new String[]{"", "", "", "", "", "", "236682773", "", ""});
        Tags.mvTag.put("欧美", new String[]{"", "", "", "", "", "", "236682735", "", ""});
        Tags.mvTag.put("现场", new String[]{"", "", "", "", "", "", "236742576", "", ""});
        Tags.mvTag.put("热舞", new String[]{"", "", "", "", "", "", "236682777", "", ""});
        Tags.mvTag.put("伤感", new String[]{"", "", "", "", "", "", "236742508", "", ""});
        Tags.mvTag.put("剧情", new String[]{"", "", "", "", "", "", "236742578", "", ""});

        // 好看(部分标签与 b 站合并)
        Tags.mvTag.put("影视", new String[]{"", "", "", "", "", "", "", "yingshi_new", "181"});
        Tags.mvTag.put("音乐", new String[]{"", "", "", "", "", "", "", "yinyue_new", "3"});
        Tags.mvTag.put("VLOG", new String[]{"", "", "", "", "", "", "", "yunying_vlog", ""});
        Tags.mvTag.put("游戏", new String[]{"", "", "", "", "", "", "", "youxi_new", "4"});
        Tags.mvTag.put("搞笑", new String[]{"", "", "", "", "", "", "", "gaoxiao_new", "138"});
        Tags.mvTag.put("综艺", new String[]{"", "", "", "", "", "", "", "zongyi_new", "71"});
        Tags.mvTag.put("娱乐", new String[]{"", "", "", "", "", "", "", "yule_new", "5"});
        Tags.mvTag.put("动漫", new String[]{"", "", "", "", "", "", "", "dongman_new", ""});
        Tags.mvTag.put("生活", new String[]{"", "", "", "", "", "", "", "shenghuo_new", "160"});
        Tags.mvTag.put("广场舞", new String[]{"", "", "", "", "", "", "", "guangchuangwu_new", ""});
        Tags.mvTag.put("美食", new String[]{"", "", "", "", "", "", "", "meishi_new", "211"});
        Tags.mvTag.put("宠物", new String[]{"", "", "", "", "", "", "", "chongwu_new", ""});
        Tags.mvTag.put("三农", new String[]{"", "", "", "", "", "", "", "sannong_new", "251"});
        Tags.mvTag.put("军事", new String[]{"", "", "", "", "", "", "", "junshi_new", "179"});
        Tags.mvTag.put("社会", new String[]{"", "", "", "", "", "", "", "shehui_new", "205"});
        Tags.mvTag.put("体育", new String[]{"", "", "", "", "", "", "", "tiyu_new", ""});
        Tags.mvTag.put("科技", new String[]{"", "", "", "", "", "", "", "keji_new", "188"});
        Tags.mvTag.put("时尚", new String[]{"", "", "", "", "", "", "", "shishang_new", "155"});
        Tags.mvTag.put("汽车", new String[]{"", "", "", "", "", "", "", "qiche_new", "223"});
        Tags.mvTag.put("亲子", new String[]{"", "", "", "", "", "", "", "qinzi_new", ""});
        Tags.mvTag.put("文化", new String[]{"", "", "", "", "", "", "", "wenhua_new", ""});
        Tags.mvTag.put("旅游", new String[]{"", "", "", "", "", "", "", "lvyou_new", ""});
        Tags.mvTag.put("秒懂", new String[]{"", "", "", "", "", "", "", "yunying_miaodong", ""});

        // 哔哩哔哩
        Tags.mvTag.put("动画", new String[]{"", "", "", "", "", "", "", "", "1"});
        Tags.mvTag.put("MAD·AMV", new String[]{"", "", "", "", "", "", "", "", "24"});
        Tags.mvTag.put("MMD·3D", new String[]{"", "", "", "", "", "", "", "", "25"});
        Tags.mvTag.put("短片·手书·配音", new String[]{"", "", "", "", "", "", "", "", "47"});
        Tags.mvTag.put("手办·模玩", new String[]{"", "", "", "", "", "", "", "", "210"});
        Tags.mvTag.put("特摄", new String[]{"", "", "", "", "", "", "", "", "86"});
        Tags.mvTag.put("综合", new String[]{"", "", "", "", "", "", "", "", "27"});
        Tags.mvTag.put("番剧", new String[]{"", "", "", "", "", "", "", "", "13"});
        Tags.mvTag.put("资讯", new String[]{"", "", "", "", "", "", "", "", "51"});
        Tags.mvTag.put("官方延伸", new String[]{"", "", "", "", "", "", "", "", "152"});
        Tags.mvTag.put("完结动画", new String[]{"", "", "", "", "", "", "", "", "32"});
        Tags.mvTag.put("连载动画", new String[]{"", "", "", "", "", "", "", "", "33"});
        Tags.mvTag.put("国创", new String[]{"", "", "", "", "", "", "", "", "167"});
        Tags.mvTag.put("国产动画", new String[]{"", "", "", "", "", "", "", "", "153"});
        Tags.mvTag.put("国产原创相关", new String[]{"", "", "", "", "", "", "", "", "168"});
        Tags.mvTag.put("布袋戏", new String[]{"", "", "", "", "", "", "", "", "169"});
        Tags.mvTag.put("资讯", new String[]{"", "", "", "", "", "", "", "", "170"});
        Tags.mvTag.put("动态漫·广播剧", new String[]{"", "", "", "", "", "", "", "", "195"});
//        Tags.mvTag.put("音乐", new String[]{"", "", "", "", "", "","", "", "3"});
        Tags.mvTag.put("原创音乐", new String[]{"", "", "", "", "", "", "", "", "28"});
        Tags.mvTag.put("翻唱", new String[]{"", "", "", "", "", "", "", "", "31"});
        Tags.mvTag.put("VOCALOID·UTAU", new String[]{"", "", "", "", "", "", "", "", "30"});
//        Tags.mvTag.put("电音 (已下线)", new String[]{"", "", "", "", "", "","", "", "194"});
        Tags.mvTag.put("演奏", new String[]{"", "", "", "", "", "", "", "", "59"});
        Tags.mvTag.put("MV", new String[]{"", "", "", "", "", "", "", "", "193"});
        Tags.mvTag.put("音乐现场", new String[]{"", "", "", "", "", "", "", "", "29"});
        Tags.mvTag.put("音乐综合", new String[]{"", "", "", "", "", "", "", "", "130"});
        Tags.mvTag.put("乐评盘点", new String[]{"", "", "", "", "", "", "", "", "243"});
        Tags.mvTag.put("音乐教学", new String[]{"", "", "", "", "", "", "", "", "244"});
        Tags.mvTag.put("舞蹈", new String[]{"", "", "", "", "", "", "", "", "129"});
        Tags.mvTag.put("宅舞", new String[]{"", "", "", "", "", "", "", "", "20"});
        Tags.mvTag.put("舞蹈综合", new String[]{"", "", "", "", "", "", "", "", "154"});
        Tags.mvTag.put("舞蹈教程", new String[]{"", "", "", "", "", "", "", "", "156"});
        Tags.mvTag.put("街舞", new String[]{"", "", "", "", "", "", "", "", "198"});
        Tags.mvTag.put("明星舞蹈", new String[]{"", "", "", "", "", "", "", "", "199"});
        Tags.mvTag.put("中国舞", new String[]{"", "", "", "", "", "", "", "", "200"});
//        Tags.mvTag.put("游戏", new String[]{"", "", "", "", "", "","", "", "4"});
        Tags.mvTag.put("单机游戏", new String[]{"", "", "", "", "", "", "", "", "17"});
        Tags.mvTag.put("电子竞技", new String[]{"", "", "", "", "", "", "", "", "171"});
        Tags.mvTag.put("手机游戏", new String[]{"", "", "", "", "", "", "", "", "172"});
        Tags.mvTag.put("网络游戏", new String[]{"", "", "", "", "", "", "", "", "65"});
        Tags.mvTag.put("桌游棋牌", new String[]{"", "", "", "", "", "", "", "", "173"});
        Tags.mvTag.put("GMV", new String[]{"", "", "", "", "", "", "", "", "121"});
        Tags.mvTag.put("音游", new String[]{"", "", "", "", "", "", "", "", "136"});
        Tags.mvTag.put("Mugen", new String[]{"", "", "", "", "", "", "", "", "19"});
        Tags.mvTag.put("知识", new String[]{"", "", "", "", "", "", "", "", "36"});
        Tags.mvTag.put("科学科普", new String[]{"", "", "", "", "", "", "", "", "201"});
        Tags.mvTag.put("社科·法律·心理", new String[]{"", "", "", "", "", "", "", "", "124"});
        Tags.mvTag.put("人文历史", new String[]{"", "", "", "", "", "", "", "", "228"});
        Tags.mvTag.put("财经商业", new String[]{"", "", "", "", "", "", "", "", "207"});
        Tags.mvTag.put("校园学习", new String[]{"", "", "", "", "", "", "", "", "208"});
        Tags.mvTag.put("职业职场", new String[]{"", "", "", "", "", "", "", "", "209"});
        Tags.mvTag.put("设计·创意", new String[]{"", "", "", "", "", "", "", "", "229"});
        Tags.mvTag.put("野生技术协会", new String[]{"", "", "", "", "", "", "", "", "122"});
//        Tags.mvTag.put("演讲·公开课 (已下线)", new String[]{"", "", "", "", "", "","", "", "39"});
//        Tags.mvTag.put("星海 (已下线)", new String[]{"", "", "", "", "", "","", "", "96"});
//        Tags.mvTag.put("机械 (已下线)", new String[]{"", "", "", "", "", "","", "", "98"});
//        Tags.mvTag.put("科技", new String[]{"", "", "", "", "", "","", "", "188"});
        Tags.mvTag.put("数码", new String[]{"", "", "", "", "", "", "", "", "95"});
        Tags.mvTag.put("软件应用", new String[]{"", "", "", "", "", "", "", "", "230"});
        Tags.mvTag.put("计算机技术", new String[]{"", "", "", "", "", "", "", "", "231"});
        Tags.mvTag.put("工业·工程·机械", new String[]{"", "", "", "", "", "", "", "", "232"});
        Tags.mvTag.put("极客DIY", new String[]{"", "", "", "", "", "", "", "", "233"});
//        Tags.mvTag.put("电脑装机 (已下线)", new String[]{"", "", "", "", "", "","", "", "189"});
//        Tags.mvTag.put("摄影摄像 (已下线)", new String[]{"", "", "", "", "", "","", "", "190"});
//        Tags.mvTag.put("影音智能 (已下线)", new String[]{"", "", "", "", "", "","", "", "191"});
        Tags.mvTag.put("运动", new String[]{"", "", "", "", "", "", "", "", "234"});
        Tags.mvTag.put("篮球", new String[]{"", "", "", "", "", "", "", "", "235"});
        Tags.mvTag.put("足球", new String[]{"", "", "", "", "", "", "", "", "249"});
        Tags.mvTag.put("健身", new String[]{"", "", "", "", "", "", "", "", "164"});
        Tags.mvTag.put("竞技体育", new String[]{"", "", "", "", "", "", "", "", "236"});
        Tags.mvTag.put("运动文化", new String[]{"", "", "", "", "", "", "", "", "237"});
        Tags.mvTag.put("运动综合", new String[]{"", "", "", "", "", "", "", "", "238"});
//        Tags.mvTag.put("汽车", new String[]{"", "", "", "", "", "","", "", "223"});
        Tags.mvTag.put("赛车", new String[]{"", "", "", "", "", "", "", "", "245"});
        Tags.mvTag.put("改装玩车", new String[]{"", "", "", "", "", "", "", "", "246"});
        Tags.mvTag.put("新能源车", new String[]{"", "", "", "", "", "", "", "", "247"});
        Tags.mvTag.put("房车", new String[]{"", "", "", "", "", "", "", "", "248"});
        Tags.mvTag.put("摩托车", new String[]{"", "", "", "", "", "", "", "", "240"});
        Tags.mvTag.put("购车攻略", new String[]{"", "", "", "", "", "", "", "", "227"});
        Tags.mvTag.put("汽车生活", new String[]{"", "", "", "", "", "", "", "", "176"});
//        Tags.mvTag.put("汽车文化 (已下线)", new String[]{"", "", "", "", "", "","", "", "224"});
//        Tags.mvTag.put("汽车极客 (已下线)", new String[]{"", "", "", "", "", "","", "", "225"});
//        Tags.mvTag.put("智能出行 (已下线)", new String[]{"", "", "", "", "", "","", "", "226"});
//        Tags.mvTag.put("生活", new String[]{"", "", "", "", "", "","", "", "160"});
//        Tags.mvTag.put("搞笑", new String[]{"", "", "", "", "", "","", "", "138"});
        Tags.mvTag.put("出行", new String[]{"", "", "", "", "", "", "", "", "250"});
//        Tags.mvTag.put("三农", new String[]{"", "", "", "", "", "","", "", "251"});
        Tags.mvTag.put("家居房产", new String[]{"", "", "", "", "", "", "", "", "239"});
        Tags.mvTag.put("手工", new String[]{"", "", "", "", "", "", "", "", "161"});
        Tags.mvTag.put("绘画", new String[]{"", "", "", "", "", "", "", "", "162"});
        Tags.mvTag.put("日常", new String[]{"", "", "", "", "", "", "", "", "21"});
//        Tags.mvTag.put("美食圈 (重定向)", new String[]{"", "", "", "", "", "","", "", "76"});
//        Tags.mvTag.put("动物圈 (重定向)", new String[]{"", "", "", "", "", "","", "", "75"});
//        Tags.mvTag.put("运动 (重定向)", new String[]{"", "", "", "", "", "","", "", "163"});
//        Tags.mvTag.put("汽车 (重定向)", new String[]{"", "", "", "", "", "","", "", "176"});
//        Tags.mvTag.put("其他 (已下线)", new String[]{"", "", "", "", "", "","", "", "174"});
//        Tags.mvTag.put("美食", new String[]{"", "", "", "", "", "","", "", "211"});
        Tags.mvTag.put("美食制作", new String[]{"", "", "", "", "", "", "", "", "76"});
        Tags.mvTag.put("美食侦探", new String[]{"", "", "", "", "", "", "", "", "212"});
        Tags.mvTag.put("美食测评", new String[]{"", "", "", "", "", "", "", "", "213"});
        Tags.mvTag.put("田园美食", new String[]{"", "", "", "", "", "", "", "", "214"});
        Tags.mvTag.put("美食记录", new String[]{"", "", "", "", "", "", "", "", "215"});
        Tags.mvTag.put("动物圈", new String[]{"", "", "", "", "", "", "", "", "217"});
        Tags.mvTag.put("喵星人", new String[]{"", "", "", "", "", "", "", "", "218"});
        Tags.mvTag.put("汪星人", new String[]{"", "", "", "", "", "", "", "", "219"});
        Tags.mvTag.put("野生动物", new String[]{"", "", "", "", "", "", "", "", "221"});
        Tags.mvTag.put("爬宠", new String[]{"", "", "", "", "", "", "", "", "222"});
        Tags.mvTag.put("大熊猫", new String[]{"", "", "", "", "", "", "", "", "220"});
        Tags.mvTag.put("动物综合", new String[]{"", "", "", "", "", "", "", "", "75"});
        Tags.mvTag.put("鬼畜", new String[]{"", "", "", "", "", "", "", "", "119"});
        Tags.mvTag.put("鬼畜调教", new String[]{"", "", "", "", "", "", "", "", "22"});
        Tags.mvTag.put("音MAD", new String[]{"", "", "", "", "", "", "", "", "26"});
        Tags.mvTag.put("人力VOCALOID", new String[]{"", "", "", "", "", "", "", "", "126"});
        Tags.mvTag.put("鬼畜剧场", new String[]{"", "", "", "", "", "", "", "", "216"});
        Tags.mvTag.put("教程演示", new String[]{"", "", "", "", "", "", "", "", "127"});
//        Tags.mvTag.put("时尚", new String[]{"", "", "", "", "", "","", "", "155"});
        Tags.mvTag.put("美妆护肤", new String[]{"", "", "", "", "", "", "", "", "157"});
        Tags.mvTag.put("仿妆cos", new String[]{"", "", "", "", "", "", "", "", "252"});
        Tags.mvTag.put("穿搭", new String[]{"", "", "", "", "", "", "", "", "158"});
//        Tags.mvTag.put("健身 (重定向)", new String[]{"", "", "", "", "", "","", "", "164"});
        Tags.mvTag.put("时尚潮流", new String[]{"", "", "", "", "", "", "", "", "159"});
//        Tags.mvTag.put("风尚标 (已下线)", new String[]{"", "", "", "", "", "","", "", "192"});
        Tags.mvTag.put("资讯", new String[]{"", "", "", "", "", "", "", "", "202"});
        Tags.mvTag.put("热点", new String[]{"", "", "", "", "", "", "", "", "203"});
        Tags.mvTag.put("环球", new String[]{"", "", "", "", "", "", "", "", "204"});
//        Tags.mvTag.put("社会", new String[]{"", "", "", "", "", "","", "", "205"});
        Tags.mvTag.put("综合", new String[]{"", "", "", "", "", "", "", "", "206"});
//        Tags.mvTag.put("广告", new String[]{"", "", "", "", "", "","", "", "165"});
//        Tags.mvTag.put("广告 (已下线)", new String[]{"", "", "", "", "", "","", "", "166"});
//        Tags.mvTag.put("娱乐", new String[]{"", "", "", "", "", "","", "", "5"});
//        Tags.mvTag.put("综艺", new String[]{"", "", "", "", "", "","", "", "71"});
        Tags.mvTag.put("娱乐杂谈", new String[]{"", "", "", "", "", "", "", "", "241"});
        Tags.mvTag.put("粉丝创作", new String[]{"", "", "", "", "", "", "", "", "242"});
        Tags.mvTag.put("明星综合", new String[]{"", "", "", "", "", "", "", "", "137"});
//        Tags.mvTag.put("Korea相关 (已下线)", new String[]{"", "", "", "", "", "","", "", "131"});
//        Tags.mvTag.put("影视", new String[]{"", "", "", "", "", "","", "", "181"});
        Tags.mvTag.put("影视杂谈", new String[]{"", "", "", "", "", "", "", "", "182"});
        Tags.mvTag.put("影视剪辑", new String[]{"", "", "", "", "", "", "", "", "183"});
        Tags.mvTag.put("小剧场", new String[]{"", "", "", "", "", "", "", "", "85"});
        Tags.mvTag.put("预告·资讯", new String[]{"", "", "", "", "", "", "", "", "184"});
        Tags.mvTag.put("纪录片", new String[]{"", "", "", "", "", "", "", "", "177"});
        Tags.mvTag.put("人文·历史", new String[]{"", "", "", "", "", "", "", "", "37"});
        Tags.mvTag.put("科学·探索·自然", new String[]{"", "", "", "", "", "", "", "", "178"});
//        Tags.mvTag.put("军事", new String[]{"", "", "", "", "", "","", "", "179"});
        Tags.mvTag.put("社会·美食·旅行", new String[]{"", "", "", "", "", "", "", "", "180"});
        Tags.mvTag.put("电影", new String[]{"", "", "", "", "", "", "", "", "23"});
        Tags.mvTag.put("华语电影", new String[]{"", "", "", "", "", "", "", "", "147"});
        Tags.mvTag.put("欧美电影", new String[]{"", "", "", "", "", "", "", "", "145"});
        Tags.mvTag.put("日本电影", new String[]{"", "", "", "", "", "", "", "", "146"});
        Tags.mvTag.put("其他国家", new String[]{"", "", "", "", "", "", "", "", "83"});
        Tags.mvTag.put("电视剧", new String[]{"", "", "", "", "", "", "", "", "11"});
        Tags.mvTag.put("国产剧", new String[]{"", "", "", "", "", "", "", "", "185"});
        Tags.mvTag.put("海外剧", new String[]{"", "", "", "", "", "", "", "", "187"});

        final int c = 9;
        // 酷狗
        // MV 标签
        Runnable initMvTagKg = () -> {
            String radioTagBody = HttpRequest.get(String.format(MV_TAG_KG_API))
                    .execute()
                    .body();
            JSONObject radioTagJson = JSONObject.fromObject(radioTagBody);
            JSONArray tags = radioTagJson.getJSONObject("data").getJSONArray("list");
            for (int i = 0, len = tags.size(); i < len; i++) {
                JSONObject tagJson = tags.getJSONObject(i);

                String name = tagJson.getString("name");
                String id = tagJson.getString("channel_id");

                if (!Tags.mvTag.containsKey(name)) Tags.mvTag.put(name, new String[c]);
                Tags.mvTag.get(name)[2] = id;
            }
        };
        // QQ
        // MV 标签
        Runnable initMvTagQq = () -> {
            String radioTagBody = HttpRequest.get(String.format(MV_TAG_QQ_API))
                    .execute()
                    .body();
            JSONObject radioTagJson = JSONObject.fromObject(radioTagBody);
            JSONArray tags = radioTagJson.getJSONObject("data").getJSONArray("version");
            for (int i = 0, len = tags.size(); i < len; i++) {
                JSONObject tagJson = tags.getJSONObject(i);

                String name = tagJson.getString("name");
                if ("全部".equals(name)) continue;
                String id = tagJson.getString("id");

                if (!Tags.mvTag.containsKey(name)) Tags.mvTag.put(name, new String[c]);
                Tags.mvTag.get(name)[3] = "15";
                Tags.mvTag.get(name)[4] = id;
            }
        };

        List<Future<?>> taskList = new LinkedList<>();

        taskList.add(GlobalExecutors.requestExecutor.submit(initMvTagKg));
        taskList.add(GlobalExecutors.requestExecutor.submit(initMvTagQq));

        taskList.forEach(task -> {
            try {
                task.get();
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
    }

    // MV 排行 API
    private static final String TOP_MV_API
            = prefix + "/top/mv?area=%s&offset=%s&limit=%s";
    // 最新 MV API
    private static final String NEW_MV_API
            = prefix + "/mv/first?area=%s&limit=100";
    // 全部 MV API
    private static final String ALL_MV_API
            = prefix + "/mv/all?area=%s&type=%s&offset=%s&limit=%s";
    // 推荐 MV API
    private static final String RECOMMEND_MV_API
            = prefix + "/personalized/mv?limit=100";
    // 网易出品 MV API
    private static final String EXCLUSIVE_MV_API
            = prefix + "/mv/exclusive/rcmd?offset=%s&limit=%s";
    // 推荐 MV API (酷狗)
    private static final String RECOMMEND_MV_KG_API = "http://mobilecdnbj.kugou.com/api/v5/video/list?sort=4&id=%s&page=%s&pagesize=%s";
    // 推荐 MV API (QQ)
    private static final String RECOMMEND_MV_QQ_API = prefixQQ33 + "/mv/list?area=%s&version=%s&pageNo=%s&pageSize=%s";
    // 最新 MV API (QQ)
    private static final String NEW_MV_QQ_API = prefixQQ33 + "/new/mv?type=%s";
    // 推荐 MV API (酷我)
    private static final String RECOMMEND_MV_KW_API = "http://www.kuwo.cn/api/www/music/mvList?pid=%s&pn=%s&rn=%s&httpsStatus=1";
    // 推荐 MV API (千千)
    private static final String RECOMMEND_MV_QI_API
            = "https://music.91q.com/v1/video/list?appid=16073360&pageNo=%s&pageSize=%s&timestamp=%s";
    // 猜你喜欢视频 API (好看)
    private static final String GUESS_VIDEO_HK_API
            = "https://haokan.baidu.com/videoui/api/Getvideolandfeed?time=%s";
    // 榜单视频 API (好看)
    private static final String TOP_VIDEO_HK_API
            = "https://haokan.baidu.com/videoui/page/pc/toplist?type=hotvideo&sfrom=haokan_web_banner&page=%s&pageSize=%s&_format=json";
    // 推荐视频 API (好看)
    private static final String RECOMMEND_VIDEO_HK_API
            = "https://haokan.baidu.com/web/video/feed?tab=%s&act=pcFeed&pd=pc&num=%s&shuaxin_id=1661766211525";
    // 热门视频 API (哔哩哔哩)
    private static final String HOT_VIDEO_BI_API
            = "https://api.bilibili.com/x/web-interface/popular?pn=%s&ps=%s";
    // 分区排行榜视频 API (哔哩哔哩)
    private static final String CAT_RANK_VIDEO_BI_API
            = "http://api.bilibili.com/x/web-interface/ranking/region?rid=%s";
    // 分区最新视频 API (哔哩哔哩)
    private static final String CAT_NEW_VIDEO_BI_API
            = "http://api.bilibili.com/x/web-interface/dynamic/region?rid=%s&pn=%s&ps=%s";

    // 歌曲信息 API (单首)
    private static final String SINGLE_SONG_DETAIL_API = prefix + "/song/detail?ids=%s";
    // 节目信息 API
    private static final String SINGLE_PROGRAM_DETAIL_API = prefix + "/dj/program/detail?id=%s";
    // 歌曲信息 API (酷狗)
    private static final String SINGLE_SONG_DETAIL_KG_API = "https://www.kugou.com/yy/index.php?r=play/getdata&album_audio_id=%s";
    // 歌曲信息 API (QQ)
    private static final String SINGLE_SONG_DETAIL_QQ_API = prefixQQ33 + "/song?songmid=%s";
    // 歌曲封面信息 API (QQ)
    private static final String SINGLE_SONG_IMG_QQ_API = "https://y.gtimg.cn/music/photo_new/T002R500x500M000%s.jpg";
    // 歌曲信息 API (酷我)
//    private static final String SINGLE_SONG_DETAIL_KW_API = prefixKw + "/kuwo/musicInfo?mid=%s";
    private static final String SINGLE_SONG_DETAIL_KW_API = "http://www.kuwo.cn/api/www/music/musicInfo?mid=%s&httpsStatus=1";
    // 歌曲信息 API (咪咕)
    private static final String SINGLE_SONG_DETAIL_MG_API = prefixMg + "/song?cid=%s";
    // 歌曲信息 API (喜马拉雅)
    private static final String SINGLE_SONG_DETAIL_XM_API = "https://www.ximalaya.com/revision/track/simple?trackId=%s";
    // 歌曲信息 API (千千)
    private static final String SINGLE_SONG_DETAIL_QI_API = "https://music.91q.com/v1/song/info?TSID=%s&appid=16073360&timestamp=%s";
    // 歌曲信息 API (音乐磁场)
    private static final String SINGLE_SONG_DETAIL_HF_API = "https://www.hifini.com/thread-%s.htm";
    // 歌曲信息 API (咕咕咕音乐)
    private static final String SINGLE_SONG_DETAIL_GG_API = "http://www.gggmusic.com/thread-%s.htm";
    // 歌曲信息 API (猫耳)
    private static final String SINGLE_SONG_DETAIL_ME_API = "https://www.missevan.com/sound/getsound?soundid=%s";
    // 歌曲专辑信息 API (猫耳)
    private static final String SONG_ALBUM_DETAIL_ME_API = "https://www.missevan.com/dramaapi/getdramabysound?sound_id=%s";
    // 歌曲信息 API (哔哩哔哩)
    private static final String SINGLE_SONG_DETAIL_BI_API = "http://www.bilibili.com/audio/music-service-c/web/song/info?sid=%s";

    // 歌曲 URL 获取 API
    private static final String GET_SONG_URL_API_NEW = prefix + "/song/url/v1?id=%s&level=hires";
    private static final String GET_SONG_URL_API = prefix + "/song/url?id=%s";
    // 歌曲 URL 获取 API (QQ)
//    private static final String GET_SONG_URL_QQ_API = prefixQQ33 + "/song/url?id=%s";
    // 歌曲 URL 获取 API (酷我)
//    private static final String GET_SONG_URL_KW_API = prefixKw + "/kuwo/url?mid=%s";
//    private static final String GET_SONG_URL_KW_API = "http://www.kuwo.cn/api/v1/www/music/playUrl?mid=%s&type=music&httpsStatus=1";
//    private static final String GET_SONG_URL_KW_API = "http://antiserver.kuwo.cn/anti.s?type=convert_url&format=mp3&response=url&rid=%s";
    private static final String GET_SONG_URL_KW_API = "http://www.kuwo.cn/api/v1/www/music/playUrl?mid=%s&type=convert_url3&br=320kmp3";
    // 歌曲 URL 获取 API (千千)
    private static final String GET_SONG_URL_QI_API = "https://music.91q.com/v1/song/tracklink?TSID=%s&appid=16073360&timestamp=%s";
    // 歌曲 URL 获取 API (喜马拉雅)
    private static final String GET_SONG_URL_XM_API = "https://www.ximalaya.com/revision/play/v1/audio?id=%s&ptype=1";
    // 歌曲 URL 获取 API (哔哩哔哩)
    private static final String GET_SONG_URL_BI_API = "https://www.bilibili.com/audio/music-service-c/web/url?sid=%s";

    // 歌词 API
//    private static final String LYRIC_API = prefix + "/lyric/new?id=%s";
    private static final String LYRIC_API = prefix + "/lyric?id=%s";
    // 歌词 API (酷狗)
//    private static final String LYRIC_KG_API = "http://lyrics.kugou.com/download?ver=1&client=pc&id=%s&accesskey=%s&fmt=lrc&charset=utf8";
    // 歌词 API (QQ)
//    private static final String LYRIC_QQ_API = prefixQQ33 + "/lyric?songmid=%s";
    private static final String LYRIC_QQ_API = "https://c.y.qq.com/lyric/fcgi-bin/fcg_query_lyric_new.fcg?songmid=%s&g_tk=5381&loginUin=0&hostUin=0&format=json&inCharset=utf8&outCharset=utf-8¬ice=0&platform=yqq&needNewCode=0";
    // 歌词 API (酷我)
//    private static final String LYRIC_KW_API = prefixKw + "/kuwo/lrc?musicId=%s";
    private static final String LYRIC_KW_API = "http://m.kuwo.cn/newh5/singles/songinfoandlrc?musicId=%s&httpsStatus=1";
    // 弹幕 API (猫耳)
    private static final String DM_ME_API = "https://www.missevan.com/sound/getdm?soundid=%s";
    // 歌词 API (哔哩哔哩)
    private static final String LYRIC_BI_API = "http://www.bilibili.com/audio/music-service-c/web/song/lyric?sid=%s";

    // 歌单信息 API
    private static final String PLAYLIST_DETAIL_API = prefix + "/playlist/detail?id=%s";
    // 歌单歌曲 API
    private static final String PLAYLIST_SONGS_API = prefix + "/playlist/track/all?id=%s&offset=%s&limit=%s";
    // 歌单信息 API (酷狗)
    private static final String PLAYLIST_DETAIL_KG_API = "https://mobiles.kugou.com/api/v5/special/info_v2?appid=1058&specialid=0&global_specialid=%s&format=jsonp&srcappid=2919&clientver=20000&clienttime=1586163242519&mid=1586163242519&uuid=1586163242519&dfid=-&signature=%s";
    private static final String PLAYLIST_SONGS_KG_API = "https://mobiles.kugou.com/api/v5/special/song_v2?appid=1058&global_specialid=%s&specialid=0&plat=0&version=8000&page=%s&pagesize=%s&srcappid=2919&clientver=20000&clienttime=1586163263991&mid=1586163263991&uuid=1586163263991&dfid=-&signature=%s";
    //    private static final String PLAYLIST_DETAIL_KG_API = "https://m.kugou.com/plist/list/%s?json=true&page=%s";
    // 歌单信息 API (QQ)
    private static final String PLAYLIST_DETAIL_QQ_API = prefixQQ33 + "/songlist?id=%s";
    // 歌单信息 API (酷我)
//    private static final String PLAYLIST_DETAIL_KW_API = prefixKw + "/kuwo/musicList?pid=%s";
    private static final String PLAYLIST_DETAIL_KW_API = "http://www.kuwo.cn/api/www/playlist/playListInfo?pid=%s&pn=%s&rn=%s&httpsStatus=1";
    // 歌单信息 API (咪咕)
//    private static final String PLAYLIST_DETAIL_MG_API = prefixMg + "/playlist?id=%s";
    private static final String PLAYLIST_DETAIL_MG_API = "https://app.c.nf.migu.cn/MIGUM2.0/v1.0/content/resourceinfo.do?needSimple=00&resourceType=2021&resourceId=%s";
    // 歌单歌曲 API (咪咕)
    private static final String PLAYLIST_SONGS_MG_API = "https://app.c.nf.migu.cn/MIGUM2.0/v1.0/user/queryMusicListSongs.do?musicListId=%s&pageNo=%s&pageSize=%s";
    // 歌单信息 API (千千)
    private static final String PLAYLIST_DETAIL_QI_API = "https://music.91q.com/v1/tracklist/info?appid=16073360&id=%s&pageNo=%s&pageSize=%s&timestamp=%s";
    // 歌单信息 API (猫耳)
    private static final String PLAYLIST_DETAIL_ME_API = "https://www.missevan.com/sound/soundAllList?albumid=%s";
    // 歌单信息 API (哔哩哔哩)
    private static final String PLAYLIST_DETAIL_BI_API = "https://www.bilibili.com/audio/music-service-c/web/menu/info?sid=%s";
    // 歌单歌曲 API (哔哩哔哩)
    private static final String PLAYLIST_SONGS_BI_API = "https://www.bilibili.com/audio/music-service-c/web/song/of-menu?sid=%s&pn=%s&ps=%s";

    // 专辑信息 API
    private static final String ALBUM_DETAIL_API = prefix + "/album?id=%s";
    // 专辑信息 API (酷狗)
    private static final String ALBUM_DETAIL_KG_API = "http://mobilecdn.kugou.com/api/v3/album/info?version=9108&albumid=%s";
    // 专辑歌曲 API (酷狗)
    private static final String ALBUM_SONGS_KG_API = "http://mobilecdn.kugou.com/api/v3/album/song?version=9108&albumid=%s&page=%s&pagesize=%s";
    // 专辑信息 API (QQ)
    private static final String ALBUM_DETAIL_QQ_API = prefixQQ33 + "/album?albummid=%s";
    // 专辑歌曲 API (QQ)
    private static final String ALBUM_SONGS_QQ_API = prefixQQ33 + "/album/songs?albummid=%s";
    // 专辑信息 API (酷我)
//    private static final String ALBUM_DETAIL_KW_API = prefixKw + "/kuwo/albumInfo?albumId=%s&pn=%s&rn=%s";
    private static final String ALBUM_DETAIL_KW_API = "http://www.kuwo.cn/api/www/album/albumInfo?albumId=%s&pn=%s&rn=%s&httpsStatus=1";
    // 专辑信息 API (咪咕)
    private static final String ALBUM_DETAIL_MG_API = prefixMg + "/album?id=%s";
    // 专辑信息 API (千千)
    private static final String ALBUM_DETAIL_QI_API = "https://music.91q.com/v1/album/info?albumAssetCode=%s&appid=16073360&timestamp=%s";
    // 专辑信息 API (豆瓣)
    private static final String ALBUM_DETAIL_DB_API = "https://music.douban.com/subject/%s/";
    // 专辑信息 API (堆糖)
    private static final String ALBUM_DETAIL_DT_API = "https://www.duitang.com/napi/album/detail/?album_id=%s";

    // 歌手信息 API
    private static final String ARTIST_DETAIL_API = prefix + "/artists?id=%s";
    // 歌手信息 API (酷狗)
    private static final String ARTIST_DETAIL_KG_API = "http://mobilecdnbj.kugou.com/api/v3/singer/info?singerid=%s";
    // 歌手信息 API (QQ)
    private static final String ARTIST_DETAIL_QQ_API = prefixQQ33 + "/singer/desc?singermid=%s";
    // 歌手图片 API (QQ)
    private static final String ARTIST_IMG_QQ_API = "https://y.gtimg.cn/music/photo_new/T001R500x500M000%s.jpg";
    // 歌手信息 API (酷我)
    private static final String ARTIST_DETAIL_KW_API = "https://kuwo.cn/api/www/artist/artist?artistid=%s&httpsStatus=1";
    // 歌手信息 API (咪咕)
    private static final String ARTIST_DETAIL_MG_API = prefixMg + "/singer/desc?id=%s";
    // 歌手信息 API (千千)
    private static final String ARTIST_DETAIL_QI_API = "https://music.91q.com/v1/artist/info?appid=16073360&artistCode=%s&timestamp=%s";
    // 歌手信息 API (豆瓣)
    private static final String ARTIST_DETAIL_DB_API = "https://movie.douban.com/celebrity/%s/";
    // 歌手歌曲 API
    private static final String ARTIST_SONGS_API = prefix + "/artist/songs?id=%s&offset=%s&limit=%s";
    // 歌手专辑 API
    private static final String ARTIST_ALBUMS_API = prefix + "/artist/album?id=%s&offset=%s&limit=%s";
    // 歌手 MV API
    private static final String ARTIST_MVS_API = prefix + "/artist/mv?id=%s&offset=%s&limit=%s";
    // 歌手视频 API
//    private static final String ARTIST_VIDEOS_API = prefix + "/artist/video?id=%s&cursor=%s&size=%s";
    // 歌手歌曲 API (酷狗)
    private static final String ARTIST_SONGS_KG_API = "http://mobilecdnbj.kugou.com/api/v3/singer/song?&singerid=%s&page=%s&pagesize=%s";
    // 歌手专辑 API (酷狗)
    private static final String ARTIST_ALBUMS_KG_API = "http://mobilecdnbj.kugou.com/api/v3/singer/album?&singerid=%s&page=%s&pagesize=%s";
    // 歌手 MV API (酷狗)
    private static final String ARTIST_MVS_KG_API = "http://mobilecdnbj.kugou.com/api/v3/singer/mv?&singerid=%s&page=%s&pagesize=%s";
    // 歌手歌曲 API (QQ)
    private static final String ARTIST_SONGS_QQ_API = prefixQQ33 + "/singer/songs?singermid=%s&page=%s&num=%s";
    // 歌手专辑 API (QQ)
    private static final String ARTIST_ALBUMS_QQ_API = prefixQQ33 + "/singer/album?singermid=%s&pageNo=%s&pageSize=%s";
    // 歌手 MV API (QQ)
    private static final String ARTIST_MVS_QQ_API = prefixQQ33 + "/singer/mv?singermid=%s&pageNo=%s&pageSize=%s";
    // 歌手歌曲 API (酷我)
//    private static final String ARTIST_SONGS_KW_API = prefixKw + "/kuwo/singer/music?artistid=%s&pn=%s&rn=%s";
    private static final String ARTIST_SONGS_KW_API = "http://www.kuwo.cn/api/www/artist/artistMusic?artistid=%s&pn=%s&rn=%s&httpsStatus=1";
    // 歌手专辑 API (酷我)
//    private static final String ARTIST_ALBUMS_KW_API = prefixKw + "/kuwo/singer/album?artistid=%s&pn=%s&rn=%s";
    private static final String ARTIST_ALBUMS_KW_API = "http://www.kuwo.cn/api/www/artist/artistAlbum?artistid=%s&pn=%s&rn=%s&httpsStatus=1";
    // 歌手 MV API (酷我)
//    private static final String ARTIST_MVS_KW_API = prefixKw + "/kuwo/singer/mv?artistid=%s&pn=%s&rn=%s";
    private static final String ARTIST_MVS_KW_API = "http://www.kuwo.cn/api/www/artist/artistMv?artistid=%s&pn=%s&rn=%s&httpsStatus=1";
    // 歌手歌曲 API (咪咕)
    private static final String ARTIST_SONGS_MG_API = prefixMg + "/singer/songs?id=%s&pageNo=%s";
    // 歌手专辑 API (咪咕)
    private static final String ARTIST_ALBUMS_MG_API = prefixMg + "/singer/albums?id=%s&pageNo=%s";
    // 歌手歌曲 API (千千)
    private static final String ARTIST_SONGS_QI_API = "https://music.91q.com/v1/artist/song?appid=16073360&artistCode=%s&pageNo=%s&pageSize=%s&timestamp=%s";
    // 歌手专辑 API (千千)
    private static final String ARTIST_ALBUMS_QI_API = "https://music.91q.com/v1/artist/album?appid=16073360&artistCode=%s&pageNo=%s&pageSize=%s&timestamp=%s";

    // 电台信息 API
    private static final String RADIO_DETAIL_API = prefix + "/dj/detail?rid=%s";
    // 电台节目信息 API
    private static final String RADIO_PROGRAM_DETAIL_API = prefix + "/dj/program?rid=%s&offset=%s&limit=%s";
    // 电台信息 API (QQ)
    private static final String RADIO_DETAIL_QQ_API = prefixQQ33 + "/radio?id=%s";
    // 电台信息 API (喜马拉雅)
    private static final String RADIO_DETAIL_XM_API = "https://www.ximalaya.com/revision/album/v1/simple?albumId=%s";
    // 简短电台信息 API (喜马拉雅)
    private static final String BRIEF_RADIO_DETAIL_XM_API = "https://www.ximalaya.com/tdk-web/seo/search/albumInfo?albumId=%s";
    // 电台节目 API (喜马拉雅)
    private static final String RADIO_PROGRAM_XM_API = "http://www.ximalaya.com/revision/album/v1/getTracksList?albumId=%s&sort=%s&&pageNum=%s&pageSize=%s";
    // 电台信息 API (猫耳)
    private static final String RADIO_DETAIL_ME_API = "https://www.missevan.com/dramaapi/getdrama?drama_id=%s";
    // 电台节目 API (猫耳)
//    private static final String RADIO_PROGRAM_ME_API = "https://www.missevan.com/dramaapi/getdramaepisodedetails?drama_id=%s&p=%s&page_size=%s";
    // 电台信息 API (豆瓣)
    private static final String RADIO_DETAIL_DB_API = "https://movie.douban.com/subject/%s/";
    // 图书电台信息 API (豆瓣)
    private static final String BOOK_RADIO_DETAIL_DB_API = "https://book.douban.com/subject/%s/";
    // 游戏电台信息 API (豆瓣)
    private static final String GAME_RADIO_DETAIL_DB_API = "https://www.douban.com/game/%s/";

    // MV 信息 API
    private static final String MV_DETAIL_API = prefix + "/mv/detail?mvid=%s";
    // MV 信息 API (酷狗)
    private static final String MV_DETAIL_KG_API = "http://mobilecdnbj.kugou.com/api/v3/mv/detail?area_code=1&plat=0&mvhash=%s";
    // MV 信息 API (QQ)
    private static final String MV_DETAIL_QQ_API = prefixQQ33 + "/mv?id=%s";
    // MV 信息 API (酷我)
    private static final String MV_DETAIL_KW_API = "http://www.kuwo.cn/api/www/music/musicInfo?mid=%s&httpsStatus=1";

    // MV 视频链接 API
    private static final String MV_URL_API = prefix + "/mv/url?id=%s";
    // 视频链接 API
    private static final String VIDEO_URL_API = prefix + "/video/url?id=%s";
    // Mlog 链接 API
//    private static final String MLOG_URL_API = prefix + "/mlog/url?id=%s";
    // MV 视频链接获取 API (酷狗)
//    private static final String MV_URL_KG_API = "https://gateway.kugou.com/v2/interface/index?appid=1014&clienttime=%s&clientver=20000&cmd=123&dfid=-" +
//            "&ext=mp4&hash=%s&ismp3=0&key=kugoumvcloud&mid=%s&pid=6&srcappid=2919&ssl=1&uuid=%s";
    private static final String MV_URL_KG_API = "http://m.kugou.com/app/i/mv.php?cmd=100&hash=%s&ismp3=1&ext=mp4";
    // MV 视频链接获取 API (QQ)
    private static final String MV_URL_QQ_API = prefixQQ33 + "/mv/url?id=%s";
    // MV 视频链接获取 API (酷我)
//    private static final String MV_URL_KW_API = prefixKw + "/kuwo/url?mid=%s&type=mv";
    private static final String MV_URL_KW_API = "http://www.kuwo.cn/api/v1/www/music/playUrl?mid=%s&type=mv&httpsStatus=1";
    // MV 视频链接获取 API (千千)
    private static final String MV_URL_QI_API = "https://music.91q.com/v1/video/info?appid=16073360&assetCode=%s&timestamp=%s";
    // MV 视频链接获取 API (好看)
    private static final String MV_URL_HK_API = "https://haokan.baidu.com/v?vid=%s&_format=json";
    // 视频 bvid 获取 cid (哔哩哔哩)
    private static final String VIDEO_CID_BI_API = "http://api.bilibili.com/x/player/pagelist?bvid=%s";
    // MV 视频链接获取 API (哔哩哔哩)
    private static final String VIDEO_URL_BI_API = "http://api.bilibili.com/x/player/playurl?bvid=%s&cid=%s&qn=64";

    // 榜单信息 API (酷狗)
    private static final String RANKING_DETAIL_KG_API = "http://mobilecdnbj.kugou.com/api/v3/rank/song?volid=35050&rankid=%s&page=%s&pagesize=%s";
    // 榜单信息 API (QQ)
    private static final String RANKING_DETAIL_QQ_API = prefixQQ33 + "/top?id=%s&pageSize=%s";
    // 榜单信息 API (酷我)
//    private static final String RANKING_DETAIL_KW_API = prefixKw + "/kuwo/rank/musicList?bangId=%s&pn=%s&rn=%s";
    private static final String RANKING_DETAIL_KW_API = "http://www.kuwo.cn/api/www/bang/bang/musicList?bangId=%s&pn=%s&rn=%s&httpsStatus=1";
    // 榜单信息 API (咪咕)
    private static final String RANKING_DETAIL_MG_API = "https://app.c.nf.migu.cn/MIGUM2.0/v1.0/content/querycontentbyId.do?columnId=%s";
    // 榜单信息 API (千千)
    private static final String RANKING_DETAIL_QI_API = "https://music.91q.com/v1/bd/list?appid=16073360&bdid=%s&pageNo=%s&pageSize=%s&timestamp=%s";
    // 榜单信息 API (猫耳)
    private static final String RANKING_DETAIL_ME_API = "https://www.missevan.com/sound/soundalllist?albumid=%s";

    // 用户信息 API
    private static final String USER_DETAIL_API = prefix + "/user/detail?uid=%s";
    // 用户歌曲 API
    private static final String USER_SONGS_API = prefix + "/user/record?type=%s&uid=%s";
    // 用户信息 API (喜马拉雅)
    private static final String USER_DETAIL_XM_API = "https://www.ximalaya.com/revision/user/basic?uid=%s";
    // 用户节目 API (喜马拉雅)
    private static final String USER_PROGRAMS_XM_API = "https://www.ximalaya.com/revision/user/track?uid=%s&orderType=%s&page=%s&pageSize=%s&keyWord=";
    // 用户信息 API (音乐磁场)
    private static final String USER_DETAIL_HF_API = "https://www.hifini.com/user-%s.htm";
    // 用户节目 API (音乐磁场)
    private static final String USER_PROGRAMS_HF_API = "https://www.hifini.com/user-thread-%s-%s.htm";
    // 用户信息 API (咕咕咕音乐)
    private static final String USER_DETAIL_GG_API = "http://www.gggmusic.com/user-%s.htm";
    // 用户节目 API (咕咕咕音乐)
    private static final String USER_PROGRAMS_GG_API = "http://www.gggmusic.com/user-thread-%s-%s.htm";
    // 用户信息 API (猫耳)
    private static final String USER_DETAIL_ME_API = "https://www.missevan.com/%s/";
    // CV 信息 API (猫耳)
    private static final String CV_DETAIL_ME_API = "https://www.missevan.com/dramaapi/cvinfo?cv_id=%s&page=%s&page_size=%s";
    // 社团信息 API (猫耳)
    private static final String ORGANIZATION_DETAIL_ME_API = "https://www.missevan.com/organization/profile?organization_id=%s";
    // 社团电台 API (猫耳)
    private static final String ORGANIZATION_RADIOS_ME_API = "https://www.missevan.com/organization/drama?organization_id=%s&page=%s";
    // 用户节目 API (猫耳)
    private static final String USER_PROGRAMS_ME_API = "https://www.missevan.com/person/getusersound?order=%s&user_id=%s&p=%s&page_size=%s";
    // 声优节目 API (猫耳)
    private static final String CV_PROGRAMS_ME_API = "https://www.missevan.com/seiy/%s";
    // 用户信息 API (好看)
    private static final String USER_DETAIL_HK_API = "https://haokan.baidu.com/author/%s";
    // 用户信息 API (豆瓣)
    private static final String USER_DETAIL_DB_API = "https://www.douban.com/people/%s/";
    // 用户信息 API (堆糖)
    private static final String USER_DETAIL_DT_API = "https://www.duitang.com/people/?id=%s";
    // 用户信息 API (哔哩哔哩)
    private static final String USER_DETAIL_BI_API = "http://api.bilibili.com/x/web-interface/card?mid=%s&photo=true";
    // 用户音频 API (猫耳)
    private static final String USER_AUDIO_BI_API = "https://api.bilibili.com/audio/music-service/web/song/upper?order=%s&uid=%s&pn=%s&ps=%s";

    // 相似歌曲 API
    private static final String SIMILAR_SONG_API = prefix + "/simi/song?id=%s";
    // 相似歌曲 API (QQ)
    private static final String SIMILAR_SONG_QQ_API = prefixQQ33 + "/song/similar?id=%s";
    // 相似歌曲 API (猫耳)
    private static final String SIMILAR_SONG_ME_API = "https://www.missevan.com/sound/getsoundlike?sound_id=%s&type=15";
    // 用户歌单 API
    private static final String USER_PLAYLIST_API = prefix + "/user/playlist?uid=%s&limit=1000";
    // 用户创建歌单 API (QQ)
    private static final String USER_CREATED_PLAYLIST_QQ_API = prefixQQ33 + "/user/songlist?id=%s";
    // 用户收藏歌单 API (QQ)
    private static final String USER_COLLECTED_PLAYLIST_QQ_API = prefixQQ33 + "/user/collect/songlist?id=%s&pageNo=%s&pageSize=%s";
    // 用户收藏专辑 API (QQ)
    private static final String USER_COLLECTED_ALBUM_QQ_API = prefixQQ33 + "/user/collect/album?id=%s&pageNo=%s&pageSize=%s";
    // 用户专辑 API (堆糖)
    private static final String USER_ALBUM_DT_API = "https://www.duitang.com/napi/album/list/by_user/?user_id=%s&start=%s&limit=%s";
    // 用户电台 API
    private static final String USER_RADIO_API = prefix + "/user/audio?uid=%s";
    // 用户电台 API (喜马拉雅)
    private static final String USER_RADIO_XM_API = "https://www.ximalaya.com/revision/user/pub?uid=%s&page=%s&pageSize=%s&keyWord=";
    // 用户收藏电台 API (喜马拉雅)
    private static final String USER_SUB_RADIO_XM_API = "https://www.ximalaya.com/revision/user/sub?uid=%s&page=%s&pageSize=%s&keyWord=";
    // 用户电台 API (猫耳)
    private static final String USER_RADIO_ME_API = "https://www.missevan.com/dramaapi/getuserdramas?user_id=%s&s=&order=0&page=%s&page_size=%s";
    // 用户收藏电台 API (猫耳)
    private static final String USER_SUB_RADIO_ME_API = "https://www.missevan.com/dramaapi/getusersubscriptions?user_id=%s&page=%s&page_size=%s";
    // 用户专辑 API (豆瓣)
    private static final String USER_ALBUM_DB_API = "https://music.douban.com/people/%s/collect?start=%s&sort=time&rating=all&filter=all&mode=grid";
    // 用户电台 API (豆瓣)
    private static final String USER_RADIO_DB_API = "https://movie.douban.com/people/%s/collect?start=%s&sort=time&rating=all&filter=all&mode=grid";
    // 用户图书电台 API (豆瓣)
    private static final String USER_BOOK_RADIO_DB_API = "https://book.douban.com/people/%s/collect?start=%s&sort=time&rating=all&filter=all&mode=grid";

    // 用户视频 API (好看)
    private static final String USER_VIDEO_HK_API = "https://haokan.baidu.com/web/author/listall?app_id=%s&rn=20&ctime=%s";
    // 用户小视频 API (好看)
    private static final String USER_SMALL_VIDEO_HK_API = "https://haokan.baidu.com/web/author/listall?app_id=%s&rn=20&video_type=haokan|tabhubVideo";
    // 用户视频 API (哔哩哔哩)
    private static final String USER_VIDEO_BI_API = "http://api.bilibili.com/x/space/arc/search?order=%s&mid=%s&pn=%s&ps=%s";

    // 歌曲相关歌单 API
    private static final String RELATED_PLAYLIST_API = prefix + "/simi/playlist?id=%s";
    // 相关歌单 API (QQ)
    private static final String RELATED_PLAYLIST_QQ_API = prefixQQ33 + "/song/playlist?id=%s";
    // 歌单相似歌单 API
    private static final String SIMILAR_PLAYLIST_API = prefix + "/related/playlist?id=%s";
    // 相似 MV API
    private static final String SIMILAR_MV_API = prefix + "/simi/mv?mvid=%s";
    // 视频相关视频 API
    private static final String RELATED_VIDEO_API = prefix + "/related/allvideo?id=%s";
    // 歌曲相关视频 API
    private static final String RELATED_MLOG_API = prefix + "/mlog/music/rcmd?songid=%s&limit=500";
    // mlog id 转视频 id API
    private static final String MLOG_TO_VIDEO_API = prefix + "/mlog/to/video?id=%s";
    // 相关 MV API (QQ)
    private static final String RELATED_MV_QQ_API = prefixQQ33 + "/song/mv?id=%s";
    // 相似 MV API (QQ)
    private static final String SIMILAR_MV_QQ_API = prefixQQ33 + "/mv?id=%s";
    // 相似歌手 API
    private static final String SIMILAR_ARTIST_API = prefix + "/simi/artist?id=%s";
    // 相似歌手 API (酷狗)(POST)
    private static final String SIMILAR_ARTIST_KG_API = "http://kmr.service.kugou.com/v1/author/similar";
    // 相似歌手 API (QQ)
    private static final String SIMILAR_ARTIST_QQ_API = prefixQQ33 + "/singer/sim?singermid=%s";
    // 社团声优 API (猫耳)
    private static final String ORGANIZATION_CVS_ME_API = "https://www.missevan.com/organization/cast?organization_id=%s&page=%s";
    // 歌手合作人 API (豆瓣)
    private static final String ARTIST_BUDDY_DB_API = "https://movie.douban.com/celebrity/%s/partners?start=%s";
    // 歌手电台 API (豆瓣)
    private static final String ARTIST_RADIO_DB_API = "https://movie.douban.com/celebrity/%s/movies?start=%s&format=pic&sortby=time";
    // 相似视频 API (好看)
    private static final String SIMILAR_VIDEO_HK_API = "https://haokan.baidu.com/videoui/api/videorec?title=%s&vid=%s&act=pcRec&pd=pc";
    // 相似视频 API (哔哩哔哩)
    private static final String SIMILAR_VIDEO_BI_API = "http://api.bilibili.com/x/web-interface/archive/related?bvid=%s";
    // 视频分集 API (哔哩哔哩)
    private static final String VIDEO_EPISODES_BI_API = "http://api.bilibili.com/x/player/pagelist?bvid=%s";

    // 用户关注 API
    private static final String USER_FOLLOWS_API = prefix + "/user/follows?uid=%s&limit=1000";
    // 用户关注 API (喜马拉雅)
    private static final String USER_FOLLOWS_XM_API = "https://www.ximalaya.com/revision/user/following?uid=%s&page=%s&pageSize=%s&keyWord=";
    // 用户关注 API (猫耳)
    private static final String USER_FOLLOWS_ME_API = "https://www.missevan.com/person/getuserattention?type=0&user_id=%s&p=%s&page_size=%s";
    // 用户关注 API (堆糖)
    private static final String USER_FOLLOWS_DT_API = "https://www.duitang.com/napi/friendship/follows/?user_id=%s&start=%s&limit=%s";
    // 用户关注 API (哔哩哔哩)
    private static final String USER_FOLLOWS_BI_API = "https://api.bilibili.com/x/relation/followings?vmid=%s&pn=%s&ps=%s";
    // 用户粉丝 API
    private static final String USER_FOLLOWEDS_API = prefix + "/user/followeds?uid=%s&offset=%s&limit=%s";
    // 用户粉丝 API (喜马拉雅)
    private static final String USER_FOLLOWEDS_XM_API = "https://www.ximalaya.com/revision/user/fans?uid=%s&page=%s&pageSize=%s&keyWord=";
    // 用户粉丝 API (猫耳)
    private static final String USER_FOLLOWEDS_ME_API = "https://www.missevan.com/person/getuserattention?type=1&user_id=%s&p=%s&page_size=%s";
    // 用户粉丝 API (堆糖)
    private static final String USER_FOLLOWEDS_DT_API = "https://www.duitang.com/napi/friendship/fans/?user_id=%s&start=%s&limit=%s";
    // 用户粉丝 API (哔哩哔哩)
    private static final String USER_FOLLOWEDS_BI_API = "https://api.bilibili.com/x/relation/followers?vmid=%s&pn=%s&ps=%s";

    // 歌单收藏者 API
    private static final String PLAYLIST_SUBSCRIBERS_API = prefix + "/playlist/subscribers?id=%s&offset=%s&limit=%s";
    // 歌手粉丝 API
    private static final String ARTIST_FANS_API = prefix + "/artist/fans?id=%s&offset=%s&limit=%s";
    // 歌手粉丝总数 API
    private static final String ARTIST_FANS_TOTAL_API = prefix + "/artist/follow/count?id=%s";
    // 社团职员 API (猫耳)
    private static final String ORGANIZATION_STAFFS_ME_API = "https://www.missevan.com/organization/staff?organization_id=%s&page=%s";
    // 歌手粉丝 API (豆瓣)
    private static final String ARTIST_FANS_DB_API = "https://movie.douban.com/celebrity/%s/fans?start=%s";
    // 电台订阅者 API
    private static final String RADIO_SUBSCRIBERS_API = prefix + "/dj/subscriber?id=%s";
    // 电台 CV API (猫耳)
    private static final String RADIO_CVS_ME_API = "https://www.missevan.com/dramaapi/getdrama?drama_id=%s";
    // 电台演职员 API (豆瓣)
    private static final String RADIO_ARTISTS_DB_API = "https://movie.douban.com/subject/%s/celebrities";
    // 歌曲推荐电台 API (猫耳)
    private static final String SONG_REC_RADIO_ME_API = "https://www.missevan.com/sound/getsoundlike?sound_id=%s&type=15";
    // 相似电台 API (猫耳)
    private static final String SIMILAR_RADIO_ME_API = "https://www.missevan.com/dramaapi/getdrama?drama_id=%s";
    // 相似电台 API (豆瓣)
    private static final String SIMILAR_RADIO_DB_API = "https://movie.douban.com/subject/%s/";
    // 相似图书电台 API (豆瓣)
    private static final String SIMILAR_BOOK_RADIO_DB_API = "https://book.douban.com/subject/%s/";
    // 相似游戏电台 API (豆瓣)
    private static final String SIMILAR_GAME_RADIO_DB_API = "https://www.douban.com/game/%s/";
    // 相似专辑 API (豆瓣)
    private static final String SIMILAR_ALBUM_DB_API = "https://music.douban.com/subject/%s/";

    // 格言 API
    private static final String MOTTO_API = "https://v1.hitokoto.cn/?encode=json&lang=cn&c=d&c=i";

    /**
     * 获取格言
     *
     * @return
     */
    public static String getMotto() {
        String mottoBody = HttpRequest.get(String.format(MOTTO_API))
                .execute()
                .body();
        JSONObject mottoJson = JSONObject.fromObject(mottoBody);
        String content = mottoJson.getString("hitokoto");
        String from = mottoJson.getString("from");
        String fromWho = mottoJson.getString("from_who");
        return "「" + content + "」    —— " + ("null".equals(fromWho) ? "" : fromWho)
                + ("null".equals(from) || from.equals(fromWho) ? "" : String.format("《%s》", from.replaceAll("《|》", "")));
    }

    /**
     * 获取热搜
     *
     * @return
     */
    public static Set<String> getHotSearch() {
        Set<String> results = new LinkedHashSet<>();

        // 网易云
        Callable<List<String>> getHotSearch = () -> {
            LinkedList<String> res = new LinkedList<>();

            String hotSearchBody = HttpRequest.get(String.format(HOT_SEARCH_API))
                    .execute()
                    .body();
            JSONObject hotSearchJson = JSONObject.fromObject(hotSearchBody);
            JSONObject result = hotSearchJson.getJSONObject("result");
            JSONArray hotSearchArray = result.getJSONArray("hots");
            for (int i = 0, len = hotSearchArray.size(); i < len; i++) {
                JSONObject keywordJson = hotSearchArray.getJSONObject(i);
                res.add(keywordJson.getString("first").trim());
            }
            return res;
        };

        // 酷狗
        Callable<List<String>> getHotSearchKg = () -> {
            LinkedList<String> res = new LinkedList<>();

            String hotSearchBody = HttpRequest.get(String.format(HOT_SEARCH_KG_API))
                    .header("dfid", "1ssiv93oVqMp27cirf2CvoF1")
                    .header("mid", "156798703528610303473757548878786007104")
                    .header("clienttime", "1584257267")
                    .header("x-router", "msearch.kugou.com")
                    .header("user-agent", "Android9-AndroidPhone-10020-130-0-searchrecommendprotocol-wifi")
                    .header("kg-rc", "1")
                    .execute()
                    .body();
            JSONArray hotkeys = JSONObject.fromObject(hotSearchBody).getJSONObject("data").getJSONArray("list").getJSONObject(0).getJSONArray("keywords");
            for (int i = 0, len = hotkeys.size(); i < len; i++) {
                JSONObject keywordJson = hotkeys.getJSONObject(i);
                res.add(keywordJson.getString("keyword"));
            }
            return res;
        };

        // QQ
        Callable<List<String>> getHotSearchQq = () -> {
            LinkedList<String> res = new LinkedList<>();

            String hotSearchBody = HttpRequest.post(String.format(HOT_SEARCH_QQ_API))
                    .body("{\"comm\":{\"ct\":\"19\",\"cv\":\"1803\",\"guid\":\"0\",\"patch\":\"118\",\"psrf_access_token_expiresAt\":0,\"psrf_qqaccess_token\":\"\",\"psrf_qqopenid\":\"\",\"psrf_qqunionid\":\"\",\"tmeAppID\":\"qqmusic\",\"tmeLoginType\":0,\"uin\":\"0\",\"wid\":\"0\"},\"hotkey\":{\"method\":\"GetHotkeyForQQMusicPC\",\"module\":\"tencent_musicsoso_hotkey.HotkeyService\",\"param\":{\"search_id\":\"\",\"uin\":0}}}")
                    .execute()
                    .body();
            JSONArray hotkeys = JSONObject.fromObject(hotSearchBody).getJSONObject("hotkey").getJSONObject("data").getJSONArray("vec_hotkey");
            for (int i = 0, len = hotkeys.size(); i < len; i++) {
                JSONObject keywordJson = hotkeys.getJSONObject(i);
                res.add(keywordJson.getString("title"));
            }
            return res;
        };

        // 酷我
        Callable<List<String>> getHotSearchKw = () -> {
            LinkedList<String> res = new LinkedList<>();

            HttpResponse resp = HttpRequest.get(String.format(HOT_SEARCH_KW_API)).execute();
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                JSONArray hotkeys = JSONObject.fromObject(resp.body()).getJSONArray("tagvalue");
                for (int i = 0, len = hotkeys.size(); i < len; i++) {
                    res.add(hotkeys.getJSONObject(i).getString("key"));
                }
            }
            return res;
        };

        // 咪咕
        Callable<List<String>> getHotSearchMg = () -> {
            LinkedList<String> res = new LinkedList<>();

            HttpResponse resp = HttpRequest.get(String.format(HOT_SEARCH_MG_API)).execute();
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                JSONArray hotkeys = JSONObject.fromObject(resp.body()).getJSONArray("data");
                for (int i = 0, len = hotkeys.size(); i < len; i++) {
                    res.add(hotkeys.getJSONObject(i).getString("word"));
                }
            }
            return res;
        };

        List<Future<List<String>>> taskList = new LinkedList<>();

        taskList.add(GlobalExecutors.requestExecutor.submit(getHotSearch));
        taskList.add(GlobalExecutors.requestExecutor.submit(getHotSearchKg));
        taskList.add(GlobalExecutors.requestExecutor.submit(getHotSearchQq));
        taskList.add(GlobalExecutors.requestExecutor.submit(getHotSearchKw));
        taskList.add(GlobalExecutors.requestExecutor.submit(getHotSearchMg));

        taskList.forEach(task -> {
            try {
                results.addAll(task.get());
            } catch (InterruptedException e) {
//                e.printStackTrace();
            } catch (ExecutionException e) {
//                e.printStackTrace();
            }
        });

        return results;
    }

    /**
     * 获取搜索建议
     *
     * @return
     */
    public static Set<String> getSearchSuggestion(String keyword) {
        Set<String> results = new LinkedHashSet<>();

        // 关键词为空时直接跳出
        if (StringUtil.isEmpty(keyword.trim())) return results;

        // 先对关键词编码，避免特殊符号的干扰
        String encodedKeyword = StringUtil.encode(keyword);

        // 网易云
        Callable<List<String>> getSimpleSearchSuggestion = () -> {
            LinkedList<String> res = new LinkedList<>();

            String searchSuggestionBody = HttpRequest.get(String.format(SIMPLE_SEARCH_SUGGESTION_API, encodedKeyword))
                    .execute()
                    .body();
            JSONObject searchSuggestionJson = JSONObject.fromObject(searchSuggestionBody);
            JSONObject result = searchSuggestionJson.optJSONObject("result");
            if (result != null && !result.isNullObject()) {
                JSONArray searchSuggestionArray = result.optJSONArray("allMatch");
                if (searchSuggestionArray != null) {
                    for (int i = 0, len = searchSuggestionArray.size(); i < len; i++) {
                        JSONObject keywordJson = searchSuggestionArray.getJSONObject(i);
                        res.add(keywordJson.getString("keyword"));
                    }
                }
            }
            return res;
        };
        Callable<List<String>> getSearchSuggestion = () -> {
            LinkedList<String> res = new LinkedList<>();

            String searchSuggestionBody = HttpRequest.get(String.format(SEARCH_SUGGESTION_API, encodedKeyword))
                    .execute()
                    .body();
            JSONObject searchSuggestionJson = JSONObject.fromObject(searchSuggestionBody);
            JSONObject result = searchSuggestionJson.optJSONObject("result");
            if (result != null) {
                JSONArray songArray = result.optJSONArray("songs");
                if (songArray != null) {
                    for (int i = 0, len = songArray.size(); i < len; i++) {
                        res.add(songArray.getJSONObject(i).getString("name"));
                    }
                }
                JSONArray artistArray = result.optJSONArray("artists");
                if (artistArray != null) {
                    for (int i = 0, len = artistArray.size(); i < len; i++) {
                        res.add(artistArray.getJSONObject(i).getString("name"));
                    }
                }
                JSONArray albumArray = result.optJSONArray("albums");
                if (albumArray != null) {
                    for (int i = 0, len = albumArray.size(); i < len; i++) {
                        res.add(albumArray.getJSONObject(i).getString("name"));
                    }
                }
            }
            return res;
        };

        // 酷狗
        Callable<List<String>> getSearchSuggestionKg = () -> {
            LinkedList<String> res = new LinkedList<>();

            String searchSuggestionBody = HttpRequest.get(String.format(SEARCH_SUGGESTION_KG_API, encodedKeyword))
                    .execute()
                    .body();
            JSONObject searchSuggestionJson = JSONObject.fromObject(searchSuggestionBody);
            JSONArray data = searchSuggestionJson.getJSONArray("data");
            for (int i = 0, len = data.size(); i < len; i++) {
                JSONObject keywordJson = data.getJSONObject(i);
                res.add(keywordJson.getString("keyword"));
            }
            return res;
        };

        // QQ
        Callable<List<String>> getSearchSuggestionQq = () -> {
            LinkedList<String> res = new LinkedList<>();

            String searchSuggestionBody = HttpRequest.get(String.format(SEARCH_SUGGESTION_QQ_API, encodedKeyword))
                    .header(Header.REFERER, "https://y.qq.com/portal/player.html")
                    .execute()
                    .body();
            JSONObject searchSuggestionJson = JSONObject.fromObject(searchSuggestionBody);
            JSONObject data = searchSuggestionJson.optJSONObject("data");
            if (data != null) {
                JSONArray songArray = data.getJSONObject("song").getJSONArray("itemlist");
                for (int i = 0, len = songArray.size(); i < len; i++) {
                    res.add(songArray.getJSONObject(i).getString("name"));
                }
                JSONArray artistArray = data.getJSONObject("singer").getJSONArray("itemlist");
                for (int i = 0, len = artistArray.size(); i < len; i++) {
                    res.add(artistArray.getJSONObject(i).getString("name"));
                }
                JSONArray albumArray = data.getJSONObject("album").getJSONArray("itemlist");
                for (int i = 0, len = albumArray.size(); i < len; i++) {
                    res.add(albumArray.getJSONObject(i).getString("name"));
                }
                JSONArray mvArray = data.getJSONObject("mv").getJSONArray("itemlist");
                for (int i = 0, len = mvArray.size(); i < len; i++) {
                    res.add(mvArray.getJSONObject(i).getString("name"));
                }
            }
            return res;
        };

        // 酷我
        Callable<List<String>> getSearchSuggestionKw = () -> {
            LinkedList<String> res = new LinkedList<>();

            HttpResponse resp = kwRequest(String.format(SEARCH_SUGGESTION_KW_API, encodedKeyword)).execute();
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                JSONObject searchSuggestionJson = JSONObject.fromObject(resp.body());
                JSONArray data = searchSuggestionJson.getJSONArray("data");
                Pattern p = Pattern.compile("RELWORD=(.*?)\\r\\n");
                for (int i = 0, len = data.size(); i < len; i++) {
                    Matcher matcher = p.matcher(data.getString(i));
                    matcher.find();
                    res.add(matcher.group(1));
                }
            }
            return res;
        };

        // 千千
        Callable<List<String>> getSearchSuggestionQi = () -> {
            LinkedList<String> res = new LinkedList<>();

            HttpResponse resp = HttpRequest.get(buildQianUrl(String.format(SEARCH_SUGGESTION_QI_API, System.currentTimeMillis(), encodedKeyword))).execute();
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                JSONObject searchSuggestionJson = JSONObject.fromObject(resp.body());
                JSONArray data = searchSuggestionJson.getJSONArray("data");
                for (int i = 0, len = data.size(); i < len; i++) {
                    res.add(data.getString(i));
                }
            }
            return res;
        };

        List<Future<List<String>>> taskList = new LinkedList<>();

        taskList.add(GlobalExecutors.requestExecutor.submit(getSimpleSearchSuggestion));
        taskList.add(GlobalExecutors.requestExecutor.submit(getSearchSuggestion));
        taskList.add(GlobalExecutors.requestExecutor.submit(getSearchSuggestionKg));
        taskList.add(GlobalExecutors.requestExecutor.submit(getSearchSuggestionQq));
        taskList.add(GlobalExecutors.requestExecutor.submit(getSearchSuggestionKw));
        taskList.add(GlobalExecutors.requestExecutor.submit(getSearchSuggestionQi));

        taskList.forEach(task -> {
            try {
                results.addAll(task.get());
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });

        return results;
    }

    /**
     * 根据关键词获取歌曲
     */
    public static CommonResult<NetMusicInfo> searchMusic(int src, int type, String subType, String keyword, int limit, int page) {
        AtomicReference<Integer> total = new AtomicReference<>(0);
        List<NetMusicInfo> musicInfos = new LinkedList<>();

        // 先对关键词编码，避免特殊符号的干扰
        String encodedKeyword = StringUtil.encode(keyword);

        boolean dt = "默认".equals(subType);
        String[] s = Tags.programSearchTag.get(subType);

        // 网易云
        // 搜歌曲
        Callable<CommonResult<NetMusicInfo>> searchMusic = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String musicInfoBody = HttpRequest.get(String.format(SEARCH_MUSIC_API, encodedKeyword, limit, (page - 1) * limit))
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            JSONObject result = musicInfoJson.optJSONObject("result");
            if (result != null) {
                t = result.getInt("songCount");
                JSONArray songsArray = result.optJSONArray("songs");
                if (songsArray != null) {
                    for (int i = 0, len = songsArray.size(); i < len; i++) {
                        JSONObject songJson = songsArray.getJSONObject(i);

                        String songId = songJson.getString("id");
                        String songName = songJson.getString("name").trim();
                        String artist = parseArtists(songJson, NetMusicSource.NET_CLOUD);
                        String artistId = songJson.getJSONArray("ar").getJSONObject(0).getString("id");
                        String albumName = songJson.getJSONObject("al").getString("name");
                        String albumId = songJson.getJSONObject("al").getString("id");
                        Double duration = songJson.getDouble("dt") / 1000;
                        String mvId = songJson.getString("mv");

                        NetMusicInfo musicInfo = new NetMusicInfo();
                        musicInfo.setId(songId);
                        musicInfo.setName(songName);
                        musicInfo.setArtist(artist);
                        musicInfo.setArtistId(artistId);
                        musicInfo.setAlbumName(albumName);
                        musicInfo.setAlbumId(albumId);
                        musicInfo.setDuration(duration);
                        musicInfo.setMvId(mvId);

                        res.add(musicInfo);
                    }
                }
            }
            return new CommonResult<>(res, t);
        };
        // 搜歌词
        Callable<CommonResult<NetMusicInfo>> searchMusicByLyric = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String musicInfoBody = HttpRequest.get(String.format(SEARCH_MUSIC_BY_LYRIC_API, encodedKeyword, limit, (page - 1) * limit))
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            JSONObject result = musicInfoJson.optJSONObject("result");
            if (result != null) {
                t = result.getInt("songCount");
                JSONArray songs = result.optJSONArray("songs");
                if (songs != null) {
                    for (int i = 0, len = songs.size(); i < len; i++) {
                        JSONObject songJson = songs.getJSONObject(i);

                        String songId = songJson.getString("id");
                        String songName = songJson.getString("name").trim();
                        String artist = parseArtists(songJson, NetMusicSource.NET_CLOUD);
                        String artistId = songJson.getJSONArray("artists").getJSONObject(0).getString("id");
                        String albumName = songJson.getJSONObject("album").getString("name");
                        String albumId = songJson.getJSONObject("album").getString("id");
                        Double duration = songJson.getDouble("duration") / 1000;
                        String mvId = songJson.getString("mvid");
                        String lrcMatch = songJson.getJSONObject("lyrics").getString("txt").replace("\n", " / ");
//                        JSONArray lyrics = songJson.optJSONArray("lyrics");
//                        String lrcMatch = null;
//                        if (lyrics != null) {
//                            StringBuffer sb = new StringBuffer();
//                            for (int j = 0, size = lyrics.size(); j < size; j++) {
//                                sb.append(lyrics.get(j));
//                                if (j != size - 1) sb.append(" / ");
//                            }
//                            lrcMatch = StringUtils.removeHTMLLabel(sb.toString());
//                        }

                        NetMusicInfo musicInfo = new NetMusicInfo();
                        musicInfo.setId(songId);
                        musicInfo.setName(songName);
                        musicInfo.setArtist(artist);
                        musicInfo.setArtistId(artistId);
                        musicInfo.setAlbumName(albumName);
                        musicInfo.setAlbumId(albumId);
                        musicInfo.setDuration(duration);
                        musicInfo.setMvId(mvId);
                        musicInfo.setLrcMatch(lrcMatch);

                        res.add(musicInfo);
                    }
                }
            }
            return new CommonResult<>(res, t);
        };
        // 搜声音
        Callable<CommonResult<NetMusicInfo>> searchVoice = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            final int lim = Math.min(20, limit);
            String musicInfoBody = HttpRequest.get(String.format(SEARCH_VOICE_API, encodedKeyword, lim, (page - 1) * lim))
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            JSONObject data = musicInfoJson.getJSONObject("data");
            t = data.getInt("totalCount");
            JSONArray songsArray = data.optJSONArray("resources");
            if (songsArray != null) {
                for (int i = 0, len = songsArray.size(); i < len; i++) {
                    JSONObject programJson = songsArray.getJSONObject(i).getJSONObject("baseInfo");
                    JSONObject mainSongJson = programJson.getJSONObject("mainSong");
                    JSONObject djJson = programJson.getJSONObject("dj");
                    JSONObject radioJson = programJson.getJSONObject("radio");

                    String programId = programJson.getString("id");
                    String songId = mainSongJson.getString("id");
                    String name = mainSongJson.getString("name");
                    String artist = djJson.getString("nickname");
                    String artistId = djJson.getString("userId");
                    String albumName = radioJson.getString("name");
                    String albumId = radioJson.getString("id");
                    Double duration = mainSongJson.getDouble("duration") / 1000;

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setProgramId(programId);
                    musicInfo.setId(songId);
                    musicInfo.setName(name);
                    musicInfo.setArtist(artist);
                    musicInfo.setArtistId(artistId);
                    musicInfo.setAlbumName(albumName);
                    musicInfo.setAlbumId(albumId);
                    musicInfo.setDuration(duration);

                    res.add(musicInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 酷狗
        // 搜单曲
        Callable<CommonResult<NetMusicInfo>> searchMusicKg = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String musicInfoBody = HttpRequest.get(String.format(SEARCH_MUSIC_KG_API, encodedKeyword, page, limit))
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            JSONObject data = musicInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray songsArray = data.getJSONArray("info");
            for (int i = 0, len = songsArray.size(); i < len; i++) {
                JSONObject songJson = songsArray.getJSONObject(i);

                String hash = songJson.getString("hash");
                String songId = songJson.getString("album_audio_id");
                String songName = songJson.getString("songname");
                String artist = songJson.getString("singername");
                String albumName = songJson.getString("album_name");
                String albumId = songJson.getString("album_id");
                Double duration = songJson.getDouble("duration");
                String mvId = songJson.getString("mvhash");
                String lrcMatch = songJson.optString("lyric");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.KG);
                musicInfo.setHash(hash);
                musicInfo.setId(songId);
                musicInfo.setName(songName);
                musicInfo.setArtist(artist);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);
                musicInfo.setMvId(mvId);
                musicInfo.setLrcMatch(lrcMatch);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 搜歌词
        Callable<CommonResult<NetMusicInfo>> searchMusicByLyricKg = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String musicInfoBody = HttpRequest.get(String.format(SEARCH_MUSIC_BY_LYRIC_KG_API, encodedKeyword, page, limit))
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            JSONObject data = musicInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray songsArray = data.getJSONArray("info");
            for (int i = 0, len = songsArray.size(); i < len; i++) {
                JSONObject songJson = songsArray.getJSONObject(i);

                String hash = songJson.getString("hash");
                String songId = songJson.getString("album_audio_id");
                String[] split = songJson.getString("filename").split(" - ");
                String songName = split[split.length == 1 ? 0 : 1];
                String artist = songJson.getString("singername");
//                String albumName = songJson.getString("remark");
                String albumId = songJson.getString("album_id");
                Double duration = songJson.getDouble("duration");
                String mvId = songJson.getString("mvhash");
                String lrcMatch = songJson.optString("lyric");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.KG);
                musicInfo.setHash(hash);
                musicInfo.setId(songId);
                musicInfo.setName(songName);
                musicInfo.setArtist(artist);
//                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);
                musicInfo.setMvId(mvId);
                musicInfo.setLrcMatch(lrcMatch);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };

        // QQ
        // 搜歌曲
        Callable<CommonResult<NetMusicInfo>> searchMusicQq = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String musicInfoBody = HttpRequest.post(String.format(qqSearchApi))
                    .body(String.format(qqSearchJson, page, limit, keyword, 0))
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            JSONObject data = musicInfoJson.getJSONObject("music.search.SearchCgiService").getJSONObject("data");
            t = data.getJSONObject("meta").getInt("sum");
            JSONArray songsArray = data.getJSONObject("body").getJSONObject("song").getJSONArray("list");
            for (int i = 0, len = songsArray.size(); i < len; i++) {
                JSONObject songJson = songsArray.getJSONObject(i);

                String songId = songJson.getString("mid");
                String songName = songJson.getString("name");
                String artist = parseArtists(songJson, NetMusicSource.QQ);
                String artistId = songJson.getJSONArray("singer").getJSONObject(0).getString("mid");
                String albumName = songJson.getJSONObject("album").getString("name");
                String albumId = songJson.getJSONObject("album").getString("mid");
                Double duration = songJson.getDouble("interval");
                String mvId = songJson.getJSONObject("mv").getString("vid");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.QQ);
                musicInfo.setId(songId);
                musicInfo.setName(songName);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);
                musicInfo.setMvId(mvId);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 搜歌词
        Callable<CommonResult<NetMusicInfo>> searchMusicByLyricQq = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String musicInfoBody = HttpRequest.post(String.format(qqSearchApi))
                    .body(String.format(qqSearchJson, page, limit, keyword, 7))
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            JSONObject data = musicInfoJson.getJSONObject("music.search.SearchCgiService").getJSONObject("data");
            t = data.getJSONObject("meta").getInt("sum");
            JSONArray songsArray = data.getJSONObject("body").getJSONObject("song").getJSONArray("list");
            for (int i = 0, len = songsArray.size(); i < len; i++) {
                JSONObject songJson = songsArray.getJSONObject(i);

                String songId = songJson.getString("mid");
                String songName = songJson.getString("name");
                String artist = parseArtists(songJson, NetMusicSource.QQ);
                String artistId = songJson.getJSONArray("singer").getJSONObject(0).getString("mid");
                String albumName = songJson.getJSONObject("album").getString("name");
                String albumId = songJson.getJSONObject("album").getString("mid");
                Double duration = songJson.getDouble("interval");
                String mvId = songJson.getJSONObject("mv").getString("id");
                String lrcMatch = StringUtil.removeHTMLLabel(songJson.optString("content")).replace("\\n", " / ");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.QQ);
                musicInfo.setId(songId);
                musicInfo.setName(songName);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);
                musicInfo.setMvId(mvId);
                musicInfo.setLrcMatch(lrcMatch);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 酷我
        Callable<CommonResult<NetMusicInfo>> searchMusicKw = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = kwRequest(String.format(SEARCH_MUSIC_KW_API, encodedKeyword, page, limit)).execute();
            // 有时候请求会崩，先判断是否请求成功
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                String musicInfoBody = resp.body();
                JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
                JSONObject data = musicInfoJson.optJSONObject("data");
                if (data != null) {
                    t = data.getInt("total");
                    JSONArray songsArray = data.optJSONArray("list");
                    if (songsArray != null) {
                        for (int i = 0, len = songsArray.size(); i < len; i++) {
                            JSONObject songJson = songsArray.getJSONObject(i);

                            String songId = songJson.getString("rid");
                            String songName = StringUtil.removeHTMLLabel(songJson.getString("name"));
                            String artist = StringUtil.removeHTMLLabel(songJson.getString("artist"));
                            String artistId = songJson.getString("artistid");
                            String albumName = StringUtil.removeHTMLLabel(songJson.getString("album"));
                            String albumId = songJson.getString("albumid");
                            Double duration = songJson.getDouble("duration");
                            String mvId = songJson.getInt("hasmv") == 0 ? "" : songId;

                            NetMusicInfo musicInfo = new NetMusicInfo();
                            musicInfo.setSource(NetMusicSource.KW);
                            musicInfo.setId(songId);
                            musicInfo.setName(songName);
                            musicInfo.setArtist(artist);
                            musicInfo.setArtistId(artistId);
                            musicInfo.setAlbumName(albumName);
                            musicInfo.setAlbumId(albumId);
                            musicInfo.setDuration(duration);
                            musicInfo.setMvId(mvId);

                            res.add(musicInfo);
                        }
                    }
                }
            }
            return new CommonResult<>(res, t);
        };

        // 咪咕
        Callable<CommonResult<NetMusicInfo>> searchMusicMg = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String musicInfoBody = HttpRequest.get(String.format(SEARCH_MUSIC_MG_API, encodedKeyword, page, limit))
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            JSONObject data = musicInfoJson.getJSONObject("data");
            t = data.optInt("total");
            JSONArray songsArray = data.getJSONArray("list");
            for (int i = 0, len = songsArray.size(); i < len; i++) {
                JSONObject songJson = songsArray.getJSONObject(i);

                String songId = songJson.getString("cid");
                String songName = songJson.getString("name");
                String artist = parseArtists(songJson, NetMusicSource.MG);
                String artistId = songJson.getJSONArray("artists").getJSONObject(0).getString("id");
                String albumName = songJson.getJSONObject("album").getString("name");
                String albumId = songJson.getJSONObject("album").getString("id");
                // 咪咕音乐没有 mv 时，该字段不存在！
                String mvId = songJson.optString("mvId");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.MG);
                musicInfo.setId(songId);
                musicInfo.setName(songName);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setMvId(mvId);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 千千
        Callable<CommonResult<NetMusicInfo>> searchMusicQi = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String musicInfoBody = HttpRequest.get(buildQianUrl(String.format(SEARCH_MUSIC_QI_API, page, limit, System.currentTimeMillis(), encodedKeyword)))
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            JSONObject data = musicInfoJson.optJSONObject("data");
            if (data != null) {
                t = data.optInt("total");
                JSONArray songsArray = data.getJSONArray("typeTrack");
                for (int i = 0, len = songsArray.size(); i < len; i++) {
                    JSONObject songJson = songsArray.getJSONObject(i);

                    String songId = songJson.getString("TSID");
                    String songName = songJson.getString("title");
                    String artist = parseArtists(songJson, NetMusicSource.QI);
                    JSONArray artistArray = songJson.optJSONArray("artist");
                    String artistId = artistArray != null && !artistArray.isEmpty() ? artistArray.getJSONObject(0).getString("artistCode") : "";
                    String albumName = songJson.getString("albumTitle");
                    String albumId = songJson.getString("albumAssetCode");
                    Double duration = songJson.getDouble("duration");

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setSource(NetMusicSource.QI);
                    musicInfo.setId(songId);
                    musicInfo.setName(songName);
                    musicInfo.setArtist(artist);
                    musicInfo.setArtistId(artistId);
                    musicInfo.setAlbumName(albumName);
                    musicInfo.setAlbumId(albumId);
                    musicInfo.setDuration(duration);

                    res.add(musicInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 音乐磁场
        Callable<CommonResult<NetMusicInfo>> searchMusicHf = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String musicInfoBody = HttpRequest.get(String.format(SEARCH_MUSIC_HF_API, encodedKeyword.replace("%", "_"), page))
                    .cookie(HF_COOKIE)
                    .execute()
                    .body();
            Document doc = Jsoup.parse(musicInfoBody);
            Elements songs = doc.select(".media.thread.tap");
            Elements ap = doc.select("a.page-link");
            String ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 1).text(), 1);
            if (StringUtil.isEmpty(ts))
                ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 2).text(), 1);
            boolean hasTs = StringUtil.isNotEmpty(ts);
            if (hasTs) t = Integer.parseInt(ts) * limit;
            else t = songs.size();
            for (int i = 0, len = songs.size(); i < len; i++) {
                Element song = songs.get(i);

                Elements a = song.select(".subject.break-all a");
                Element span = song.select(".username.text-grey.mr-1").first();

                String songId = ReUtil.get("thread-(.*?)\\.htm", a.attr("href"), 1);
                String songName = a.text();
                String artist = span.text();
                String artistId = span.attr("uid");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.HF);
                musicInfo.setId(songId);
                musicInfo.setName(songName);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 咕咕咕音乐
        Callable<CommonResult<NetMusicInfo>> searchMusicGg = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String musicInfoBody = HttpRequest.get(String.format(SEARCH_MUSIC_GG_API, encodedKeyword.replace("%", "_"), page))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(musicInfoBody);
            Elements songs = doc.select(".media.thread.tap");
            Elements ap = doc.select("a.page-link");
            String ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 1).text(), 1);
            if (StringUtil.isEmpty(ts))
                ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 2).text(), 1);
            boolean hasTs = StringUtil.isNotEmpty(ts);
            if (hasTs) t = Integer.parseInt(ts) * limit;
            else t = songs.size();
            for (int i = 0, len = songs.size(); i < len; i++) {
                Element song = songs.get(i);

                Elements a = song.select(".subject.break-all a");

                String songId = ReUtil.get("thread-(.*?)\\.htm", a.attr("href"), 1);
                String songName = a.text();

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.GG);
                musicInfo.setId(songId);
                musicInfo.setName(songName);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 喜马拉雅
        Callable<CommonResult<NetMusicInfo>> searchMusicXm = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String musicInfoBody = HttpRequest.get(String.format(SEARCH_MUSIC_XM_API, encodedKeyword, page, limit))
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            JSONObject data = musicInfoJson.getJSONObject("data").getJSONObject("track");
            t = data.optInt("total");
            JSONArray songsArray = data.getJSONArray("docs");
            for (int i = 0, len = songsArray.size(); i < len; i++) {
                JSONObject songJson = songsArray.getJSONObject(i);

                String songId = songJson.getString("id");
                String name = songJson.getString("title");
                String artist = songJson.getString("nickname");
                String artistId = songJson.getString("uid");
                String albumName = songJson.getString("albumTitle");
                String albumId = songJson.getString("albumId");
                Double duration = songJson.getDouble("duration");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.XM);
                musicInfo.setId(songId);
                musicInfo.setName(name);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 猫耳
        Callable<CommonResult<NetMusicInfo>> searchProgramMe = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[0])) {
                String musicInfoBody = HttpRequest.get(String.format(SEARCH_PROGRAM_ME_API, s[0].trim(), encodedKeyword, page, limit))
                        .execute()
                        .body();
                JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
                JSONObject data = musicInfoJson.getJSONObject("info");
                t = data.getJSONObject("pagination").getInt("count");
                JSONArray songsArray = data.getJSONArray("Datas");
                for (int i = 0, len = songsArray.size(); i < len; i++) {
                    JSONObject songJson = songsArray.getJSONObject(i);

                    String songId = songJson.getString("id");
                    String name = StringUtil.removeHTMLLabel(songJson.getString("soundstr"));
                    String artist = songJson.getString("username");
                    String artistId = songJson.getString("user_id");
                    Double duration = songJson.getDouble("duration") / 1000;

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setSource(NetMusicSource.ME);
                    musicInfo.setId(songId);
                    musicInfo.setName(name);
                    musicInfo.setArtist(artist);
                    musicInfo.setArtistId(artistId);
                    musicInfo.setDuration(duration);

                    res.add(musicInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        List<Future<CommonResult<NetMusicInfo>>> taskList = new LinkedList<>();

        switch (type) {
            case 1:
                if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL)
                    taskList.add(GlobalExecutors.requestExecutor.submit(searchMusicByLyric));
                if (src == NetMusicSource.KG || src == NetMusicSource.ALL)
                    taskList.add(GlobalExecutors.requestExecutor.submit(searchMusicByLyricKg));
                if (src == NetMusicSource.QQ || src == NetMusicSource.ALL)
                    taskList.add(GlobalExecutors.requestExecutor.submit(searchMusicByLyricQq));
                break;
            case 2:
                if (dt) {
                    if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL)
                        taskList.add(GlobalExecutors.requestExecutor.submit(searchVoice));
                    if (src == NetMusicSource.XM || src == NetMusicSource.ALL)
                        taskList.add(GlobalExecutors.requestExecutor.submit(searchMusicXm));
                    if (src == NetMusicSource.HF || src == NetMusicSource.ALL)
                        taskList.add(GlobalExecutors.requestExecutor.submit(searchMusicHf));
                    if (src == NetMusicSource.GG || src == NetMusicSource.ALL)
                        taskList.add(GlobalExecutors.requestExecutor.submit(searchMusicGg));
                }
                if (src == NetMusicSource.ME || src == NetMusicSource.ALL)
                    taskList.add(GlobalExecutors.requestExecutor.submit(searchProgramMe));
                break;
            default:
                if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL)
                    taskList.add(GlobalExecutors.requestExecutor.submit(searchMusic));
                if (src == NetMusicSource.KG || src == NetMusicSource.ALL)
                    taskList.add(GlobalExecutors.requestExecutor.submit(searchMusicKg));
                if (src == NetMusicSource.QQ || src == NetMusicSource.ALL)
                    taskList.add(GlobalExecutors.requestExecutor.submit(searchMusicQq));
                if (src == NetMusicSource.KW || src == NetMusicSource.ALL)
                    taskList.add(GlobalExecutors.requestExecutor.submit(searchMusicKw));
                if (src == NetMusicSource.MG || src == NetMusicSource.ALL)
                    taskList.add(GlobalExecutors.requestExecutor.submit(searchMusicMg));
                if (src == NetMusicSource.QI || src == NetMusicSource.ALL)
                    taskList.add(GlobalExecutors.requestExecutor.submit(searchMusicQi));
        }

        List<List<NetMusicInfo>> rl = new LinkedList<>();
        taskList.forEach(task -> {
            try {
                CommonResult<NetMusicInfo> result = task.get();
                rl.add(result.data);
                total.set(Math.max(total.get(), result.total));
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
        musicInfos.addAll(ListUtil.joinAll(rl));


        return new CommonResult<>(musicInfos, total.get());
    }

    /**
     * 补充 NetMusicInfo 歌曲时长
     */
    public static void fillDuration(NetMusicInfo musicInfo) {
        int source = musicInfo.getSource();
        String songId = musicInfo.getId();

        // 咪咕
        if (source == NetMusicSource.MG) {
            String songBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_MG_API, songId))
                    .execute()
                    .body();
            JSONObject data = JSONObject.fromObject(songBody).getJSONObject("data");
            if (!musicInfo.hasDuration()) musicInfo.setDuration(data.optDouble("duration", 0));
        }
    }

    /**
     * 补充 NetMusicInfo 歌曲信息(包括 时长、专辑名称、封面图片、歌词)
     */
    public static void fillMusicInfo(NetMusicInfo musicInfo) {
        // 歌曲信息是完整的
        if (musicInfo.isIntegrated()) return;

        String songId = musicInfo.getId();
        int source = musicInfo.getSource();
        boolean isProgram = musicInfo.isProgram();

        List<Future<?>> taskList = new LinkedList<>();

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
                if (isProgram) {
                    String songBody = HttpRequest.get(String.format(SINGLE_PROGRAM_DETAIL_API, musicInfo.getProgramId()))
                            .execute()
                            .body();
                    JSONObject songJson = JSONObject.fromObject(songBody).getJSONObject("program");

                    if (!musicInfo.hasDuration()) musicInfo.setDuration(songJson.getDouble("duration") / 1000);
                    if (!musicInfo.hasArtist())
                        musicInfo.setArtist(songJson.getJSONObject("dj").getString("nickname"));
                    if (!musicInfo.hasArtistId())
                        musicInfo.setArtistId(songJson.getJSONObject("dj").getString("userId"));
                    if (!musicInfo.hasAlbumName())
                        musicInfo.setAlbumName(songJson.getJSONObject("radio").getString("name"));
                    if (!musicInfo.hasAlbumId())
                        musicInfo.setAlbumId(songJson.getJSONObject("radio").getString("id"));
                    if (!musicInfo.hasAlbumImage()) {
                        GlobalExecutors.imageExecutor.submit(() -> {
                            BufferedImage albumImage = getImageFromUrl(songJson.getString("coverUrl"));
                            ImageUtil.toFile(albumImage, SimplePath.IMG_CACHE_PATH + musicInfo.toAlbumImageFileName());
                            musicInfo.callback();
                        });
                    }
                } else {
                    String songBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_API, songId))
                            .execute()
                            .body();
                    JSONArray array = JSONObject.fromObject(songBody).optJSONArray("songs");
                    if (array != null) {
                        JSONObject songJson = array.getJSONObject(0);
                        if (!musicInfo.hasDuration()) musicInfo.setDuration(songJson.getDouble("dt") / 1000);
                        if (!musicInfo.hasArtist())
                            musicInfo.setArtist(parseArtists(songJson, NetMusicSource.NET_CLOUD));
                        if (!musicInfo.hasArtistId())
                            musicInfo.setArtistId(songJson.getJSONArray("ar").getJSONObject(0).getString("id"));
                        if (!musicInfo.hasAlbumName())
                            musicInfo.setAlbumName(songJson.getJSONObject("al").getString("name"));
                        if (!musicInfo.hasAlbumId())
                            musicInfo.setAlbumId(songJson.getJSONObject("al").getString("id"));
                        if (!musicInfo.hasAlbumImage()) {
                            GlobalExecutors.imageExecutor.submit(() -> {
                                BufferedImage albumImage = getImageFromUrl(songJson.getJSONObject("al").getString("picUrl"));
                                ImageUtil.toFile(albumImage, SimplePath.IMG_CACHE_PATH + musicInfo.toAlbumImageFileName());
                                musicInfo.callback();
                            });
                        }
                    }
                }
            }));
//            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
//                if (!musicInfo.hasUrl()) {
//                    String url = fetchMusicUrl(songId, NetMusicSource.NET_CLOUD);
//                    // 排除试听部分，直接换源
//                    if (StringUtils.isNotEmpty(url)) musicInfo.setUrl(url);
//                    else MusicServerUtils.fillAvailableMusicUrl(musicInfo);
//                    // 网易云音乐里面有的电台节目是 flac 格式！
//                    if (url.endsWith(Format.FLAC)) musicInfo.setFormat(Format.FLAC);
//                }
//            }));
            // 填充歌词、翻译、罗马音
//            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
//                fillLrc(musicInfo);
//            }));
        }

        // 酷狗
        else if (source == NetMusicSource.KG) {
            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
                // 酷狗接口请求需要带上 cookie ！
                String songBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_KG_API, songId))
                        .header(Header.COOKIE, COOKIE)
                        .execute()
                        .body();
                JSONObject data = JSONObject.fromObject(songBody).getJSONObject("data");
                // 时长是毫秒，转为秒
                if (!musicInfo.hasDuration()) musicInfo.setDuration(data.optDouble("timelength") / 1000);
                if (!musicInfo.hasArtist()) musicInfo.setArtist(parseArtists(data, NetMusicSource.KG));
                if (!musicInfo.hasArtistId()) {
                    JSONArray artistArray = data.optJSONArray("authors");
                    if (artistArray != null && !artistArray.isEmpty())
                        musicInfo.setArtistId(artistArray.getJSONObject(0).getString("author_id"));
                }
                if (!musicInfo.hasAlbumName()) musicInfo.setAlbumName(data.optString("album_name"));
                if (!musicInfo.hasAlbumId()) musicInfo.setAlbumId(data.optString("album_id"));
                if (!musicInfo.hasAlbumImage()) {
                    GlobalExecutors.imageExecutor.submit(() -> {
                        BufferedImage albumImage = getImageFromUrl(data.optString("img"));
                        ImageUtil.toFile(albumImage, SimplePath.IMG_CACHE_PATH + musicInfo.toAlbumImageFileName());
                        musicInfo.callback();
                    });
                }
//                if (!musicInfo.hasUrl()) {
//                    // 排除试听部分，直接换源
//                    String url = data.getString("play_url");
//                    if (StringUtils.isNotEmpty(url) && data.getInt("is_free_part") == 0) musicInfo.setUrl(url);
//                    else MusicServerUtils.fillAvailableMusicUrl(musicInfo);
//                }
                if (!musicInfo.hasLrc()) musicInfo.setLrc(data.optString("lyrics"));
            }));
//            // 填充歌词、翻译、罗马音
//            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
//                fillLrc(musicInfo);
//            }));
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
                String songBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_QQ_API, songId))
                        .execute()
                        .body();
                JSONObject data = JSONObject.fromObject(songBody).getJSONObject("data");
                JSONObject trackInfo = data.getJSONObject("track_info");
                JSONArray singer = trackInfo.getJSONArray("singer");
                JSONObject album = trackInfo.getJSONObject("album");

                if (!musicInfo.hasDuration()) musicInfo.setDuration(trackInfo.getDouble("interval"));
                if (!musicInfo.hasArtist()) musicInfo.setArtist(parseArtists(trackInfo, NetMusicSource.QQ));
                if (!musicInfo.hasArtistId())
                    musicInfo.setArtistId(singer.getJSONObject(0).getString("mid"));
                if (!musicInfo.hasAlbumName())
                    musicInfo.setAlbumName(album.getString("name"));
                if (!musicInfo.hasAlbumId()) musicInfo.setAlbumId(album.getString("mid"));
                if (!musicInfo.hasAlbumImage()) {
                    GlobalExecutors.imageExecutor.submit(() -> {
                        // QQ 的歌曲专辑图片需要额外请求接口获得！
                        BufferedImage albumImage = getImageFromUrl(String.format(SINGLE_SONG_IMG_QQ_API, album.getString("mid")));
                        // 有的歌曲没有专辑，先找备份专辑图片，如果还没有就将歌手的图片作为封面
                        if (albumImage == null)
                            albumImage = getImageFromUrl(String.format(SINGLE_SONG_IMG_QQ_API, album.getString("pmid")));
                        if (albumImage == null)
                            albumImage = getImageFromUrl(String.format(ARTIST_IMG_QQ_API, singer.getJSONObject(0).getString("mid")));
                        ImageUtil.toFile(albumImage, SimplePath.IMG_CACHE_PATH + musicInfo.toAlbumImageFileName());
                        musicInfo.callback();
                    });
                }
            }));
//            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
//                if (!musicInfo.hasUrl()) {
//                    // 排除试听部分，直接换源
//                    String url = fetchMusicUrl(songId, NetMusicSource.QQ);
//                    if (StringUtils.isNotEmpty(url)) musicInfo.setUrl(url);
//                    else MusicServerUtils.fillAvailableMusicUrl(musicInfo);
//                }
//            }));
            // 填充歌词、翻译、罗马音
//            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
//                fillLrc(musicInfo);
//            }));
        }

        // 酷我
        else if (source == NetMusicSource.KW) {
            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
                String songBody = kwRequest(String.format(SINGLE_SONG_DETAIL_KW_API, songId))
                        .execute()
                        .body();
                JSONObject data = JSONObject.fromObject(songBody).getJSONObject("data");

                if (!musicInfo.hasDuration()) musicInfo.setDuration(data.getDouble("duration"));
                if (!musicInfo.hasArtist()) musicInfo.setArtist(data.getString("artist"));
                if (!musicInfo.hasArtistId()) musicInfo.setArtistId(data.getString("artistid"));
                if (!musicInfo.hasAlbumName()) musicInfo.setAlbumName(data.getString("album"));
                if (!musicInfo.hasAlbumId()) musicInfo.setAlbumId(data.getString("albumid"));
                if (!musicInfo.hasAlbumImage()) {
                    GlobalExecutors.imageExecutor.submit(() -> {
                        BufferedImage albumImage = getImageFromUrl(data.getString("pic"));
                        ImageUtil.toFile(albumImage, SimplePath.IMG_CACHE_PATH + musicInfo.toAlbumImageFileName());
                        musicInfo.callback();
                    });
                }
            }));
//            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
//                if (!musicInfo.hasUrl()) {
//                    // 无链接，直接换源
//                    String url = fetchMusicUrl(songId, NetMusicSource.KW);
//                    if (StringUtils.isNotEmpty(url)) musicInfo.setUrl(url);
//                    else MusicServerUtils.fillAvailableMusicUrl(musicInfo);
//                }
//            }));
            // 填充歌词、翻译、罗马音
//            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
//                fillLrc(musicInfo);
//            }));
        }

        // 咪咕
        else if (source == NetMusicSource.MG) {
            String songBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_MG_API, songId))
                    .execute()
                    .body();
            JSONObject data = JSONObject.fromObject(songBody).getJSONObject("data");

            String albumId = data.getJSONObject("album").getString("id");
            if (!musicInfo.hasArtist()) musicInfo.setArtist(parseArtists(data, NetMusicSource.MG));
            if (!musicInfo.hasArtistId())
                musicInfo.setArtistId(data.getJSONArray("artists").getJSONObject(0).getString("id"));
            // 咪咕的专辑名称需要额外请求专辑信息接口！
            if (!musicInfo.hasAlbumName()) {
                String albumBody = HttpRequest.get(String.format(ALBUM_DETAIL_MG_API, albumId))
                        .execute()
                        .body();
                JSONObject albumData = JSONObject.fromObject(albumBody).getJSONObject("data");
                musicInfo.setAlbumName(albumData.getString("name"));
            }
            if (!musicInfo.hasAlbumId()) musicInfo.setAlbumId(albumId);
            if (!musicInfo.hasDuration()) musicInfo.setDuration(data.getDouble("duration"));
            if (!musicInfo.hasAlbumImage()) {
                GlobalExecutors.imageExecutor.submit(() -> {
                    BufferedImage albumImage = getImageFromUrl(data.getString("picUrl"));
                    ImageUtil.toFile(albumImage, SimplePath.IMG_CACHE_PATH + musicInfo.toAlbumImageFileName());
                    musicInfo.callback();
                });
            }
//            if (!musicInfo.hasUrl()) {
//                // 无链接，直接换源
//                String url = data.getString("320");
//                if (StringUtils.isNotEmpty(url)) musicInfo.setUrl(url);
//                else MusicServerUtils.fillAvailableMusicUrl(musicInfo);
//            }
            if (!musicInfo.hasLrc()) musicInfo.setLrc(data.getString("lyric"));
        }

        // 千千
        else if (source == NetMusicSource.QI) {
            String songBody = HttpRequest.get(buildQianUrl(String.format(SINGLE_SONG_DETAIL_QI_API, songId, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject data = JSONObject.fromObject(songBody).getJSONArray("data").getJSONObject(0);

            if (!musicInfo.hasArtist()) musicInfo.setArtist(parseArtists(data, NetMusicSource.QI));
            if (!musicInfo.hasArtistId()) {
                JSONArray artistArray = data.optJSONArray("artist");
                if (artistArray != null && !artistArray.isEmpty())
                    musicInfo.setArtistId(artistArray.getJSONObject(0).getString("artistCode"));
            }
            if (!musicInfo.hasAlbumName()) musicInfo.setAlbumName(data.getString("albumTitle"));
            if (!musicInfo.hasAlbumId()) musicInfo.setAlbumId(data.getString("albumAssetCode"));
            if (!musicInfo.hasDuration()) musicInfo.setDuration(data.getDouble("duration"));
            if (!musicInfo.hasAlbumImage()) {
                GlobalExecutors.imageExecutor.submit(() -> {
                    BufferedImage albumImage = getImageFromUrl(data.getString("pic"));
                    ImageUtil.toFile(albumImage, SimplePath.IMG_CACHE_PATH + musicInfo.toAlbumImageFileName());
                    musicInfo.callback();
                });
            }
//            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
//                if (!musicInfo.hasUrl()) {
//                    // 无链接或试听，直接换源
//                    String url = fetchMusicUrl(songId, NetMusicSource.QI);
//                    if (StringUtils.isNotEmpty(url)) musicInfo.setUrl(url);
//                    else MusicServerUtils.fillAvailableMusicUrl(musicInfo);
//                }
//            }));
            // 填充歌词、翻译、罗马音
//            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
//                fillLrc(musicInfo);
//            }));
        }

        // 音乐磁场
        else if (source == NetMusicSource.HF) {
            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
                String songBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_HF_API, songId))
                        .cookie(HF_COOKIE)
                        .execute()
                        .body();
                Document doc = Jsoup.parse(songBody);
                String dataStr = ReUtil.get("music: \\[.*?(\\{.*?\\}).*?\\]", doc.html(), 1);
                JSONObject data = JSONObject.fromObject(dataStr);

                Elements a = doc.select(".m-3.text-center h5 a");

                if (!musicInfo.hasArtist()) musicInfo.setArtist(a.text());
                if (!musicInfo.hasArtistId()) musicInfo.setArtistId(ReUtil.get("user-(\\d+)\\.htm", a.attr("href"), 1));
                if (!musicInfo.hasAlbumImage()) {
                    GlobalExecutors.imageExecutor.submit(() -> {
                        String picUrl = data.optString("pic");
                        if (picUrl.contains("music.126.net"))
                            picUrl = picUrl.replaceFirst("param=\\d+y\\d+", "param=500y500");
                        else if (picUrl.contains("y.gtimg.cn"))
                            picUrl = picUrl.replaceFirst("300x300", "500x500");
                        if (!picUrl.startsWith("http")) picUrl = "https://www.hifini.com/" + picUrl;
                        BufferedImage albumImage = getImageFromUrl(picUrl);
                        ImageUtil.toFile(albumImage, SimplePath.IMG_CACHE_PATH + musicInfo.toAlbumImageFileName());
                        musicInfo.callback();
                    });
                }
            }));
        }

        // 咕咕咕音乐
        else if (source == NetMusicSource.GG) {
            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
                String songBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_GG_API, songId))
                        .execute()
                        .body();
                Document doc = Jsoup.parse(songBody);
                String dataStr = ReUtil.get("audio: \\[.*?(\\{.*?\\}).*?\\]", doc.html(), 1);
                JSONObject data = JSONObject.fromObject(dataStr);

                Elements a = doc.select(".m-3.text-center h5 a");

                if (!musicInfo.hasArtist()) musicInfo.setArtist(a.text());
                if (!musicInfo.hasArtistId()) musicInfo.setArtistId(ReUtil.get("user-(\\d+)\\.htm", a.attr("href"), 1));
                if (!musicInfo.hasAlbumImage()) {
                    GlobalExecutors.imageExecutor.submit(() -> {
                        String picUrl = data.getString("cover");
                        if (picUrl.contains("music.126.net"))
                            picUrl = picUrl.replaceFirst("param=\\d+y\\d+", "param=500y500");
                        else if (picUrl.contains("y.gtimg.cn"))
                            picUrl = picUrl.replaceFirst("300x300", "500x500");
                        if (!picUrl.startsWith("http")) picUrl = "http://www.gggmusic.com/" + picUrl;
                        BufferedImage albumImage = getImageFromUrl(picUrl);
                        ImageUtil.toFile(albumImage, SimplePath.IMG_CACHE_PATH + musicInfo.toAlbumImageFileName());
                        musicInfo.callback();
                    });
                }
            }));
        }

        // 喜马拉雅
        else if (source == NetMusicSource.XM) {
            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
                String songBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_XM_API, songId))
                        .execute()
                        .body();
                JSONObject data = JSONObject.fromObject(songBody).getJSONObject("data");
                JSONObject trackInfo = data.getJSONObject("trackInfo");
                JSONObject albumInfo = data.getJSONObject("albumInfo");

                if (!musicInfo.hasArtistId()) musicInfo.setArtistId(trackInfo.getString("anchorUid"));
                if (!musicInfo.hasAlbumName()) musicInfo.setAlbumName(albumInfo.getString("title"));
                if (!musicInfo.hasAlbumId()) musicInfo.setAlbumId(albumInfo.getString("albumId"));
                if (!musicInfo.hasDuration()) musicInfo.setDuration(trackInfo.getDouble("duration"));
                if (!musicInfo.hasAlbumImage()) {
                    GlobalExecutors.imageExecutor.submit(() -> {
                        BufferedImage albumImage = getImageFromUrl("https:" + trackInfo.getString("coverPath"));
                        ImageUtil.toFile(albumImage, SimplePath.IMG_CACHE_PATH + musicInfo.toAlbumImageFileName());
                        musicInfo.callback();
                    });
                }
            }));
//            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
//                if (!musicInfo.hasUrl()) {
//                    String url = fetchMusicUrl(songId, NetMusicSource.XM);
//                    if (url.contains(".m4a")) musicInfo.setFormat(Format.M4A);
//                    musicInfo.setUrl(url);
//                }
//            }));
            musicInfo.setLrc("");
        }

        // 猫耳
        else if (source == NetMusicSource.ME) {
            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
                String songBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_ME_API, songId))
                        .execute()
                        .body();
                JSONObject data = JSONObject.fromObject(songBody).getJSONObject("info").getJSONObject("sound");
                // 时长是毫秒，转为秒
                if (!musicInfo.hasDuration()) musicInfo.setDuration(data.getDouble("duration") / 1000);
                if (!musicInfo.hasArtist()) musicInfo.setArtist(data.getString("username"));
                if (!musicInfo.hasArtistId()) musicInfo.setArtistId(data.getString("user_id"));
                if (!musicInfo.hasAlbumImage()) {
                    GlobalExecutors.imageExecutor.submit(() -> {
                        BufferedImage albumImage = getImageFromUrl(data.getString("front_cover"));
                        ImageUtil.toFile(albumImage, SimplePath.IMG_CACHE_PATH + musicInfo.toAlbumImageFileName());
                        musicInfo.callback();
                    });
                }
//                if (!musicInfo.hasUrl()) {
//                    String url = data.optString("soundurl");
//                    musicInfo.setUrl(url);
//                    if (url.contains(".m4a")) musicInfo.setFormat(Format.M4A);
//                }
            }));
            // 填充歌词、翻译、罗马音
//            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
//                fillLrc(musicInfo);
//            }));
            // 猫耳的专辑需要单独请求专辑信息接口！
            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
                String albumBody = HttpRequest.get(String.format(SONG_ALBUM_DETAIL_ME_API, songId))
                        .execute()
                        .body();
                JSONObject info = JSONObject.fromObject(albumBody).optJSONObject("info");
                if (info == null) return;
                JSONObject albumData = info.getJSONObject("drama");
                if (!musicInfo.hasAlbumName()) musicInfo.setAlbumName(albumData.getString("name"));
                if (!musicInfo.hasAlbumId()) musicInfo.setAlbumId(albumData.getString("id"));
            }));
        }

        // 哔哩哔哩
        else if (source == NetMusicSource.BI) {
            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
                String songBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_BI_API, songId))
                        .setFollowRedirects(true)
                        .cookie(BI_COOKIE)
                        .execute()
                        .body();
                JSONObject data = JSONObject.fromObject(songBody).getJSONObject("data");
                // 时长是毫秒，转为秒
                if (!musicInfo.hasDuration()) musicInfo.setDuration(data.getDouble("duration"));
                if (!musicInfo.hasArtist()) musicInfo.setArtist(data.getString("uname"));
                if (!musicInfo.hasArtistId()) musicInfo.setArtistId(data.getString("uid"));
                if (!musicInfo.hasAlbumImage()) {
                    GlobalExecutors.imageExecutor.submit(() -> {
                        BufferedImage albumImage = getImageFromUrl(data.getString("cover"));
                        ImageUtil.toFile(albumImage, SimplePath.IMG_CACHE_PATH + musicInfo.toAlbumImageFileName());
                        musicInfo.callback();
                    });
                }
            }));
//            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
//                String url = fetchMusicUrl(songId, NetMusicSource.BI);
//                if (url.contains(".m4a")) musicInfo.setFormat(Format.M4A);
//                musicInfo.setUrl(url);
//            }));
            // 填充歌词、翻译、罗马音
//            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
//                fillLrc(musicInfo);
//            }));
        }

        // 阻塞等待所有请求完成
        taskList.forEach(task -> {
            try {
                task.get();
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
    }

    /**
     * 补充 NetMusicInfo 的 url
     */
    public static void fillMusicUrl(NetMusicInfo musicInfo) {
        // 歌曲信息是完整的
        if (musicInfo.isIntegrated()) return;

        String songId = musicInfo.getId();
        int source = musicInfo.getSource();

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String url = fetchMusicUrl(songId, NetMusicSource.NET_CLOUD);
            // 排除试听部分，直接换源
            if (StringUtil.isNotEmpty(url)) musicInfo.setUrl(url);
            else MusicServerUtil.fillAvailableMusicUrl(musicInfo);
            // 网易云音乐里面有的电台节目是 flac 格式！
            if (url.endsWith(Format.FLAC)) musicInfo.setFormat(Format.FLAC);
        }

        // 酷狗
        else if (source == NetMusicSource.KG) {
            // 排除试听部分，直接换源
            String url = fetchMusicUrl(songId, NetMusicSource.KG);
            if (StringUtil.isNotEmpty(url)) musicInfo.setUrl(url);
            else MusicServerUtil.fillAvailableMusicUrl(musicInfo);
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            // 排除试听部分，直接换源
            String url = fetchMusicUrl(songId, NetMusicSource.QQ);
            if (StringUtil.isNotEmpty(url)) musicInfo.setUrl(url);
            else MusicServerUtil.fillAvailableMusicUrl(musicInfo);
        }

        // 酷我
        else if (source == NetMusicSource.KW) {
            // 无链接，直接换源
            String url = fetchMusicUrl(songId, NetMusicSource.KW);
            if (StringUtil.isNotEmpty(url)) musicInfo.setUrl(url);
            else MusicServerUtil.fillAvailableMusicUrl(musicInfo);
        }

        // 咪咕
        else if (source == NetMusicSource.MG) {
            // 无链接，直接换源
            String url = fetchMusicUrl(songId, NetMusicSource.MG);
            if (StringUtil.isNotEmpty(url)) musicInfo.setUrl(url);
            else MusicServerUtil.fillAvailableMusicUrl(musicInfo);
        }

        // 千千
        else if (source == NetMusicSource.QI) {
            // 无链接或试听，直接换源
            String url = fetchMusicUrl(songId, NetMusicSource.QI);
            if (StringUtil.isNotEmpty(url)) musicInfo.setUrl(url);
            else MusicServerUtil.fillAvailableMusicUrl(musicInfo);
        }

        // 音乐磁场
        else if (source == NetMusicSource.HF) {
            // 无链接或试听，直接换源
            String url = fetchMusicUrl(songId, NetMusicSource.HF);
            if (url.contains(".m4a")) musicInfo.setFormat(Format.M4A);
            if (StringUtil.isNotEmpty(url)) musicInfo.setUrl(url);
            else MusicServerUtil.fillAvailableMusicUrl(musicInfo);
        }

        // 咕咕咕音乐
        else if (source == NetMusicSource.GG) {
            // 无链接或试听，直接换源
            String url = fetchMusicUrl(songId, NetMusicSource.GG);
            if (url.contains(".m4a")) musicInfo.setFormat(Format.M4A);
            if (StringUtil.isNotEmpty(url)) musicInfo.setUrl(url);
            else MusicServerUtil.fillAvailableMusicUrl(musicInfo);
        }

        // 喜马拉雅
        else if (source == NetMusicSource.XM) {
            String url = fetchMusicUrl(songId, NetMusicSource.XM);
            if (url.contains(".m4a")) musicInfo.setFormat(Format.M4A);
            musicInfo.setUrl(url);
        }

        // 猫耳
        else if (source == NetMusicSource.ME) {
            String url = fetchMusicUrl(songId, NetMusicSource.ME);
            musicInfo.setUrl(url);
            if (url.contains(".m4a")) musicInfo.setFormat(Format.M4A);
        }

        // 哔哩哔哩
        else if (source == NetMusicSource.BI) {
            String url = fetchMusicUrl(songId, NetMusicSource.BI);
            if (url.contains(".m4a")) musicInfo.setFormat(Format.M4A);
            musicInfo.setUrl(url);
        }
    }

    /**
     * 根据关键词获取歌单
     */
    public static CommonResult<NetPlaylistInfo> searchPlaylists(int src, String keyword, int limit, int page) {
        AtomicInteger total = new AtomicInteger();
        List<NetPlaylistInfo> playlistInfos = new LinkedList<>();

        // 先对关键词编码，避免特殊符号的干扰
        String encodedKeyword = StringUtil.encode(keyword);

        // 网易云
        Callable<CommonResult<NetPlaylistInfo>> searchPlaylists = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            String playlistInfoBody = HttpRequest.get(String.format(SEARCH_PLAYLIST_API, encodedKeyword, limit, (page - 1) * limit))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject result = playlistInfoJson.getJSONObject("result");
            if (result.has("playlists")) {
                t = result.getInt("playlistCount");
                JSONArray playlistArray = result.getJSONArray("playlists");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);
                    JSONObject ct = playlistJson.optJSONObject("creator");

                    String playlistId = playlistJson.getString("id");
                    String name = playlistJson.getString("name");
                    String creator = ct != null ? ct.getString("nickname") : "";
                    String creatorId = ct != null ? ct.getString("userId") : "";
                    Long playCount = playlistJson.getLong("playCount");
                    Integer trackCount = playlistJson.getInt("trackCount");
                    String coverImgThumbUrl = playlistJson.getString("coverImgUrl");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(name);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCreatorId(creatorId);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    playlistInfo.setTrackCount(trackCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });
                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 酷狗
        Callable<CommonResult<NetPlaylistInfo>> searchPlaylistsKg = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            String playlistInfoBody = HttpRequest.get(String.format(SEARCH_PLAYLIST_KG_API, encodedKeyword, page, limit))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray playlistArray = data.getJSONArray("info");
            for (int i = 0, len = playlistArray.size(); i < len; i++) {
                JSONObject playlistJson = playlistArray.getJSONObject(i);

                String playlistId = playlistJson.getString("specialid");
                String playlistName = playlistJson.getString("specialname");
                String creator = playlistJson.getString("nickname");
                Long playCount = playlistJson.getLong("playcount");
                Integer trackCount = playlistJson.getInt("songcount");
                String coverImgThumbUrl = playlistJson.getString("imgurl").replace("/{size}", "");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setSource(NetMusicSource.KG);
                playlistInfo.setId(playlistId);
                playlistInfo.setName(playlistName);
                playlistInfo.setCreator(creator);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                playlistInfo.setPlayCount(playCount);
                playlistInfo.setTrackCount(trackCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(playlistInfo);
            }
            return new CommonResult<>(res, t);
        };

        // QQ
        Callable<CommonResult<NetPlaylistInfo>> searchPlaylistsQq = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            String playlistInfoBody = HttpRequest.post(String.format(qqSearchApi))
                    .body(String.format(qqSearchJson, page, limit, keyword, 3))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONObject("music.search.SearchCgiService").getJSONObject("data");
            t = data.getJSONObject("meta").getInt("sum");
            JSONArray playlistArray = data.getJSONObject("body").getJSONObject("songlist").getJSONArray("list");
            for (int i = 0, len = playlistArray.size(); i < len; i++) {
                JSONObject playlistJson = playlistArray.getJSONObject(i);

                String playlistId = playlistJson.getString("dissid");
                String playlistName = playlistJson.getString("dissname");
                String creator = playlistJson.getJSONObject("creator").getString("name");
                Long playCount = playlistJson.getLong("listennum");
                Integer trackCount = playlistJson.getInt("song_count");
                String coverImgThumbUrl = playlistJson.getString("imgurl");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setSource(NetMusicSource.QQ);
                playlistInfo.setId(playlistId);
                playlistInfo.setName(playlistName);
                playlistInfo.setCreator(creator);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                playlistInfo.setPlayCount(playCount);
                playlistInfo.setTrackCount(trackCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(playlistInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 酷我
        Callable<CommonResult<NetPlaylistInfo>> searchPlaylistsKw = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = kwRequest(String.format(SEARCH_PLAYLIST_KW_API, encodedKeyword, page, limit)).execute();
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                String playlistInfoBody = resp.body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                JSONObject data = playlistInfoJson.getJSONObject("data");
                t = data.getInt("total");
                JSONArray playlistArray = data.getJSONArray("list");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("id");
                    String playlistName = StringUtil.removeHTMLLabel(playlistJson.getString("name"));
                    String creator = playlistJson.getString("uname");
                    Long playCount = playlistJson.getLong("listencnt");
                    Integer trackCount = playlistJson.getInt("total");
                    String coverImgThumbUrl = playlistJson.getString("img");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.KW);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    playlistInfo.setTrackCount(trackCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });
                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 咪咕
        Callable<CommonResult<NetPlaylistInfo>> searchPlaylistsMg = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            String playlistInfoBody = HttpRequest.get(String.format(SEARCH_PLAYLIST_MG_API, encodedKeyword, page, limit))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.optJSONObject("data");
            if (data != null) {
                t = data.optInt("total");
                JSONArray playlistArray = data.getJSONArray("list");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("id");
                    String playlistName = playlistJson.getString("name");
                    String creator = playlistJson.getJSONObject("creator").getString("name");
                    Long playCount = playlistJson.getLong("playCount");
                    Integer trackCount = playlistJson.getInt("songCount");
                    String coverImgThumbUrl = playlistJson.getString("picUrl");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.MG);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator("null".equals(creator) ? "" : creator);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    playlistInfo.setTrackCount(trackCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });
                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        List<Future<CommonResult<NetPlaylistInfo>>> taskList = new LinkedList<>();

        if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchPlaylists));
        if (src == NetMusicSource.KG || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchPlaylistsKg));
        if (src == NetMusicSource.QQ || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchPlaylistsQq));
        if (src == NetMusicSource.KW || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchPlaylistsKw));
        if (src == NetMusicSource.MG || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchPlaylistsMg));

        List<List<NetPlaylistInfo>> rl = new LinkedList<>();
        taskList.forEach(task -> {
            try {
                CommonResult<NetPlaylistInfo> result = task.get();
                rl.add(result.data);
                total.set(Math.max(total.get(), result.total));
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
        playlistInfos.addAll(ListUtil.joinAll(rl));

        return new CommonResult<>(playlistInfos, total.get());
    }

    /**
     * 根据关键词获取专辑
     */
    public static CommonResult<NetAlbumInfo> searchAlbums(int src, String keyword, int limit, int page) {
        AtomicInteger total = new AtomicInteger();
        List<NetAlbumInfo> albumInfos = new LinkedList<>();

        // 先对关键词编码，避免特殊符号的干扰
        String encodedKeyword = StringUtil.encode(keyword);

        // 网易云
        Callable<CommonResult<NetAlbumInfo>> searchAlbums = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            String albumInfoBody = HttpRequest.get(String.format(SEARCH_ALBUM_API, encodedKeyword, limit, (page - 1) * limit))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject result = albumInfoJson.getJSONObject("result");
            if (!result.has("albums")) return new CommonResult<>(albumInfos, 0);
            t = result.getInt("albumCount");
            JSONArray albumArray = result.getJSONArray("albums");
            for (int i = 0, len = albumArray.size(); i < len; i++) {
                JSONObject albumJson = albumArray.getJSONObject(i);

                String albumId = albumJson.getString("id");
                String albumName = albumJson.getString("name");
                String artist = parseArtists(albumJson, NetMusicSource.NET_CLOUD);
                String artistId = albumJson.getJSONArray("artists").getJSONObject(0).getString("id");
                String publishTime = TimeUtil.msToDate(albumJson.getLong("publishTime"));
                Integer songNum = albumJson.getInt("size");
                String coverImgThumbUrl = albumJson.getString("picUrl");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(albumInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 酷狗
        Callable<CommonResult<NetAlbumInfo>> searchAlbumsKg = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            String albumInfoBody = HttpRequest.get(String.format(SEARCH_ALBUM_KG_API, encodedKeyword, page, limit))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray albumArray = data.getJSONArray("info");
            for (int i = 0, len = albumArray.size(); i < len; i++) {
                JSONObject albumJson = albumArray.getJSONObject(i);

                String albumId = albumJson.getString("albumid");
                String albumName = albumJson.getString("albumname");
                String artist = albumJson.getString("singername");
                String artistId = albumJson.getString("singerid");
                String publishTime = albumJson.getString("publishtime").replace(" 00:00:00", "");
                Integer songNum = albumJson.getInt("songcount");
                String coverImgThumbUrl = albumJson.getString("imgurl").replace("/{size}", "");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.KG);
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(albumInfo);
            }
            return new CommonResult<>(res, t);
        };

        // QQ
        Callable<CommonResult<NetAlbumInfo>> searchAlbumsQq = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            String albumInfoBody = HttpRequest.post(String.format(qqSearchApi))
                    .body(String.format(qqSearchJson, page, limit, keyword, 2))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("music.search.SearchCgiService").getJSONObject("data");
            t = data.getJSONObject("meta").getInt("sum");
            JSONArray albumArray = data.getJSONObject("body").getJSONObject("album").getJSONArray("list");
            for (int i = 0, len = albumArray.size(); i < len; i++) {
                JSONObject albumJson = albumArray.getJSONObject(i);

                String albumId = albumJson.getString("albumMID");
                String albumName = albumJson.getString("albumName");
                String artist = parseArtists(albumJson, NetMusicSource.QQ);
                String artistId = albumJson.getJSONArray("singer_list").getJSONObject(0).getString("mid");
                String publishTime = albumJson.getString("publicTime");
                Integer songNum = albumJson.getInt("song_count");
                String coverImgThumbUrl = albumJson.getString("albumPic").replaceFirst("http:", "https:");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.QQ);
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(albumInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 酷我
        Callable<CommonResult<NetAlbumInfo>> searchAlbumsKw = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = kwRequest(String.format(SEARCH_ALBUM_KW_API, encodedKeyword, page, limit)).execute();
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                String albumInfoBody = resp.body();
                JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
                JSONObject data = albumInfoJson.getJSONObject("data");
                t = data.getInt("total");
                JSONArray albumArray = data.getJSONArray("albumList");
                for (int i = 0, len = albumArray.size(); i < len; i++) {
                    JSONObject albumJson = albumArray.getJSONObject(i);

                    String albumId = albumJson.getString("albumid");
                    String albumName = StringUtil.removeHTMLLabel(albumJson.getString("album"));
                    String artist = albumJson.getString("artist");
                    String artistId = albumJson.getString("artistid");
                    String publishTime = albumJson.getString("releaseDate");
                    String coverImgThumbUrl = albumJson.getString("pic");

                    NetAlbumInfo albumInfo = new NetAlbumInfo();
                    albumInfo.setSource(NetMusicSource.KW);
                    albumInfo.setId(albumId);
                    albumInfo.setName(albumName);
                    albumInfo.setArtist(artist);
                    albumInfo.setArtistId(artistId);
                    albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    albumInfo.setPublishTime(publishTime);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        albumInfo.setCoverImgThumb(coverImgThumb);
                    });
                    res.add(albumInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 咪咕
        Callable<CommonResult<NetAlbumInfo>> searchAlbumsMg = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            String albumInfoBody = HttpRequest.get(String.format(SEARCH_ALBUM_MG_API, encodedKeyword, page, limit))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            // 咪咕可能接口异常，需要判空！
            JSONObject data = albumInfoJson.optJSONObject("data");
            if (data != null) {
                t = data.optInt("total");
                JSONArray albumArray = data.getJSONArray("list");
                for (int i = 0, len = albumArray.size(); i < len; i++) {
                    JSONObject albumJson = albumArray.getJSONObject(i);

                    String albumId = albumJson.getString("id");
                    String albumName = albumJson.getString("name");
                    String artist = parseArtists(albumJson, NetMusicSource.MG);
                    String artistId = albumJson.getJSONArray("artists").getJSONObject(0).getString("id");
                    String publishTime = albumJson.getString("publishTime");
                    Integer songNum = albumJson.getInt("songCount");
                    String coverImgThumbUrl = albumJson.getString("picUrl");

                    NetAlbumInfo albumInfo = new NetAlbumInfo();
                    albumInfo.setSource(NetMusicSource.MG);
                    albumInfo.setId(albumId);
                    albumInfo.setName(albumName);
                    albumInfo.setArtist(artist);
                    albumInfo.setArtistId(artistId);
                    albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    albumInfo.setPublishTime("null".equals(publishTime) ? "" : publishTime);
                    albumInfo.setSongNum(songNum);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        albumInfo.setCoverImgThumb(coverImgThumb);
                    });
                    res.add(albumInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 千千
        Callable<CommonResult<NetAlbumInfo>> searchAlbumsQi = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = HttpRequest.get(buildQianUrl(String.format(SEARCH_ALBUM_QI_API, page, limit, System.currentTimeMillis(), encodedKeyword))).execute();
            String albumInfoBody = resp.body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray albumArray = data.getJSONArray("typeAlbum");
            for (int i = 0, len = albumArray.size(); i < len; i++) {
                JSONObject albumJson = albumArray.getJSONObject(i);

                String albumId = albumJson.getString("albumAssetCode");
                String albumName = albumJson.getString("title");
                String artist = parseArtists(albumJson, NetMusicSource.QI);
                JSONArray artistArray = albumJson.optJSONArray("artist");
                String artistId = artistArray != null && !artistArray.isEmpty() ? artistArray.getJSONObject(0).getString("artistCode") : "";
                String rd = albumJson.optString("releaseDate");
                String publishTime = StringUtil.isNotEmpty(rd) ? rd.split("T")[0] : "";
                String coverImgThumbUrl = albumJson.getString("pic");
                Integer songNum = albumJson.getJSONArray("trackList").size();

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.QI);
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(albumInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 豆瓣
        Callable<CommonResult<NetAlbumInfo>> searchAlbumsDb = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            final int lim = Math.min(20, limit);
            String albumInfoBody = HttpRequest.get(String.format(SEARCH_ALBUM_DB_API, encodedKeyword, (page - 1) * lim))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONArray albumArray = albumInfoJson.optJSONArray("items");
            if (albumArray != null) {
                t = albumInfoJson.getInt("total");
                for (int i = 0, len = albumArray.size(); i < len; i++) {
                    Document doc = Jsoup.parse(albumArray.getString(i));
                    Elements result = doc.select("div.result");
                    Elements a = result.select("h3 a");

                    String albumId = ReUtil.get("sid: (\\d+)", a.attr("onclick"), 1);
                    String albumName = a.text().trim();
                    String artist = result.select("span.subject-cast").text();
                    String coverImgThumbUrl = result.select("div.pic img").attr("src");

                    NetAlbumInfo albumInfo = new NetAlbumInfo();
                    albumInfo.setSource(NetMusicSource.DB);
                    albumInfo.setId(albumId);
                    albumInfo.setName(albumName);
                    albumInfo.setArtist(artist);
                    albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        albumInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(albumInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 堆糖
        Callable<CommonResult<NetAlbumInfo>> searchAlbumsDt = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = HttpRequest.get(String.format(SEARCH_ALBUM_DT_API, encodedKeyword, (page - 1) * limit, limit, System.currentTimeMillis())).execute();
            String albumInfoBody = resp.body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray albumArray = data.getJSONArray("object_list");
            for (int i = 0, len = albumArray.size(); i < len; i++) {
                JSONObject albumJson = albumArray.getJSONObject(i);

                String albumId = albumJson.getString("id");
                String albumName = albumJson.getString("name");
                String artist = albumJson.getJSONObject("user").getString("username");
                String artistId = albumJson.getJSONObject("user").getString("id");
                String publishTime = TimeUtil.msToDate(albumJson.getLong("updated_at_ts") * 1000);
                String coverImgThumbUrl = albumJson.getJSONArray("covers").getString(0);
                Integer songNum = albumJson.getInt("count");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.DT);
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(albumInfo);
            }
            return new CommonResult<>(res, t);
        };
        Callable<CommonResult<NetAlbumInfo>> searchAlbumsDt2 = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = HttpRequest.get(String.format(SEARCH_ALBUM_DT_API_2, encodedKeyword, (page - 1) * limit, limit, System.currentTimeMillis())).execute();
            String albumInfoBody = resp.body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray albumArray = data.getJSONArray("object_list");
            for (int i = 0, len = albumArray.size(); i < len; i++) {
                JSONObject mainJson = albumArray.getJSONObject(i);
                JSONObject albumJson = mainJson.getJSONObject("album");

                String albumId = albumJson.getString("id");
                String albumName = albumJson.getString("name");
                String artist = mainJson.getJSONObject("sender").getString("username");
                String artistId = mainJson.getJSONObject("sender").getString("id");
                String publishTime = TimeUtil.msToDate(mainJson.getLong("add_datetime_ts") * 1000);
                String coverImgThumbUrl = albumJson.getJSONArray("covers").getString(0);
                Integer songNum = albumJson.getInt("count");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.DT);
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(albumInfo);
            }
            return new CommonResult<>(res, t);
        };

        List<Future<CommonResult<NetAlbumInfo>>> taskList = new LinkedList<>();

        if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchAlbums));
        if (src == NetMusicSource.KG || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchAlbumsKg));
        if (src == NetMusicSource.QQ || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchAlbumsQq));
        if (src == NetMusicSource.KW || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchAlbumsKw));
        if (src == NetMusicSource.MG || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchAlbumsMg));
        if (src == NetMusicSource.QI || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchAlbumsQi));
        if (src == NetMusicSource.DB || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchAlbumsDb));
        if (src == NetMusicSource.DT || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchAlbumsDt));
        if (src == NetMusicSource.DT || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchAlbumsDt2));

        List<List<NetAlbumInfo>> rl = new LinkedList<>();
        taskList.forEach(task -> {
            try {
                CommonResult<NetAlbumInfo> result = task.get();
                rl.add(result.data);
                total.set(Math.max(total.get(), result.total));
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
        albumInfos.addAll(ListUtil.joinAll(rl));

        return new CommonResult<>(albumInfos, total.get());
    }

    /**
     * 根据关键词获取歌手
     */
    public static CommonResult<NetArtistInfo> searchArtists(int src, String keyword, int limit, int page) {
        AtomicInteger total = new AtomicInteger();
        List<NetArtistInfo> artistInfos = new LinkedList<>();

        // 先对关键词编码，避免特殊符号的干扰
        String encodedKeyword = StringUtil.encode(keyword);

        // 网易云
        Callable<CommonResult<NetArtistInfo>> searchArtists = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            String artistInfoBody = HttpRequest.get(String.format(SEARCH_ARTIST_API, encodedKeyword, limit, (page - 1) * limit))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject result = artistInfoJson.optJSONObject("result");
            if (result != null) {
                t = result.getInt("artistCount");
                JSONArray artistArray = result.optJSONArray("artists");
                if (artistArray != null) {
                    for (int i = 0, len = artistArray.size(); i < len; i++) {
                        JSONObject artistJson = artistArray.getJSONObject(i);

                        String artistId = artistJson.getString("id");
                        String artistName = artistJson.getString("name");
                        Integer albumNum = artistJson.getInt("albumSize");
                        Integer mvNum = artistJson.getInt("mvSize");
                        String coverImgThumbUrl = artistJson.getString("img1v1Url");

                        NetArtistInfo artistInfo = new NetArtistInfo();
                        artistInfo.setId(artistId);
                        artistInfo.setName(artistName);
                        artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                        artistInfo.setAlbumNum(albumNum);
                        artistInfo.setMvNum(mvNum);
                        GlobalExecutors.imageExecutor.execute(() -> {
                            BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                            artistInfo.setCoverImgThumb(coverImgThumb);
                        });
                        res.add(artistInfo);
                    }
                }
            }
            return new CommonResult<>(res, t);
        };

        // QQ
        Callable<CommonResult<NetArtistInfo>> searchArtistsQq = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            String artistInfoBody = HttpRequest.post(String.format(qqSearchApi))
                    .body(String.format(qqSearchJson, page, Math.min(40, limit), keyword, 1))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject data = artistInfoJson.getJSONObject("music.search.SearchCgiService").getJSONObject("data");
            t = data.getJSONObject("meta").getInt("sum");
            JSONArray artistArray = data.getJSONObject("body").getJSONObject("singer").getJSONArray("list");
            for (int i = 0, len = artistArray.size(); i < len; i++) {
                JSONObject artistJson = artistArray.getJSONObject(i);

                String artistId = artistJson.getString("singerMID");
                String artistName = artistJson.getString("singerName");
                Integer songNum = artistJson.getInt("songNum");
                Integer albumNum = artistJson.getInt("albumNum");
                Integer mvNum = artistJson.getInt("mvNum");
                String coverImgThumbUrl = String.format(ARTIST_IMG_QQ_API, artistId);

                NetArtistInfo artistInfo = new NetArtistInfo();
                artistInfo.setSource(NetMusicSource.QQ);
                artistInfo.setId(artistId);
                artistInfo.setName(artistName);
                artistInfo.setSongNum(songNum);
                artistInfo.setAlbumNum(albumNum);
                artistInfo.setMvNum(mvNum);
                artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    artistInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(artistInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 酷我
        Callable<CommonResult<NetArtistInfo>> searchArtistsKw = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = kwRequest(String.format(SEARCH_ARTIST_KW_API, encodedKeyword, page, limit)).execute();
            // 酷我有时候会崩，先验证是否请求成功
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                String artistInfoBody = resp.body();
                JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                JSONObject data = artistInfoJson.getJSONObject("data");
                t = data.getInt("total");
                JSONArray artistArray = data.getJSONArray("list");
                for (int i = 0, len = artistArray.size(); i < len; i++) {
                    JSONObject artistJson = artistArray.getJSONObject(i);

                    String artistId = artistJson.getString("id");
                    String artistName = artistJson.getString("name");
                    Integer songNum = artistJson.getInt("musicNum");
                    String coverImgThumbUrl = artistJson.getString("pic300");

                    NetArtistInfo artistInfo = new NetArtistInfo();
                    artistInfo.setSource(NetMusicSource.KW);
                    artistInfo.setId(artistId);
                    artistInfo.setName(artistName);
                    artistInfo.setSongNum(songNum);
                    artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        artistInfo.setCoverImgThumb(coverImgThumb);
                    });
                    res.add(artistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 咪咕
        Callable<CommonResult<NetArtistInfo>> searchArtistsMg = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            String artistInfoBody = HttpRequest.get(String.format(SEARCH_ARTIST_MG_API, encodedKeyword, page, limit))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject data = artistInfoJson.optJSONObject("data");
            // 咪咕可能接口异常，需要判空！
            if (data != null) {
                t = data.optInt("total");
                JSONArray artistArray = data.getJSONArray("list");
                for (int i = 0, len = artistArray.size(); i < len; i++) {
                    JSONObject artistJson = artistArray.getJSONObject(i);

                    String artistId = artistJson.getString("id");
                    String artistName = artistJson.getString("name");
                    Integer songNum = artistJson.getInt("songCount");
                    Integer albumNum = artistJson.getInt("albumCount");
                    String coverImgThumbUrl = artistJson.getString("picUrl");

                    NetArtistInfo artistInfo = new NetArtistInfo();
                    artistInfo.setSource(NetMusicSource.MG);
                    artistInfo.setId(artistId);
                    artistInfo.setName(artistName);
                    artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    artistInfo.setSongNum(songNum);
                    artistInfo.setAlbumNum(albumNum);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        artistInfo.setCoverImgThumb(coverImgThumb);
                    });
                    res.add(artistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 千千
        Callable<CommonResult<NetArtistInfo>> searchArtistsQi = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            String artistInfoBody = HttpRequest.get(buildQianUrl(String.format(SEARCH_ARTIST_QI_API, page, limit, System.currentTimeMillis(), encodedKeyword)))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject data = artistInfoJson.optJSONObject("data");
            t = data.optInt("total");
            JSONArray artistArray = data.getJSONArray("typeArtist");
            for (int i = 0, len = artistArray.size(); i < len; i++) {
                JSONObject artistJson = artistArray.getJSONObject(i);

                String artistId = artistJson.getString("artistCode");
                String artistName = artistJson.getString("name");
                Integer songNum = artistJson.getInt("trackTotal");
                String coverImgThumbUrl = artistJson.getString("pic");

                NetArtistInfo artistInfo = new NetArtistInfo();
                artistInfo.setSource(NetMusicSource.QI);
                artistInfo.setId(artistId);
                artistInfo.setName(artistName);
                artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                artistInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    artistInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(artistInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 猫耳
        Callable<CommonResult<NetArtistInfo>> searchCVsMe = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            String artistInfoBody = HttpRequest.get(String.format(SEARCH_CV_ME_API, encodedKeyword, page, limit))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject info = artistInfoJson.optJSONObject("info");
            t = info.getJSONObject("pagination").getInt("count");
            JSONArray artistArray = info.getJSONArray("Datas");
            for (int i = 0, len = artistArray.size(); i < len; i++) {
                JSONObject artistJson = artistArray.getJSONObject(i);

                String artistId = artistJson.getString("id");
                String artistName = artistJson.getString("name");
                String coverImgThumbUrl = artistJson.getString("icon");

                NetArtistInfo artistInfo = new NetArtistInfo();
                artistInfo.setSource(NetMusicSource.ME);
                artistInfo.setId(artistId);
                artistInfo.setName(artistName);
                artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);

                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    artistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(artistInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 豆瓣
        Callable<CommonResult<NetArtistInfo>> searchArtistsDb = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            String artistInfoBody = HttpRequest.get(String.format(SEARCH_ARTIST_DB_API, encodedKeyword, (page - 1) * 15))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(artistInfoBody);
            t = Integer.parseInt(doc.select("div.rr").first().text().split("共")[1]);
            t += t / 15 * 5;
            Elements result = doc.select("div.result");
            for (int i = 0, len = result.size(); i < len; i++) {
                Element artist = result.get(i);
                Element a = artist.select(".content a").first();
                Element img = artist.select(".pic img").first();

                String artistId = ReUtil.get("celebrity/(\\d+)/", a.attr("href"), 1);
                String artistName = a.text();
                String coverImgThumbUrl = img.attr("src");

                NetArtistInfo artistInfo = new NetArtistInfo();
                artistInfo.setSource(NetMusicSource.DB);
                artistInfo.setId(artistId);
                artistInfo.setName(artistName);
                artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    artistInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(artistInfo);
            }
            return new CommonResult<>(res, t);
        };

        List<Future<CommonResult<NetArtistInfo>>> taskList = new LinkedList<>();

        if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchArtists));
        if (src == NetMusicSource.QQ || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchArtistsQq));
        if (src == NetMusicSource.KW || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchArtistsKw));
        if (src == NetMusicSource.MG || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchArtistsMg));
        if (src == NetMusicSource.QI || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchArtistsQi));
        if (src == NetMusicSource.ME || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchCVsMe));
        if (src == NetMusicSource.DB || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchArtistsDb));

        List<List<NetArtistInfo>> rl = new LinkedList<>();
        taskList.forEach(task -> {
            try {
                CommonResult<NetArtistInfo> result = task.get();
                rl.add(result.data);
                total.set(Math.max(total.get(), result.total));
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
        artistInfos.addAll(ListUtil.joinAll(rl));

        return new CommonResult<>(artistInfos, total.get());
    }

    /**
     * 根据关键词获取电台
     */
    public static CommonResult<NetRadioInfo> searchRadios(int src, String keyword, int limit, int page) {
        AtomicInteger total = new AtomicInteger();
        List<NetRadioInfo> radioInfos = new LinkedList<>();

        // 先对关键词编码，避免特殊符号的干扰
        String encodedKeyword = StringUtil.encode(keyword);

        // 网易云
        Callable<CommonResult<NetRadioInfo>> searchRadios = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            String radioInfoBody = HttpRequest.get(String.format(SEARCH_RADIO_API, encodedKeyword, (page - 1) * limit, limit))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONObject result = radioInfoJson.getJSONObject("result");
            if (!result.isEmpty()) {
                t = result.getInt("djRadiosCount");
                JSONArray radioArray = result.getJSONArray("djRadios");
                for (int i = 0, len = radioArray.size(); i < len; i++) {
                    JSONObject radioJson = radioArray.getJSONObject(i);

                    String radioId = radioJson.getString("id");
                    String radioName = radioJson.getString("name");
                    String dj = radioJson.getJSONObject("dj").getString("nickname");
                    String djId = radioJson.getJSONObject("dj").getString("userId");
                    Long playCount = radioJson.getLong("playCount");
                    Integer trackCount = radioJson.getInt("programCount");
                    String category = radioJson.getString("category");
                    if (!category.isEmpty()) category += "、" + radioJson.getString("secondCategory");
                    String coverImgThumbUrl = radioJson.getString("picUrl");
//                String createTime = TimeUtils.msToDate(radioJson.getLong("createTime"));

                    NetRadioInfo radioInfo = new NetRadioInfo();
                    radioInfo.setId(radioId);
                    radioInfo.setName(radioName);
                    radioInfo.setDj(dj);
                    radioInfo.setDjId(djId);
                    radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    radioInfo.setPlayCount(playCount);
                    radioInfo.setTrackCount(trackCount);
                    radioInfo.setCategory(category);
//                radioInfo.setCreateTime(createTime);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        radioInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(radioInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 喜马拉雅
        Callable<CommonResult<NetRadioInfo>> searchRadiosXm = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            String radioInfoBody = HttpRequest.get(String.format(SEARCH_RADIO_XM_API, encodedKeyword, page, limit))
                    .header(Header.USER_AGENT, USER_AGENT)
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONObject data = radioInfoJson.getJSONObject("data").getJSONObject("album");
            t = data.getInt("total");
            JSONArray radioArray = data.getJSONArray("docs");
            for (int i = 0, len = radioArray.size(); i < len; i++) {
                JSONObject radioJson = radioArray.getJSONObject(i);

                String radioId = radioJson.getString("albumId");
                String radioName = radioJson.getString("title");
                String dj = radioJson.getString("nickname");
                String djId = radioJson.getString("uid");
                String coverImgThumbUrl = radioJson.getString("coverPath");
                Long playCount = radioJson.getLong("playCount");
                Integer trackCount = radioJson.getInt("tracksCount");
                String category = radioJson.getString("categoryTitle");

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setSource(NetMusicSource.XM);
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                radioInfo.setDj(dj);
                radioInfo.setDjId(djId);
                radioInfo.setPlayCount(playCount);
                radioInfo.setTrackCount(trackCount);
                radioInfo.setCategory(category);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 猫耳
        Callable<CommonResult<NetRadioInfo>> searchRadiosMe = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            String radioInfoBody = HttpRequest.get(String.format(SEARCH_RADIO_ME_API, encodedKeyword, page, limit))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONObject data = radioInfoJson.getJSONObject("info");
            t = data.getJSONObject("pagination").getInt("count");
            JSONArray radioArray = data.getJSONArray("Datas");
            for (int i = 0, len = radioArray.size(); i < len; i++) {
                JSONObject radioJson = radioArray.getJSONObject(i);

                String radioId = radioJson.getString("id");
                String radioName = radioJson.getString("name");
                String dj = radioJson.getString("author");
                String coverImgThumbUrl = radioJson.getString("cover");
                Long playCount = radioJson.getLong("view_count");
                String category = radioJson.getString("catalog_name");

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setSource(NetMusicSource.ME);
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                radioInfo.setDj(dj);
                radioInfo.setPlayCount(playCount);
                radioInfo.setCategory(category);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 豆瓣
        Callable<CommonResult<NetRadioInfo>> searchRadiosDb = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            final int lim = Math.min(20, limit);
            String radioInfoBody = HttpRequest.get(String.format(SEARCH_RADIO_DB_API, encodedKeyword, (page - 1) * lim))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONArray radioArray = radioInfoJson.optJSONArray("items");
            if (radioArray != null) {
                t = radioInfoJson.getInt("total");
                for (int i = 0, len = radioArray.size(); i < len; i++) {
                    Document doc = Jsoup.parse(radioArray.getString(i));
                    Elements result = doc.select("div.result");
                    Elements a = result.select("h3 a");
                    Elements span = result.select(".title h3 span");

                    String radioId = ReUtil.get("sid: (\\d+)", a.attr("onclick"), 1);
                    String radioName = a.text().trim();
                    String dj = result.select("span.subject-cast").text();
                    String coverImgThumbUrl = result.select("div.pic img").attr("src");
                    String category = ReUtil.get("\\[(.*?)\\]", span.text(), 1);

                    NetRadioInfo radioInfo = new NetRadioInfo();
                    radioInfo.setSource(NetMusicSource.DB);
                    radioInfo.setId(radioId);
                    radioInfo.setName(radioName);
                    radioInfo.setDj(dj);
                    radioInfo.setCategory(category);
                    radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        radioInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(radioInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 豆瓣图书
        Callable<CommonResult<NetRadioInfo>> searchBookRadiosDb = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            final int lim = Math.min(20, limit);
            String radioInfoBody = HttpRequest.get(String.format(SEARCH_BOOK_RADIO_DB_API, encodedKeyword, (page - 1) * lim))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONArray radioArray = radioInfoJson.optJSONArray("items");
            if (radioArray != null) {
                t = radioInfoJson.getInt("total");
                for (int i = 0, len = radioArray.size(); i < len; i++) {
                    Document doc = Jsoup.parse(radioArray.getString(i));
                    Elements result = doc.select("div.result");
                    Elements a = result.select("h3 a");
                    Elements span = result.select(".title h3 span");

                    String radioId = ReUtil.get("sid: (\\d+)", a.attr("onclick"), 1);
                    String radioName = a.text().trim();
                    String dj = result.select("span.subject-cast").text();
                    String coverImgThumbUrl = result.select("div.pic img").attr("src");
                    String category = ReUtil.get("\\[(.*?)\\]", span.text(), 1);

                    NetRadioInfo radioInfo = new NetRadioInfo();
                    radioInfo.setType(RadioType.BOOK);
                    radioInfo.setSource(NetMusicSource.DB);
                    radioInfo.setId(radioId);
                    radioInfo.setName(radioName);
                    radioInfo.setDj(dj);
                    radioInfo.setCategory(category);
                    radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        radioInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(radioInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 豆瓣游戏
        Callable<CommonResult<NetRadioInfo>> searchGameRadiosDb = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            final int lim = Math.min(20, limit);
            String radioInfoBody = HttpRequest.get(String.format(SEARCH_GAME_RADIO_DB_API, encodedKeyword, (page - 1) * lim))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONArray radioArray = radioInfoJson.optJSONArray("items");
            if (radioArray != null) {
                t = radioInfoJson.getInt("total");
                for (int i = 0, len = radioArray.size(); i < len; i++) {
                    Document doc = Jsoup.parse(radioArray.getString(i));
                    Elements result = doc.select("div.result");
                    Elements a = result.select("h3 a");
                    Elements span = result.select(".title h3 span");

                    String radioId = ReUtil.get("sid: (\\d+)", a.attr("onclick"), 1);
                    String radioName = a.text().trim();
                    String dj = result.select("span.subject-cast").text();
                    String coverImgThumbUrl = result.select("div.pic img").attr("src");
                    String category = ReUtil.get("\\[(.*?)\\]", span.text(), 1);

                    NetRadioInfo radioInfo = new NetRadioInfo();
                    radioInfo.setType(RadioType.GAME);
                    radioInfo.setSource(NetMusicSource.DB);
                    radioInfo.setId(radioId);
                    radioInfo.setName(radioName);
                    radioInfo.setDj(dj);
                    radioInfo.setCategory(category);
                    radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        radioInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(radioInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        List<Future<CommonResult<NetRadioInfo>>> taskList = new LinkedList<>();

        if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchRadios));
        if (src == NetMusicSource.XM || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchRadiosXm));
        if (src == NetMusicSource.ME || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchRadiosMe));
        if (src == NetMusicSource.DB || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchRadiosDb));
        if (src == NetMusicSource.DB || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchBookRadiosDb));
        if (src == NetMusicSource.DB || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchGameRadiosDb));

        List<List<NetRadioInfo>> rl = new LinkedList<>();
        taskList.forEach(task -> {
            try {
                CommonResult<NetRadioInfo> result = task.get();
                rl.add(result.data);
                total.set(Math.max(total.get(), result.total));
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
        radioInfos.addAll(ListUtil.joinAll(rl));

        return new CommonResult<>(radioInfos, total.get());
    }

    /**
     * 根据关键词获取 MV
     */
    public static CommonResult<NetMvInfo> searchMvs(int src, String keyword, int limit, int page) {
        AtomicInteger total = new AtomicInteger();
        List<NetMvInfo> mvInfos = new LinkedList<>();
//        Set<NetMvInfo> set = Collections.synchronizedSet(new HashSet<>());

        // 先对关键词编码，避免特殊符号的干扰
        String encodedKeyword = StringUtil.encode(keyword);

        // 网易云
        // MV
        Callable<CommonResult<NetMvInfo>> searchMvs = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            String mvInfoBody = HttpRequest.get(String.format(SEARCH_MV_API, encodedKeyword, limit, (page - 1) * limit))
                    .execute()
                    .body();
            JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
            JSONObject result = mvInfoJson.getJSONObject("result");
            if (!result.isEmpty()) {
                t = result.getInt("mvCount");
                JSONArray mvArray = result.getJSONArray("mvs");
                for (int i = 0, len = mvArray.size(); i < len; i++) {
                    JSONObject mvJson = mvArray.getJSONObject(i);

                    String mvId = mvJson.getString("id");
                    String mvName = mvJson.getString("name").trim();
                    String artistName = parseArtists(mvJson, NetMusicSource.NET_CLOUD);
                    String creatorId = mvJson.getJSONArray("artists").getJSONObject(0).getString("id");
                    Long playCount = mvJson.getLong("playCount");
                    Double duration = mvJson.getDouble("duration") / 1000;
                    String coverImgUrl = mvJson.getString("cover");

                    NetMvInfo mvInfo = new NetMvInfo();
                    mvInfo.setId(mvId);
                    mvInfo.setName(mvName);
                    mvInfo.setArtist(artistName);
                    mvInfo.setCreatorId(creatorId);
                    mvInfo.setPlayCount(playCount);
                    mvInfo.setDuration(duration);
                    mvInfo.setCoverImgUrl(coverImgUrl);

                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                        mvInfo.setCoverImgThumb(coverImgThumb);
                    });
                    res.add(mvInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 视频
        Callable<CommonResult<NetMvInfo>> searchVideos = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            String mvInfoBody = HttpRequest.get(String.format(SEARCH_VIDEO_API, encodedKeyword, limit, (page - 1) * limit))
                    .execute()
                    .body();
            JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
            JSONObject result = mvInfoJson.getJSONObject("result");
            if (!result.isEmpty()) {
                t = result.getInt("videoCount");
                JSONArray mvArray = result.getJSONArray("videos");
                for (int i = 0, len = mvArray.size(); i < len; i++) {
                    JSONObject mvJson = mvArray.getJSONObject(i);

                    Integer type = mvJson.getInt("type");
                    String mvId = mvJson.getString("vid");
                    String mvName = mvJson.getString("title");
                    String creators = parseCreators(mvJson);
                    String creatorId = mvJson.getJSONArray("creator").getJSONObject(0).getString("userId");
                    Long playCount = mvJson.getLong("playTime");
                    Double duration = mvJson.getDouble("durationms") / 1000;
                    String coverImgUrl = mvJson.getString("coverUrl");

                    NetMvInfo mvInfo = new NetMvInfo();
                    // 网易云视频和 MV 分开了
                    mvInfo.setType(type == 1 ? MvInfoType.VIDEO : MvInfoType.MV);
                    mvInfo.setId(mvId);
                    mvInfo.setName(mvName);
                    mvInfo.setArtist(creators);
                    mvInfo.setCreatorId(creatorId);
                    mvInfo.setPlayCount(playCount);
                    mvInfo.setDuration(duration);
                    mvInfo.setCoverImgUrl(coverImgUrl);

                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                        mvInfo.setCoverImgThumb(coverImgThumb);
                    });
                    res.add(mvInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 酷狗
        Callable<CommonResult<NetMvInfo>> searchMvsKg = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            String mvInfoBody = HttpRequest.get(String.format(SEARCH_MV_KG_API, encodedKeyword, page, limit))
                    .execute()
                    .body();
            JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
            JSONObject data = mvInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray mvArray = data.getJSONArray("info");
            for (int i = 0, len = mvArray.size(); i < len; i++) {
                JSONObject mvJson = mvArray.getJSONObject(i);

                String mvId = mvJson.getString("hash");
                // 酷狗返回的名称含有 HTML 标签，需要去除
                String mvName = StringUtil.removeHTMLLabel(mvJson.getString("filename"));
                String artistName = StringUtil.removeHTMLLabel(mvJson.getString("singername"));
                String creatorId = mvJson.getString("userid");
                Long playCount = mvJson.getLong("historyheat");
                Double duration = mvJson.getDouble("duration");
                String pubTime = mvJson.getString("publishdate").split(" ")[0];
                String coverImgUrl = mvJson.getString("imgurl").replace("/{size}", "");

                NetMvInfo mvInfo = new NetMvInfo();
                mvInfo.setSource(NetMusicSource.KG);
                // 酷狗搜索 MV 只给了用户 id，默认全是视频
                mvInfo.setType(MvInfoType.VIDEO);
                mvInfo.setId(mvId);
                mvInfo.setName(mvName);
                mvInfo.setArtist(artistName);
                mvInfo.setCreatorId(creatorId);
                mvInfo.setPlayCount(playCount);
                mvInfo.setDuration(duration);
                mvInfo.setPubTime(pubTime);
                mvInfo.setCoverImgUrl(coverImgUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                    mvInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(mvInfo);
            }
            return new CommonResult<>(res, t);
        };

        // QQ
        Callable<CommonResult<NetMvInfo>> searchMvsQq = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            String mvInfoBody = HttpRequest.post(String.format(qqSearchApi))
                    .body(String.format(qqSearchJson, page, limit, keyword, 4))
                    .execute()
                    .body();
            JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
            JSONObject data = mvInfoJson.getJSONObject("music.search.SearchCgiService").getJSONObject("data");
            t = data.getJSONObject("meta").getInt("sum");
            JSONArray mvArray = data.getJSONObject("body").getJSONObject("mv").getJSONArray("list");
            for (int i = 0, len = mvArray.size(); i < len; i++) {
                JSONObject mvJson = mvArray.getJSONObject(i);

                String mvId = mvJson.getString("v_id");
                String mvName = mvJson.getString("mv_name").trim();
                String artistName = parseArtists(mvJson, NetMusicSource.QQ);
                String creatorId = mvJson.getJSONArray("singer_list").getJSONObject(0).getString("mid");
                Long playCount = mvJson.getLong("play_count");
                Double duration = mvJson.getDouble("duration");
                String pubTime = mvJson.getString("publish_date");
                String coverImgUrl = mvJson.getString("mv_pic_url").replaceFirst("http:", "https:");

                NetMvInfo mvInfo = new NetMvInfo();
                mvInfo.setSource(NetMusicSource.QQ);
                mvInfo.setId(mvId);
                mvInfo.setName(mvName);
                mvInfo.setArtist(artistName);
                mvInfo.setCreatorId(creatorId);
                mvInfo.setPlayCount(playCount);
                mvInfo.setDuration(duration);
                mvInfo.setPubTime(pubTime);
                mvInfo.setCoverImgUrl(coverImgUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                    mvInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(mvInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 酷我
        Callable<CommonResult<NetMvInfo>> searchMvsKw = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = kwRequest(String.format(SEARCH_MV_KW_API, encodedKeyword, page, limit)).execute();
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                String mvInfoBody = resp.body();
                JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
                JSONObject data = mvInfoJson.getJSONObject("data");
                t = data.getInt("total");
                JSONArray mvArray = data.getJSONArray("mvlist");
                for (int i = 0, len = mvArray.size(); i < len; i++) {
                    JSONObject mvJson = mvArray.getJSONObject(i);

                    String mvId = mvJson.getString("id");
                    String mvName = mvJson.getString("name").trim();
                    String artistName = mvJson.getString("artist");
                    String creatorId = mvJson.getString("artistid");
                    Long playCount = mvJson.getLong("mvPlayCnt");
                    Double duration = mvJson.getDouble("duration");
                    String coverImgUrl = mvJson.getString("pic");

                    NetMvInfo mvInfo = new NetMvInfo();
                    mvInfo.setSource(NetMusicSource.KW);
                    mvInfo.setId(mvId);
                    mvInfo.setName(mvName);
                    mvInfo.setArtist(artistName);
                    mvInfo.setCreatorId(creatorId);
                    mvInfo.setPlayCount(playCount);
                    mvInfo.setDuration(duration);
                    mvInfo.setCoverImgUrl(coverImgUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                        mvInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(mvInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 好看
        Callable<CommonResult<NetMvInfo>> searchMvsHk = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = HttpRequest.get(String.format(SEARCH_MV_HK_API, encodedKeyword, page, limit))
                    .header(Header.COOKIE, HK_COOKIE)
                    .execute();
            String mvInfoBody = resp.body();
            JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
            JSONObject data = mvInfoJson.getJSONObject("data");
            t = page * limit;
            if (data.getInt("has_more") == 1) t++;
            JSONArray mvArray = data.getJSONArray("list");
            for (int i = 0, len = mvArray.size(); i < len; i++) {
                JSONObject mvJson = mvArray.getJSONObject(i);

                String mvId = mvJson.getString("vid");
                String mvName = mvJson.getString("title");
                String artistName = mvJson.getString("author");
                String creatorId = mvJson.getString("author_id");
                Long playCount = StringUtil.parseNumber(mvJson.getString("read_num").replaceFirst("次播放", ""));
                Double duration = TimeUtil.toSeconds(mvJson.getString("duration"));
                String pubTime = mvJson.getString("publishTimeText");
                String coverImgUrl = mvJson.getString("cover_src");

                NetMvInfo mvInfo = new NetMvInfo();
                mvInfo.setSource(NetMusicSource.HK);
                mvInfo.setId(mvId);
                mvInfo.setName(mvName);
                mvInfo.setArtist(artistName);
                mvInfo.setCreatorId(creatorId);
                mvInfo.setPlayCount(playCount);
                mvInfo.setDuration(duration);
                mvInfo.setPubTime(pubTime);
                mvInfo.setCoverImgUrl(coverImgUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                    mvInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(mvInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 哔哩哔哩
        Callable<CommonResult<NetMvInfo>> searchMvsBi = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = HttpRequest.get(String.format(SEARCH_MV_BI_API, encodedKeyword, page))
                    .cookie(BI_COOKIE)
                    .execute();
            String mvInfoBody = resp.body();
            JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
            JSONObject data = mvInfoJson.getJSONObject("data");
            t = data.getInt("numResults");
            JSONArray mvArray = data.getJSONArray("result");
            for (int i = 0, len = mvArray.size(); i < len; i++) {
                JSONObject mvJson = mvArray.getJSONObject(i);

                String bvId = mvJson.getString("bvid");
                String mvName = StringUtil.removeHTMLLabel(mvJson.getString("title"));
                String artistName = mvJson.getString("author");
                String creatorId = mvJson.getString("mid");
                Long playCount = mvJson.getLong("play");
                Double duration = TimeUtil.toSeconds(mvJson.getString("duration"));
                String pubTime = TimeUtil.msToDate(mvJson.getLong("pubdate") * 1000);
                String coverImgUrl = "https:" + mvJson.getString("pic");

                NetMvInfo mvInfo = new NetMvInfo();
                mvInfo.setSource(NetMusicSource.BI);
                mvInfo.setBvid(bvId);
                mvInfo.setName(mvName);
                mvInfo.setArtist(artistName);
                mvInfo.setCreatorId(creatorId);
                mvInfo.setPlayCount(playCount);
                mvInfo.setDuration(duration);
                mvInfo.setPubTime(pubTime);
                mvInfo.setCoverImgUrl(coverImgUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                    mvInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(mvInfo);
            }
            return new CommonResult<>(res, t);
        };

        List<Future<CommonResult<NetMvInfo>>> taskList = new LinkedList<>();

        if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchMvs));
        if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchVideos));
        if (src == NetMusicSource.KG || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchMvsKg));
        if (src == NetMusicSource.QQ || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchMvsQq));
        if (src == NetMusicSource.KW || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchMvsKw));
        if (src == NetMusicSource.HK || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchMvsHk));
        if (src == NetMusicSource.BI || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchMvsBi));

        List<List<NetMvInfo>> rl = new LinkedList<>();
        taskList.forEach(task -> {
            try {
                CommonResult<NetMvInfo> result = task.get();
                rl.add(result.data);
                total.set(Math.max(total.get(), result.total));
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
        mvInfos.addAll(ListUtil.joinAll(rl));

        return new CommonResult<>(mvInfos, total.get());
    }

    /**
     * 获取所有榜单
     */
    public static CommonResult<NetRankingInfo> getRankings(int src) {
        AtomicInteger total = new AtomicInteger();
        List<NetRankingInfo> rankingInfos = new LinkedList<>();

        // 网易云
        Callable<CommonResult<NetRankingInfo>> getRankings = () -> {
            LinkedList<NetRankingInfo> res = new LinkedList<>();
            Integer t = 0;

            String rankingInfoBody = HttpRequest.get(String.format(GET_RANKING_API))
                    .execute()
                    .body();
            JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
            JSONArray rankingArray = rankingInfoJson.getJSONArray("list");
            for (int i = 0, len = rankingArray.size(); i < len; i++) {
                JSONObject rankingJson = rankingArray.getJSONObject(i);

                String rankingId = rankingJson.getString("id");
                String rankingName = rankingJson.getString("name");
                String coverImgUrl = rankingJson.getString("coverImgUrl");
                String description = rankingJson.getString("description");
                Long playCount = rankingJson.getLong("playCount");
                String updateFre = rankingJson.getString("updateFrequency");
                String updateTime = TimeUtil.msToDate(rankingJson.getLong("trackUpdateTime"));

                NetRankingInfo rankingInfo = new NetRankingInfo();
                rankingInfo.setId(rankingId);
                rankingInfo.setName(rankingName);
                rankingInfo.setCoverImgUrl(coverImgUrl);
                rankingInfo.setDescription(description.equals("null") ? "" : description);
                rankingInfo.setPlayCount(playCount);
                rankingInfo.setUpdateFre(updateFre);
                rankingInfo.setUpdateTime(updateTime);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgUrl);
                    rankingInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(rankingInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 酷狗
        Callable<CommonResult<NetRankingInfo>> getRankingsKg = () -> {
            LinkedList<NetRankingInfo> res = new LinkedList<>();
            Integer t = 0;

            String rankingInfoBody = HttpRequest.get(String.format(GET_RANKING_KG_API))
                    .execute()
                    .body();
            JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
            JSONArray rankingArray = rankingInfoJson.getJSONObject("data").getJSONArray("info");
            for (int i = 0, len = rankingArray.size(); i < len; i++) {
                JSONObject rankingJson = rankingArray.getJSONObject(i);

                String rankingId = rankingJson.getString("rankid");
                String rankingName = rankingJson.getString("rankname");
                String coverImgUrl = rankingJson.getString("banner_9").replace("/{size}", "");
                String description = rankingJson.getString("intro");
                String updateFre = rankingJson.getString("update_frequency");
                Long playCount = rankingJson.getLong("play_times");

                NetRankingInfo rankingInfo = new NetRankingInfo();
                rankingInfo.setSource(NetMusicSource.KG);
                rankingInfo.setId(rankingId);
                rankingInfo.setName(rankingName);
                rankingInfo.setCoverImgUrl(coverImgUrl);
                rankingInfo.setDescription(description);
                rankingInfo.setUpdateFre(updateFre);
                rankingInfo.setPlayCount(playCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgUrl);
                    rankingInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(rankingInfo);
            }
            return new CommonResult<>(res, t);
        };

        // QQ
        Callable<CommonResult<NetRankingInfo>> getRankingsQq = () -> {
            LinkedList<NetRankingInfo> res = new LinkedList<>();
            Integer t = 0;

            String rankingInfoBody = HttpRequest.get(String.format(GET_RANKING_QQ_API))
                    .execute()
                    .body();
            JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
            JSONArray data = rankingInfoJson.getJSONArray("data");
            for (int i = 0, len = data.size(); i < len; i++) {
                JSONArray rankingArray = data.getJSONObject(i).getJSONArray("list");
                for (int j = 0, s = rankingArray.size(); j < s; j++) {
                    JSONObject rankingJson = rankingArray.getJSONObject(j);

                    String rankingId = rankingJson.getString("topId");
                    String rankingName = rankingJson.getString("label");
                    String coverImgUrl = rankingJson.getString("picUrl").replaceFirst("http:", "https:");
                    Long playCount = rankingJson.getLong("listenNum");
                    String updateTime = rankingJson.getString("updateTime");

                    NetRankingInfo rankingInfo = new NetRankingInfo();
                    rankingInfo.setSource(NetMusicSource.QQ);
                    rankingInfo.setId(rankingId);
                    rankingInfo.setName(rankingName);
                    rankingInfo.setCoverImgUrl(coverImgUrl);
                    rankingInfo.setPlayCount(playCount);
                    rankingInfo.setUpdateTime(updateTime);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgUrl);
                        rankingInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(rankingInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        Callable<CommonResult<NetRankingInfo>> getRankingsQq2 = () -> {
            LinkedList<NetRankingInfo> res = new LinkedList<>();
            Integer t = 0;

            String rankingInfoBody = HttpRequest.get(String.format(GET_RANKING_QQ_API_2))
                    .execute()
                    .body();
            JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
            JSONArray data = rankingInfoJson.getJSONObject("data").getJSONArray("topList");
            for (int i = 0, len = data.size(); i < len; i++) {
                JSONObject rankingJson = data.getJSONObject(i);

                String rankingId = rankingJson.getString("id");
                String rankingName = rankingJson.getString("topTitle");
                String coverImgUrl = rankingJson.getString("picUrl").replaceFirst("http:", "https:");
                Long playCount = rankingJson.getLong("listenCount");

                NetRankingInfo rankingInfo = new NetRankingInfo();
                rankingInfo.setSource(NetMusicSource.QQ);
                rankingInfo.setId(rankingId);
                rankingInfo.setName(rankingName);
                rankingInfo.setCoverImgUrl(coverImgUrl);
                rankingInfo.setPlayCount(playCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgUrl);
                    rankingInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(rankingInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 酷我
        // 所有榜单
        Callable<CommonResult<NetRankingInfo>> getRankingsKw = () -> {
            LinkedList<NetRankingInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = kwRequest(String.format(GET_RANKING_KW_API)).execute();
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                String rankingInfoBody = resp.body();
                JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
                JSONArray data = rankingInfoJson.getJSONArray("data");
                for (int i = 0, len = data.size(); i < len; i++) {
                    JSONArray rankingArray = data.getJSONObject(i).getJSONArray("list");
                    for (int j = 0, s = rankingArray.size(); j < s; j++) {
                        JSONObject rankingJson = rankingArray.getJSONObject(j);

                        String rankingId = rankingJson.getString("sourceid");
                        String rankingName = rankingJson.getString("name");
                        String coverImgUrl = rankingJson.getString("pic");
                        String description = rankingJson.getString("intro");
                        String updateFre = rankingJson.getString("pub");

                        NetRankingInfo rankingInfo = new NetRankingInfo();
                        rankingInfo.setSource(NetMusicSource.KW);
                        rankingInfo.setId(rankingId);
                        rankingInfo.setName(rankingName);
                        rankingInfo.setCoverImgUrl(coverImgUrl);
                        rankingInfo.setUpdateFre(updateFre);
                        rankingInfo.setDescription(description);
                        GlobalExecutors.imageExecutor.execute(() -> {
                            BufferedImage coverImgThumb = extractProfile(coverImgUrl);
                            rankingInfo.setCoverImgThumb(coverImgThumb);
                        });

                        res.add(rankingInfo);
                    }
                }
            }
            return new CommonResult<>(res, t);
        };
        Callable<CommonResult<NetRankingInfo>> getRankingsKw2 = () -> {
            LinkedList<NetRankingInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = HttpRequest.get(String.format(GET_RANKING_KW_API_2)).execute();
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                String rankingInfoBody = resp.body();
                JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
                JSONArray data = rankingInfoJson.getJSONArray("child");
                for (int i = 0, len = data.size(); i < len; i++) {
                    JSONObject rankingJson = data.getJSONObject(i);

                    String rankingId = rankingJson.getString("sourceid");
                    String rankingName = rankingJson.getString("name");
                    String coverImgUrl = rankingJson.getString("pic");
                    String updateTime = rankingJson.getString("info").replaceFirst("更新于", "");

                    NetRankingInfo rankingInfo = new NetRankingInfo();
                    rankingInfo.setSource(NetMusicSource.KW);
                    rankingInfo.setId(rankingId);
                    rankingInfo.setName(rankingName);
                    rankingInfo.setCoverImgUrl(coverImgUrl);
                    rankingInfo.setUpdateTime(updateTime);
                    rankingInfo.setDescription("");
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgUrl);
                        rankingInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(rankingInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 推荐榜单
//        Callable<CommonResult<NetRankingInfo>> getRecRankingsKw = () -> {
//            LinkedList<NetRankingInfo> res = new LinkedList<>();
//            Integer t = 0;
//
//            HttpResponse resp = kwRequest(String.format(GET_REC_RANKING_KW_API))
//                    .header(Header.REFERER, "http://www.kuwo.cn/rankList")
//                    .execute();
//            if (resp.getStatus() == HttpStatus.HTTP_OK) {
//                String rankingInfoBody = resp.body();
//                JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
//                JSONArray data = rankingInfoJson.getJSONArray("data");
//                for (int i = 0, len = data.size(); i < len; i++) {
//                    JSONObject rankingJson = data.getJSONObject(i);
//
//                    String rankingId = rankingJson.getString("id");
//                    String rankingName = rankingJson.getString("name");
//                    String coverImgUrl = rankingJson.getString("pic");
//                    String updateTime = rankingJson.getString("pub");
//                    String desc = "";
//
//                    NetRankingInfo rankingInfo = new NetRankingInfo();
//                    rankingInfo.setSource(NetMusicSource.KW);
//                    rankingInfo.setId(rankingId);
//                    rankingInfo.setName(rankingName);
//                    rankingInfo.setCoverImgUrl(coverImgUrl);
//                    rankingInfo.setUpdateTime(updateTime);
//                    rankingInfo.setDescription(desc);
//                    GlobalExecutors.imageExecutor.execute(() -> {
//                        BufferedImage coverImgThumb = extractProfile(coverImgUrl);
//                        rankingInfo.setCoverImgThumb(coverImgThumb);
//                    });
//
//                    res.add(rankingInfo);
//                }
//            }
//            return new CommonResult<>(res, t);
//        };

        // 咪咕
        Callable<CommonResult<NetRankingInfo>> getRankingsMg = () -> {
            LinkedList<NetRankingInfo> res = new LinkedList<>();
            Integer t = 0;

            String rankingInfoBody = HttpRequest.get(String.format(GET_RANKING_MG_API))
                    .execute()
                    .body();
            JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
            JSONObject data = rankingInfoJson.getJSONObject("data");
            JSONArray contentItemList = data.getJSONArray("contentItemList");
            for (int i = 0, len = contentItemList.size(); i < len; i++) {
                JSONArray itemList = contentItemList.getJSONObject(i).optJSONArray("itemList");
                if (itemList != null) {
                    for (int j = 0, s = itemList.size(); j < s; j++) {
                        JSONObject item = itemList.getJSONObject(j);

                        String template = item.getString("template");
                        if (template.equals("row1") || template.equals("grid1")) {
                            JSONObject param = item.getJSONObject("displayLogId").getJSONObject("param");

                            String rankingId = param.getString("rankId");
                            String rankingName = param.getString("rankName");
                            String coverImgUrl = item.getString("imageUrl");
                            String updateFre = item.getJSONArray("barList").getJSONObject(0).getString("title");

                            NetRankingInfo rankingInfo = new NetRankingInfo();
                            rankingInfo.setSource(NetMusicSource.MG);
                            rankingInfo.setId(rankingId);
                            rankingInfo.setName(rankingName);
                            rankingInfo.setUpdateFre(updateFre);
                            rankingInfo.setCoverImgUrl(coverImgUrl);
//                        rankingInfo.setPlayCount(playCount);
//                        rankingInfo.setUpdateTime(updateTime);
                            GlobalExecutors.imageExecutor.execute(() -> {
                                BufferedImage coverImgThumb = extractProfile(coverImgUrl);
                                rankingInfo.setCoverImgThumb(coverImgThumb);
                            });

                            res.add(rankingInfo);
                        }
                    }
                }
            }
            return new CommonResult<>(res, t);
        };

        // 千千
        Callable<CommonResult<NetRankingInfo>> getRankingsQi = () -> {
            LinkedList<NetRankingInfo> res = new LinkedList<>();
            Integer t = 0;

            String rankingInfoBody = HttpRequest.get(buildQianUrl(String.format(GET_RANKING_QI_API, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
            JSONArray rankingArray = rankingInfoJson.getJSONArray("data");
            for (int i = 0, len = rankingArray.size(); i < len; i++) {
                JSONObject rankingJson = rankingArray.getJSONObject(i);

                String rankingId = rankingJson.getString("bdid");
                String rankingName = rankingJson.getString("title");
                String coverImgUrl = rankingJson.getString("pic");

                NetRankingInfo rankingInfo = new NetRankingInfo();
                rankingInfo.setSource(NetMusicSource.QI);
                rankingInfo.setId(rankingId);
                rankingInfo.setName(rankingName);
                rankingInfo.setCoverImgUrl(coverImgUrl);
                rankingInfo.setDescription("");
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgUrl);
                    rankingInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(rankingInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 猫耳
        Callable<CommonResult<NetRankingInfo>> getRankingsMe = () -> {
            LinkedList<NetRankingInfo> res = new LinkedList<>();
            Integer t = 0;

            String rankingInfoBody = HttpRequest.get(String.format(GET_RANKING_ME_API))
                    .execute()
                    .body();
            JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
            JSONArray rankingArray = rankingInfoJson.getJSONArray("info");
            for (int i = 0, len = rankingArray.size(); i < len; i++) {
                JSONObject rankingJson = rankingArray.getJSONObject(i).getJSONObject("album");

                String rankingId = rankingJson.getString("id");
                String rankingName = rankingJson.getString("title");
                String coverImgUrl = rankingJson.getString("front_cover");
                String updateTime = TimeUtil.msToDate(rankingJson.getLong("last_update_time") * 1000);
                Long playCount = rankingJson.getLong("view_count");

                NetRankingInfo rankingInfo = new NetRankingInfo();
                rankingInfo.setSource(NetMusicSource.ME);
                rankingInfo.setId(rankingId);
                rankingInfo.setName(rankingName);
                rankingInfo.setCoverImgUrl(coverImgUrl);
                rankingInfo.setUpdateTime(updateTime);
                rankingInfo.setPlayCount(playCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgUrl);
                    rankingInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(rankingInfo);
            }
            return new CommonResult<>(res, t);
        };

        List<Future<CommonResult<NetRankingInfo>>> taskList = new LinkedList<>();

        if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(getRankings));
        if (src == NetMusicSource.KG || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(getRankingsKg));
        if (src == NetMusicSource.QQ || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(getRankingsQq));
        if (src == NetMusicSource.QQ || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(getRankingsQq2));
        if (src == NetMusicSource.KW || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(getRankingsKw));
        if (src == NetMusicSource.KW || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(getRankingsKw2));
//        taskList.add(GlobalExecutors.requestExecutor.submit(getRecRankingsKw));
        if (src == NetMusicSource.MG || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(getRankingsMg));
        if (src == NetMusicSource.QI || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(getRankingsQi));
        if (src == NetMusicSource.ME || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(getRankingsMe));

        List<List<NetRankingInfo>> rl = new LinkedList<>();
        taskList.forEach(task -> {
            try {
                CommonResult<NetRankingInfo> result = task.get();
                rl.add(result.data);
                total.set(Math.max(total.get(), result.total));
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
        rankingInfos.addAll(ListUtil.joinAll(rl));

        return new CommonResult<>(rankingInfos, total.get());
    }

    /**
     * 根据关键词获取用户
     */
    public static CommonResult<NetUserInfo> searchUsers(int src, String keyword, int limit, int page) {
        AtomicInteger total = new AtomicInteger();
        List<NetUserInfo> userInfos = new LinkedList<>();

        // 先对关键词编码，避免特殊符号的干扰
        String encodedKeyword = StringUtil.encode(keyword);

        // 网易云
        Callable<CommonResult<NetUserInfo>> searchUsers = () -> {
            LinkedList<NetUserInfo> res = new LinkedList<>();
            Integer t = 0;

            String userInfoBody = HttpRequest.get(String.format(SEARCH_USER_API, encodedKeyword, (page - 1) * limit, limit))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject result = userInfoJson.getJSONObject("result");
            if (!result.isEmpty()) {
                t = result.getInt("userprofileCount");
                JSONArray userArray = result.getJSONArray("userprofiles");
                for (int i = 0, len = userArray.size(); i < len; i++) {
                    JSONObject userJson = userArray.getJSONObject(i);

                    String userId = userJson.getString("userId");
                    String userName = userJson.getString("nickname");
                    Integer gen = userJson.getInt("gender");
                    String gender = gen == 0 ? "保密" : gen == 1 ? "♂ 男" : "♀ 女";
                    String avatarThumbUrl = userJson.getString("avatarUrl");
                    Integer follow = userJson.getInt("follows");
                    Integer followed = userJson.getInt("followeds");
                    Integer playlistCount = userJson.getInt("playlistCount");

                    NetUserInfo userInfo = new NetUserInfo();
                    userInfo.setId(userId);
                    userInfo.setName(userName);
                    userInfo.setGender(gender);
                    userInfo.setAvatarThumbUrl(avatarThumbUrl);
                    userInfo.setFollow(follow);
                    userInfo.setFollowed(followed);
                    userInfo.setPlaylistCount(playlistCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage avatarThumb = extractProfile(avatarThumbUrl);
                        userInfo.setAvatarThumb(avatarThumb);
                    });

                    res.add(userInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // QQ
        Callable<CommonResult<NetUserInfo>> searchUsersQq = () -> {
            LinkedList<NetUserInfo> res = new LinkedList<>();
            Integer t = 0;

            String userInfoBody = HttpRequest.post(String.format(qqSearchApi))
                    .body(String.format(qqSearchJson, page, limit, keyword, 8))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject data = userInfoJson.getJSONObject("music.search.SearchCgiService").getJSONObject("data");
            t = data.getJSONObject("meta").getInt("sum");
            JSONArray userArray = data.getJSONObject("body").getJSONObject("user").getJSONArray("list");
            for (int i = 0, len = userArray.size(); i < len; i++) {
                JSONObject userJson = userArray.getJSONObject(i);

                String userId = userJson.getString("encrypt_uin");
                String userName = userJson.getString("title");
                String gender = "保密";
                String avatarThumbUrl = userJson.getString("pic");
                Integer followed = userJson.getInt("fans_num");
                Integer playlistCount = userJson.getInt("diss_num");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setSource(NetMusicSource.QQ);
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
                userInfo.setAvatarUrl(avatarThumbUrl);
                userInfo.setFollowed(followed);
                userInfo.setPlaylistCount(playlistCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(avatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 喜马拉雅
        Callable<CommonResult<NetUserInfo>> searchUsersXm = () -> {
            LinkedList<NetUserInfo> res = new LinkedList<>();
            Integer t = 0;

            String userInfoBody = HttpRequest.get(String.format(SEARCH_USER_XM_API, encodedKeyword, page, limit))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject result = userInfoJson.getJSONObject("data").optJSONObject("user");
            if (result != null) {
                t = result.getInt("total");
                JSONArray userArray = result.getJSONArray("docs");
                for (int i = 0, len = userArray.size(); i < len; i++) {
                    JSONObject userJson = userArray.getJSONObject(i);

                    String userId = userJson.getString("uid");
                    String userName = userJson.getString("nickname");
                    Integer gen = userJson.getInt("gender");
                    String gender = gen == 0 ? "保密" : gen == 1 ? "♂ 男" : "♀ 女";
                    String avatarThumbUrl = userJson.getString("logoPic");
                    int in = avatarThumbUrl.lastIndexOf('!');
                    if (in > 0) avatarThumbUrl = avatarThumbUrl.substring(0, in);
                    Integer follow = userJson.getInt("followingsCount");
                    Integer followed = userJson.getInt("followersCount");
                    Integer radioCount = userJson.getInt("albumCount");
                    Integer programCount = userJson.getInt("tracksCount");

                    NetUserInfo userInfo = new NetUserInfo();
                    userInfo.setSource(NetMusicSource.XM);
                    userInfo.setId(userId);
                    userInfo.setName(userName);
                    userInfo.setGender(gender);
                    userInfo.setAvatarThumbUrl(avatarThumbUrl);
                    userInfo.setFollow(follow);
                    userInfo.setFollowed(followed);
                    userInfo.setRadioCount(radioCount);
                    userInfo.setProgramCount(programCount);

                    String finalAvatarThumbUrl = avatarThumbUrl;
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                        userInfo.setAvatarThumb(avatarThumb);
                    });

                    res.add(userInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 猫耳
        Callable<CommonResult<NetUserInfo>> searchUsersMe = () -> {
            LinkedList<NetUserInfo> res = new LinkedList<>();
            Integer t = 0;

            String userInfoBody = HttpRequest.get(String.format(SEARCH_USER_ME_API, encodedKeyword, page, limit))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject info = userInfoJson.getJSONObject("info");
            t = info.getJSONObject("pagination").getInt("count");
            JSONArray userArray = info.getJSONArray("Datas");
            for (int i = 0, len = userArray.size(); i < len; i++) {
                JSONObject userJson = userArray.getJSONObject(i);

                String userId = userJson.getString("id");
                String userName = userJson.getString("username");
                String gender = "保密";
                String avatarThumbUrl = userJson.getString("avatar2");
//                String bgImgUrl = userJson.getString("coverurl2");
                Integer follow = userJson.getInt("follownum");
                Integer followed = userJson.getInt("fansnum");
//                Integer radioCount = userJson.getInt("albumnum");
                Integer programCount = userJson.getInt("soundnum");
//                String sign = userJson.getString("userintro");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setSource(NetMusicSource.ME);
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
                userInfo.setFollow(follow);
                userInfo.setFollowed(followed);
//                userInfo.setRadioCount(radioCount);
                userInfo.setProgramCount(programCount);
//                userInfo.setSign(sign);
//                userInfo.setBgImgUrl(bgImgUrl);

                String finalAvatarThumbUrl = avatarThumbUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 好看
        Callable<CommonResult<NetUserInfo>> searchUsersHk = () -> {
            LinkedList<NetUserInfo> res = new LinkedList<>();
            Integer t = 0;

            String userInfoBody = HttpRequest.get(String.format(SEARCH_USER_HK_API, encodedKeyword, page, limit))
                    .header(Header.COOKIE, HK_COOKIE)
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject data = userInfoJson.getJSONObject("data");
            t = data.getInt("has_more") == 1 ? (page + 1) * limit : page * limit;
            JSONArray userArray = data.getJSONArray("list");
            for (int i = 0, len = userArray.size(); i < len; i++) {
                JSONObject userJson = userArray.getJSONObject(i);

                String userId = userJson.getString("appid");
                String userName = userJson.getString("name");
                String gender = "保密";
                String avatarThumbUrl = userJson.getString("author_icon");
                Integer followed = userJson.getInt("fansCnt");
                Integer programCount = userJson.getInt("videoCnt");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setSource(NetMusicSource.HK);
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
                userInfo.setFollowed(followed);
                userInfo.setProgramCount(programCount);

                String finalAvatarThumbUrl = avatarThumbUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 豆瓣
        Callable<CommonResult<NetUserInfo>> searchUsersDb = () -> {
            LinkedList<NetUserInfo> res = new LinkedList<>();
            Integer t = 0;

            final int lim = Math.min(20, limit);
            String userInfoBody = HttpRequest.get(String.format(SEARCH_USER_DB_API, encodedKeyword, (page - 1) * lim))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONArray userArray = userInfoJson.optJSONArray("items");
            if (userArray != null) {
                t = userInfoJson.getInt("total");
                for (int i = 0, len = userArray.size(); i < len; i++) {
                    Document doc = Jsoup.parse(userArray.getString(i));
                    Elements result = doc.select("div.result");
                    Elements a = result.select("h3 a");
                    Elements info = result.select(".title .info");
                    Elements img = result.select("div.pic img");

                    String userId = ReUtil.get("sid: (\\d+)", a.attr("onclick"), 1);
                    String userName = a.text().trim();
                    String gender = "保密";
                    String sr = img.attr("src");
                    String avatarThumbUrl = sr.contains("/user") ? sr.replaceFirst("normal", "large") : sr.replaceFirst("/up", "/ul");
                    Integer followed = Integer.parseInt(ReUtil.get("(\\d+)人关注", info.text(), 1));

                    NetUserInfo userInfo = new NetUserInfo();
                    userInfo.setSource(NetMusicSource.DB);
                    userInfo.setId(userId);
                    userInfo.setName(userName);
                    userInfo.setGender(gender);
                    userInfo.setAvatarThumbUrl(avatarThumbUrl);
                    userInfo.setFollowed(followed);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(avatarThumbUrl);
                        userInfo.setAvatarThumb(coverImgThumb);
                    });

                    res.add(userInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 堆糖
        Callable<CommonResult<NetUserInfo>> searchUsersDt = () -> {
            LinkedList<NetUserInfo> res = new LinkedList<>();
            Integer t = 0;

            String userInfoBody = HttpRequest.get(String.format(SEARCH_USER_DT_API, encodedKeyword, (page - 1) * limit, limit, System.currentTimeMillis()))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject data = userInfoJson.getJSONObject("data");
            JSONArray userArray = data.optJSONArray("object_list");
            if (userArray != null && !userArray.isEmpty()) {
                t = data.getInt("total");
                for (int i = 0, len = userArray.size(); i < len; i++) {
                    JSONObject userJson = userArray.getJSONObject(i);

                    String userId = userJson.getString("id");
                    String userName = userJson.getString("username");
                    String gender = "保密";
                    String avatarThumbUrl = userJson.getString("avatar");
                    Integer follow = userJson.getInt("followCount");
                    Integer followed = userJson.getInt("beFollowCount");

                    NetUserInfo userInfo = new NetUserInfo();
                    userInfo.setSource(NetMusicSource.DT);
                    userInfo.setId(userId);
                    userInfo.setName(userName);
                    userInfo.setGender(gender);
                    userInfo.setAvatarThumbUrl(avatarThumbUrl);
                    userInfo.setFollow(follow);
                    userInfo.setFollowed(followed);

                    String finalAvatarThumbUrl = avatarThumbUrl;
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                        userInfo.setAvatarThumb(avatarThumb);
                    });

                    res.add(userInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 哔哩哔哩
        Callable<CommonResult<NetUserInfo>> searchUsersBi = () -> {
            LinkedList<NetUserInfo> res = new LinkedList<>();
            Integer t = 0;

            String userInfoBody = HttpRequest.get(String.format(SEARCH_USER_BI_API, encodedKeyword, page))
                    .cookie(BI_COOKIE)
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject data = userInfoJson.getJSONObject("data");
            JSONArray userArray = data.optJSONArray("result");
            if (userArray != null) {
                t = data.getInt("numResults");
                for (int i = 0, len = userArray.size(); i < len; i++) {
                    JSONObject userJson = userArray.getJSONObject(i);

                    String userId = userJson.getString("mid");
                    String userName = userJson.getString("uname");
                    int gen = userJson.getInt("gender");
                    String gender = gen == 1 ? "♂ 男" : gen == 2 ? "♀ 女" : "保密";
                    String avatarThumbUrl = "https:" + userJson.getString("upic");
                    Integer programCount = userJson.getInt("videos");
                    Integer followed = userJson.getInt("fans");

                    NetUserInfo userInfo = new NetUserInfo();
                    userInfo.setSource(NetMusicSource.BI);
                    userInfo.setId(userId);
                    userInfo.setName(userName);
                    userInfo.setGender(gender);
                    userInfo.setAvatarThumbUrl(avatarThumbUrl);
                    userInfo.setProgramCount(programCount);
                    userInfo.setFollowed(followed);

                    String finalAvatarThumbUrl = avatarThumbUrl;
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                        userInfo.setAvatarThumb(avatarThumb);
                    });

                    res.add(userInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        List<Future<CommonResult<NetUserInfo>>> taskList = new LinkedList<>();

        if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchUsers));
        if (src == NetMusicSource.QQ || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchUsersQq));
        if (src == NetMusicSource.XM || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchUsersXm));
        if (src == NetMusicSource.ME || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchUsersMe));
        if (src == NetMusicSource.HK || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchUsersHk));
        if (src == NetMusicSource.DB || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchUsersDb));
        if (src == NetMusicSource.DT || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchUsersDt));
        if (src == NetMusicSource.BI || src == NetMusicSource.ALL)
            taskList.add(GlobalExecutors.requestExecutor.submit(searchUsersBi));

        List<List<NetUserInfo>> rl = new LinkedList<>();
        taskList.forEach(task -> {
            try {
                CommonResult<NetUserInfo> result = task.get();
                rl.add(result.data);
                total.set(Math.max(total.get(), result.total));
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
        userInfos.addAll(ListUtil.joinAll(rl));

        return new CommonResult<>(userInfos, total.get());
    }

    /**
     * 获取 歌曲 / 歌单 / 专辑 / MV 评论
     */
    public static CommonResult<NetCommentInfo> getComments(Object info, String type, int limit, int page, String cursor) {
        int total = 0;
        List<NetCommentInfo> commentInfos = new LinkedList<>();

        String id = null;
        String[] typeStr = null;
        Integer source = 0;
        boolean hotOnly = "热门评论".equals(type);

        boolean isRadio = false, isBook = false, isGame = false;

        if (info instanceof NetMusicInfo) {
            NetMusicInfo netMusicInfo = (NetMusicInfo) info;
            // 网易云需要先判断是普通歌曲还是电台节目，酷狗歌曲获取评论需要 hash
            boolean hasProgramId = netMusicInfo.hasProgramId();
            boolean hasHash = netMusicInfo.hasHash();
            id = hasProgramId ? netMusicInfo.getProgramId() : hasHash ? netMusicInfo.getHash() : netMusicInfo.getId();
            source = netMusicInfo.getSource();
            // 网易 QQ 酷我 猫耳
            typeStr = new String[]{hasProgramId ? "4" : "0", "1", "15", "1"};

            if (source == NetMusicSource.QQ) {
                // QQ 需要先通过 mid 获取 id
                String songInfoBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_QQ_API, netMusicInfo.getId()))
                        .execute()
                        .body();
                JSONObject trackInfo = JSONObject.fromObject(songInfoBody).getJSONObject("data").getJSONObject("track_info");
                id = trackInfo.getString("id");
            }
        } else if (info instanceof NetPlaylistInfo) {
            NetPlaylistInfo netPlaylistInfo = (NetPlaylistInfo) info;
            id = netPlaylistInfo.getId();
            source = netPlaylistInfo.getSource();
            // 网易 QQ 酷我 猫耳
            typeStr = new String[]{"2", "3", "8", "2"};
        } else if (info instanceof NetAlbumInfo) {
            NetAlbumInfo netAlbumInfo = (NetAlbumInfo) info;
            id = netAlbumInfo.getId();
            source = netAlbumInfo.getSource();
            typeStr = new String[]{"3", "2", ""};

            if (source == NetMusicSource.QQ) {
                // QQ 需要先通过 mid 获取 id
                String songInfoBody = HttpRequest.get(String.format(ALBUM_DETAIL_QQ_API, netAlbumInfo.getId()))
                        .execute()
                        .body();
                id = JSONObject.fromObject(songInfoBody).getJSONObject("data").getString("id");
            }
        } else if (info instanceof NetRadioInfo) {
            NetRadioInfo netRadioInfo = (NetRadioInfo) info;
            id = netRadioInfo.getId();
            source = netRadioInfo.getSource();
            isRadio = true;
            isBook = netRadioInfo.isBook();
            isGame = netRadioInfo.isGame();
            typeStr = new String[]{"7", "", "", ""};
        } else if (info instanceof NetMvInfo) {
            NetMvInfo netMvInfo = (NetMvInfo) info;
            // 网易云需要判断是视频还是 MV 还是 Mlog
            boolean isVideo = netMvInfo.isVideo();
            boolean isMlog = netMvInfo.isMlog();

            source = netMvInfo.getSource();
            // 哔哩哔哩获取视频的 bvid
            id = source == NetMusicSource.BI ? netMvInfo.getBvid() : netMvInfo.getId();

            // Mlog 需要先获取视频 id，并转为视频类型
            if (isMlog) {
                String body = HttpRequest.get(String.format(MLOG_TO_VIDEO_API, id))
                        .execute()
                        .body();
                id = JSONObject.fromObject(body).getString("data");
                netMvInfo.setId(id);
                netMvInfo.setType(MvInfoType.VIDEO);
            }

            typeStr = new String[]{isVideo || isMlog ? "5" : "1", "5", "7"};
        } else if (info instanceof NetRankingInfo) {
            NetRankingInfo netRankingInfo = (NetRankingInfo) info;
            id = netRankingInfo.getId();
            source = netRankingInfo.getSource();
            typeStr = new String[]{"2", "4", "2"};
        }

        // 网易云
        if (source == NetMusicSource.NET_CLOUD && StringUtil.isNotEmpty(typeStr[0])) {
            String commentInfoBody = HttpRequest.get(String.format(GET_COMMENTS_API, typeStr[0], id, page, limit, hotOnly ? 2 : 3, cursor))
                    .execute()
                    .body();
            JSONObject data = JSONObject.fromObject(commentInfoBody).getJSONObject("data");
            total = data.getInt("totalCount");
            // 按时间排序时才需要 cursor ！
            if (!hotOnly) cursor = data.getString("cursor");
            JSONArray commentArray = data.getJSONArray("comments");
            for (int i = 0, len = commentArray.size(); i < len; i++) {
                JSONObject commentJson = commentArray.getJSONObject(i);
                JSONObject user = commentJson.getJSONObject("user");

                String userId = user.getString("userId");
                String username = user.getString("nickname");
                String profileUrl = user.getString("avatarUrl");
                String content = commentJson.getString("content");
                String time = TimeUtil.msToPhrase(commentJson.getLong("time"));
                Integer likedCount = commentJson.getInt("likedCount");

                NetCommentInfo commentInfo = new NetCommentInfo();
                commentInfo.setUserId(userId);
                commentInfo.setUsername(username);
                commentInfo.setProfileUrl(profileUrl);
                commentInfo.setContent(content);
                commentInfo.setTime(time);
                commentInfo.setLikedCount(likedCount);

                NetCommentInfo finalCommentInfo = commentInfo;
                String finalProfileUrl = profileUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage profile = extractProfile(finalProfileUrl);
                    finalCommentInfo.setProfile(profile);
                });

                commentInfos.add(commentInfo);

                // 被回复的评论
                JSONArray beReplied = commentJson.optJSONArray("beReplied");
                if (beReplied == null) continue;
                for (int j = 0, l = beReplied.size(); j < l; j++) {
                    commentJson = beReplied.getJSONObject(j);

                    user = commentJson.getJSONObject("user");
                    userId = user.getString("userId");
                    username = user.getString("nickname");
                    profileUrl = user.getString("avatarUrl");
                    content = commentJson.getString("content");

                    commentInfo = new NetCommentInfo();
                    commentInfo.setSub(true);
                    commentInfo.setUserId(userId);
                    commentInfo.setUsername(username);
                    commentInfo.setProfileUrl(profileUrl);
                    commentInfo.setContent(content);

                    NetCommentInfo finalCommentInfo1 = commentInfo;
                    String finalProfileUrl1 = profileUrl;
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage profile = extractProfile(finalProfileUrl1);
                        finalCommentInfo1.setProfile(profile);
                    });

                    commentInfos.add(commentInfo);
                }
            }
        }

        // 酷狗
        else if (source == NetMusicSource.KG && info instanceof NetMusicInfo) {
            String commentInfoBody = HttpRequest.get(String.format(GET_COMMENTS_KG_API, id, page, limit))
                    // 注意此处必须加 header 才能请求到正确的数据！
                    .header(Header.USER_AGENT, "Android712-AndroidPhone-8983-18-0-COMMENT-wifi")
                    .execute()
                    .body();
            JSONObject commentInfoJson = JSONObject.fromObject(commentInfoBody);
            JSONArray commentArray = hotOnly ? commentInfoJson.optJSONArray("weightList") : commentInfoJson.optJSONArray("list");
            total = hotOnly ? (commentArray != null ? commentArray.size() : 0) : commentInfoJson.getInt("count");
            if (commentArray != null) {
                for (int i = 0, len = commentArray.size(); i < len; i++) {
                    JSONObject commentJson = commentArray.getJSONObject(i);

                    String username = commentJson.getString("user_name");
                    String profileUrl = commentJson.getString("user_pic");
                    String content = commentJson.optString("content");
                    String time = TimeUtil.strToPhrase(commentJson.getString("addtime"));
                    Integer likedCount = commentJson.getJSONObject("like").getInt("likenum");

                    NetCommentInfo commentInfo = new NetCommentInfo();
                    commentInfo.setSource(NetMusicSource.KG);
                    commentInfo.setUsername(username);
                    commentInfo.setProfileUrl(profileUrl);
                    commentInfo.setContent(content);
                    commentInfo.setTime(time);
                    commentInfo.setLikedCount(likedCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage profile = extractProfile(profileUrl);
                        commentInfo.setProfile(profile);
                    });

                    commentInfos.add(commentInfo);
                }
            }
        }

        // QQ
        else if (source == NetMusicSource.QQ && StringUtil.isNotEmpty(typeStr[1])) {
            String commentInfoBody = HttpRequest.get(String.format(GET_COMMENTS_QQ_API, hotOnly ? 1 : 0, typeStr[1],
                            id, page, hotOnly ? limit : Math.min(25, limit)))
                    .execute()
                    .body();
            JSONObject commentInfoJson = JSONObject.fromObject(commentInfoBody);
            JSONObject data = commentInfoJson.getJSONObject("data");
            JSONObject commentJson = data.getJSONObject("comment");
            total = commentJson.getInt("commenttotal");
            JSONArray commentArray = commentJson.optJSONArray("commentlist");
            if (commentArray != null) {
                for (int i = 0, len = commentArray.size(); i < len; i++) {
                    JSONObject cj = commentArray.getJSONObject(i);

                    String userId = cj.getString("encrypt_uin");
                    String username = cj.getString("nick");
                    String profileUrl = cj.getString("avatarurl").replaceFirst("http:", "https:");
                    JSONArray middleCommentContent = cj.optJSONArray("middlecommentcontent");
                    String content;
                    JSONObject cj2 = null;
                    if (middleCommentContent != null) {
                        cj2 = middleCommentContent.getJSONObject(0);
                        content = cj2.getString("subcommentcontent").replace("\\n", "\n");
                    } else
                        content = cj.optString("rootcommentcontent").replace("\\n", "\n");
                    // 评论可能已被删除
                    if (content.isEmpty()) content = "该评论已被删除";
                    String time = TimeUtil.msToPhrase(cj.getLong("time") * 1000);
                    Integer likedCount = cj.getInt("praisenum");

                    NetCommentInfo commentInfo = new NetCommentInfo();
                    commentInfo.setSource(NetMusicSource.QQ);
                    commentInfo.setUserId(userId);
                    commentInfo.setUsername(username);
                    commentInfo.setProfileUrl(profileUrl);
                    commentInfo.setContent(content);
                    commentInfo.setTime(time);
                    commentInfo.setLikedCount(likedCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage profile = extractProfile(profileUrl);
                        commentInfo.setProfile(profile);
                    });

                    commentInfos.add(commentInfo);

                    // 被回复的评论
                    if (middleCommentContent != null) {
                        String uId = cj2.optString("encrypt_replyeduin");
                        String uname = cj.optString("rootcommentnick");
                        String cnt = cj.optString("rootcommentcontent").replace("\\n", "\n");

                        NetCommentInfo ci = new NetCommentInfo();
                        ci.setSource(NetMusicSource.QQ);
                        ci.setSub(true);
                        ci.setUserId(uId);
                        ci.setUsername(StringUtil.isEmpty(uname) ? "null" : uname.substring(1));
                        ci.setContent(StringUtil.isEmpty(cnt) ? "该评论已被删除" : cnt);
                        commentInfos.add(ci);
                    }
                }
            }
        }

        // 酷我
        else if (source == NetMusicSource.KW && StringUtil.isNotEmpty(typeStr[2])) {
            String ref = "";
            switch (Integer.parseInt(typeStr[2])) {
                case 15:
                    ref = "http://www.kuwo.cn/play_detail/" + StringUtil.encode(id);
                    break;
                case 7:
                    ref = "http://www.kuwo.cn/mvplay/" + StringUtil.encode(id);
                    break;
                case 8:
                    ref = "http://www.kuwo.cn/playlist_detail/" + StringUtil.encode(id);
                    break;
                case 2:
                    ref = "http://www.kuwo.cn/rankList" + StringUtil.encode(id);
                    break;
            }
            String url = hotOnly ? GET_HOT_COMMENTS_KW_API : GET_NEW_COMMENTS_KW_API;
            // 最新评论
            String commentInfoBody = kwRequest(String.format(url, typeStr[2], id, page, limit))
                    .header(Header.REFERER, ref)
                    .execute()
                    .body();
            JSONObject commentInfoJson = JSONObject.fromObject(commentInfoBody);
            JSONArray commentArray = null;
            if (!commentInfoJson.has("data")) {
                total = commentInfoJson.getInt("total");
                commentArray = commentInfoJson.getJSONArray("rows");
            }
            if (commentArray != null) {
                for (int i = 0, len = commentArray.size(); i < len; i++) {
                    JSONObject commentJson = commentArray.getJSONObject(i);

                    String username = StringUtil.decode(commentJson.getString("u_name"));
                    String profileUrl = commentJson.getString("u_pic");
                    String content = commentJson.getString("msg");
                    String time = TimeUtil.strToPhrase(commentJson.getString("time"));
                    Integer likedCount = commentJson.getInt("like_num");

                    NetCommentInfo commentInfo = new NetCommentInfo();
                    commentInfo.setSource(NetMusicSource.KW);
                    commentInfo.setUsername(username);
                    commentInfo.setProfileUrl(profileUrl);
                    commentInfo.setContent(content);
                    commentInfo.setTime(time);
                    commentInfo.setLikedCount(likedCount);
                    String finalProfileUrl = profileUrl;
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage profile = extractProfile(finalProfileUrl);
                        commentInfo.setProfile(profile);
                    });

                    commentInfos.add(commentInfo);

                    // 被回复的评论
                    JSONObject reply = commentJson.optJSONObject("reply");
                    if (reply == null) continue;
                    username = StringUtil.decode(reply.getString("u_name"));
                    profileUrl = reply.getString("u_pic");
                    content = reply.getString("msg");
                    time = TimeUtil.strToPhrase(reply.getString("time"));
                    likedCount = reply.getInt("like_num");

                    NetCommentInfo rCommentInfo = new NetCommentInfo();
                    rCommentInfo.setSource(NetMusicSource.KW);
                    rCommentInfo.setSub(true);
                    rCommentInfo.setUsername(username);
                    rCommentInfo.setProfileUrl(profileUrl);
                    rCommentInfo.setContent(content);
                    rCommentInfo.setTime(time);
                    rCommentInfo.setLikedCount(likedCount);
                    String finalProfileUrl1 = profileUrl;
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage profile = extractProfile(finalProfileUrl1);
                        rCommentInfo.setProfile(profile);
                    });

                    commentInfos.add(rCommentInfo);
                }
            }
        }

        // 喜马拉雅
        else if (source == NetMusicSource.XM) {
            JSONArray commentArray;
            if (isRadio) {
                String url = hotOnly ? GET_HOT_RADIO_COMMENTS_XM_API : GET_NEW_RADIO_COMMENTS_XM_API;
                String commentInfoBody = HttpRequest.get(String.format(url, id, page, limit))
                        .execute()
                        .body();
                JSONObject commentInfoJson = JSONObject.fromObject(commentInfoBody);
                JSONObject data = commentInfoJson.getJSONObject("data");
                JSONObject comments = data.getJSONObject("comments");
                total = comments.getInt("totalCount");
                commentArray = comments.getJSONArray("list");
            } else {
                String commentInfoBody = HttpRequest.get(String.format(GET_COMMENTS_XM_API, id, page, limit))
                        .execute()
                        .body();
                JSONObject commentInfoJson = JSONObject.fromObject(commentInfoBody);
                JSONObject data = commentInfoJson.getJSONObject("data");
                total = data.getInt("totalComment");
                commentArray = data.getJSONArray("comments");
            }
            if (commentArray != null) {
                for (int i = 0, len = commentArray.size(); i < len; i++) {
                    JSONObject commentJson = commentArray.getJSONObject(i);

                    String userId = commentJson.getString("uid");
                    String username = commentJson.getString("nickname");
                    String smallHeader = commentJson.getString("smallHeader");
                    String profileUrl = isRadio ? smallHeader : "http:" + smallHeader;
                    String content = commentJson.getString("content");
                    String time = TimeUtil.msToPhrase(commentJson.getLong(isRadio ? "createdAt" : "commentTime"));
                    Integer likedCount = commentJson.getInt("likes");
                    Integer score = commentJson.optInt("newAlbumScore", -1);

                    NetCommentInfo commentInfo = new NetCommentInfo();
                    commentInfo.setSource(NetMusicSource.XM);
                    commentInfo.setUserId(userId);
                    commentInfo.setUsername(username);
                    commentInfo.setProfileUrl(profileUrl);
                    commentInfo.setContent(content);
                    commentInfo.setTime(time);
                    commentInfo.setLikedCount(likedCount);
                    commentInfo.setScore(score);

                    String finalProfileUrl1 = profileUrl;
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage profile = extractProfile(finalProfileUrl1);
                        commentInfo.setProfile(profile);
                    });

                    commentInfos.add(commentInfo);

                    // 回复
                    JSONArray replies = commentJson.optJSONArray("replies");
                    if (replies == null) continue;
                    for (int j = 0, s = replies.size(); j < s; j++) {
                        JSONObject cj = replies.getJSONObject(j);

                        userId = cj.getString("uid");
                        username = cj.getString("nickname");
                        smallHeader = cj.getString("smallHeader");
                        profileUrl = isRadio ? smallHeader : "http:" + smallHeader;
                        content = cj.getString("content");
                        time = isRadio ? TimeUtil.msToPhrase(cj.getLong("createdAt")) : cj.getString("createAt");
                        likedCount = cj.getInt("likes");
                        score = cj.optInt("newAlbumScore", -1);

                        NetCommentInfo ci = new NetCommentInfo();
                        ci.setSource(NetMusicSource.XM);
                        ci.setSub(true);
                        ci.setUserId(userId);
                        ci.setUsername(username);
                        ci.setProfileUrl(profileUrl);
                        ci.setContent(content);
                        ci.setTime(time);
                        ci.setLikedCount(likedCount);
                        ci.setScore(score);

                        String finalProfileUrl = profileUrl;
                        GlobalExecutors.imageExecutor.execute(() -> {
                            BufferedImage profile = extractProfile(finalProfileUrl);
                            ci.setProfile(profile);
                        });

                        commentInfos.add(ci);
                    }
                }
            }
        }

        // 音乐磁场
        else if (source == NetMusicSource.HF) {
            String commentInfoBody = HttpRequest.get(String.format(GET_COMMENTS_HF_API, id, page))
                    .cookie(HF_COOKIE)
                    .execute()
                    .body();
            Document doc = Jsoup.parse(commentInfoBody);
            Elements comments = doc.select("li.media.post");
            Elements ap = doc.select("a.page-link");
            String ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 1).text(), 1);
            if (StringUtil.isEmpty(ts))
                ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 2).text(), 1);
            boolean hasTs = StringUtil.isNotEmpty(ts);
            if (hasTs) total = Integer.parseInt(ts) * limit;
            else total = comments.size();
            for (int i = 0, len = comments.size(); i < len; i++) {
                Element comment = comments.get(i);

                Element msg = comment.select(".message.mt-1.break-all").first();
                if (msg == null) continue;

                String username = comment.select(".username").text();
                String userId = ReUtil.get("user-(\\d+)\\.htm", comment.select(".username a").attr("href"), 1);
                String profileUrl = "https://www.hifini.com/" + comment.select("img").attr("src");
                String content = msg.ownText().trim();
                String time = TimeUtil.strToPhrase(comment.select(".date.text-grey.ml-2").text());

                NetCommentInfo commentInfo = new NetCommentInfo();
                commentInfo.setSource(NetMusicSource.HF);
                commentInfo.setUsername(username);
                commentInfo.setUserId(userId);
                commentInfo.setProfileUrl(profileUrl);
                commentInfo.setContent(content);
                commentInfo.setTime(time);
                String finalProfileUrl1 = profileUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage profile = extractProfile(finalProfileUrl1);
                    commentInfo.setProfile(profile);
                });

                commentInfos.add(commentInfo);

                // 被回复的评论
                Elements bq = msg.select("blockquote");
                if (bq.isEmpty()) continue;

                username = bq.select("a").text().trim();
                userId = ReUtil.get("user-(\\d+)\\.htm", comment.select("a").attr("href"), 1);
                profileUrl = "https://www.hifini.com/" + bq.select("img").attr("src");
                content = bq.first().ownText();

                NetCommentInfo ci = new NetCommentInfo();
                ci.setSource(NetMusicSource.HF);
                ci.setSub(true);
                ci.setUsername(username);
                ci.setUserId(userId);
                ci.setProfileUrl(profileUrl);
                ci.setContent(content);
                String finalProfileUrl = profileUrl;

                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage profile = extractProfile(finalProfileUrl);
                    ci.setProfile(profile);
                });

                commentInfos.add(ci);
            }
        }

        // 咕咕咕音乐
        else if (source == NetMusicSource.GG) {
            String commentInfoBody = HttpRequest.get(String.format(GET_COMMENTS_GG_API, id, page))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(commentInfoBody);
            Elements comments = doc.select("li.media.post");
            Elements ap = doc.select("a.page-link");
            String ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 1).text(), 1);
            if (StringUtil.isEmpty(ts))
                ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 2).text(), 1);
            boolean hasTs = StringUtil.isNotEmpty(ts);
            if (hasTs) total = Integer.parseInt(ts) * limit;
            else total = comments.size();
            for (int i = 0, len = comments.size(); i < len; i++) {
                Element comment = comments.get(i);

                Element msg = comment.select(".message.mt-1.break-all").first();
                if (msg == null) continue;

                String username = comment.select(".username").text();
                String userId = ReUtil.get("user-(\\d+)\\.htm", comment.select(".username a").attr("href"), 1);
                String profileUrl = "http://www.gggmusic.com/" + comment.select("img").attr("src");
                String content = msg.ownText().trim();
                String time = TimeUtil.strToPhrase(comment.select(".date.text-grey.ml-2").text());

                NetCommentInfo commentInfo = new NetCommentInfo();
                commentInfo.setSource(NetMusicSource.GG);
                commentInfo.setUsername(username);
                commentInfo.setUserId(userId);
                commentInfo.setProfileUrl(profileUrl);
                commentInfo.setContent(content);
                commentInfo.setTime(time);
                String finalProfileUrl1 = profileUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage profile = extractProfile(finalProfileUrl1);
                    commentInfo.setProfile(profile);
                });

                commentInfos.add(commentInfo);

                // 被回复的评论
                Elements bq = msg.select("blockquote");
                if (bq.isEmpty()) continue;

                username = bq.select("a").text().trim();
                userId = ReUtil.get("user-(\\d+)\\.htm", comment.select("a").attr("href"), 1);
                profileUrl = "http://www.gggmusic.com/" + bq.select("img").attr("src");
                content = bq.first().ownText();

                NetCommentInfo ci = new NetCommentInfo();
                ci.setSource(NetMusicSource.GG);
                ci.setSub(true);
                ci.setUsername(username);
                ci.setUserId(userId);
                ci.setProfileUrl(profileUrl);
                ci.setContent(content);
                String finalProfileUrl = profileUrl;

                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage profile = extractProfile(finalProfileUrl);
                    ci.setProfile(profile);
                });

                commentInfos.add(ci);
            }
        }

        // 猫耳
        else if (source == NetMusicSource.ME && StringUtil.isNotEmpty(typeStr[3])) {
            String commentInfoBody = HttpRequest.get(String.format(GET_COMMENTS_ME_API, typeStr[3], hotOnly ? 3 : 1, id, page, limit))
                    .execute()
                    .body();
            JSONObject commentInfoJson = JSONObject.fromObject(commentInfoBody);
            JSONObject data = commentInfoJson.getJSONObject("info").getJSONObject("comment");
            total = data.getJSONObject("pagination").getInt("count");
            JSONArray commentArray = data.getJSONArray("Datas");
            for (int i = 0, len = commentArray.size(); i < len; i++) {
                JSONObject commentJson = commentArray.getJSONObject(i);

                String userId = commentJson.getString("userid");
                String username = commentJson.getString("username");
                String profileUrl = commentJson.getString("icon");
                String content = commentJson.getString("comment_content");
                String time = commentJson.getString("ctime");
                Integer likedCount = commentJson.getInt("like_num");

                NetCommentInfo commentInfo = new NetCommentInfo();
                commentInfo.setSource(NetMusicSource.ME);
                commentInfo.setUserId(userId);
                commentInfo.setUsername(username);
                commentInfo.setProfileUrl(profileUrl);
                commentInfo.setContent(content);
                commentInfo.setTime(time);
                commentInfo.setLikedCount(likedCount);

                String finalProfileUrl1 = profileUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage profile = extractProfile(finalProfileUrl1);
                    commentInfo.setProfile(profile);
                });

                commentInfos.add(commentInfo);

                JSONArray subComments = commentJson.getJSONArray("subcomments");
                for (int j = 0, s = subComments.size(); j < s; j++) {
                    JSONObject cj = subComments.getJSONObject(j);

                    userId = cj.getString("userid");
                    username = cj.getString("username");
                    profileUrl = cj.getString("icon");
                    content = cj.getString("comment_content");
                    time = cj.getString("ctime");
                    likedCount = cj.getInt("like_num");

                    NetCommentInfo ci = new NetCommentInfo();
                    ci.setSource(NetMusicSource.ME);
                    ci.setSub(true);
                    ci.setUserId(userId);
                    ci.setUsername(username);
                    ci.setProfileUrl(profileUrl);
                    ci.setContent(content);
                    ci.setTime(time);
                    ci.setLikedCount(likedCount);

                    String finalProfileUrl = profileUrl;
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage profile = extractProfile(finalProfileUrl);
                        ci.setProfile(profile);
                    });

                    commentInfos.add(ci);
                }
            }
        }

        // 好看
        else if (source == NetMusicSource.HK) {
            String commentInfoBody = HttpRequest.get(String.format(GET_COMMENTS_HK_API, id, page, limit))
                    .execute()
                    .body();
            JSONObject commentInfoJson = JSONObject.fromObject(commentInfoBody);
            JSONObject data = commentInfoJson.getJSONObject("data");
            total = data.getInt("comment_count");
            JSONArray commentArray = data.getJSONArray("list");
            for (int i = 0, len = commentArray.size(); i < len; i++) {
                JSONObject commentJson = commentArray.getJSONObject(i);

                String userId = commentJson.getString("third_id");
                String username = commentJson.getString("uname");
                String profileUrl = commentJson.getString("avatar");
                String content = commentJson.getString("content");
                String time = TimeUtil.msToPhrase(commentJson.getLong("create_time") * 1000);
                Integer likedCount = commentJson.getInt("like_count");

                NetCommentInfo commentInfo = new NetCommentInfo();
                commentInfo.setSource(NetMusicSource.HK);
                commentInfo.setUserId(userId);
                commentInfo.setUsername(username);
                commentInfo.setProfileUrl(profileUrl);
                commentInfo.setContent(content);
                commentInfo.setTime(time);
                commentInfo.setLikedCount(likedCount);

                String finalProfileUrl1 = profileUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage profile = extractProfile(finalProfileUrl1);
                    commentInfo.setProfile(profile);
                });

                commentInfos.add(commentInfo);

                // 回复
                JSONArray replies = commentJson.getJSONArray("reply_list");
                for (int j = 0, s = replies.size(); j < s; j++) {
                    JSONObject cj = replies.getJSONObject(j);

                    userId = cj.getString("third_id");
                    username = cj.getString("uname");
                    profileUrl = cj.getString("avatar");
                    content = cj.getString("content");
                    time = TimeUtil.msToPhrase(cj.getLong("create_time") * 1000);
                    likedCount = cj.getInt("like_count");

                    NetCommentInfo ci = new NetCommentInfo();
                    ci.setSource(NetMusicSource.HK);
                    ci.setSub(true);
                    ci.setUserId(userId);
                    ci.setUsername(username);
                    ci.setProfileUrl(profileUrl);
                    ci.setContent(content);
                    ci.setTime(time);
                    ci.setLikedCount(likedCount);

                    String finalProfileUrl = profileUrl;
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage profile = extractProfile(finalProfileUrl);
                        ci.setProfile(profile);
                    });

                    commentInfos.add(ci);
                }
            }
        }

        // 豆瓣
        else if (source == NetMusicSource.DB) {
            if (isGame) {
                String url = GET_GAME_RADIO_COMMENTS_DB_API;
                String commentInfoBody = HttpRequest.get(String.format(url, id, hotOnly ? "score" : "time", (page - 1) * limit, limit))
                        .setFollowRedirects(true)
                        .execute()
                        .body();
                Document doc = Jsoup.parse(commentInfoBody);
                Elements comments = doc.select("li.comment-item");
                String ts = ReUtil.get("\\((\\d+)\\)", doc.select("div#content h1").text(), 1);
                total = StringUtil.isNotEmpty(ts) ? Integer.parseInt(ts) : comments.size();
                for (int i = 0, len = comments.size(); i < len; i++) {
                    Element comment = comments.get(i);
                    Element a = comment.select("div.user-info a").first();
                    Element sht = comment.select("span.short").first();
                    Element t = comment.select("span.pubtime").first();
                    Element d = comment.select("span.digg span").first();
                    Elements rating = comment.select("div.user-info span");

                    String userId = ReUtil.get("/people/(.*?)/", a.attr("href"), 1);
                    String username = a.text();
                    String content = sht.text();
                    String time = TimeUtil.strToPhrase(t.text().replaceAll("年|月", "-").replace("日", ""));
                    Integer likedCount = Integer.parseInt(d.text());
                    String r = ReUtil.get("allstar(\\d+)", rating.size() > 2 ? rating.get(2).className() : "", 1);
                    Integer score = StringUtil.isEmpty(r) ? -1 : Integer.parseInt(r) / 10 * 2;

                    NetCommentInfo commentInfo = new NetCommentInfo();
                    commentInfo.setSource(NetMusicSource.DB);
                    commentInfo.setUserId(userId);
                    commentInfo.setUsername(username);
                    commentInfo.setContent(content);
                    commentInfo.setTime(time);
                    commentInfo.setLikedCount(likedCount);
                    commentInfo.setScore(score);

                    commentInfos.add(commentInfo);
                }
            } else {
                String url;
                if (isRadio) {
                    if (isBook) url = GET_BOOK_RADIO_COMMENTS_DB_API;
                    else url = GET_RADIO_COMMENTS_DB_API;
                } else url = GET_ALBUM_COMMENTS_DB_API;
                String commentInfoBody = HttpRequest.get(String.format(url, id, hotOnly ? "new_score" : "time", (page - 1) * limit, limit))
                        .setFollowRedirects(true)
                        .execute()
                        .body();
                Document doc = Jsoup.parse(commentInfoBody);
                Elements comments = doc.select(isRadio && !isBook ? "div.comment-item" : "li.comment-item");
                String ts = ReUtil.get("\\((\\d+)\\)", doc.select("li.is-active").text(), 1);
                total = StringUtil.isNotEmpty(ts) ? Integer.parseInt(ts) : comments.size();
                for (int i = 0, len = comments.size(); i < len; i++) {
                    Element comment = comments.get(i);
                    Element a = comment.select("span.comment-info a").first();
                    Element img = comment.select("div.avatar img").first();
                    Element cnt = comment.select("p.comment-content").first();
                    Element t = comment.select(isBook ? "a.comment-time" : "span.comment-time").first();
                    Element v = comment.select("span.vote-count").first();
                    Element rating = comment.select("span.comment-info span").get(isRadio && !isBook ? 1 : 0);

                    String userId = ReUtil.get("/people/(.*?)/", a.attr("href"), 1);
                    String username = a.text();
                    String src = img.attr("src");
                    String profileUrl = src.contains("/user") ? src.replaceFirst("normal", "large") : src.replaceFirst(isRadio ? "/u" : "/up", "/ul");
                    String content = cnt.text();
                    String time = TimeUtil.strToPhrase(t.text().trim());
                    Integer likedCount = Integer.parseInt(v.text());
                    String r = ReUtil.get("(\\d+) ", rating.className(), 1);
                    Integer score = StringUtil.isEmpty(r) ? -1 : Integer.parseInt(r) / 10 * 2;

                    NetCommentInfo commentInfo = new NetCommentInfo();
                    commentInfo.setSource(NetMusicSource.DB);
                    commentInfo.setUserId(userId);
                    commentInfo.setUsername(username);
                    commentInfo.setProfileUrl(profileUrl);
                    commentInfo.setContent(content);
                    commentInfo.setTime(time);
                    commentInfo.setLikedCount(likedCount);
                    commentInfo.setScore(score);

                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage profile = extractProfile(profileUrl);
                        commentInfo.setProfile(profile);
                    });

                    commentInfos.add(commentInfo);
                }
            }
        }

        // 哔哩哔哩
        else if (source == NetMusicSource.BI) {
            String url = info instanceof NetMvInfo ? String.format(GET_VIDEO_COMMENTS_BI_API, BvAvConverter.convertBv2Av(id), hotOnly ? 1 : 0, page, limit)
                    : String.format(GET_SONG_COMMENTS_BI_API, id, hotOnly ? 1 : 0, page, limit);
            String commentInfoBody = HttpRequest.get(url)
                    .cookie(BI_COOKIE)
                    .execute()
                    .body()
                    // 貌似解析不了，触及到什么特殊字符了？
                    .replaceAll("\"\\[\\d+.*?\\]\"", "\"\"");
            JSONObject commentInfoJson = JSONObject.fromObject(commentInfoBody);
            JSONObject data = commentInfoJson.getJSONObject("data");
            total = data.getJSONObject("page").getInt("count");
            JSONArray commentArray = data.optJSONArray("replies");
            if (commentArray != null) {
                for (int i = 0, len = commentArray.size(); i < len; i++) {
                    JSONObject commentJson = commentArray.getJSONObject(i);
                    JSONObject member = commentJson.getJSONObject("member");

                    String userId = commentJson.getString("mid");
                    String username = member.getString("uname");
                    String profileUrl = member.getString("avatar");
                    String content = commentJson.getJSONObject("content").getString("message");
                    String time = TimeUtil.msToPhrase(commentJson.getLong("ctime") * 1000);
                    Integer likedCount = commentJson.getInt("like");

                    NetCommentInfo commentInfo = new NetCommentInfo();
                    commentInfo.setSource(NetMusicSource.BI);
                    commentInfo.setUserId(userId);
                    commentInfo.setUsername(username);
                    commentInfo.setProfileUrl(profileUrl);
                    commentInfo.setContent(content);
                    commentInfo.setTime(time);
                    commentInfo.setLikedCount(likedCount);

                    String finalProfileUrl1 = profileUrl;
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage profile = extractProfile(finalProfileUrl1);
                        commentInfo.setProfile(profile);
                    });

                    commentInfos.add(commentInfo);

                    // 回复
                    JSONArray replies = commentJson.optJSONArray("replies");
                    if (replies == null) continue;
                    for (int j = 0, s = replies.size(); j < s; j++) {
                        JSONObject cj = replies.getJSONObject(j);
                        JSONObject mem = cj.getJSONObject("member");

                        userId = cj.getString("mid");
                        username = mem.getString("uname");
                        profileUrl = mem.getString("avatar");
                        content = cj.getJSONObject("content").getString("message");
                        time = TimeUtil.msToPhrase(cj.getLong("ctime") * 1000);
                        likedCount = cj.getInt("like");

                        NetCommentInfo ci = new NetCommentInfo();
                        ci.setSource(NetMusicSource.BI);
                        ci.setSub(true);
                        ci.setUserId(userId);
                        ci.setUsername(username);
                        ci.setProfileUrl(profileUrl);
                        ci.setContent(content);
                        ci.setTime(time);
                        ci.setLikedCount(likedCount);

                        String finalProfileUrl = profileUrl;
                        GlobalExecutors.imageExecutor.execute(() -> {
                            BufferedImage profile = extractProfile(finalProfileUrl);
                            ci.setProfile(profile);
                        });

                        commentInfos.add(ci);
                    }
                }
            }
        }

        return new CommonResult<>(commentInfos, total, cursor);
    }

    /**
     * 获取歌曲乐谱
     */
    public static CommonResult<NetSheetInfo> getSheets(NetMusicInfo musicInfo) {
        int source = musicInfo.getSource();
        String id = musicInfo.getId();
        LinkedList<NetSheetInfo> sheetInfos = new LinkedList<>();
        Integer total = 0;

        if (source == NetMusicSource.NET_CLOUD) {
            String sheetInfoBody = HttpRequest.get(String.format(GET_SHEETS_API, id))
                    .execute()
                    .body();
            JSONObject sheetInfoJson = JSONObject.fromObject(sheetInfoBody);
            JSONObject data = sheetInfoJson.getJSONObject("data");
            JSONArray sheetArray = data.optJSONArray("musicSheetSimpleInfoVOS");
            if (sheetArray != null) {
                total = sheetArray.size();
                for (int i = 0, len = sheetArray.size(); i < len; i++) {
                    JSONObject sheetJson = sheetArray.getJSONObject(i);

                    String sheetId = sheetJson.getString("id");
                    String name = sheetJson.getString("name");
                    String coverImgUrl = sheetJson.getString("coverImageUrl");
                    String difficulty = sheetJson.getString("difficulty");
                    String musicKey = sheetJson.getString("musicKey");
                    String playVersion = sheetJson.getString("playVersion");
                    String chordName = sheetJson.getString("chordName");
                    Integer pageSize = sheetJson.getInt("totalPageSize");
                    Integer bpm = sheetJson.getInt("bpm");

                    NetSheetInfo sheetInfo = new NetSheetInfo();
                    sheetInfo.setId(sheetId);
                    sheetInfo.setName(name);
                    sheetInfo.setDifficulty(difficulty);
                    sheetInfo.setMusicKey(musicKey);
                    sheetInfo.setPlayVersion(playVersion);
                    sheetInfo.setChordName(chordName);
                    sheetInfo.setPageSize(pageSize);
                    sheetInfo.setBpm(bpm);

                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImg = extractProfile(coverImgUrl);
                        sheetInfo.setCoverImg(coverImg);
                    });

                    sheetInfos.add(sheetInfo);
                }
            }
        }

        return new CommonResult<>(sheetInfos, total);
    }

    /**
     * 获取乐谱图片链接
     */
    public static CommonResult<String> getSheetImgUrls(NetSheetInfo sheetInfo) {
        int source = sheetInfo.getSource();
        String id = sheetInfo.getId();
        LinkedList<String> imgUrls = new LinkedList<>();
        Integer total = 0;

        if (source == NetMusicSource.NET_CLOUD) {
            String imgInfoBody = HttpRequest.get(String.format(GET_SHEETS_IMG_API, id))
                    .execute()
                    .body();
            JSONObject imgInfoJson = JSONObject.fromObject(imgInfoBody);
            JSONArray imgArray = imgInfoJson.getJSONArray("data");
            total = imgArray.size();
            for (int i = 0, len = imgArray.size(); i < len; i++) {
                JSONObject imgJson = imgArray.getJSONObject(i);
                imgUrls.add(imgJson.getString("url"));
            }
        }

        return new CommonResult<>(imgUrls, total);
    }

    /**
     * 获取专辑照片链接
     */
    public static CommonResult<String> getAlbumImgUrls(NetAlbumInfo albumInfo, int page, int limit, String cursor) {
        int source = albumInfo.getSource();
        String id = albumInfo.getId();
        LinkedList<String> imgUrls = new LinkedList<>();
        cursor = StringUtil.encode(cursor);
        Integer total = 0;

        if (source == NetMusicSource.DT) {
            String imgInfoBody = HttpRequest.get(String.format(GET_ALBUMS_IMG_DT_API, id, cursor, limit, System.currentTimeMillis()))
                    .execute()
                    .body();
            JSONObject data = JSONObject.fromObject(imgInfoBody).getJSONObject("data");
            JSONArray imgs = data.getJSONArray("object_list");
            cursor = data.getString("after");
            total = page * limit;
            if (data.getInt("more") == 1) total++;
            else total = (page - 1) * limit + imgs.size();
            for (int i = 0, len = imgs.size(); i < len; i++) {
                JSONObject img = imgs.getJSONObject(i);
                imgUrls.add(img.getJSONObject("photo").getString("path"));
            }
        }

        return new CommonResult<>(imgUrls, total, cursor);
    }

    /**
     * 获取歌手照片链接
     */
    public static CommonResult<String> getArtistImgUrls(NetArtistInfo artistInfo, int page) {
        int source = artistInfo.getSource();
        String id = artistInfo.getId();
        LinkedList<String> imgUrls = new LinkedList<>();
        Integer total = 0;
        final int limit = 30;

        if (source == NetMusicSource.DB) {
            String imgInfoBody = HttpRequest.get(String.format(GET_ARTISTS_IMG_DB_API, id, (page - 1) * limit))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(imgInfoBody);
            Elements imgs = doc.select("ul.poster-col3.clearfix div.cover img");
            String t = ReUtil.get("共(\\d+)张", doc.select("span.count").text(), 1);
            total = StringUtil.isEmpty(t) ? imgs.size() : Integer.parseInt(t);
            for (int i = 0, len = imgs.size(); i < len; i++) {
                Element img = imgs.get(i);
                String url = img.attr("src").replaceFirst("/m/", "/l/");
                imgUrls.add(url);
            }
        }

        return new CommonResult<>(imgUrls, total);
    }

    /**
     * 获取电台照片链接
     */
    public static CommonResult<String> getRadioImgUrls(NetRadioInfo radioInfo, int page) {
        int source = radioInfo.getSource();
        String id = radioInfo.getId();
        boolean isBook = radioInfo.isBook();
        boolean isGame = radioInfo.isGame();
        LinkedList<String> imgUrls = new LinkedList<>();
        Integer total = 0;
        final int limit = isGame ? 24 : 30;

        if (source == NetMusicSource.DB) {
            if (isGame) {
                String imgInfoBody = HttpRequest.get(String.format(GET_GAME_RADIO_IMG_DB_API, id, (page - 1) * limit))
                        .execute()
                        .body();
                Document doc = Jsoup.parse(imgInfoBody);
                Elements imgs = doc.select("div.pholist ul img");
                String t = ReUtil.get("共(\\d+)张", doc.select("span.count").text(), 1);
                total = StringUtil.isEmpty(t) ? imgs.size() : Integer.parseInt(t);
                for (int i = 0, len = imgs.size(); i < len; i++) {
                    Element img = imgs.get(i);
                    String url = img.attr("src").replaceFirst("/thumb/", "/photo/");
                    imgUrls.add(url);
                }
            } else if (!isBook) {
                String imgInfoBody = HttpRequest.get(String.format(GET_RADIO_IMG_DB_API, id, (page - 1) * limit))
                        .execute()
                        .body();
                Document doc = Jsoup.parse(imgInfoBody);
                Elements imgs = doc.select("ul.poster-col3.clearfix div.cover img");
                String t = ReUtil.get("共(\\d+)张", doc.select("span.count").text(), 1);
                total = StringUtil.isEmpty(t) ? imgs.size() : Integer.parseInt(t);
                for (int i = 0, len = imgs.size(); i < len; i++) {
                    Element img = imgs.get(i);
                    String url = img.attr("src").replaceFirst("/m/", "/l/");
                    imgUrls.add(url);
                }
            }
        }

        return new CommonResult<>(imgUrls, total);
    }

    /**
     * 获取电台海报链接
     */
    public static CommonResult<String> getRadioPosterUrls(NetRadioInfo radioInfo, int page) {
        int source = radioInfo.getSource();
        String id = radioInfo.getId();
        boolean isBook = radioInfo.isBook();
        LinkedList<String> imgUrls = new LinkedList<>();
        Integer total = 0;
        final int limit = 30;

        if (source == NetMusicSource.DB && !isBook) {
            String imgInfoBody = HttpRequest.get(String.format(GET_RADIO_POSTER_DB_API, id, (page - 1) * limit))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(imgInfoBody);
            Elements imgs = doc.select("ul.poster-col3.clearfix div.cover img");
            String t = ReUtil.get("共(\\d+)张", doc.select("span.count").text(), 1);
            total = StringUtil.isEmpty(t) ? imgs.size() : Integer.parseInt(t);
            for (int i = 0, len = imgs.size(); i < len; i++) {
                Element img = imgs.get(i);
                String url = img.attr("src").replaceFirst("/m/", "/l/");
                imgUrls.add(url);
            }
        }

        return new CommonResult<>(imgUrls, total);
    }

    /**
     * 提取头像
     *
     * @param imgUrl
     * @return
     */
    private static BufferedImage extractProfile(String imgUrl) {
        return ImageUtil.setRadius(ImageUtil.width(imgUrl, ImageConstants.profileWidth), 0.1);
    }

    /**
     * 提取 MV 封面
     *
     * @param imgUrl
     * @return
     */
    private static BufferedImage extractMvCover(String imgUrl) {
        BufferedImage img = ImageUtil.width(imgUrl, ImageConstants.mvCoverWidth);
        if (img == null) return null;
        // 控制 MV 封面高度不超过阈值
        if (img.getHeight() > ImageConstants.mvCoverMaxHeight)
            img = ImageUtil.height(img, ImageConstants.mvCoverMaxHeight);
        return ImageUtil.setRadius(img, 0.1);
    }

    /**
     * 获取推荐歌单
     */
    public static CommonResult<NetPlaylistInfo> getRecommendPlaylists(int src, String tag, int limit, int page) {
        AtomicInteger total = new AtomicInteger();
        List<NetPlaylistInfo> playlistInfos = new LinkedList<>();

        final String defaultTag = "默认";
        String[] s = Tags.recPlaylistTag.get(tag);

        // 网易云(程序分页)
        // 发现歌单
        Callable<CommonResult<NetPlaylistInfo>> getDiscoverPlaylists = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            final int lim = Math.min(35, limit);
            String playlistInfoBody = HttpRequest.get(String.format(DISCOVER_PLAYLIST_API, (page - 1) * lim, lim))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(playlistInfoBody);
            Elements playlists = doc.select("ul.m-cvrlst.f-cb li");
            Elements a = doc.select(".u-page a");
            t = Integer.parseInt(a.get(a.size() - 2).text()) * limit;
            for (int i = 0, len = playlists.size(); i < len; i++) {
                Element playlist = playlists.get(i);
                Element pa = playlist.select("p.dec a.tit.f-thide.s-fc0").first();
                Element nb = playlist.select(".bottom span.nb").first();
                Element fc = playlist.select("a.nm.nm-icn.f-thide.s-fc3").first();
                Element img = playlist.select(".u-cover.u-cover-1 img").first();

                String playlistId = ReUtil.get("id=(\\d+)", pa.attr("href"), 1);
                String playlistName = pa.text();
                String creator = fc.text();
                String creatorId = ReUtil.get("id=(\\d+)", fc.attr("href"), 1);
                Long playCount = StringUtil.parseNumber(nb.text());
                String coverImgThumbUrl = img.attr("src");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setId(playlistId);
                playlistInfo.setName(playlistName);
                playlistInfo.setCreator(creator);
                playlistInfo.setCreatorId(creatorId);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                playlistInfo.setPlayCount(playCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 个人推荐
        Callable<CommonResult<NetPlaylistInfo>> getRecommendPlaylists = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            String playlistInfoBody = HttpRequest.get(RECOMMEND_PLAYLIST_API)
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONArray playlistArray = playlistInfoJson.getJSONArray("result");
            t = playlistArray.size();
            for (int i = (page - 1) * limit, len = Math.min(playlistArray.size(), page * limit); i < len; i++) {
                JSONObject playlistJson = playlistArray.getJSONObject(i);

                String playlistId = playlistJson.getString("id");
                String playlistName = playlistJson.getString("name");
                Long playCount = playlistJson.getLong("playCount");
                Integer trackCount = playlistJson.getInt("trackCount");
                String coverImgThumbUrl = playlistJson.getString("picUrl");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setId(playlistId);
                playlistInfo.setName(playlistName);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                playlistInfo.setPlayCount(playCount);
                playlistInfo.setTrackCount(trackCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 曲风歌单
        Callable<CommonResult<NetPlaylistInfo>> getStylePlaylists = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[0])) {
                String playlistInfoBody = HttpRequest.get(String.format(STYLE_PLAYLIST_API, s[0], (page - 1) * limit, limit))
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                JSONObject data = playlistInfoJson.getJSONObject("data");
                JSONArray playlistArray = data.getJSONArray("playlist");
                t = data.getJSONObject("page").getInt("total");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("id");
                    String playlistName = playlistJson.getString("name");
                    String creator = playlistJson.getString("userName");
                    String creatorId = playlistJson.getString("userId");
                    Long playCount = playlistJson.getLong("playCount");
                    Integer trackCount = playlistJson.getInt("songCount");
                    String coverImgThumbUrl = playlistJson.getString("cover");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCreatorId(creatorId);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    playlistInfo.setTrackCount(trackCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 酷狗(接口分页)
        // 每页固定 30 条的推荐歌单
        Callable<CommonResult<NetPlaylistInfo>> getRecommendPlaylistsKg = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            String playlistInfoBody = HttpRequest.get(String.format(RECOMMEND_PLAYLIST_KG_API, page))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONObject("plist").getJSONObject("list");
            t = data.getInt("total");
            JSONArray playlistArray = data.getJSONArray("info");
            for (int i = 0, len = playlistArray.size(); i < len; i++) {
                JSONObject playlistJson = playlistArray.getJSONObject(i);

                String playlistId = playlistJson.getString("specialid");
                String playlistName = playlistJson.getString("specialname");
                String creator = playlistJson.getString("username");
                Long playCount = playlistJson.getLong("playcount");
                Integer trackCount = playlistJson.optInt("songcount", -1);
                String coverImgThumbUrl = playlistJson.getString("imgurl").replace("/{size}", "");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setSource(NetMusicSource.KG);
                playlistInfo.setId(playlistId);
                playlistInfo.setName(playlistName);
                playlistInfo.setCreator(creator);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                playlistInfo.setPlayCount(playCount);
                playlistInfo.setTrackCount(trackCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 推荐歌单(推荐)
        Callable<CommonResult<NetPlaylistInfo>> getRecommendTagPlaylistsKg = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[1])) {
                String playlistInfoBody = HttpRequest.get(String.format(RECOMMEND_CAT_PLAYLIST_KG_API, s[1].trim(), page))
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                t = limit * 100;
                JSONArray playlistArray = playlistInfoJson.getJSONArray("special_db");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("specialid");
                    String playlistName = playlistJson.getString("specialname");
                    String creator = playlistJson.getString("nickname");
                    Long playCount = StringUtil.parseNumber(playlistJson.getString("total_play_count"));
                    String coverImgThumbUrl = playlistJson.getString("img");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.KG);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 推荐歌单(最新)
        Callable<CommonResult<NetPlaylistInfo>> getNewTagPlaylistsKg = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[1])) {
                String playlistInfoBody = HttpRequest.get(String.format(NEW_CAT_PLAYLIST_KG_API, s[1].trim(), page))
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                t = limit * 100;
                JSONArray playlistArray = playlistInfoJson.getJSONArray("special_db");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("specialid");
                    String playlistName = playlistJson.getString("specialname");
                    String creator = playlistJson.getString("nickname");
                    Long playCount = StringUtil.parseNumber(playlistJson.getString("total_play_count"));
                    String coverImgThumbUrl = playlistJson.getString("img");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.KG);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // QQ
        // 每日推荐(程序分页)
        Callable<CommonResult<NetPlaylistInfo>> getRecommendPlaylistsQqDaily = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            String playlistInfoBody = HttpRequest.get(DAILY_RECOMMEND_PLAYLIST_QQ_API)
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONArray playlistArray = playlistInfoJson.getJSONObject("data").getJSONArray("list");
            t = playlistArray.size();
            for (int i = (page - 1) * limit, len = Math.min(playlistArray.size(), page * limit); i < len; i++) {
                JSONObject playlistJson = playlistArray.getJSONObject(i);

                String playlistId = playlistJson.getString("content_id");
                String playlistName = playlistJson.getString("title");
                String creator = playlistJson.getString("username");
                Long playCount = playlistJson.getLong("listen_num");
                String coverImgThumbUrl = playlistJson.getString("cover");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setSource(NetMusicSource.QQ);
                playlistInfo.setId(playlistId);
                playlistInfo.setName(playlistName);
                playlistInfo.setCreator(creator);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                playlistInfo.setPlayCount(playCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 推荐歌单(程序分页)
//        Callable<CommonResult<NetPlaylistInfo>> getRecommendPlaylistsQq = () -> {
//            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
//            Integer t = 0;
//
//            if (StringUtils.isNotEmpty(s[0])) {
//                String playlistInfoBody = HttpRequest.get(String.format(RECOMMEND_PLAYLIST_QQ_API, s[0]))
//                        .execute()
//                        .body();
//                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
//                JSONArray playlistArray = playlistInfoJson.getJSONObject("data").getJSONArray("list");
//                t = playlistArray.size();
//                for (int i = (page - 1) * limit, len = Math.min(playlistArray.size(), page * limit); i < len; i++) {
//                    JSONObject playlistJson = playlistArray.getJSONObject(i);
//
//                    String playlistId = playlistJson.getString("tid");
//                    String playlistName = playlistJson.getString("title");
//                    String creator = playlistJson.getJSONObject("creator_info").getString("nick");
//                    Long playCount = playlistJson.getLong("access_num");
//                    Integer trackCount = playlistJson.getJSONArray("song_ids").size();
//                    String coverImgThumbUrl = playlistJson.getString("cover_url_big");
//
//                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
//                    playlistInfo.setSource(NetMusicSource.QQ);
//                    playlistInfo.setId(playlistId);
//                    playlistInfo.setName(playlistName);
//                    playlistInfo.setCreator(creator);
//                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
//                    playlistInfo.setPlayCount(playCount);
//                    playlistInfo.setTrackCount(trackCount);
//                    GlobalExecutors.imageExecutor.execute(() -> {
//                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
//                        playlistInfo.setCoverImgThumb(coverImgThumb);
//                    });
//
//                    res.add(playlistInfo);
//                }
//            }
//            return new CommonResult<>(res, t);
//        };
        // 分类推荐歌单(最新)(接口分页)
        Callable<CommonResult<NetPlaylistInfo>> getNewPlaylistsQq = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[2])) {
                String cat = s[2];
                boolean isAll = "10000000".equals(cat);
                String url;
                if (isAll) {
                    url = NEW_PLAYLIST_QQ_API + StringUtil.encode(String.format(
                            "{\"comm\":{\"cv\":1602,\"ct\":20}," +
                                    "\"playlist\":{" +
                                    "\"method\":\"get_playlist_by_tag\"," +
                                    "\"param\":{\"id\":10000000,\"sin\":%s,\"size\":%s,\"order\":2,\"cur_page\":%s}," +
                                    "\"module\":\"playlist.PlayListPlazaServer\"}}", (page - 1) * limit, limit, page));
                } else {
                    url = NEW_PLAYLIST_QQ_API + StringUtil.encode(String.format(
                            "{\"comm\":{\"cv\":1602,\"ct\":20}," +
                                    "\"playlist\":{" +
                                    "\"method\":\"get_category_content\"," +
                                    "\"param\":{" +
                                    "\"titleid\":%s," +
                                    "\"caller\":\"0\"," +
                                    "\"category_id\":%s," +
                                    "\"size\":%s," +
                                    "\"page\":%s," +
                                    "\"use_page\":1}," +
                                    "\"module\":\"playlist.PlayListCategoryServer\"}}", cat, cat, limit, page - 1));
                }
                String playlistInfoBody = HttpRequest.get(url)
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                if (isAll) {
                    JSONObject data = playlistInfoJson.getJSONObject("playlist").getJSONObject("data");
                    t = data.getInt("total");
                    JSONArray playlistArray = data.getJSONArray("v_playlist");
                    for (int i = 0, len = playlistArray.size(); i < len; i++) {
                        JSONObject playlistJson = playlistArray.getJSONObject(i);

                        String playlistId = playlistJson.getString("tid");
                        String playlistName = playlistJson.getString("title");
                        String creator = playlistJson.getJSONObject("creator_info").getString("nick");
                        Long playCount = playlistJson.getLong("access_num");
                        String coverImgThumbUrl = playlistJson.getString("cover_url_small");

                        NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                        playlistInfo.setSource(NetMusicSource.QQ);
                        playlistInfo.setId(playlistId);
                        playlistInfo.setName(playlistName);
                        playlistInfo.setCreator(creator);
                        playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                        playlistInfo.setPlayCount(playCount);
                        GlobalExecutors.imageExecutor.execute(() -> {
                            BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                            playlistInfo.setCoverImgThumb(coverImgThumb);
                        });

                        res.add(playlistInfo);
                    }
                } else {
                    JSONObject data = playlistInfoJson.getJSONObject("playlist").getJSONObject("data").getJSONObject("content");
                    t = data.getInt("total_cnt");
                    JSONArray playlistArray = data.getJSONArray("v_item");
                    for (int i = 0, len = playlistArray.size(); i < len; i++) {
                        JSONObject playlistJson = playlistArray.getJSONObject(i).getJSONObject("basic");

                        String playlistId = playlistJson.getString("tid");
                        String playlistName = playlistJson.getString("title");
                        String creator = playlistJson.getJSONObject("creator").getString("nick");
                        Long playCount = playlistJson.getLong("play_cnt");
                        String coverImgThumbUrl = playlistJson.getJSONObject("cover").getString("small_url");

                        NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                        playlistInfo.setSource(NetMusicSource.QQ);
                        playlistInfo.setId(playlistId);
                        playlistInfo.setName(playlistName);
                        playlistInfo.setCreator(creator);
                        playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                        playlistInfo.setPlayCount(playCount);
                        GlobalExecutors.imageExecutor.execute(() -> {
                            BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                            playlistInfo.setCoverImgThumb(coverImgThumb);
                        });

                        res.add(playlistInfo);
                    }
                }
            }
            return new CommonResult<>(res, t);
        };

        // 酷我
        // 推荐歌单(程序分页)
        Callable<CommonResult<NetPlaylistInfo>> getRecommendPlaylistsKw = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = kwRequest(RECOMMEND_PLAYLIST_KW_API).execute();
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                String playlistInfoBody = resp.body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                JSONArray playlistArray = playlistInfoJson.getJSONObject("data").getJSONArray("list");
                t = playlistArray.size();
                for (int i = (page - 1) * limit, len = Math.min(playlistArray.size(), page * limit); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("id");
                    String playlistName = playlistJson.getString("name");
                    String creator = playlistJson.getString("uname");
                    Long playCount = playlistJson.getLong("listencnt");
                    Integer trackCount = playlistJson.getInt("total");
                    String coverImgThumbUrl = playlistJson.getString("img");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.KW);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    playlistInfo.setTrackCount(trackCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 推荐歌单(最新)(程序分页)
        Callable<CommonResult<NetPlaylistInfo>> getNewPlaylistsKw = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = HttpRequest.get(String.format(NEW_PLAYLIST_KW_API, page, limit)).execute();
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                String playlistInfoBody = resp.body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                JSONObject data = playlistInfoJson.getJSONObject("data");
                t = data.getInt("total");
                JSONArray playlistArray = data.getJSONArray("data");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("id");
                    String playlistName = playlistJson.getString("name");
                    String creator = playlistJson.getString("uname");
                    Long playCount = playlistJson.getLong("listencnt");
                    Integer trackCount = playlistJson.getInt("total");
                    String coverImgThumbUrl = playlistJson.getString("img");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.KW);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    playlistInfo.setTrackCount(trackCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 咪咕(接口分页)
        // 推荐歌单(最新)
        Callable<CommonResult<NetPlaylistInfo>> getRecNewPlaylistsMg = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            String playlistInfoBody = HttpRequest.get(String.format(REC_NEW_PLAYLIST_MG_API, page, limit))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONObject("data").getJSONArray("contentItemList").getJSONObject(0);
            t = 1000;
            JSONArray playlistArray = data.getJSONArray("itemList");
            for (int i = 0, len = playlistArray.size(); i < len; i++) {
                JSONObject playlistJson = playlistArray.getJSONObject(i);

                String playlistId = ReUtil.get("id=(\\d+)", playlistJson.getString("actionUrl"), 1);
                String playlistName = playlistJson.getString("title");
                String creator = playlistJson.getString("subTitle");
                String fs = playlistJson.getJSONArray("barList").getJSONObject(0).getString("title");
                Long playCount = StringUtil.parseNumber(fs);
                String coverImgThumbUrl = playlistJson.getString("imageUrl");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setSource(NetMusicSource.MG);
                playlistInfo.setId(playlistId);
                playlistInfo.setName(playlistName);
                playlistInfo.setCreator("null".equals(creator) ? "" : creator);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                playlistInfo.setPlayCount(playCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 推荐歌单(每页固定 10 条)
        Callable<CommonResult<NetPlaylistInfo>> getRecommendPlaylistsMg = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            String playlistInfoBody = HttpRequest.get(String.format(RECOMMEND_PLAYLIST_MG_API, (page - 1) * 10))
                    .header(Header.USER_AGENT, "Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1")
                    .header(Header.REFERER, "https://m.music.migu.cn/")
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONObject("retMsg");
            t = data.getInt("countSize");
            JSONArray playlistArray = data.getJSONArray("playlist");
            for (int i = 0, len = playlistArray.size(); i < len; i++) {
                JSONObject playlistJson = playlistArray.getJSONObject(i);

                String playlistId = playlistJson.getString("playListId");
                String playlistName = playlistJson.getString("playListName");
                String creator = playlistJson.getString("createName");
                Long playCount = playlistJson.getLong("playCount");
                Integer trackCount = playlistJson.getInt("contentCount");
                String coverImgThumbUrl = playlistJson.getString("image");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setSource(NetMusicSource.MG);
                playlistInfo.setId(playlistId);
                playlistInfo.setName(playlistName);
                playlistInfo.setCreator("null".equals(creator) ? "" : creator);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                playlistInfo.setPlayCount(playCount);
                playlistInfo.setTrackCount(trackCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 最新歌单(每页固定 10 条)
        Callable<CommonResult<NetPlaylistInfo>> getNewPlaylistsMg = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            String playlistInfoBody = HttpRequest.get(String.format(NEW_PLAYLIST_MG_API, (page - 1) * 10))
                    .header(Header.USER_AGENT, "Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1")
                    .header(Header.REFERER, "https://m.music.migu.cn/")
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONObject("retMsg");
            t = data.getInt("countSize");
            JSONArray playlistArray = data.getJSONArray("playlist");
            for (int i = 0, len = playlistArray.size(); i < len; i++) {
                JSONObject playlistJson = playlistArray.getJSONObject(i);

                String playlistId = playlistJson.getString("playListId");
                String playlistName = playlistJson.getString("playListName");
                String creator = playlistJson.getString("createName");
                Long playCount = playlistJson.getLong("playCount");
                Integer trackCount = playlistJson.getInt("contentCount");
                String coverImgThumbUrl = playlistJson.getString("image");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setSource(NetMusicSource.MG);
                playlistInfo.setId(playlistId);
                playlistInfo.setName(playlistName);
                playlistInfo.setCreator("null".equals(creator) ? "" : creator);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                playlistInfo.setPlayCount(playCount);
                playlistInfo.setTrackCount(trackCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 千千
        // 推荐歌单
        Callable<CommonResult<NetPlaylistInfo>> getRecPlaylistsQi = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            String playlistInfoBody = HttpRequest.get(buildQianUrl(String.format(REC_PLAYLIST_QI_API, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONArray("data").getJSONObject(4);
            t = data.getInt("module_nums");
            JSONArray playlistArray = data.getJSONArray("result");
            for (int i = (page - 1) * limit, len = Math.min(playlistArray.size(), page * limit); i < len; i++) {
                JSONObject playlistJson = playlistArray.getJSONObject(i);

                String playlistId = playlistJson.getString("id");
                String playlistName = playlistJson.getString("title");
                Integer trackCount = playlistJson.getInt("trackCount");
                String coverImgThumbUrl = playlistJson.getString("pic");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setSource(NetMusicSource.QI);
                playlistInfo.setId(playlistId);
                playlistInfo.setName(playlistName);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                playlistInfo.setTrackCount(trackCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 猫耳
        // 推荐歌单
        Callable<CommonResult<NetPlaylistInfo>> getRecPlaylistsMe = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            String playlistInfoBody = HttpRequest.get(String.format(REC_PLAYLIST_ME_API))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject info = playlistInfoJson.getJSONObject("info");
            JSONArray playlistArray = info.getJSONArray("albums");
            t = playlistArray.size();
            for (int i = (page - 1) * limit, len = Math.min(playlistArray.size(), page * limit); i < len; i++) {
                JSONObject playlistJson = playlistArray.getJSONObject(i);

                String playlistId = playlistJson.getString("id");
                String playlistName = playlistJson.getString("title");
                String creator = playlistJson.getString("username");
                String creatorId = playlistJson.getString("user_id");
                Integer trackCount = playlistJson.getInt("music_count");
                Long playCount = playlistJson.getLong("view_count");
                String coverImgThumbUrl = playlistJson.getString("front_cover");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setSource(NetMusicSource.ME);
                playlistInfo.setId(playlistId);
                playlistInfo.setName(playlistName);
                playlistInfo.setCreator(creator);
                playlistInfo.setCreatorId(creatorId);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                playlistInfo.setTrackCount(trackCount);
                playlistInfo.setPlayCount(playCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 分类歌单(最新)
        Callable<CommonResult<NetPlaylistInfo>> getNewPlaylistsMe = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[3])) {
                String playlistInfoBody = HttpRequest.get(String.format(NEW_PLAYLIST_ME_API, s[3].trim(), page, limit))
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                t = playlistInfoJson.getJSONObject("pagination").getInt("count");
                JSONArray playlistArray = playlistInfoJson.getJSONArray("albums");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("id");
                    String playlistName = playlistJson.getString("title");
                    String creator = playlistJson.getString("username");
                    String creatorId = playlistJson.getString("user_id");
                    Integer trackCount = playlistJson.getInt("music_count");
                    String coverImgThumbUrl = playlistJson.getString("front_cover");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.ME);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCreatorId(creatorId);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setTrackCount(trackCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 哔哩哔哩
        // 推荐歌单
        Callable<CommonResult<NetPlaylistInfo>> getRecPlaylistsBi = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            String playlistInfoBody = HttpRequest.get(String.format(NEW_PLAYLIST_BI_API, page, limit))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONObject("data");
            t = data.getInt("totalSize");
            JSONArray playlistArray = data.getJSONArray("data");
            for (int i = 0, len = playlistArray.size(); i < len; i++) {
                JSONObject playlistJson = playlistArray.getJSONObject(i);
                JSONObject statistic = playlistJson.getJSONObject("statistic");

                String playlistId = statistic.getString("sid");
                String playlistName = playlistJson.getString("title");
                String creator = playlistJson.getString("uname");
                String creatorId = playlistJson.getString("uid");
                Integer trackCount = playlistJson.getInt("snum");
                Long playCount = statistic.getLong("play");
                String coverImgThumbUrl = playlistJson.getString("cover");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setSource(NetMusicSource.BI);
                playlistInfo.setId(playlistId);
                playlistInfo.setName(playlistName);
                playlistInfo.setCreator(creator);
                playlistInfo.setCreatorId(creatorId);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                playlistInfo.setTrackCount(trackCount);
                playlistInfo.setPlayCount(playCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
            return new CommonResult<>(res, t);
        };

        List<Future<CommonResult<NetPlaylistInfo>>> taskList = new LinkedList<>();

        boolean dt = defaultTag.equals(tag);

        if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getDiscoverPlaylists));
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendPlaylists));
            if (!dt) taskList.add(GlobalExecutors.requestExecutor.submit(getStylePlaylists));
        }

        if (src == NetMusicSource.KG || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendPlaylistsKg));
            taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendTagPlaylistsKg));
            taskList.add(GlobalExecutors.requestExecutor.submit(getNewTagPlaylistsKg));
        }

        if (src == NetMusicSource.QQ || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendPlaylistsQqDaily));
//        taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendPlaylistsQq));
            taskList.add(GlobalExecutors.requestExecutor.submit(getNewPlaylistsQq));
        }

        if (src == NetMusicSource.KW || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendPlaylistsKw));
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getNewPlaylistsKw));
        }

        if (src == NetMusicSource.MG || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getRecNewPlaylistsMg));
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendPlaylistsMg));
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getNewPlaylistsMg));
        }

        if (src == NetMusicSource.QI || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getRecPlaylistsQi));
        }

        if (src == NetMusicSource.ME || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getRecPlaylistsMe));
            taskList.add(GlobalExecutors.requestExecutor.submit(getNewPlaylistsMe));
        }

        if (src == NetMusicSource.BI || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getRecPlaylistsBi));
        }

        List<List<NetPlaylistInfo>> rl = new LinkedList<>();
        taskList.forEach(task -> {
            try {
                CommonResult<NetPlaylistInfo> result = task.get();
                rl.add(result.data);
                total.set(Math.max(total.get(), result.total));
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
        playlistInfos.addAll(ListUtil.joinAll(rl));

        return new CommonResult<>(playlistInfos, total.get());
    }

    /**
     * 获取精品歌单 + 网友精选碟，分页
     */
    public static CommonResult<NetPlaylistInfo> getHighQualityPlaylists(int src, String tag, int limit, int page) {
        AtomicInteger total = new AtomicInteger();
        List<NetPlaylistInfo> playlistInfos = new LinkedList<>();

        final String defaultTag = "默认";
        String[] s = Tags.playlistTag.get(tag);

        // 网易云
        // 精品歌单(程序分页)
        Callable<CommonResult<NetPlaylistInfo>> getHighQualityPlaylists = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[0])) {
                String playlistInfoBody = HttpRequest.get(String.format(HIGH_QUALITY_PLAYLIST_API, s[0]))
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                JSONArray playlistArray = playlistInfoJson.getJSONArray("playlists");
                t = playlistArray.size();
                for (int i = (page - 1) * limit, len = Math.min(playlistArray.size(), page * limit); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);
                    JSONObject ct = playlistJson.optJSONObject("creator");

                    String playlistId = playlistJson.getString("id");
                    String name = playlistJson.getString("name");
                    String creator = ct != null ? ct.getString("nickname") : "";
                    String creatorId = ct != null ? ct.getString("userId") : "";
                    Long playCount = playlistJson.getLong("playCount");
                    Integer trackCount = playlistJson.getInt("trackCount");
                    String coverImgThumbUrl = playlistJson.getString("coverImgUrl");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(name);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCreatorId(creatorId);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    playlistInfo.setTrackCount(trackCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 网友精选碟(最热)(接口分页)
        Callable<CommonResult<NetPlaylistInfo>> getHotPickedPlaylists = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[1])) {
                String playlistInfoBody = HttpRequest.get(String.format(HOT_PICKED_PLAYLIST_API, s[1], limit, (page - 1) * limit))
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                t = playlistInfoJson.getInt("total");
                JSONArray playlistArray = playlistInfoJson.getJSONArray("playlists");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);
                    JSONObject ct = playlistJson.optJSONObject("creator");

                    String playlistId = playlistJson.getString("id");
                    String name = playlistJson.getString("name");
                    String creator = ct != null ? ct.getString("nickname") : "";
                    String creatorId = ct != null ? ct.getString("userId") : "";
                    Long playCount = playlistJson.getLong("playCount");
                    Integer trackCount = playlistJson.getInt("trackCount");
                    String coverImgThumbUrl = playlistJson.getString("coverImgUrl");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(name);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCreatorId(creatorId);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    playlistInfo.setTrackCount(trackCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 网友精选碟(最新)(接口分页)
        Callable<CommonResult<NetPlaylistInfo>> getNewPickedPlaylists = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[1])) {
                String playlistInfoBody = HttpRequest.get(String.format(NEW_PICKED_PLAYLIST_API, s[1], limit, (page - 1) * limit))
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                t = playlistInfoJson.getInt("total");
                JSONArray playlistArray = playlistInfoJson.getJSONArray("playlists");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);
                    JSONObject ct = playlistJson.optJSONObject("creator");

                    String playlistId = playlistJson.getString("id");
                    String name = playlistJson.getString("name");
                    String creator = ct != null ? ct.getString("nickname") : "";
                    String creatorId = ct != null ? ct.getString("userId") : "";
                    Long playCount = playlistJson.getLong("playCount");
                    Integer trackCount = playlistJson.getInt("trackCount");
                    String coverImgThumbUrl = playlistJson.getString("coverImgUrl");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(name);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCreatorId(creatorId);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    playlistInfo.setTrackCount(trackCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 酷狗
        // 推荐歌单(最热)
        Callable<CommonResult<NetPlaylistInfo>> getTagPlaylistsKg = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[2])) {
                String playlistInfoBody = HttpRequest.get(String.format(CAT_PLAYLIST_KG_API, s[2].trim(), page))
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                t = limit * 100;
                JSONArray playlistArray = playlistInfoJson.getJSONArray("special_db");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("specialid");
                    String playlistName = playlistJson.getString("specialname");
                    String creator = playlistJson.getString("nickname");
                    Long playCount = StringUtil.parseNumber(playlistJson.getString("total_play_count"));
                    String coverImgThumbUrl = playlistJson.getString("img");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.KG);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 推荐歌单(热藏)
        Callable<CommonResult<NetPlaylistInfo>> getHotCollectedTagPlaylistsKg = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[2])) {
                String playlistInfoBody = HttpRequest.get(String.format(HOT_COLLECTED_CAT_PLAYLIST_KG_API, s[2].trim(), page))
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                t = limit * 100;
                JSONArray playlistArray = playlistInfoJson.getJSONArray("special_db");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("specialid");
                    String playlistName = playlistJson.getString("specialname");
                    String creator = playlistJson.getString("nickname");
                    Long playCount = StringUtil.parseNumber(playlistJson.getString("total_play_count"));
                    String coverImgThumbUrl = playlistJson.getString("img");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.KG);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 推荐歌单(飙升)
        Callable<CommonResult<NetPlaylistInfo>> getUpTagPlaylistsKg = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[2])) {
                String playlistInfoBody = HttpRequest.get(String.format(UP_CAT_PLAYLIST_KG_API, s[2].trim(), page))
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                t = limit * 100;
                JSONArray playlistArray = playlistInfoJson.getJSONArray("special_db");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("specialid");
                    String playlistName = playlistJson.getString("specialname");
                    String creator = playlistJson.getString("nickname");
                    Long playCount = StringUtil.parseNumber(playlistJson.getString("total_play_count"));
                    String coverImgThumbUrl = playlistJson.getString("img");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.KG);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 热门歌单(这个接口不分页，分开处理)
        Callable<CommonResult<NetPlaylistInfo>> getHotPlaylistsKg = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            String playlistInfoBody = HttpRequest.get(String.format(HOT_PLAYLIST_KG_API))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONObject("data");
            JSONArray playlistArray = data.getJSONArray("list");
            t = playlistArray.size();
            for (int i = (page - 1) * limit, len = Math.min(playlistArray.size(), page * limit); i < len; i++) {
                JSONObject playlistJson = playlistArray.getJSONObject(i);

                String playlistId = playlistJson.getString("specialid");
                String playlistName = playlistJson.getString("specialname");
                String creator = playlistJson.getString("nickname");
                Long playCount = playlistJson.getLong("playcount");
                Integer trackCount = playlistJson.getInt("songcount");
                String coverImgThumbUrl = playlistJson.getString("imgurl").replace("/{size}", "");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setSource(NetMusicSource.KG);
                playlistInfo.setId(playlistId);
                playlistInfo.setName(playlistName);
                playlistInfo.setCreator(creator);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                playlistInfo.setPlayCount(playCount);
                playlistInfo.setTrackCount(trackCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
            return new CommonResult<>(res, t);
        };

        // QQ
        // 分类推荐歌单(接口分页)
        Callable<CommonResult<NetPlaylistInfo>> getCatPlaylistsQq = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[3])) {
                String cat = s[3];
                boolean isAll = "10000000".equals(cat);
                String url;
                if (isAll) {
                    url = CAT_PLAYLIST_QQ_API + StringUtil.encode(String.format(
                            "{\"comm\":{\"cv\":1602,\"ct\":20}," +
                                    "\"playlist\":{" +
                                    "\"method\":\"get_playlist_by_tag\"," +
                                    "\"param\":{\"id\":10000000,\"sin\":%s,\"size\":%s,\"order\":5,\"cur_page\":%s}," +
                                    "\"module\":\"playlist.PlayListPlazaServer\"}}", (page - 1) * limit, limit, page));
                } else {
                    url = CAT_PLAYLIST_QQ_API + StringUtil.encode(String.format(
                            "{\"comm\":{\"cv\":1602,\"ct\":20}," +
                                    "\"playlist\":{" +
                                    "\"method\":\"get_category_content\"," +
                                    "\"param\":{" +
                                    "\"titleid\":%s," +
                                    "\"caller\":\"0\"," +
                                    "\"category_id\":%s," +
                                    "\"size\":%s," +
                                    "\"page\":%s," +
                                    "\"use_page\":1}," +
                                    "\"module\":\"playlist.PlayListCategoryServer\"}}", cat, cat, limit, page - 1));
                }
                String playlistInfoBody = HttpRequest.get(url)
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                if (isAll) {
                    JSONObject data = playlistInfoJson.getJSONObject("playlist").getJSONObject("data");
                    t = data.getInt("total");
                    JSONArray playlistArray = data.getJSONArray("v_playlist");
                    for (int i = 0, len = playlistArray.size(); i < len; i++) {
                        JSONObject playlistJson = playlistArray.getJSONObject(i);

                        String playlistId = playlistJson.getString("tid");
                        String playlistName = playlistJson.getString("title");
                        String creator = playlistJson.getJSONObject("creator_info").getString("nick");
                        Long playCount = playlistJson.getLong("access_num");
                        String coverImgThumbUrl = playlistJson.getString("cover_url_small");

                        NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                        playlistInfo.setSource(NetMusicSource.QQ);
                        playlistInfo.setId(playlistId);
                        playlistInfo.setName(playlistName);
                        playlistInfo.setCreator(creator);
                        playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                        playlistInfo.setPlayCount(playCount);
                        GlobalExecutors.imageExecutor.execute(() -> {
                            BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                            playlistInfo.setCoverImgThumb(coverImgThumb);
                        });

                        res.add(playlistInfo);
                    }
                } else {
                    JSONObject data = playlistInfoJson.getJSONObject("playlist").getJSONObject("data").getJSONObject("content");
                    t = data.getInt("total_cnt");
                    JSONArray playlistArray = data.getJSONArray("v_item");
                    for (int i = 0, len = playlistArray.size(); i < len; i++) {
                        JSONObject playlistJson = playlistArray.getJSONObject(i).getJSONObject("basic");

                        String playlistId = playlistJson.getString("tid");
                        String playlistName = playlistJson.getString("title");
                        String creator = playlistJson.getJSONObject("creator").getString("nick");
                        Long playCount = playlistJson.getLong("play_cnt");
                        String coverImgThumbUrl = playlistJson.getJSONObject("cover").getString("small_url");

                        NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                        playlistInfo.setSource(NetMusicSource.QQ);
                        playlistInfo.setId(playlistId);
                        playlistInfo.setName(playlistName);
                        playlistInfo.setCreator(creator);
                        playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                        playlistInfo.setPlayCount(playCount);
                        GlobalExecutors.imageExecutor.execute(() -> {
                            BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                            playlistInfo.setCoverImgThumb(coverImgThumb);
                        });

                        res.add(playlistInfo);
                    }
                }
            }
            return new CommonResult<>(res, t);
        };

        // 酷我
        // 热门歌单
        Callable<CommonResult<NetPlaylistInfo>> getHotPlaylistsKw = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = HttpRequest.get(String.format(HOT_PLAYLIST_KW_API, page, limit))
                    .setFollowRedirects(true)
                    .execute();
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                String playlistInfoBody = resp.body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                JSONObject data = playlistInfoJson.getJSONObject("data");
                t = data.getInt("total");
                JSONArray playlistArray = data.getJSONArray("data");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("id");
                    String playlistName = playlistJson.getString("name");
                    String creator = playlistJson.getString("uname");
                    Long playCount = playlistJson.getLong("listencnt");
                    Integer trackCount = playlistJson.getInt("total");
                    String coverImgThumbUrl = playlistJson.getString("img");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.KW);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    playlistInfo.setTrackCount(trackCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 默认歌单(热门)(接口分页)
        Callable<CommonResult<NetPlaylistInfo>> getDefaultPlaylistsKw = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = HttpRequest.get(String.format(DEFAULT_PLAYLIST_KW_API, page, limit)).execute();
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                String playlistInfoBody = resp.body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                JSONObject data = playlistInfoJson.getJSONObject("data");
                t = data.getInt("total");
                JSONArray playlistArray = data.getJSONArray("data");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("id");
                    String playlistName = playlistJson.getString("name");
                    String creator = playlistJson.getString("uname");
                    Long playCount = playlistJson.getLong("listencnt");
                    Integer trackCount = playlistJson.getInt("total");
                    String coverImgThumbUrl = playlistJson.getString("img");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.KW);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    playlistInfo.setTrackCount(trackCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 分类歌单(接口分页)
        Callable<CommonResult<NetPlaylistInfo>> getCatPlaylistsKw = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[4])) {
                String[] sp = s[4].split(" ");
                // 根据 digest 信息请求不同的分类歌单接口
                if ("43".equals(sp[1])) {
                    HttpResponse resp = HttpRequest.get(String.format(CAT_PLAYLIST_KW_API_2, sp[0])).execute();
                    if (resp.getStatus() == HttpStatus.HTTP_OK) {
                        String playlistInfoBody = resp.body();
                        JSONArray playlistArray = JSONArray.fromObject(playlistInfoBody);
                        for (int i = 0, l = playlistArray.size(); i < l; i++) {
                            JSONArray list = playlistArray.getJSONObject(i).getJSONArray("list");
                            for (int j = 0, k = list.size(); j < k; j++, t++) {
                                if (t >= (page - 1) * limit && t < page * limit) {
                                    JSONObject playlistJson = list.getJSONObject(j);

                                    String playlistId = playlistJson.getString("id");
                                    String playlistName = playlistJson.getString("name");
                                    String coverImgThumbUrl = playlistJson.getString("img");

                                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                                    playlistInfo.setSource(NetMusicSource.KW);
                                    playlistInfo.setId(playlistId);
                                    playlistInfo.setName(playlistName);
                                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                                    GlobalExecutors.imageExecutor.execute(() -> {
                                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                                        playlistInfo.setCoverImgThumb(coverImgThumb);
                                    });

                                    res.add(playlistInfo);
                                }
                            }
                        }
                    }
                } else {
                    HttpResponse resp = HttpRequest.get(String.format(CAT_PLAYLIST_KW_API, sp[0], page, limit)).execute();
                    if (resp.getStatus() == HttpStatus.HTTP_OK) {
                        String playlistInfoBody = resp.body();
                        JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                        JSONObject data = playlistInfoJson.getJSONObject("data");
                        t = data.getInt("total");
                        JSONArray playlistArray = data.getJSONArray("data");
                        for (int i = 0, len = playlistArray.size(); i < len; i++) {
                            JSONObject playlistJson = playlistArray.getJSONObject(i);

                            String playlistId = playlistJson.getString("id");
                            String playlistName = playlistJson.getString("name");
                            String creator = playlistJson.getString("uname");
                            Long playCount = playlistJson.getLong("listencnt");
                            Integer trackCount = playlistJson.getInt("total");
                            String coverImgThumbUrl = playlistJson.getString("img");

                            NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                            playlistInfo.setSource(NetMusicSource.KW);
                            playlistInfo.setId(playlistId);
                            playlistInfo.setName(playlistName);
                            playlistInfo.setCreator(creator);
                            playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                            playlistInfo.setPlayCount(playCount);
                            playlistInfo.setTrackCount(trackCount);
                            GlobalExecutors.imageExecutor.execute(() -> {
                                BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                                playlistInfo.setCoverImgThumb(coverImgThumb);
                            });

                            res.add(playlistInfo);
                        }
                    }
                }
            }
            return new CommonResult<>(res, t);
        };

        // 咪咕
        // 推荐歌单(最热)
        Callable<CommonResult<NetPlaylistInfo>> getRecHotPlaylistsMg = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            String playlistInfoBody = HttpRequest.get(String.format(REC_HOT_PLAYLIST_MG_API, page, limit))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONObject("data").getJSONArray("contentItemList").getJSONObject(0);
            t = 1000;
            JSONArray playlistArray = data.getJSONArray("itemList");
            for (int i = 0, len = playlistArray.size(); i < len; i++) {
                JSONObject playlistJson = playlistArray.getJSONObject(i);

                String playlistId = ReUtil.get("id=(\\d+)", playlistJson.getString("actionUrl"), 1);
                String playlistName = playlistJson.getString("title");
                String creator = playlistJson.getString("subTitle");
                String fs = playlistJson.getJSONArray("barList").getJSONObject(0).getString("title");
                Long playCount = StringUtil.parseNumber(fs);
                String coverImgThumbUrl = playlistJson.getString("imageUrl");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setSource(NetMusicSource.MG);
                playlistInfo.setId(playlistId);
                playlistInfo.setName(playlistName);
                playlistInfo.setCreator("null".equals(creator) ? "" : creator);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                playlistInfo.setPlayCount(playCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 推荐歌单(每页固定 10 条)
//        Callable<CommonResult<NetPlaylistInfo>> getRecommendPlaylistsMg = () -> {
//            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
//            Integer t = 0;
//
//            String playlistInfoBody = HttpRequest.get(String.format(RECOMMEND_PLAYLIST_MG_API, (page - 1) * 10))
//                    .header(Header.USER_AGENT, "Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1")
//                    .header(Header.REFERER, "https://m.music.migu.cn/")
//                    .execute()
//                    .body();
//            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
//            JSONObject data = playlistInfoJson.getJSONObject("retMsg");
//            t = data.getInt("countSize");
//            JSONArray playlistArray = data.getJSONArray("playlist");
//            for (int i = 0, len = playlistArray.size(); i < len; i++) {
//                JSONObject playlistJson = playlistArray.getJSONObject(i);
//
//                String playlistId = playlistJson.getString("playListId");
//                String playlistName = playlistJson.getString("playListName");
//                String creator = playlistJson.getString("createName");
//                Long playCount = playlistJson.getLong("playCount");
//                Integer trackCount = playlistJson.getInt("contentCount");
//                String coverImgThumbUrl = playlistJson.getString("image");
//
//                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
//                playlistInfo.setSource(NetMusicSource.MG);
//                playlistInfo.setId(playlistId);
//                playlistInfo.setName(playlistName);
//                playlistInfo.setCreator("null".equals(creator) ? "" : creator);
//                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
//                playlistInfo.setPlayCount(playCount);
//                playlistInfo.setTrackCount(trackCount);
//                GlobalExecutors.imageExecutor.execute(() -> {
//                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
//                    playlistInfo.setCoverImgThumb(coverImgThumb);
//                });
//
//                res.add(playlistInfo);
//            }
//            return new CommonResult<>(res, t);
//        };
        // 分类歌单(每页 10 条)
        Callable<CommonResult<NetPlaylistInfo>> getCatPlaylistsMg = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[5])) {
                String playlistInfoBody = HttpRequest.get(String.format(CAT_PLAYLIST_MG_API, s[5], page))
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                JSONObject data = playlistInfoJson.getJSONObject("data").getJSONObject("contentItemList");
                t = 300;
                JSONArray playlistArray = data.getJSONArray("itemList");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getJSONObject("logEvent").getString("contentId");
                    String playlistName = playlistJson.getString("title");
                    String creator = playlistJson.getString("subTitle");
                    String fs = playlistJson.getString("playNum");
                    Long playCount = StringUtil.parseNumber(fs);
                    String coverImgThumbUrl = playlistJson.getString("imageUrl");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.MG);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator("null".equals(creator) ? "" : creator);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 千千
        // 分类歌单
        Callable<CommonResult<NetPlaylistInfo>> getCatPlaylistsQi = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[6])) {
                String playlistInfoBody = HttpRequest.get(buildQianUrl(String.format(CAT_PLAYLIST_QI_API, page, limit, s[6].trim(), System.currentTimeMillis())))
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                JSONObject data = playlistInfoJson.getJSONObject("data");
                t = data.getInt("total");
                JSONArray playlistArray = data.getJSONArray("result");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("id");
                    String playlistName = playlistJson.getString("title");
                    Integer trackCount = playlistJson.getInt("trackCount");
                    String coverImgThumbUrl = playlistJson.getString("pic");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.QI);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setTrackCount(trackCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 猫耳
        // 分类歌单
        Callable<CommonResult<NetPlaylistInfo>> getCatPlaylistsMe = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[7])) {
                String playlistInfoBody = HttpRequest.get(String.format(CAT_PLAYLIST_ME_API, s[7].trim(), page, limit))
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                t = playlistInfoJson.getJSONObject("pagination").getInt("count");
                JSONArray playlistArray = playlistInfoJson.getJSONArray("albums");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("id");
                    String playlistName = playlistJson.getString("title");
                    String creator = playlistJson.getString("username");
                    String creatorId = playlistJson.getString("user_id");
                    Integer trackCount = playlistJson.getInt("music_count");
                    String coverImgThumbUrl = playlistJson.getString("front_cover");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.ME);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCreatorId(creatorId);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setTrackCount(trackCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 探索歌单
        Callable<CommonResult<NetPlaylistInfo>> getExpPlaylistsMe = () -> {
            LinkedList<NetPlaylistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[8])) {
                String playlistInfoBody = HttpRequest.get(String.format(EXP_PLAYLIST_ME_API, s[8].trim(), page, limit))
                        .execute()
                        .body();
                JSONArray playlistArray = JSONArray.fromObject(playlistInfoBody);
                t = playlistArray.size();
                for (int i = (page - 1) * limit, len = Math.min(playlistArray.size(), page * limit); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("id");
                    String playlistName = playlistJson.getString("title");
                    String creator = playlistJson.getString("username");
                    String creatorId = playlistJson.getString("user_id");
                    Long playCount = playlistJson.getLong("view_count");
                    Integer trackCount = playlistJson.getInt("music_count");
                    String coverImgThumbUrl = playlistJson.getString("front_cover");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.ME);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCreatorId(creatorId);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setTrackCount(trackCount);
                    playlistInfo.setPlayCount(playCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(playlistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        List<Future<CommonResult<NetPlaylistInfo>>> taskList = new LinkedList<>();

        boolean dt = defaultTag.equals(tag);

        if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getHighQualityPlaylists));
            taskList.add(GlobalExecutors.requestExecutor.submit(getHotPickedPlaylists));
            taskList.add(GlobalExecutors.requestExecutor.submit(getNewPickedPlaylists));
        }

        if (src == NetMusicSource.KG || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getTagPlaylistsKg));
            taskList.add(GlobalExecutors.requestExecutor.submit(getHotCollectedTagPlaylistsKg));
            taskList.add(GlobalExecutors.requestExecutor.submit(getUpTagPlaylistsKg));
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getHotPlaylistsKg));
        }

        if (src == NetMusicSource.QQ || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getCatPlaylistsQq));
        }

        if (src == NetMusicSource.KW || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getHotPlaylistsKw));
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getDefaultPlaylistsKw));
            taskList.add(GlobalExecutors.requestExecutor.submit(getCatPlaylistsKw));
        }

        if (src == NetMusicSource.MG || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getRecHotPlaylistsMg));
//            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendPlaylistsMg));
            taskList.add(GlobalExecutors.requestExecutor.submit(getCatPlaylistsMg));
        }

        if (src == NetMusicSource.QI || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getCatPlaylistsQi));
        }

        if (src == NetMusicSource.ME || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getCatPlaylistsMe));
            taskList.add(GlobalExecutors.requestExecutor.submit(getExpPlaylistsMe));
        }

        List<List<NetPlaylistInfo>> rl = new LinkedList<>();
        taskList.forEach(task -> {
            try {
                CommonResult<NetPlaylistInfo> result = task.get();
                rl.add(result.data);
                total.set(Math.max(total.get(), result.total));
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
        playlistInfos.addAll(ListUtil.joinAll(rl));

        return new CommonResult<>(playlistInfos, total.get());
    }

    /**
     * 获取歌手排行
     */
    public static CommonResult<NetArtistInfo> getArtistLists(int src, String tag, int limit, int page) {
        AtomicInteger total = new AtomicInteger();
        List<NetArtistInfo> artistInfos = new LinkedList<>();
//        Set<NetArtistInfo> set = Collections.synchronizedSet(new HashSet<>());

        final String defaultTag = "默认";
        String[] s = Tags.artistTag.get(tag);

        // 网易云 (接口分页)
        // 歌手榜
        Callable<CommonResult<NetArtistInfo>> getArtistRanking = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[0])) {
                String artistInfoBody = HttpRequest.get(String.format(ARTIST_RANKING_LIST_API, s[0]))
                        .execute()
                        .body();
                JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                JSONArray artistArray = artistInfoJson.getJSONObject("list").getJSONArray("artists");
                t = artistArray.size();
                for (int i = (page - 1) * limit, len = Math.min(artistArray.size(), page * limit); i < len; i++) {
                    JSONObject artistJson = artistArray.getJSONObject(i);

                    String artistId = artistJson.getString("id");
                    String artistName = artistJson.getString("name");
                    Integer songNum = artistJson.getInt("musicSize");
                    Integer albumNum = artistJson.getInt("albumSize");
                    String coverImgThumbUrl = artistJson.getString("img1v1Url");

                    NetArtistInfo artistInfo = new NetArtistInfo();
                    artistInfo.setId(artistId);
                    artistInfo.setName(artistName);
                    artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    artistInfo.setSongNum(songNum);
                    artistInfo.setAlbumNum(albumNum);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        artistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(artistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 热门歌手
        Callable<CommonResult<NetArtistInfo>> getHotArtist = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            String artistInfoBody = HttpRequest.get(String.format(HOT_ARTIST_LIST_API, (page - 1) * limit, limit))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONArray artistArray = artistInfoJson.getJSONArray("artists");
            t = artistArray.size();
            for (int i = 0, len = artistArray.size(); i < len; i++) {
                JSONObject artistJson = artistArray.getJSONObject(i);

                String artistId = artistJson.getString("id");
                String artistName = artistJson.getString("name");
                Integer songNum = artistJson.getInt("musicSize");
                Integer albumNum = artistJson.getInt("albumSize");
                String coverImgThumbUrl = artistJson.getString("img1v1Url");

                NetArtistInfo artistInfo = new NetArtistInfo();
                artistInfo.setId(artistId);
                artistInfo.setName(artistName);
                artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                artistInfo.setSongNum(songNum);
                artistInfo.setAlbumNum(albumNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    artistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(artistInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 分类歌手
        Callable<CommonResult<NetArtistInfo>> getCatArtist = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[1])) {
                String[] split = s[1].split(" ");
                String artistInfoBody = HttpRequest.get(String.format(CAT_ARTIST_API, split[0], split[1], split[2], (page - 1) * limit, limit))
                        .execute()
                        .body();
                JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                JSONArray artistArray = artistInfoJson.getJSONArray("artists");
                t = artistArray.size();
                for (int i = 0, len = artistArray.size(); i < len; i++) {
                    JSONObject artistJson = artistArray.getJSONObject(i);

                    String artistId = artistJson.getString("id");
                    String artistName = artistJson.getString("name");
                    Integer songNum = artistJson.getInt("musicSize");
                    Integer albumNum = artistJson.getInt("albumSize");
                    String coverImgThumbUrl = artistJson.getString("img1v1Url");

                    NetArtistInfo artistInfo = new NetArtistInfo();
                    artistInfo.setId(artistId);
                    artistInfo.setName(artistName);
                    artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    artistInfo.setSongNum(songNum);
                    artistInfo.setAlbumNum(albumNum);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        artistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(artistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 曲风歌手
        Callable<CommonResult<NetArtistInfo>> getStyleArtist = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[2])) {
                String artistInfoBody = HttpRequest.get(String.format(STYLE_ARTIST_API, s[2], (page - 1) * limit, limit))
                        .execute()
                        .body();
                JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                JSONObject data = artistInfoJson.getJSONObject("data");
                JSONArray artistArray = data.getJSONArray("artists");
                t = data.getJSONObject("page").getInt("total");
                for (int i = 0, len = artistArray.size(); i < len; i++) {
                    JSONObject artistJson = artistArray.getJSONObject(i);

                    String artistId = artistJson.getString("id");
                    String artistName = artistJson.getString("name");
                    Integer songNum = artistJson.getInt("musicSize");
                    Integer albumNum = artistJson.getInt("albumSize");
                    String coverImgThumbUrl = artistJson.getString("img1v1Url");

                    NetArtistInfo artistInfo = new NetArtistInfo();
                    artistInfo.setId(artistId);
                    artistInfo.setName(artistName);
                    artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    artistInfo.setSongNum(songNum);
                    artistInfo.setAlbumNum(albumNum);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        artistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(artistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 酷狗(接口分页)
        // 热门歌手
        Callable<CommonResult<NetArtistInfo>> getHotArtistKg = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[3])) {
                String[] split = s[3].split(" ");
                String artistInfoBody = HttpRequest.get(String.format(HOT_ARTIST_LIST_KG_API, split[0], split[1], page, limit))
                        .execute()
                        .body();
                JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                JSONObject data = artistInfoJson.getJSONObject("data");
                t = data.getInt("total");
                JSONArray artistArray = data.getJSONArray("info");
                for (int i = 0, len = artistArray.size(); i < len; i++) {
                    JSONObject artistJson = artistArray.getJSONObject(i);

                    String artistId = artistJson.getString("singerid");
                    String artistName = artistJson.getString("singername");
//            Integer songNum = artistJson.getInt("songcount");
//            Integer albumNum = artistJson.getInt("albumcount");
//            Integer mvNum = artistJson.getInt("mvcount");
                    String coverImgThumbUrl = artistJson.getString("imgurl").replace("{size}", "240");

                    NetArtistInfo artistInfo = new NetArtistInfo();
                    artistInfo.setSource(NetMusicSource.KG);
                    artistInfo.setId(artistId);
                    artistInfo.setName(artistName);
//            artistInfo.setSongNum(songNum);
//            artistInfo.setAlbumNum(albumNum);
//            artistInfo.setMvNum(mvNum);
                    artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        artistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(artistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 飙升歌手
        Callable<CommonResult<NetArtistInfo>> getUpArtistKg = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[3])) {
                String[] split = s[3].split(" ");
                String artistInfoBody = HttpRequest.get(String.format(UP_ARTIST_LIST_KG_API, split[0], split[1], page, limit))
                        .execute()
                        .body();
                JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                JSONObject data = artistInfoJson.getJSONObject("data");
                t = data.getInt("total");
                JSONArray artistArray = data.getJSONArray("info");
                for (int i = 0, len = artistArray.size(); i < len; i++) {
                    JSONObject artistJson = artistArray.getJSONObject(i);

                    String artistId = artistJson.getString("singerid");
                    String artistName = artistJson.getString("singername");
//                    Integer songNum = artistJson.getInt("songcount");
//                    Integer albumNum = artistJson.getInt("albumcount");
//                    Integer mvNum = artistJson.getInt("mvcount");
                    String coverImgThumbUrl = artistJson.getString("imgurl").replace("{size}", "240");

                    NetArtistInfo artistInfo = new NetArtistInfo();
                    artistInfo.setSource(NetMusicSource.KG);
                    artistInfo.setId(artistId);
                    artistInfo.setName(artistName);
//                    artistInfo.setSongNum(songNum);
//                    artistInfo.setAlbumNum(albumNum);
//                    artistInfo.setMvNum(mvNum);
                    artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        artistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(artistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // QQ (每页固定 80 条)
        Callable<CommonResult<NetArtistInfo>> getArtistRankingQq = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[4])) {
                final int num = 80;
                String[] split = s[4].split(" ");
                String artistInfoBody = HttpRequest.get(String.format(ARTIST_LIST_QQ_API, split[0], split[1], split[2], split[3], (page - 1) / 4 + 1))
                        .execute()
                        .body();
                JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                JSONObject data = artistInfoJson.getJSONObject("data");
                t = data.getInt("total");
                JSONArray artistArray = data.getJSONArray("list");
                for (int i = (page - 1) * limit % num, len = Math.min(artistArray.size(), (page - 1) * limit % num + limit); i < len; i++) {
                    JSONObject artistJson = artistArray.getJSONObject(i);

                    String artistId = artistJson.getString("singer_mid");
                    String artistName = artistJson.getString("singer_name");
                    String coverImgThumbUrl = String.format(ARTIST_IMG_QQ_API, artistId);

                    NetArtistInfo artistInfo = new NetArtistInfo();
                    artistInfo.setSource(NetMusicSource.QQ);
                    artistInfo.setId(artistId);
                    artistInfo.setName(artistName);
                    artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        artistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(artistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 酷我 (接口分页)
        // 推荐歌手
        Callable<CommonResult<NetArtistInfo>> getArtistRankingKw = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[5])) {
                HttpResponse resp = kwRequest(String.format(ARTIST_LIST_KW_API, s[5], page, limit)).execute();
                if (resp.getStatus() == HttpStatus.HTTP_OK) {
                    String artistInfoBody = resp.body();
                    JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                    JSONObject data = artistInfoJson.getJSONObject("data");
                    t = data.getInt("total");
                    JSONArray artistArray = data.getJSONArray("artistList");
                    for (int i = 0, len = artistArray.size(); i < len; i++) {
                        JSONObject artistJson = artistArray.getJSONObject(i);

                        String artistId = artistJson.getString("id");
                        String artistName = artistJson.getString("name");
                        String coverImgThumbUrl = artistJson.getString("pic300");
                        Integer songNum = artistJson.getInt("musicNum");
                        Integer albumNum = artistJson.getInt("albumNum");
                        Integer mvNum = artistJson.getInt("mvNum");

                        NetArtistInfo artistInfo = new NetArtistInfo();
                        artistInfo.setSource(NetMusicSource.KW);
                        artistInfo.setId(artistId);
                        artistInfo.setName(artistName);
                        artistInfo.setSongNum(songNum);
                        artistInfo.setAlbumNum(albumNum);
                        artistInfo.setMvNum(mvNum);
                        artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                        GlobalExecutors.imageExecutor.execute(() -> {
                            BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                            artistInfo.setCoverImgThumb(coverImgThumb);
                        });

                        res.add(artistInfo);
                    }
                }
            }
            return new CommonResult<>(res, t);
        };
        // 全部歌手
        Callable<CommonResult<NetArtistInfo>> getAllArtistsKw = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[6])) {
                String[] sp = s[6].split(" ", -1);
                HttpResponse resp = kwRequest(String.format(ALL_ARTISTS_LIST_KW_API, sp[0], sp[1], page, limit))
                        .header(Header.REFERER, StringUtil.isNotEmpty(sp[1]) ? "http://www.kuwo.cn/singers" : "")
                        .execute();
                if (resp.getStatus() == HttpStatus.HTTP_OK) {
                    String artistInfoBody = resp.body();
                    JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                    JSONObject data = artistInfoJson.getJSONObject("data");
                    t = data.getInt("total");
                    JSONArray artistArray = data.getJSONArray("artistList");
                    for (int i = 0, len = artistArray.size(); i < len; i++) {
                        JSONObject artistJson = artistArray.getJSONObject(i);

                        String artistId = artistJson.getString("id");
                        String artistName = artistJson.getString("name");
                        String coverImgThumbUrl = artistJson.getString("pic300");
                        Integer songNum = artistJson.getInt("musicNum");
                        Integer albumNum = artistJson.getInt("albumNum");
                        Integer mvNum = artistJson.getInt("mvNum");

                        NetArtistInfo artistInfo = new NetArtistInfo();
                        artistInfo.setSource(NetMusicSource.KW);
                        artistInfo.setId(artistId);
                        artistInfo.setName(artistName);
                        artistInfo.setSongNum(songNum);
                        artistInfo.setAlbumNum(albumNum);
                        artistInfo.setMvNum(mvNum);
                        artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                        GlobalExecutors.imageExecutor.execute(() -> {
                            BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                            artistInfo.setCoverImgThumb(coverImgThumb);
                        });

                        res.add(artistInfo);
                    }
                }
            }
            return new CommonResult<>(res, t);
        };

        // 咪咕
        // 来电新声榜(程序分页)
        Callable<CommonResult<NetArtistInfo>> getArtistRankingMg = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            String artistInfoBody = HttpRequest.get(String.format(ARTIST_LIST_MG_API))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject data = artistInfoJson.getJSONObject("columnInfo");
            t = data.getInt("contentsCount");
            JSONArray artistArray = data.getJSONArray("contents");
            for (int i = (page - 1) * limit, len = Math.min(artistArray.size(), page * limit); i < len; i++) {
                JSONObject artistJson = artistArray.getJSONObject(i).getJSONObject("objectInfo");

                String artistId = artistJson.getString("singerId");
                String artistName = artistJson.getString("singer");
                String coverImgThumbUrl = artistJson.getJSONArray("imgs").getJSONObject(0).getString("img");

                NetArtistInfo artistInfo = new NetArtistInfo();
                artistInfo.setSource(NetMusicSource.MG);
                artistInfo.setId(artistId);
                artistInfo.setName(artistName);
                artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    artistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(artistInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 来电唱作榜(程序分页)
        Callable<CommonResult<NetArtistInfo>> getArtistRankingMg2 = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            String artistInfoBody = HttpRequest.get(String.format(ARTIST_LIST_MG_API_2))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject data = artistInfoJson.getJSONObject("columnInfo");
            t = data.getInt("contentsCount");
            JSONArray artistArray = data.getJSONArray("contents");
            for (int i = (page - 1) * limit, len = Math.min(artistArray.size(), page * limit); i < len; i++) {
                JSONObject artistJson = artistArray.getJSONObject(i).getJSONObject("objectInfo");

                String artistId = artistJson.getString("singerId");
                String artistName = artistJson.getString("singer");
                String coverImgThumbUrl = artistJson.getJSONArray("imgs").getJSONObject(0).getString("img");

                NetArtistInfo artistInfo = new NetArtistInfo();
                artistInfo.setSource(NetMusicSource.MG);
                artistInfo.setId(artistId);
                artistInfo.setName(artistName);
                artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    artistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(artistInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 千千
        // 推荐歌手
        Callable<CommonResult<NetArtistInfo>> getRecArtistsQi = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = HttpRequest.get(buildQianUrl(String.format(REC_ARTISTS_LIST_QI_API, System.currentTimeMillis())))
                    .execute();
            String artistInfoBody = resp.body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject data = artistInfoJson.getJSONArray("data").getJSONObject(6);
            t = data.getInt("module_nums");
            JSONArray artistArray = data.getJSONArray("result");
            for (int i = (page - 1) * limit, len = Math.min(artistArray.size(), page * limit); i < len; i++) {
                JSONObject artistJson = artistArray.getJSONObject(i);

                String artistId = artistJson.getString("artistCode");
                String artistName = artistJson.getString("name");
                String coverImgUrl = artistJson.getString("pic");
                Integer songNum = artistJson.getInt("trackTotal");
                Integer albumNum = artistJson.getInt("albumTotal");
                String coverImgThumbUrl = coverImgUrl;

                NetArtistInfo artistInfo = new NetArtistInfo();
                artistInfo.setSource(NetMusicSource.QI);
                artistInfo.setId(artistId);
                artistInfo.setName(artistName);
                artistInfo.setSongNum(songNum);
                artistInfo.setAlbumNum(albumNum);
                artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgUrl);
                    if (coverImgThumb == null) coverImgThumb = extractProfile(coverImgThumbUrl);
                    artistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(artistInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 分类歌手
        Callable<CommonResult<NetArtistInfo>> getCatArtistsQi = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[7])) {
                // 分割时保留空串
                String[] sp = s[7].split(" ", -1);
                HttpResponse resp = HttpRequest.get(buildQianUrl(
                                String.format(CAT_ARTISTS_LIST_QI_API, sp[0], sp[2], sp[1], page, limit, System.currentTimeMillis())))
                        .execute();
                String artistInfoBody = resp.body();
                JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                JSONObject data = artistInfoJson.getJSONObject("data");
                t = data.getInt("total");
                JSONArray artistArray = data.getJSONArray("result");
                for (int i = 0, len = artistArray.size(); i < len; i++) {
                    JSONObject artistJson = artistArray.getJSONObject(i);

                    String artistId = artistJson.getString("artistCode");
                    String artistName = artistJson.getString("name");
                    String coverImgUrl = artistJson.getString("pic");
                    String coverImgThumbUrl = coverImgUrl;

                    NetArtistInfo artistInfo = new NetArtistInfo();
                    artistInfo.setSource(NetMusicSource.QI);
                    artistInfo.setId(artistId);
                    artistInfo.setName(artistName);
                    artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgUrl);
                        if (coverImgThumb == null) coverImgThumb = extractProfile(coverImgThumbUrl);
                        artistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(artistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 猫耳
        // 分类声优
        Callable<CommonResult<NetArtistInfo>> getCatCVsMe = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[8])) {
                String artistInfoBody = HttpRequest.get(String.format(CAT_CV_ME_API, s[8].trim(), page, limit))
                        .execute()
                        .body();
                JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                JSONObject info = artistInfoJson.getJSONObject("info");
                t = info.getJSONObject("pagination").getInt("count");
                JSONArray artistArray = info.getJSONArray("Datas");
                for (int i = 0, len = artistArray.size(); i < len; i++) {
                    JSONObject artistJson = artistArray.getJSONObject(i);

                    String artistId = artistJson.getString("id");
                    String artistName = artistJson.getString("name");
                    String coverImgThumbUrl = artistJson.getString("avatar");

                    NetArtistInfo artistInfo = new NetArtistInfo();
                    artistInfo.setSource(NetMusicSource.ME);
                    artistInfo.setId(artistId);
                    artistInfo.setName(artistName);
                    artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);

                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        artistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(artistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 分类社团
        Callable<CommonResult<NetArtistInfo>> getCatOrganizationsMe = () -> {
            LinkedList<NetArtistInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[8])) {
                String artistInfoBody = HttpRequest.get(String.format(CAT_ORGANIZATIONS_ME_API, s[8].trim(), page, limit))
                        .execute()
                        .body();
                JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                JSONObject info = artistInfoJson.getJSONObject("info");
                t = info.getJSONObject("pagination").getInt("count");
                JSONArray artistArray = info.getJSONArray("Datas");
                for (int i = 0, len = artistArray.size(); i < len; i++) {
                    JSONObject artistJson = artistArray.getJSONObject(i);

                    String artistId = artistJson.getString("id");
                    String artistName = artistJson.getString("name");
                    String coverImgThumbUrl = artistJson.getString("avatar");

                    NetArtistInfo artistInfo = new NetArtistInfo();
                    artistInfo.setSource(NetMusicSource.ME);
                    artistInfo.setOrganization(true);
                    artistInfo.setId(artistId);
                    artistInfo.setName(artistName);
                    artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);

                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        artistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(artistInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        List<Future<CommonResult<NetArtistInfo>>> taskList = new LinkedList<>();

        boolean dt = defaultTag.equals(tag);

        if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getArtistRanking));
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getHotArtist));
            taskList.add(GlobalExecutors.requestExecutor.submit(getCatArtist));
            if (!dt) taskList.add(GlobalExecutors.requestExecutor.submit(getStyleArtist));
        }

        if (src == NetMusicSource.KG || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getHotArtistKg));
            taskList.add(GlobalExecutors.requestExecutor.submit(getUpArtistKg));
        }

        if (src == NetMusicSource.QQ || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getArtistRankingQq));
        }

        if (src == NetMusicSource.KW || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getArtistRankingKw));
            taskList.add(GlobalExecutors.requestExecutor.submit(getAllArtistsKw));
        }

        if (src == NetMusicSource.MG || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getArtistRankingMg));
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getArtistRankingMg2));
        }

        if (src == NetMusicSource.QI || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getRecArtistsQi));
            taskList.add(GlobalExecutors.requestExecutor.submit(getCatArtistsQi));
        }

        if (src == NetMusicSource.ME || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getCatCVsMe));
            taskList.add(GlobalExecutors.requestExecutor.submit(getCatOrganizationsMe));
        }

        List<List<NetArtistInfo>> rl = new LinkedList<>();
        taskList.forEach(task -> {
            try {
                CommonResult<NetArtistInfo> result = task.get();
                rl.add(result.data);
                total.set(Math.max(total.get(), result.total));
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
        artistInfos.addAll(ListUtil.joinAll(rl));

        return new CommonResult<>(artistInfos, total.get());
    }

    /**
     * 获取新晋电台
     */
    public static CommonResult<NetRadioInfo> getNewRadios(int src, int limit, int page) {
        AtomicInteger total = new AtomicInteger();
        List<NetRadioInfo> radioInfos = new LinkedList<>();

        // 网易云(程序分页)
        // 新晋电台榜
        Callable<CommonResult<NetRadioInfo>> getNewRadios = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            String radioInfoBody = HttpRequest.get(String.format(NEW_RADIO_API))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONArray radioArray = radioInfoJson.getJSONArray("toplist");
            t = radioArray.size();
            for (int i = (page - 1) * limit, len = Math.min(radioArray.size(), page * limit); i < len; i++) {
                JSONObject radioJson = radioArray.getJSONObject(i);

                String radioId = radioJson.getString("id");
                String radioName = radioJson.getString("name");
                String dj = radioJson.getJSONObject("dj").getString("nickname");
                String djId = radioJson.getJSONObject("dj").getString("userId");
                Long playCount = radioJson.getLong("playCount");
                Integer trackCount = radioJson.getInt("programCount");
                String category = radioJson.getString("category");
                String coverImgThumbUrl = radioJson.getString("picUrl");
//            String createTime = TimeUtils.msToDate(radioJson.getLong("createTime"));

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                radioInfo.setDj(dj);
                radioInfo.setDjId(djId);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                radioInfo.setPlayCount(playCount);
                radioInfo.setTrackCount(trackCount);
                radioInfo.setCategory(category);
//            radioInfo.setCreateTime(createTime);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 推荐个性电台
        Callable<CommonResult<NetRadioInfo>> getPersonalizedRadios = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            String radioInfoBody = HttpRequest.get(String.format(PERSONALIZED_RADIO_API))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONArray radioArray = radioInfoJson.getJSONArray("result");
            t = radioArray.size();
            for (int i = (page - 1) * limit, len = Math.min(radioArray.size(), page * limit); i < len; i++) {
                JSONObject infoJson = radioArray.getJSONObject(i);
                JSONObject programJson = infoJson.getJSONObject("program");
                JSONObject djJson = programJson.getJSONObject("dj");
                JSONObject radioJson = programJson.getJSONObject("radio");

                String radioId = radioJson.getString("id");
                String radioName = radioJson.getString("name");
                String dj = djJson.getString("nickname");
                String djId = djJson.getString("userId");
//                Long playCount = radioJson.getLong("playCount");
                Integer trackCount = radioJson.getInt("programCount");
                String category = radioJson.getString("category");
                String coverImgThumbUrl = radioJson.getString("picUrl");
//            String createTime = TimeUtils.msToDate(radioJson.getLong("createTime"));

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                radioInfo.setDj(dj);
                radioInfo.setDjId(djId);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
//                radioInfo.setPlayCount(playCount);
                radioInfo.setTrackCount(trackCount);
                radioInfo.setCategory(category);
//            radioInfo.setCreateTime(createTime);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 推荐电台
        Callable<CommonResult<NetRadioInfo>> getRecommendRadios = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            String radioInfoBody = HttpRequest.get(String.format(RECOMMEND_RADIO_API))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONArray radioArray = radioInfoJson.getJSONArray("djRadios");
            t = radioArray.size();
            for (int i = (page - 1) * limit, len = Math.min(radioArray.size(), page * limit); i < len; i++) {
                JSONObject radioJson = radioArray.getJSONObject(i);

                String radioId = radioJson.getString("id");
                String radioName = radioJson.getString("name");
                String dj = radioJson.getJSONObject("dj").getString("nickname");
                String djId = radioJson.getJSONObject("dj").getString("userId");
                Long playCount = radioJson.getLong("playCount");
                Integer trackCount = radioJson.getInt("programCount");
                String category = radioJson.getString("category");
                String coverImgThumbUrl = radioJson.getString("picUrl");
//            String createTime = TimeUtils.msToDate(radioJson.getLong("createTime"));

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                radioInfo.setDj(dj);
                radioInfo.setDjId(djId);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                radioInfo.setPlayCount(playCount);
                radioInfo.setTrackCount(trackCount);
                radioInfo.setCategory(category);
//            radioInfo.setCreateTime(createTime);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 付费精品电台
        Callable<CommonResult<NetRadioInfo>> getPayRadios = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            String radioInfoBody = HttpRequest.get(String.format(PAY_RADIO_API))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONArray radioArray = radioInfoJson.getJSONObject("data").getJSONArray("list");
            t = radioArray.size();
            for (int i = (page - 1) * limit, len = Math.min(radioArray.size(), page * limit); i < len; i++) {
                JSONObject radioJson = radioArray.getJSONObject(i);

                String radioId = radioJson.getString("id");
                String radioName = radioJson.getString("name");
                String dj = radioJson.getString("creatorName");
                Long playCount = radioJson.getLong("score");
//                Integer trackCount = radioJson.getInt("programCount");
//                String category = radioJson.getString("category");
                String coverImgThumbUrl = radioJson.getString("picUrl");
//            String createTime = TimeUtils.msToDate(radioJson.getLong("createTime"));

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                radioInfo.setDj(dj);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                radioInfo.setPlayCount(playCount);
//                radioInfo.setTrackCount(trackCount);
//                radioInfo.setCategory(category);
//            radioInfo.setCreateTime(createTime);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 付费精选电台
        Callable<CommonResult<NetRadioInfo>> getPayGiftRadios = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            String radioInfoBody = HttpRequest.get(String.format(PAY_GIFT_RADIO_API, (page - 1) * limit, limit))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONArray radioArray = radioInfoJson.getJSONObject("data").getJSONArray("list");
            t = radioArray.size();
            for (int i = 0, len = radioArray.size(); i < len; i++) {
                JSONObject radioJson = radioArray.getJSONObject(i);

                String radioId = radioJson.getString("id");
                String radioName = radioJson.getString("name");
//                String dj = radioJson.getString("creatorName");
//                Long playCount = radioJson.getLong("score");
                Integer trackCount = radioJson.getInt("programCount");
//                String category = radioJson.getString("category");
                String coverImgThumbUrl = radioJson.getString("picUrl");
//            String createTime = TimeUtils.msToDate(radioJson.getLong("createTime"));

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
//                radioInfo.setDj(dj);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
//                radioInfo.setPlayCount(playCount);
                radioInfo.setTrackCount(trackCount);
//                radioInfo.setCategory(category);
//            radioInfo.setCreateTime(createTime);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }
            return new CommonResult<>(res, t);
        };

        // QQ(程序分页)
        Callable<CommonResult<NetRadioInfo>> getRecommendRadiosQq = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            String radioInfoBody = HttpRequest.get(String.format(RECOMMEND_RADIO_QQ_API))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONArray data = radioInfoJson.getJSONArray("data");
            for (int i = 0, len = data.size(); i < len; i++) {
                JSONArray radioArray = data.getJSONObject(i).getJSONArray("list");
                for (int j = 0, l = radioArray.size(); j < l; j++, t++) {
                    if (t >= (page - 1) * limit && t < page * limit) {
                        JSONObject radioJson = radioArray.getJSONObject(j);

                        String radioId = radioJson.getString("id");
                        String radioName = radioJson.getString("title");
                        String coverImgUrl = radioJson.getString("pic_url");
                        String coverImgThumbUrl = coverImgUrl;
                        Long playCount = radioJson.getLong("listenNum");

                        NetRadioInfo radioInfo = new NetRadioInfo();
                        radioInfo.setSource(NetMusicSource.QQ);
                        radioInfo.setId(radioId);
                        radioInfo.setName(radioName);
                        radioInfo.setPlayCount(playCount);
                        // QQ 需要提前写入电台图片 url，电台信息接口不提供！
                        radioInfo.setCoverImgUrl(coverImgUrl);
                        radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                        GlobalExecutors.imageExecutor.execute(() -> {
                            BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                            radioInfo.setCoverImgThumb(coverImgThumb);
                        });

                        res.add(radioInfo);
                    }
                }
            }
            return new CommonResult<>(res, t);
        };

        // 猫耳
        // 推荐广播剧
        Callable<CommonResult<NetRadioInfo>> getRecRadiosMe = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            String radioInfoBody = HttpRequest.get(String.format(REC_RADIO_ME_API))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONArray radioArray = radioInfoJson.getJSONArray("info");
            t = radioArray.size();
            for (int i = (page - 1) * limit, len = Math.min(radioArray.size(), page * limit); i < len; i++) {
                JSONObject radioJson = radioArray.getJSONObject(i);

                String radioId = radioJson.getString("id");
                String radioName = radioJson.getString("name");
                String dj = radioJson.getString("author");
                String coverImgThumbUrl = "https:" + radioJson.getString("cover");
                String description = StringUtil.removeHTMLLabel(radioJson.getString("abstract"));

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setSource(NetMusicSource.ME);
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                radioInfo.setDj(dj);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                radioInfo.setDescription(description);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 夏日推荐
        Callable<CommonResult<NetRadioInfo>> getSummerRadiosMe = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            String radioInfoBody = HttpRequest.get(String.format(SUMMER_RADIO_ME_API))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONArray radioArray = radioInfoJson.getJSONArray("info");
            for (int i = 0, len = radioArray.size(); i < len; i++) {
                JSONArray array = radioArray.getJSONArray(i);
                for (int j = 0, s = array.size(); j < s; j++, t++) {
                    if (t >= (page - 1) * limit && t < page * limit) {
                        JSONObject radioJson = array.getJSONObject(j);

                        String radioId = radioJson.getString("id");
                        String radioName = radioJson.getString("name");
                        String dj = radioJson.getString("author");
                        String coverImgThumbUrl = radioJson.getString("cover");

                        NetRadioInfo radioInfo = new NetRadioInfo();
                        radioInfo.setSource(NetMusicSource.ME);
                        radioInfo.setId(radioId);
                        radioInfo.setName(radioName);
                        radioInfo.setDj(dj);
                        radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                        GlobalExecutors.imageExecutor.execute(() -> {
                            BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                            radioInfo.setCoverImgThumb(coverImgThumb);
                        });

                        res.add(radioInfo);
                    }
                }
            }

            return new CommonResult<>(res, t);
        };
        // 频道
//        Callable<CommonResult<NetRadioInfo>> getChannelsMe = () -> {
//            LinkedList<NetRadioInfo> res = new LinkedList<>();
//            Integer t = 0;
//
//            String radioInfoBody = HttpRequest.get(String.format(CHANNEL_ME_API))
//                    .execute()
//                    .body();
//            Document doc = Jsoup.parse(radioInfoBody);
//            Elements radios = doc.select(".item.blk > a");
//            t = radios.size();
//            for (int i = (page - 1) * limit, len = Math.min(radios.size(), page * limit); i < len; i++) {
//                Element radio = radios.get(i);
//
//                String radioId = radio.attr("href").replace("/explore/channel/","");
//                String radioName = radio.select("b").text();
//                String coverImgThumbUrl = "https:" + radioJson.getString("cover");
//                String description = StringUtils.removeHTMLLabel(radioJson.getString("abstract"));
//
//                NetRadioInfo radioInfo = new NetRadioInfo();
//                radioInfo.setSource(NetMusicSource.ME);
//                radioInfo.setId(radioId);
//                radioInfo.setName(radioName);
//                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
//                radioInfo.setDescription(description);
//                GlobalExecutors.imageExecutor.execute(() -> {
//                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
//                    radioInfo.setCoverImgThumb(coverImgThumb);
//                });
//
//                res.add(radioInfo);
//            }
//            return new CommonResult<>(res, t);
//        };

        List<Future<CommonResult<NetRadioInfo>>> taskList = new LinkedList<>();

        if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getNewRadios));
            taskList.add(GlobalExecutors.requestExecutor.submit(getPersonalizedRadios));
            taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendRadios));
            taskList.add(GlobalExecutors.requestExecutor.submit(getPayRadios));
            taskList.add(GlobalExecutors.requestExecutor.submit(getPayGiftRadios));
        }

        if (src == NetMusicSource.QQ || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendRadiosQq));
        }

        if (src == NetMusicSource.ME || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getRecRadiosMe));
            taskList.add(GlobalExecutors.requestExecutor.submit(getSummerRadiosMe));
        }

        List<List<NetRadioInfo>> rl = new LinkedList<>();
        taskList.forEach(task -> {
            try {
                CommonResult<NetRadioInfo> result = task.get();
                rl.add(result.data);
                total.set(Math.max(total.get(), result.total));
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
        radioInfos.addAll(ListUtil.joinAll(rl));

        return new CommonResult<>(radioInfos, total.get());
    }

    /**
     * 获取个性电台 + 今日优选 + 热门电台 + 热门电台榜
     */
    public static CommonResult<NetRadioInfo> getHotRadios(int src, String tag, int limit, int page) {
        AtomicInteger total = new AtomicInteger();
        List<NetRadioInfo> radioInfos = new LinkedList<>();

        final String defaultTag = "默认";
        String[] s = Tags.radioTag.get(tag);
        // 网易云(程序分页)
//        // 个性电台推荐
//        String radioInfoBody = HttpRequest.get(String.format(PERSONAL_RADIO_API))
//                .execute()
//                .body();
//        JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
//        JSONArray radioArray = radioInfoJson.getJSONArray("data");
//        for (int i = 0, len = radioArray.size(); i < len; i++) {
//            JSONObject radioJson = radioArray.getJSONObject(i);
//
//            long radioId = radioJson.getLong("id");
//            String radioName = radioJson.getString("name");
//
//            NetRadioInfo radioInfo = new NetRadioInfo();
//            radioInfo.setId(radioId);
//            radioInfo.setName(radioName);
//            radioInfos.add(radioInfo);
//        }
        // 今日优选电台
        Callable<CommonResult<NetRadioInfo>> getDailyRadios = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            String radioInfoBody = HttpRequest.get(String.format(DAILY_RADIO_API))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONArray radioArray = radioInfoJson.getJSONArray("data");
            t = radioArray.size();
            for (int i = (page - 1) * limit, len = Math.min(radioArray.size(), page * limit); i < len; i++) {
                JSONObject radioJson = radioArray.getJSONObject(i);

                String radioId = radioJson.getString("id");
                String radioName = radioJson.getString("name");
                String dj = null;
//                if (i >= rs) dj = radioJson.getJSONObject("dj").getString("nickname");
                Long playCount = radioJson.getLong("playCount");
                Integer trackCount = radioJson.getInt("programCount");
                String category = radioJson.optString("category");
                String coverImgThumbUrl = radioJson.getString("picUrl");
//            long ms = radioJson.optLong("createTime");

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                radioInfo.setDj(dj);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                radioInfo.setPlayCount(playCount);
                radioInfo.setTrackCount(trackCount);
                radioInfo.setCategory(category);
//            if (ms != 0) {
//                String createTime = TimeUtils.msToDate(ms);
//                radioInfo.setCreateTime(createTime);
//            }
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 热门电台
        Callable<CommonResult<NetRadioInfo>> getHotRadios = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            String radioInfoBody = HttpRequest.get(String.format(HOT_RADIO_API))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONArray radioArray = radioInfoJson.getJSONArray("djRadios");
            t = radioArray.size();
            for (int i = (page - 1) * limit, len = Math.min(radioArray.size(), page * limit); i < len; i++) {
                JSONObject radioJson = radioArray.getJSONObject(i);

                String radioId = radioJson.getString("id");
                String radioName = radioJson.getString("name");
                String dj = radioJson.getJSONObject("dj").getString("nickname");
                String djId = radioJson.getJSONObject("dj").getString("userId");
                Long playCount = radioJson.getLong("playCount");
                Integer trackCount = radioJson.getInt("programCount");
                String category = radioJson.optString("category");
                String coverImgThumbUrl = radioJson.getString("picUrl");

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                radioInfo.setDj(dj);
                radioInfo.setDjId(djId);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                radioInfo.setPlayCount(playCount);
                radioInfo.setTrackCount(trackCount);
                radioInfo.setCategory(category);

                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 热门电台榜
        Callable<CommonResult<NetRadioInfo>> getRadiosRanking = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            String radioInfoBody = HttpRequest.get(String.format(RADIO_TOPLIST_API))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONArray radioArray = radioInfoJson.getJSONArray("toplist");
            t = radioArray.size();
            for (int i = (page - 1) * limit, len = Math.min(radioArray.size(), page * limit); i < len; i++) {
                JSONObject radioJson = radioArray.getJSONObject(i);

                String radioId = radioJson.getString("id");
                String radioName = radioJson.getString("name");
                String dj = radioJson.getJSONObject("dj").getString("nickname");
                String djId = radioJson.getJSONObject("dj").getString("userId");
                Long playCount = radioJson.getLong("playCount");
                Integer trackCount = radioJson.getInt("programCount");
                String category = radioJson.optString("category");
                String coverImgThumbUrl = radioJson.getString("picUrl");

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                radioInfo.setDj(dj);
                radioInfo.setDjId(djId);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                radioInfo.setPlayCount(playCount);
                radioInfo.setTrackCount(trackCount);
                radioInfo.setCategory(category);

                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 推荐电台
        Callable<CommonResult<NetRadioInfo>> getRecRadios = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            String radioInfoBody = HttpRequest.get(String.format(REC_RADIO_API))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONArray radioArray = radioInfoJson.getJSONArray("djRadios");
            t = radioArray.size();
            for (int i = (page - 1) * limit, len = Math.min(radioArray.size(), page * limit); i < len; i++) {
                JSONObject radioJson = radioArray.getJSONObject(i);

                String radioId = radioJson.getString("id");
                String radioName = radioJson.getString("name");
                String dj = radioJson.getJSONObject("dj").getString("nickname");
                String djId = radioJson.getJSONObject("dj").getString("userId");
                Long playCount = radioJson.getLong("playCount");
                Integer trackCount = radioJson.getInt("programCount");
                String category = radioJson.optString("category");
                String coverImgThumbUrl = radioJson.getString("picUrl");

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                radioInfo.setDj(dj);
                radioInfo.setDjId(djId);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                radioInfo.setPlayCount(playCount);
                radioInfo.setTrackCount(trackCount);
                radioInfo.setCategory(category);

                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 分类热门电台
        Callable<CommonResult<NetRadioInfo>> getCatHotRadios = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[0])) {
                String radioInfoBody = HttpRequest.get(String.format(CAT_HOT_RADIO_API, s[0], (page - 1) * limit, limit))
                        .execute()
                        .body();
                JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
                t = radioInfoJson.getInt("count");
                JSONArray radioArray = radioInfoJson.getJSONArray("djRadios");
                for (int i = 0, len = radioArray.size(); i < len; i++) {
                    JSONObject radioJson = radioArray.getJSONObject(i);

                    String radioId = radioJson.getString("id");
                    String radioName = radioJson.getString("name");
                    String dj = radioJson.getJSONObject("dj").getString("nickname");
                    String djId = radioJson.getJSONObject("dj").getString("userId");
//                    Long playCount = radioJson.getLong("playCount");
                    Integer trackCount = radioJson.getInt("programCount");
                    String category = radioJson.optString("category");
                    String coverImgThumbUrl = radioJson.getString("picUrl");

                    NetRadioInfo radioInfo = new NetRadioInfo();
                    radioInfo.setId(radioId);
                    radioInfo.setName(radioName);
                    radioInfo.setDj(dj);
                    radioInfo.setDjId(djId);
                    radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
//                    radioInfo.setPlayCount(playCount);
                    radioInfo.setTrackCount(trackCount);
                    radioInfo.setCategory(category);

                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        radioInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(radioInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 分类推荐电台
        Callable<CommonResult<NetRadioInfo>> getCatRecRadios = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[1])) {
                String radioInfoBody = HttpRequest.get(String.format(CAT_REC_RADIO_API, s[1]))
                        .execute()
                        .body();
                JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
                JSONArray radioArray = radioInfoJson.getJSONArray("djRadios");
                t = radioArray.size();
                for (int i = (page - 1) * limit, len = Math.min(radioArray.size(), page * limit); i < len; i++) {
                    JSONObject radioJson = radioArray.getJSONObject(i);

                    String radioId = radioJson.getString("id");
                    String radioName = radioJson.getString("name");
                    String dj = radioJson.getJSONObject("dj").getString("nickname");
                    String djId = radioJson.getJSONObject("dj").getString("userId");
//                    Long playCount = radioJson.getLong("playCount");
                    Integer trackCount = radioJson.getInt("programCount");
                    String category = radioJson.optString("category");
                    String coverImgThumbUrl = radioJson.getString("picUrl");

                    NetRadioInfo radioInfo = new NetRadioInfo();
                    radioInfo.setId(radioId);
                    radioInfo.setName(radioName);
                    radioInfo.setDj(dj);
                    radioInfo.setDjId(djId);
                    radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
//                    radioInfo.setPlayCount(playCount);
                    radioInfo.setTrackCount(trackCount);
                    radioInfo.setCategory(category);

                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        radioInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(radioInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 喜马拉雅
        // 分类电台
        Callable<CommonResult<NetRadioInfo>> getCatRadiosXm = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[3])) {
                String[] sp = s[3].split(" ", -1);
                String radioInfoBody = HttpRequest.get(String.format(CAT_RADIO_XM_API, sp[0], sp[1], page, limit))
                        .execute()
                        .body();
                JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
                JSONObject data = radioInfoJson.getJSONObject("data");
                t = data.getInt("total");
                JSONArray radioArray = data.getJSONArray("albums");
                for (int i = 0, len = radioArray.size(); i < len; i++) {
                    JSONObject radioJson = radioArray.getJSONObject(i);

                    String radioId = radioJson.getString("albumId");
                    String radioName = radioJson.getString("title");
                    String dj = radioJson.getString("anchorName");
                    String djId = radioJson.getString("uid");
                    Long playCount = radioJson.getLong("playCount");
                    Integer trackCount = radioJson.getInt("trackCount");
                    String category = tag;
                    String coverImgThumbUrl = "https:" + radioJson.getString("coverPath");
                    coverImgThumbUrl = coverImgThumbUrl.substring(0, coverImgThumbUrl.lastIndexOf('!'));

                    NetRadioInfo radioInfo = new NetRadioInfo();
                    radioInfo.setSource(NetMusicSource.XM);
                    radioInfo.setId(radioId);
                    radioInfo.setName(radioName);
                    radioInfo.setDj(dj);
                    radioInfo.setDjId(djId);
                    radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    radioInfo.setPlayCount(playCount);
                    radioInfo.setTrackCount(trackCount);
                    radioInfo.setCategory(category);

                    final String finalCoverImgThumbUrl = coverImgThumbUrl;
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(finalCoverImgThumbUrl);
                        radioInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(radioInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 频道电台
        Callable<CommonResult<NetRadioInfo>> getChannelRadiosXm = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[4])) {
                String radioInfoBody = HttpRequest.get(String.format(CHANNEL_RADIO_XM_API, s[4], page, limit))
                        .execute()
                        .body();
                JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
                JSONObject data = radioInfoJson.getJSONObject("data");
                t = data.getInt("total");
                JSONArray radioArray = data.getJSONArray("albums");
                for (int i = 0, len = radioArray.size(); i < len; i++) {
                    JSONObject radioJson = radioArray.getJSONObject(i);

                    String radioId = radioJson.getString("albumId");
                    String radioName = radioJson.getString("albumTitle");
                    String dj = radioJson.getString("albumUserNickName");
                    Long playCount = radioJson.getLong("albumPlayCount");
                    Integer trackCount = radioJson.getInt("albumTrackCount");
                    String category = tag;
                    String coverImgThumbUrl = "https://imagev2.xmcdn.com/" + radioJson.getString("albumCoverPath");

                    NetRadioInfo radioInfo = new NetRadioInfo();
                    radioInfo.setSource(NetMusicSource.XM);
                    radioInfo.setId(radioId);
                    radioInfo.setName(radioName);
                    radioInfo.setDj(dj);
                    radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    radioInfo.setPlayCount(playCount);
                    radioInfo.setTrackCount(trackCount);
                    radioInfo.setCategory(category);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        radioInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(radioInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 排行榜
        Callable<CommonResult<NetRadioInfo>> getCatRadioRankingXm = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[2])) {
                String[] sp = s[2].split(" ");
                String radioInfoBody = HttpRequest.get(String.format(CAT_RADIO_RANKING_XM_API, sp[0], sp[1]))
                        .execute()
                        .body();
                JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
                JSONArray radioArray = radioInfoJson.getJSONObject("data").getJSONArray("rankList").getJSONObject(0).getJSONArray("albums");
                t = radioArray.size();
                for (int i = (page - 1) * limit, len = Math.min(radioArray.size(), page * limit); i < len; i++) {
                    JSONObject radioJson = radioArray.getJSONObject(i);

                    String radioId = radioJson.getString("id");
                    String radioName = radioJson.getString("albumTitle");
                    String dj = radioJson.getString("anchorName");
                    String djId = radioJson.getString("anchorUrl").replace("/zhubo/", "");
                    Long playCount = radioJson.getLong("playCount");
                    Integer trackCount = radioJson.getInt("trackCount");
                    String category = radioJson.optString("categoryTitle");
                    String coverImgThumbUrl = "https://imagev2.xmcdn.com/" + radioJson.getString("cover");

                    NetRadioInfo radioInfo = new NetRadioInfo();
                    radioInfo.setSource(NetMusicSource.XM);
                    radioInfo.setId(radioId);
                    radioInfo.setName(radioName);
                    radioInfo.setDj(dj);
                    radioInfo.setDjId(djId);
                    radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    radioInfo.setPlayCount(playCount);
                    radioInfo.setTrackCount(trackCount);
                    radioInfo.setCategory(category);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        radioInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(radioInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 猫耳
        // 周榜
        Callable<CommonResult<NetRadioInfo>> getWeekRadiosMe = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            String radioInfoBody = HttpRequest.get(String.format(WEEK_RADIO_ME_API, page, limit))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONObject data = radioInfoJson.getJSONObject("info").getJSONObject("ranks");
            JSONArray radioArray = data.getJSONArray("Datas");
            t = data.getJSONObject("pagination").getInt("count");
            for (int i = 0, len = radioArray.size(); i < len; i++) {
                JSONObject radioJson = radioArray.getJSONObject(i);

                String radioId = radioJson.getString("id");
                String radioName = radioJson.getString("name");
                String dj = radioJson.getString("author");
                String coverImgThumbUrl = radioJson.getString("cover");
                String description = radioJson.getString("abstract");

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setSource(NetMusicSource.ME);
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                radioInfo.setDj(dj);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                radioInfo.setDescription(description);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 月榜
        Callable<CommonResult<NetRadioInfo>> getMonthRadiosMe = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            String radioInfoBody = HttpRequest.get(String.format(MONTH_RADIO_ME_API, page, limit))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONObject data = radioInfoJson.getJSONObject("info").getJSONObject("ranks");
            JSONArray radioArray = data.getJSONArray("Datas");
            t = data.getJSONObject("pagination").getInt("count");
            for (int i = 0, len = radioArray.size(); i < len; i++) {
                JSONObject radioJson = radioArray.getJSONObject(i);

                String radioId = radioJson.getString("id");
                String radioName = radioJson.getString("name");
                String dj = radioJson.getString("author");
                String coverImgThumbUrl = radioJson.getString("cover");
                String description = radioJson.getString("abstract");

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setSource(NetMusicSource.ME);
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                radioInfo.setDj(dj);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                radioInfo.setDescription(description);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 总榜
        Callable<CommonResult<NetRadioInfo>> getAllTimeRadiosMe = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            String radioInfoBody = HttpRequest.get(String.format(ALL_TIME_RADIO_ME_API, page, limit))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONObject data = radioInfoJson.getJSONObject("info").getJSONObject("ranks");
            JSONArray radioArray = data.getJSONArray("Datas");
            t = data.getJSONObject("pagination").getInt("count");
            for (int i = 0, len = radioArray.size(); i < len; i++) {
                JSONObject radioJson = radioArray.getJSONObject(i);

                String radioId = radioJson.getString("id");
                String radioName = radioJson.getString("name");
                String dj = radioJson.getString("author");
                String coverImgThumbUrl = radioJson.getString("cover");
                String description = radioJson.getString("abstract");

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setSource(NetMusicSource.ME);
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                radioInfo.setDj(dj);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                radioInfo.setDescription(description);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 广播剧分类
        Callable<CommonResult<NetRadioInfo>> getCatRadiosMe = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[5])) {
                String[] sp = s[5].split(" ");
                String radioInfoBody = HttpRequest.get(String.format(CAT_RADIO_ME_API, sp[2], sp[0], sp[1], page, limit))
                        .execute()
                        .body();
                JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
                JSONObject data = radioInfoJson.getJSONObject("info");
                JSONArray radioArray = data.getJSONArray("Datas");
                t = data.getJSONObject("pagination").getInt("count");
                for (int i = 0, len = radioArray.size(); i < len; i++) {
                    JSONObject radioJson = radioArray.getJSONObject(i);

                    String radioId = radioJson.getString("id");
                    String radioName = radioJson.getString("name");
                    String category = radioJson.getString("type_name");
                    String coverImgThumbUrl = radioJson.getString("cover");

                    NetRadioInfo radioInfo = new NetRadioInfo();
                    radioInfo.setSource(NetMusicSource.ME);
                    radioInfo.setId(radioId);
                    radioInfo.setName(radioName);
                    radioInfo.setCategory(category);
                    radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        radioInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(radioInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 豆瓣
        // Top 250
        Callable<CommonResult<NetRadioInfo>> getTopRadiosDb = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;
            final int rn = 25;

            String radioInfoBody = HttpRequest.get(String.format(TOP_RADIO_DB_API, (page - 1) * rn))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(radioInfoBody);
            Elements rs = doc.select("div.item");
            String ts = ReUtil.get("共(\\d+)条", doc.select("span.count").text(), 1);
            t = StringUtil.isEmpty(ts) ? rs.size() : Integer.parseInt(ts);
            t -= t / rn * 5;
            for (int i = 0, len = rs.size(); i < len; i++) {
                Element radio = rs.get(i);
                Elements a = radio.select("div.hd a");
                Elements p = radio.select("div.bd p");
                Elements img = radio.select("div.pic img");

                String radioId = ReUtil.get("/subject/(\\d+)/", a.attr("href"), 1);
                String radioName = a.text().trim();
                String dj = ReUtil.get("导演: (.*?) ", p.text(), 1);
                String coverImgThumbUrl = img.attr("src");
                String category = "电影";

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setSource(NetMusicSource.DB);
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                radioInfo.setDj(dj);
                radioInfo.setCategory(category);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 分类电台
        Callable<CommonResult<NetRadioInfo>> getCatRadiosDb = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[6])) {
                String radioInfoBody = HttpRequest.get(String.format(CAT_RADIO_DB_API, s[6], (page - 1) * limit, limit))
                        .execute()
                        .body();
                JSONArray radioArray = JSONArray.fromObject(radioInfoBody);
                t = JSONObject.fromObject(HttpRequest.get(String.format(CAT_RADIO_TOTAL_DB_API, s[6])).execute().body()).getInt("total");
                for (int i = 0, len = radioArray.size(); i < len; i++) {
                    JSONObject radioJson = radioArray.getJSONObject(i);

                    String radioId = radioJson.getString("id");
                    String radioName = radioJson.getString("title");
                    String dj = joinStrings(radioJson.getJSONArray("actors"), 4);
                    String coverImgThumbUrl = radioJson.getString("cover_url");
                    String category = joinStrings(radioJson.getJSONArray("types"), -1);

                    NetRadioInfo radioInfo = new NetRadioInfo();
                    radioInfo.setSource(NetMusicSource.DB);
                    radioInfo.setId(radioId);
                    radioInfo.setName(radioName);
                    radioInfo.setDj(dj);
                    radioInfo.setCategory(category);
                    radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        radioInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(radioInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 分类游戏电台
        Callable<CommonResult<NetRadioInfo>> getCatGameRadiosDb = () -> {
            LinkedList<NetRadioInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[7])) {
                String[] sp = s[7].split(" ", -1);
                String radioInfoBody = HttpRequest.get(String.format(CAT_GAME_RADIO_DB_API, sp[0], sp[1], page))
                        .execute()
                        .body();
                JSONObject data = JSONObject.fromObject(radioInfoBody);
                JSONArray radioArray = data.getJSONArray("games");
                t = data.getInt("total");
                for (int i = 0, len = radioArray.size(); i < len; i++) {
                    JSONObject radioJson = radioArray.getJSONObject(i);

                    String radioId = radioJson.getString("id");
                    String radioName = radioJson.getString("title");
                    String dj = radioJson.getString("platforms");
                    String coverImgThumbUrl = radioJson.getString("cover");
                    String category = radioJson.getString("genres");

                    NetRadioInfo radioInfo = new NetRadioInfo();
                    radioInfo.setType(RadioType.GAME);
                    radioInfo.setSource(NetMusicSource.DB);
                    radioInfo.setId(radioId);
                    radioInfo.setName(radioName);
                    radioInfo.setDj(dj);
                    radioInfo.setCategory(category);
                    radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        radioInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(radioInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        List<Future<CommonResult<NetRadioInfo>>> taskList = new LinkedList<>();

        boolean dt = defaultTag.equals(tag);

        if (dt) {
            if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getDailyRadios));
                taskList.add(GlobalExecutors.requestExecutor.submit(getHotRadios));
                taskList.add(GlobalExecutors.requestExecutor.submit(getRadiosRanking));
                taskList.add(GlobalExecutors.requestExecutor.submit(getRecRadios));
            }

            if (src == NetMusicSource.ME || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getWeekRadiosMe));
                taskList.add(GlobalExecutors.requestExecutor.submit(getMonthRadiosMe));
                taskList.add(GlobalExecutors.requestExecutor.submit(getAllTimeRadiosMe));
                taskList.add(GlobalExecutors.requestExecutor.submit(getCatRadiosMe));
            }

            if (src == NetMusicSource.DB || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getTopRadiosDb));
                taskList.add(GlobalExecutors.requestExecutor.submit(getCatGameRadiosDb));
            }
        } else {
            if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getCatHotRadios));
                taskList.add(GlobalExecutors.requestExecutor.submit(getCatRecRadios));
            }

            if (src == NetMusicSource.XM || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getCatRadiosXm));
                taskList.add(GlobalExecutors.requestExecutor.submit(getChannelRadiosXm));
                taskList.add(GlobalExecutors.requestExecutor.submit(getCatRadioRankingXm));
            }

            if (src == NetMusicSource.ME || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getCatRadiosMe));
            }

            if (src == NetMusicSource.DB || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getCatRadiosDb));
                taskList.add(GlobalExecutors.requestExecutor.submit(getCatGameRadiosDb));
            }
        }

        List<List<NetRadioInfo>> rl = new LinkedList<>();
        taskList.forEach(task -> {
            try {
                CommonResult<NetRadioInfo> result = task.get();
                rl.add(result.data);
                total.set(Math.max(total.get(), result.total));
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
        radioInfos.addAll(ListUtil.joinAll(rl));

        return new CommonResult<>(radioInfos, total.get());
    }

    /**
     * 获取推荐节目
     */
    public static CommonResult<NetMusicInfo> getRecommendPrograms(int src, String tag, int limit, int page) {
        AtomicInteger total = new AtomicInteger();
        List<NetMusicInfo> musicInfos = new LinkedList<>();

        final String defaultTag = "默认";
        String[] s = Tags.programTag.get(tag);

        // 网易云(程序分页)
        // 推荐节目
        Callable<CommonResult<NetMusicInfo>> getRecommendPrograms = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String programInfoBody = HttpRequest.get(String.format(RECOMMEND_PROGRAM_API))
                    .execute()
                    .body();
            JSONObject programInfoJson = JSONObject.fromObject(programInfoBody);
            JSONArray programArray = programInfoJson.getJSONArray("programs");
            t = programArray.size();
            for (int i = (page - 1) * limit, len = Math.min(programArray.size(), page * limit); i < len; i++) {
                JSONObject programJson = programArray.getJSONObject(i);
                JSONObject mainSongJson = programJson.getJSONObject("mainSong");
                JSONObject djJson = programJson.getJSONObject("dj");
                JSONObject radioJson = programJson.getJSONObject("radio");

                String programId = programJson.getString("id");
                String songId = mainSongJson.getString("id");
                String name = mainSongJson.getString("name");
                String artist = djJson.getString("nickname");
                String artistId = djJson.getString("userId");
                String albumName = radioJson.getString("name");
                String albumId = radioJson.getString("id");
                Double duration = mainSongJson.getDouble("duration") / 1000;

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setProgramId(programId);
                musicInfo.setId(songId);
                musicInfo.setName(name);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 推荐个性节目
        Callable<CommonResult<NetMusicInfo>> getPersonalizedPrograms = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String programInfoBody = HttpRequest.get(String.format(PERSONALIZED_PROGRAM_API))
                    .execute()
                    .body();
            JSONObject programInfoJson = JSONObject.fromObject(programInfoBody);
            JSONArray programArray = programInfoJson.getJSONArray("result");
            t = programArray.size();
            for (int i = (page - 1) * limit, len = Math.min(programArray.size(), page * limit); i < len; i++) {
                JSONObject programJson = programArray.getJSONObject(i).getJSONObject("program");
                JSONObject mainSongJson = programJson.getJSONObject("mainSong");
                JSONObject djJson = programJson.getJSONObject("dj");
                JSONObject radioJson = programJson.getJSONObject("radio");

                String programId = programJson.getString("id");
                String songId = mainSongJson.getString("id");
                String name = mainSongJson.getString("name");
                String artist = djJson.getString("nickname");
                String artistId = djJson.getString("userId");
                String albumName = radioJson.getString("name");
                String albumId = radioJson.getString("id");
                Double duration = mainSongJson.getDouble("duration") / 1000;

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setProgramId(programId);
                musicInfo.setId(songId);
                musicInfo.setName(name);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 24 小时节目榜
        Callable<CommonResult<NetMusicInfo>> get24HoursPrograms = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String programInfoBody = HttpRequest.get(String.format(PROGRAM_24_HOURS_TOPLIST_API))
                    .execute()
                    .body();
            JSONObject programInfoJson = JSONObject.fromObject(programInfoBody);
            JSONArray programArray = programInfoJson.getJSONObject("data").getJSONArray("list");
            t = programArray.size();
            for (int i = (page - 1) * limit, len = Math.min(programArray.size(), page * limit); i < len; i++) {
                JSONObject programJson = programArray.getJSONObject(i).getJSONObject("program");
                JSONObject mainSongJson = programJson.getJSONObject("mainSong");
                JSONObject djJson = programJson.getJSONObject("dj");
                JSONObject radioJson = programJson.getJSONObject("radio");

                String programId = programJson.getString("id");
                String songId = mainSongJson.getString("id");
                String name = mainSongJson.getString("name");
                String artist = djJson.getString("nickname");
                String artistId = djJson.getString("userId");
                String albumName = radioJson.getString("name");
                String albumId = radioJson.getString("id");
                Double duration = mainSongJson.getDouble("duration") / 1000;

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setProgramId(programId);
                musicInfo.setId(songId);
                musicInfo.setName(name);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 节目榜
        Callable<CommonResult<NetMusicInfo>> getProgramsRanking = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String programInfoBody = HttpRequest.get(String.format(PROGRAM_TOPLIST_API))
                    .execute()
                    .body();
            JSONObject programInfoJson = JSONObject.fromObject(programInfoBody);
            JSONArray programArray = programInfoJson.getJSONArray("toplist");
            t = programArray.size();
            for (int i = (page - 1) * limit, len = Math.min(programArray.size(), page * limit); i < len; i++) {
                JSONObject programJson = programArray.getJSONObject(i).getJSONObject("program");
                JSONObject mainSongJson = programJson.getJSONObject("mainSong");
                JSONObject djJson = programJson.getJSONObject("dj");
                JSONObject radioJson = programJson.getJSONObject("radio");

                String programId = programJson.getString("id");
                String songId = mainSongJson.getString("id");
                String name = mainSongJson.getString("name");
                String artist = djJson.getString("nickname");
                String artistId = djJson.getString("userId");
                String albumName = radioJson.getString("name");
                String albumId = radioJson.getString("id");
                Double duration = mainSongJson.getDouble("duration") / 1000;

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setProgramId(programId);
                musicInfo.setId(songId);
                musicInfo.setName(name);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 猫耳
        // 推荐节目
        Callable<CommonResult<NetMusicInfo>> getRecProgramsMe = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String programInfoBody = HttpRequest.get(String.format(REC_PROGRAM_ME_API))
                    .execute()
                    .body();
            JSONObject programInfoJson = JSONObject.fromObject(programInfoBody);
            JSONObject info = programInfoJson.getJSONObject("info");
            // 轮播图
            JSONArray programArray = info.getJSONArray("links");
            t = programArray.size();
            for (int i = (page - 1) * limit, len = Math.min(programArray.size(), page * limit); i < len; i++) {
                JSONObject programJson = programArray.getJSONObject(i);

                String id = ReUtil.get("/sound/(\\d+)", programJson.getString("url"), 1);
                String name = programJson.getString("title");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.ME);
                musicInfo.setId(id);
                musicInfo.setName(name);

                res.add(musicInfo);
            }
            // 右侧节目
            programArray = info.getJSONObject("sounds").getJSONArray("day3");
            t = Math.max(t, programArray.size());
            for (int i = (page - 1) * limit, len = Math.min(programArray.size(), page * limit); i < len; i++) {
                JSONObject programJson = programArray.getJSONObject(i);

                String id = programJson.getString("id");
                String name = programJson.getString("soundstr");
                Double duration = programJson.getDouble("duration") / 1000;

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.ME);
                musicInfo.setId(id);
                musicInfo.setName(name);
                musicInfo.setDuration(duration);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 探索节目(从网页解析，每页不超过 20 条)
        Callable<CommonResult<NetMusicInfo>> getExpProgramsMe = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[0])) {
                String programInfoBody = HttpRequest.get(String.format(EXP_PROGRAM_ME_API, s[0], page, Math.min(limit, 20)))
                        .execute()
                        .body();
                Document doc = Jsoup.parse(programInfoBody);
                String ts = ReUtil.get("p=(\\d+)", doc.select("li.last a").attr("href"), 1);
                t = StringUtil.isEmpty(ts) ? limit : Integer.parseInt(ts) * limit;
                Elements boxes = doc.select(".video-box");
                for (int i = 0, size = boxes.size(); i < size; i++) {
                    Element box = boxes.get(i);
                    Elements a = box.select(".video-auther a");

                    String id = box.attr("data-id");
                    String name = box.select(".video-title").text();
                    String artist = a.text();
                    String artistId = a.attr("href").replaceFirst("/", "");
                    Double duration = TimeUtil.chineseToSeconds(box.select("span.video-duration").get(1).text());

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setSource(NetMusicSource.ME);
                    musicInfo.setId(id);
                    musicInfo.setName(name);
                    musicInfo.setArtist(artist);
                    musicInfo.setArtistId(artistId);
                    musicInfo.setDuration(duration);

                    res.add(musicInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 首页分类节目(从网页解析，每页不超过 20 条)
        Callable<CommonResult<NetMusicInfo>> getIndexCatProgramsMe = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[1])) {
                String programInfoBody = HttpRequest.get(String.format(INDEX_CAT_PROGRAM_ME_API, s[1], page, Math.min(limit, 20)))
                        .execute()
                        .body();
                Document doc = Jsoup.parse(programInfoBody);
                String ts = ReUtil.get("p=(\\d+)", doc.select("li.last a").attr("href"), 1);
                t = ts.isEmpty() ? limit : Integer.parseInt(ts) * limit;
                Elements boxes = doc.select("div.vw-subcatalog-contant.fc-leftcontent-block.floatleft a[target=_player]");
                for (int i = 0, size = boxes.size(); i < size; i++) {
                    Element box = boxes.get(i);

                    String id = box.attr("href").replaceFirst("/sound/", "");
                    String name = box.attr("title");
                    Double duration = TimeUtil.toSeconds(box.select("div.vw-frontsound-time.fc-hoverheight").first().text().trim());

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setSource(NetMusicSource.ME);
                    musicInfo.setId(id);
                    musicInfo.setName(name);
                    musicInfo.setDuration(duration);

                    res.add(musicInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 首页分类节目(最新)(从网页解析，每页不超过 20 条)
        Callable<CommonResult<NetMusicInfo>> getIndexCatNewProgramsMe = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[1])) {
                String programInfoBody = HttpRequest.get(String.format(INDEX_CAT_NEW_PROGRAM_ME_API, s[1], page, Math.min(limit, 20)))
                        .execute()
                        .body();
                Document doc = Jsoup.parse(programInfoBody);
                String ts = ReUtil.get("p=(\\d+)", doc.select("li.last a").attr("href"), 1);
                t = ts.isEmpty() ? limit : Integer.parseInt(ts) * limit;
                Elements boxes = doc.select("div.vw-subcatalog-contant.fc-leftcontent-block.floatleft a[target=_player]");
                for (int i = 0, size = boxes.size(); i < size; i++) {
                    Element box = boxes.get(i);

                    String id = box.attr("href").replaceFirst("/sound/", "");
                    String name = box.attr("title");
                    Double duration = TimeUtil.toSeconds(box.select("div.vw-frontsound-time.fc-hoverheight").first().text().trim());

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setSource(NetMusicSource.ME);
                    musicInfo.setId(id);
                    musicInfo.setName(name);
                    musicInfo.setDuration(duration);

                    res.add(musicInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 首页分类节目侧边榜单
        Callable<CommonResult<NetMusicInfo>> getIndexCatProgramsRankingMe = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[1])) {
                String programInfoBody = HttpRequest.get(String.format(INDEX_CAT_PROGRAM_ME_API, s[1], page, limit))
                        .execute()
                        .body();
                Document doc = Jsoup.parse(programInfoBody);
                Elements boxes = doc.select(".vw-weibo-title.floatleft a");
                boxes.addAll(doc.select(".vw-right-content.floatleft a"));
                t = boxes.size();
                for (int i = (page - 1) * limit, size = Math.min(page * limit, boxes.size()); i < size; i++) {
                    Element box = boxes.get(i);

                    String id = box.attr("href").replaceFirst("/sound/", "");
                    String name = box.childNodeSize() > 1 ? box.select(".vw-rank-title.floatleft").text().trim() : box.text().trim();

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setSource(NetMusicSource.ME);
                    musicInfo.setId(id);
                    musicInfo.setName(name);

                    res.add(musicInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        List<Future<CommonResult<NetMusicInfo>>> taskList = new LinkedList<>();

        boolean dt = tag.equals(defaultTag);

        if (dt) {
            if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendPrograms));
                taskList.add(GlobalExecutors.requestExecutor.submit(getPersonalizedPrograms));
                taskList.add(GlobalExecutors.requestExecutor.submit(get24HoursPrograms));
                taskList.add(GlobalExecutors.requestExecutor.submit(getProgramsRanking));
            }

            if (src == NetMusicSource.ME || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getRecProgramsMe));
            }
        } else {
            if (src == NetMusicSource.ME || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getExpProgramsMe));
                taskList.add(GlobalExecutors.requestExecutor.submit(getIndexCatProgramsMe));
                taskList.add(GlobalExecutors.requestExecutor.submit(getIndexCatNewProgramsMe));
                taskList.add(GlobalExecutors.requestExecutor.submit(getIndexCatProgramsRankingMe));
            }
        }

        List<List<NetMusicInfo>> rl = new LinkedList<>();
        taskList.forEach(task -> {
            try {
                CommonResult<NetMusicInfo> result = task.get();
                rl.add(result.data);
                total.set(Math.max(total.get(), result.total));
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
        musicInfos.addAll(ListUtil.joinAll(rl));

        return new CommonResult<>(musicInfos, total.get());
    }

    /**
     * 获取飙升歌曲
     */
    public static CommonResult<NetMusicInfo> getHotMusicRecommend(int src, String tag, int limit, int page) {
        AtomicInteger total = new AtomicInteger();
        List<NetMusicInfo> musicInfos = new LinkedList<>();

        final String defaultTag = "默认";
        String[] s = Tags.hotSongTag.get(tag);

        // 网易云(榜单就是歌单，固定榜单 id 直接请求歌单音乐接口，接口分页)
        // 飙升榜
        Callable<CommonResult<NetMusicInfo>> getUpMusic = () -> getMusicInfoInPlaylist(String.valueOf(19723756), NetMusicSource.NET_CLOUD, limit, page);
        // 热歌榜
        Callable<CommonResult<NetMusicInfo>> getHotMusic = () -> getMusicInfoInPlaylist(String.valueOf(3778678), NetMusicSource.NET_CLOUD, limit, page);
        // 曲风歌曲(最热)
        Callable<CommonResult<NetMusicInfo>> getStyleHotSong = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[0])) {
                String musicInfoBody = HttpRequest.get(String.format(STYLE_HOT_SONG_API, s[0], (page - 1) * limit, limit))
                        .execute()
                        .body();
                JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
                JSONObject data = musicInfoJson.getJSONObject("data");
                JSONArray songsArray = data.getJSONArray("songs");
                t = data.getJSONObject("page").getInt("total");
                for (int i = 0, len = songsArray.size(); i < len; i++) {
                    JSONObject songJson = songsArray.getJSONObject(i);

                    String songId = songJson.getString("id");
                    String songName = songJson.getString("name").trim();
                    String artist = parseArtists(songJson, NetMusicSource.NET_CLOUD);
                    String artistId = songJson.getJSONArray("ar").getJSONObject(0).getString("id");
                    String albumName = songJson.getJSONObject("al").getString("name");
                    String albumId = songJson.getJSONObject("al").getString("id");
                    Double duration = songJson.getDouble("dt") / 1000;
                    String mvId = songJson.getString("mv");

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setId(songId);
                    musicInfo.setName(songName);
                    musicInfo.setArtist(artist);
                    musicInfo.setArtistId(artistId);
                    musicInfo.setAlbumName(albumName);
                    musicInfo.setAlbumId(albumId);
                    musicInfo.setDuration(duration);
                    musicInfo.setMvId(mvId);
                    res.add(musicInfo);
                }
            }

            return new CommonResult<>(res, t);
        };

        // 酷狗
        // 飙升榜
        Callable<CommonResult<NetMusicInfo>> getUpMusicKg = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String rankingInfoBody = HttpRequest.get(String.format(UP_MUSIC_KG_API, page, limit))
                    .execute()
                    .body();
            JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
            JSONObject data = rankingInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray songArray = data.getJSONArray("info");
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String hash = songJson.getString("hash");
                String songId = songJson.getString("album_audio_id");
                String name = songJson.getString("songname");
                String artists = parseArtists(songJson, NetMusicSource.KG);
                JSONArray artistArray = songJson.optJSONArray("authors");
                String artistId = artistArray != null && !artistArray.isEmpty() ? artistArray.getJSONObject(0).getString("author_id") : "";
//                String albumName = songJson.getString("remark");
                String albumId = songJson.getString("album_id");
                Double duration = songJson.getDouble("duration");
                String mvHash = songJson.getString("mvhash");
                String mvId = StringUtil.isEmpty(mvHash) ? "" : songJson.getJSONArray("mvdata").getJSONObject(0).getString("hash");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.KG);
                musicInfo.setHash(hash);
                musicInfo.setId(songId);
                musicInfo.setName(name);
                musicInfo.setArtist(artists);
                musicInfo.setArtistId(artistId);
//                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);
                musicInfo.setMvId(mvId);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };
        // TOP500
        Callable<CommonResult<NetMusicInfo>> getTop500Kg = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String rankingInfoBody = HttpRequest.get(String.format(TOP500_KG_API, page, limit))
                    .execute()
                    .body();
            JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
            JSONObject data = rankingInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray songArray = data.getJSONArray("info");
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String hash = songJson.getString("hash");
                String songId = songJson.getString("album_audio_id");
                String name = songJson.getString("songname");
                String artists = parseArtists(songJson, NetMusicSource.KG);
                JSONArray artistArray = songJson.optJSONArray("authors");
                String artistId = artistArray != null && !artistArray.isEmpty() ? artistArray.getJSONObject(0).getString("author_id") : "";
//                String albumName = songJson.getString("remark");
                String albumId = songJson.getString("album_id");
                Double duration = songJson.getDouble("duration");
                String mvHash = songJson.getString("mvhash");
                String mvId = StringUtil.isEmpty(mvHash) ? "" : songJson.getJSONArray("mvdata").getJSONObject(0).getString("hash");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.KG);
                musicInfo.setHash(hash);
                musicInfo.setId(songId);
                musicInfo.setName(name);
                musicInfo.setArtist(artists);
                musicInfo.setArtistId(artistId);
//                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);
                musicInfo.setMvId(mvId);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };

        // QQ
        // 流行指数榜
        Callable<CommonResult<NetMusicInfo>> getPopularMusicQq = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String musicInfoBody = HttpRequest.get(String.format(POPULAR_MUSIC_QQ_API, page, limit))
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            JSONObject data = musicInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray songArray = data.getJSONArray("list");
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String id = songJson.getString("mid");
                String name = songJson.getString("name");
                String artist = parseArtists(songJson, NetMusicSource.QQ);
                String artistId = songJson.getJSONArray("singer").getJSONObject(0).getString("mid");
                String albumName = songJson.getJSONObject("album").getString("name");
                String albumId = songJson.getJSONObject("album").getString("mid");
                Double duration = songJson.getDouble("interval");
                String mvId = songJson.getJSONObject("mv").getString("vid");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.QQ);
                musicInfo.setId(id);
                musicInfo.setName(name);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);
                musicInfo.setMvId(mvId);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 热歌榜
        Callable<CommonResult<NetMusicInfo>> getHotMusicQq = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String musicInfoBody = HttpRequest.get(String.format(HOT_MUSIC_QQ_API, page, limit))
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            JSONObject data = musicInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray songArray = data.getJSONArray("list");
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String id = songJson.getString("mid");
                String name = songJson.getString("name");
                String artist = parseArtists(songJson, NetMusicSource.QQ);
                String artistId = songJson.getJSONArray("singer").getJSONObject(0).getString("mid");
                String albumName = songJson.getJSONObject("album").getString("name");
                String albumId = songJson.getJSONObject("album").getString("mid");
                Double duration = songJson.getDouble("interval");
                String mvId = songJson.getJSONObject("mv").getString("vid");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.QQ);
                musicInfo.setId(id);
                musicInfo.setName(name);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);
                musicInfo.setMvId(mvId);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 酷我
        // 飙升榜
        Callable<CommonResult<NetMusicInfo>> getUpMusicKw = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = kwRequest(String.format(UP_MUSIC_KW_API, page, limit)).execute();
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                String musicInfoBody = resp.body();
                JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
                JSONObject data = musicInfoJson.getJSONObject("data");
                t = data.getInt("num");
                JSONArray songArray = data.getJSONArray("musicList");
                for (int i = 0, len = songArray.size(); i < len; i++) {
                    JSONObject songJson = songArray.getJSONObject(i);

                    String id = songJson.getString("rid");
                    String name = songJson.getString("name");
                    String artist = songJson.getString("artist");
                    String artistId = songJson.getString("artistid");
                    String albumName = songJson.getString("album");
                    String albumId = songJson.getString("albumid");
                    Double duration = songJson.getDouble("duration");
                    String mvId = songJson.getInt("hasmv") == 0 ? "" : id;

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setSource(NetMusicSource.KW);
                    musicInfo.setId(id);
                    musicInfo.setName(name);
                    musicInfo.setArtist(artist);
                    musicInfo.setArtistId(artistId);
                    musicInfo.setAlbumName(albumName);
                    musicInfo.setAlbumId(albumId);
                    musicInfo.setDuration(duration);
                    musicInfo.setMvId(mvId);

                    res.add(musicInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 热歌榜
        Callable<CommonResult<NetMusicInfo>> getHotMusicKw = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = kwRequest(String.format(HOT_MUSIC_KW_API, page, limit)).execute();
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                String musicInfoBody = resp.body();
                JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
                JSONObject data = musicInfoJson.getJSONObject("data");
                t = data.getInt("num");
                JSONArray songArray = data.getJSONArray("musicList");
                for (int i = 0, len = songArray.size(); i < len; i++) {
                    JSONObject songJson = songArray.getJSONObject(i);

                    String id = songJson.getString("rid");
                    String name = songJson.getString("name");
                    String artist = songJson.getString("artist");
                    String artistId = songJson.getString("artistid");
                    String albumName = songJson.getString("album");
                    String albumId = songJson.getString("albumid");
                    Double duration = songJson.getDouble("duration");
                    String mvId = songJson.getInt("hasmv") == 0 ? "" : id;

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setSource(NetMusicSource.KW);
                    musicInfo.setId(id);
                    musicInfo.setName(name);
                    musicInfo.setArtist(artist);
                    musicInfo.setArtistId(artistId);
                    musicInfo.setAlbumName(albumName);
                    musicInfo.setAlbumId(albumId);
                    musicInfo.setDuration(duration);
                    musicInfo.setMvId(mvId);

                    res.add(musicInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 咪咕
        // 尖叫热歌榜
        Callable<CommonResult<NetMusicInfo>> getHotMusicMg = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String rankingInfoBody = HttpRequest.get(String.format(HOT_MUSIC_MG_API))
                    .execute()
                    .body();
            JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
            JSONObject data = rankingInfoJson.getJSONObject("columnInfo");
            t = data.getInt("contentsCount");
            JSONArray songArray = data.getJSONArray("contents");
            for (int i = (page - 1) * limit, len = Math.min(songArray.size(), page * limit); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i).getJSONObject("objectInfo");

                String songId = songJson.optString("copyrightId");
                // 过滤掉不是歌曲的 objectInfo
                if (StringUtil.isEmpty(songId)) continue;
                String name = songJson.getString("songName");
                String artists = songJson.getString("singer");
                String artistId = songJson.getString("singerId");
                String albumName = songJson.getString("album");
                String albumId = songJson.getString("albumId");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.MG);
                musicInfo.setId(songId);
                musicInfo.setName(name);
                musicInfo.setArtist(artists);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 音乐磁场
        Callable<CommonResult<NetMusicInfo>> getHotMusicHf = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[1])) {
                String musicInfoBody = HttpRequest.get(String.format(HOT_MUSIC_HF_API, s[1], page))
                        .cookie(HF_COOKIE)
                        .execute()
                        .body();
                Document doc = Jsoup.parse(musicInfoBody);
                Elements songs = doc.select(".media.thread.tap");
                Elements ap = doc.select("a.page-link");
                String ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 1).text(), 1);
                if (StringUtil.isEmpty(ts))
                    ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 2).text(), 1);
                boolean hasTs = StringUtil.isNotEmpty(ts);
                if (hasTs) t = Integer.parseInt(ts) * limit;
                else t = songs.size();
                for (int i = hasTs ? 0 : (page - 1) * limit, len = hasTs ? songs.size() : Math.min(songs.size(), page * limit); i < len; i++) {
                    Element song = songs.get(i);

                    Elements a = song.select(".subject.break-all a");
                    Element span = song.select(".username.text-grey.mr-1").first();

                    String songId = ReUtil.get("thread-(.*?)\\.htm", a.attr("href"), 1);
                    String songName = a.text();
                    String artist = span.text();
                    String artistId = span.attr("uid");

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setSource(NetMusicSource.HF);
                    musicInfo.setId(songId);
                    musicInfo.setName(songName);
                    musicInfo.setArtist(artist);
                    musicInfo.setArtistId(artistId);

                    res.add(musicInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 咕咕咕音乐
        Callable<CommonResult<NetMusicInfo>> getHotMusicGg = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[2])) {
                String musicInfoBody = HttpRequest.get(String.format(HOT_MUSIC_GG_API, s[2], page))
                        .execute()
                        .body();
                Document doc = Jsoup.parse(musicInfoBody);
                Elements songs = doc.select(".media.thread.tap");
                Elements ap = doc.select("a.page-link");
                String ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 1).text(), 1);
                if (StringUtil.isEmpty(ts))
                    ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 2).text(), 1);
                boolean hasTs = StringUtil.isNotEmpty(ts);
                if (hasTs) t = Integer.parseInt(ts) * limit;
                else t = songs.size();
                for (int i = hasTs ? 0 : (page - 1) * limit, len = hasTs ? songs.size() : Math.min(songs.size(), page * limit); i < len; i++) {
                    Element song = songs.get(i);

                    Elements a = song.select(".subject.break-all a");

                    String songId = ReUtil.get("thread-(.*?)\\.htm", a.attr("href"), 1);
                    String songName = a.text();

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setSource(NetMusicSource.GG);
                    musicInfo.setId(songId);
                    musicInfo.setName(songName);

                    res.add(musicInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        List<Future<CommonResult<NetMusicInfo>>> taskList = new LinkedList<>();

        boolean dt = defaultTag.equals(tag);

        if (dt) {
            if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getUpMusic));
                taskList.add(GlobalExecutors.requestExecutor.submit(getHotMusic));
            }

            if (src == NetMusicSource.KG || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getUpMusicKg));
                taskList.add(GlobalExecutors.requestExecutor.submit(getTop500Kg));
            }

            if (src == NetMusicSource.QQ || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getPopularMusicQq));
                taskList.add(GlobalExecutors.requestExecutor.submit(getHotMusicQq));
            }

            if (src == NetMusicSource.KW || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getUpMusicKw));
                taskList.add(GlobalExecutors.requestExecutor.submit(getHotMusicKw));
            }

            if (src == NetMusicSource.MG || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getHotMusicMg));
            }

            if (src == NetMusicSource.HF || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getHotMusicHf));
            }

            if (src == NetMusicSource.GG || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getHotMusicGg));
            }
        } else {
            if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL)
                taskList.add(GlobalExecutors.requestExecutor.submit(getStyleHotSong));
            if (src == NetMusicSource.HF || src == NetMusicSource.ALL)
                taskList.add(GlobalExecutors.requestExecutor.submit(getHotMusicHf));
            if (src == NetMusicSource.GG || src == NetMusicSource.ALL)
                taskList.add(GlobalExecutors.requestExecutor.submit(getHotMusicGg));
        }

        List<List<NetMusicInfo>> rl = new LinkedList<>();
        taskList.forEach(task -> {
            try {
                CommonResult<NetMusicInfo> result = task.get();
                rl.add(result.data);
                total.set(Math.max(total.get(), result.total));
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
        musicInfos.addAll(ListUtil.joinAll(rl));

        return new CommonResult<>(musicInfos, total.get());
    }

    /**
     * 获取推荐歌曲 + 新歌速递
     */
    public static CommonResult<NetMusicInfo> getNewMusic(int src, String tag, int limit, int page) {
        AtomicInteger total = new AtomicInteger();
        List<NetMusicInfo> musicInfos = new LinkedList<>();

        final String defaultTag = "默认";
        String[] s = Tags.newSongTag.get(tag);

        // 网易云(程序分页)
        // 推荐新歌
        Callable<CommonResult<NetMusicInfo>> getRecommendNewSong = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String musicInfoBody = HttpRequest.get(RECOMMEND_NEW_SONG_API)
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            JSONArray songsArray = musicInfoJson.getJSONArray("result");
            t = songsArray.size();
            for (int i = (page - 1) * limit, len = Math.min(songsArray.size(), page * limit); i < len; i++) {
                JSONObject jsonObject = songsArray.getJSONObject(i);
                JSONObject songJson;
                if (jsonObject.has("song")) songJson = jsonObject.getJSONObject("song");
                else songJson = jsonObject;
                String songId = songJson.getString("id");
                String songName = songJson.getString("name").trim();
                String artist = parseArtists(songJson, NetMusicSource.NET_CLOUD);
                String artistId = songJson.getJSONArray("artists").getJSONObject(0).getString("id");
                String albumName = songJson.getJSONObject("album").getString("name");
                String albumId = songJson.getJSONObject("album").getString("id");
                Double duration = songJson.getDouble("duration") / 1000;
                String mvId = songJson.getString("mvid");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setId(songId);
                musicInfo.setName(songName);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);
                musicInfo.setMvId(mvId);
                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 新歌速递
        Callable<CommonResult<NetMusicInfo>> getFastNewSong = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[0])) {
                String musicInfoBody = HttpRequest.get(String.format(FAST_NEW_SONG_API, s[0]))
                        .execute()
                        .body();
                JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
                JSONArray songsArray = musicInfoJson.getJSONArray("data");
                t = songsArray.size();
                for (int i = (page - 1) * limit, len = Math.min(songsArray.size(), page * limit); i < len; i++) {
                    JSONObject jsonObject = songsArray.getJSONObject(i);
                    JSONObject songJson;
                    if (jsonObject.has("song")) songJson = jsonObject.getJSONObject("song");
                    else songJson = jsonObject;
                    String songId = songJson.getString("id");
                    String songName = songJson.getString("name").trim();
                    String artist = parseArtists(songJson, NetMusicSource.NET_CLOUD);
                    String artistId = songJson.getJSONArray("artists").getJSONObject(0).getString("id");
                    String albumName = songJson.getJSONObject("album").getString("name");
                    String albumId = songJson.getJSONObject("album").getString("id");
                    Double duration = songJson.getDouble("duration") / 1000;
                    String mvId = songJson.getString("mvid");

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setId(songId);
                    musicInfo.setName(songName);
                    musicInfo.setArtist(artist);
                    musicInfo.setArtistId(artistId);
                    musicInfo.setAlbumName(albumName);
                    musicInfo.setAlbumId(albumId);
                    musicInfo.setDuration(duration);
                    musicInfo.setMvId(mvId);
                    res.add(musicInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 曲风歌曲(最新)
        Callable<CommonResult<NetMusicInfo>> getStyleNewSong = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[1])) {
                String musicInfoBody = HttpRequest.get(String.format(STYLE_NEW_SONG_API, s[1], (page - 1) * limit, limit))
                        .execute()
                        .body();
                JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
                JSONObject data = musicInfoJson.getJSONObject("data");
                JSONArray songsArray = data.getJSONArray("songs");
                t = data.getJSONObject("page").getInt("total");
                for (int i = 0, len = songsArray.size(); i < len; i++) {
                    JSONObject songJson = songsArray.getJSONObject(i);

                    String songId = songJson.getString("id");
                    String songName = songJson.getString("name").trim();
                    String artist = parseArtists(songJson, NetMusicSource.NET_CLOUD);
                    String artistId = songJson.getJSONArray("ar").getJSONObject(0).getString("id");
                    String albumName = songJson.getJSONObject("al").getString("name");
                    String albumId = songJson.getJSONObject("al").getString("id");
                    Double duration = songJson.getDouble("dt") / 1000;
                    String mvId = songJson.getString("mv");

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setId(songId);
                    musicInfo.setName(songName);
                    musicInfo.setArtist(artist);
                    musicInfo.setArtistId(artistId);
                    musicInfo.setAlbumName(albumName);
                    musicInfo.setAlbumId(albumId);
                    musicInfo.setDuration(duration);
                    musicInfo.setMvId(mvId);
                    res.add(musicInfo);
                }
            }

            return new CommonResult<>(res, t);
        };

        // 酷狗
        // 华语新歌(接口分页)
        Callable<CommonResult<NetMusicInfo>> getRecommendNewSongKg = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[2])) {
                String musicInfoBody = HttpRequest.get(String.format(RECOMMEND_NEW_SONG_KG_API, s[2], page, limit))
                        .execute()
                        .body();
                JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
                JSONObject data = musicInfoJson.getJSONObject("data");
                t = data.getInt("total");
                JSONArray songsArray = data.getJSONArray("info");
                for (int i = 0, len = songsArray.size(); i < len; i++) {
                    JSONObject songJson = songsArray.getJSONObject(i);

                    String hash = songJson.getString("hash");
                    String songId = songJson.getString("album_audio_id");
                    String name = songJson.getString("songname");
                    String artists = parseArtists(songJson, NetMusicSource.KG);
                    JSONArray artistArray = songJson.optJSONArray("authors");
                    String artistId = artistArray != null && !artistArray.isEmpty() ? artistArray.getJSONObject(0).getString("author_id") : "";
                    String albumId = songJson.getString("album_id");
                    Double duration = songJson.getDouble("duration");
                    String mvId = songJson.getString("mvhash");

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setSource(NetMusicSource.KG);
                    musicInfo.setHash(hash);
                    musicInfo.setId(songId);
                    musicInfo.setName(name);
                    musicInfo.setArtist(artists);
                    musicInfo.setArtistId(artistId);
                    musicInfo.setAlbumId(albumId);
                    musicInfo.setDuration(duration);
                    musicInfo.setMvId(mvId);

                    res.add(musicInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // QQ(程序分页)
        Callable<CommonResult<NetMusicInfo>> getRecommendNewSongQq = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[3])) {
                String musicInfoBody = HttpRequest.get(String.format(RECOMMEND_NEW_SONG_QQ_API, s[3]))
                        .execute()
                        .body();
                JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
                JSONArray songsArray = musicInfoJson.getJSONObject("data").getJSONArray("list");
                t = songsArray.size();
                for (int i = (page - 1) * limit, len = Math.min(songsArray.size(), page * limit); i < len; i++) {
                    JSONObject songJson = songsArray.getJSONObject(i);

                    String songId = songJson.getString("mid");
                    String songName = songJson.getString("name");
                    String artist = parseArtists(songJson, NetMusicSource.QQ);
                    String artistId = songJson.getJSONArray("singer").getJSONObject(0).getString("mid");
                    String albumName = songJson.getJSONObject("album").getString("name");
                    String albumId = songJson.getJSONObject("album").getString("mid");
                    Double duration = songJson.getDouble("interval");
                    String mvId = songJson.getJSONObject("mv").getString("vid");

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setSource(NetMusicSource.QQ);
                    musicInfo.setId(songId);
                    musicInfo.setName(songName);
                    musicInfo.setArtist(artist);
                    musicInfo.setArtistId(artistId);
                    musicInfo.setAlbumName(albumName);
                    musicInfo.setAlbumId(albumId);
                    musicInfo.setDuration(duration);
                    musicInfo.setMvId(mvId);

                    res.add(musicInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 酷我(接口分页)
        Callable<CommonResult<NetMusicInfo>> getRecommendNewSongKw = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = kwRequest(String.format(NEW_SONG_KW_API, page, limit)).execute();
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                String musicInfoBody = resp.body();
                JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
                JSONObject data = musicInfoJson.getJSONObject("data");
                t = data.getInt("num");
                JSONArray songsArray = data.getJSONArray("musicList");
                t = Math.max(t, songsArray.size());
                for (int i = 0, len = songsArray.size(); i < len; i++) {
                    JSONObject songJson = songsArray.getJSONObject(i);

                    String id = songJson.getString("rid");
                    String name = songJson.getString("name");
                    String artist = songJson.getString("artist");
                    String artistId = songJson.getString("artistid");
                    String albumName = songJson.getString("album");
                    String albumId = songJson.getString("albumid");
                    Double duration = songJson.getDouble("duration");
                    String mvId = songJson.getInt("hasmv") == 0 ? "" : id;

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setSource(NetMusicSource.KW);
                    musicInfo.setId(id);
                    musicInfo.setName(name);
                    musicInfo.setArtist(artist);
                    musicInfo.setArtistId(artistId);
                    musicInfo.setAlbumName(albumName);
                    musicInfo.setAlbumId(albumId);
                    musicInfo.setDuration(duration);
                    musicInfo.setMvId(mvId);

                    res.add(musicInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 咪咕(接口分页)
        Callable<CommonResult<NetMusicInfo>> getRecommendNewSongMg = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String musicInfoBody = HttpRequest.get(String.format(RECOMMEND_NEW_SONG_MG_API, page, limit))
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            JSONObject data = musicInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray songsArray = data.getJSONArray("list");
            for (int i = 0, len = songsArray.size(); i < len; i++) {
                JSONObject songJson = songsArray.getJSONObject(i);

                String songId = songJson.getString("cid");
                String songName = songJson.getString("name");
                String artist = parseArtists(songJson, NetMusicSource.MG);
                String artistId = songJson.getJSONArray("artists").getJSONObject(0).getString("id");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.MG);
                musicInfo.setId(songId);
                musicInfo.setName(songName);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 千千(程序分页)
        Callable<CommonResult<NetMusicInfo>> getRecommendNewSongQi = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            String musicInfoBody = HttpRequest.get(buildQianUrl(String.format(RECOMMEND_NEW_SONG_QI_API, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            JSONObject data = musicInfoJson.getJSONArray("data").getJSONObject(2);
            t = data.getInt("module_nums");
            JSONArray songsArray = data.getJSONArray("result");
            for (int i = (page - 1) * limit, len = Math.min(songsArray.size(), page * limit); i < len; i++) {
                JSONObject songJson = songsArray.getJSONObject(i);

                String songId = songJson.getString("TSID");
                String songName = songJson.getString("title");
                String artist = parseArtists(songJson, NetMusicSource.QI);
                JSONArray artistArray = songJson.optJSONArray("artist");
                String artistId = artistArray != null && !artistArray.isEmpty() ? artistArray.getJSONObject(0).getString("artistCode") : "";
                String albumName = songJson.getString("albumTitle");
                String albumId = songJson.getString("albumAssetCode");
                Double duration = songJson.getDouble("duration");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.QI);
                musicInfo.setId(songId);
                musicInfo.setName(songName);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 音乐磁场
        Callable<CommonResult<NetMusicInfo>> getRecommendNewSongHf = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[4])) {
                String musicInfoBody = HttpRequest.get(String.format(RECOMMEND_NEW_MUSIC_HF_API, s[4], page))
                        .cookie(HF_COOKIE)
                        .execute()
                        .body();
                Document doc = Jsoup.parse(musicInfoBody);
                Elements songs = doc.select(".media.thread.tap");
                Elements ap = doc.select("a.page-link");
                String ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 1).text(), 1);
                if (StringUtil.isEmpty(ts))
                    ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 2).text(), 1);
                boolean hasTs = StringUtil.isNotEmpty(ts);
                if (hasTs) t = Integer.parseInt(ts) * limit;
                else t = songs.size();
                for (int i = hasTs ? 0 : (page - 1) * limit, len = hasTs ? songs.size() : Math.min(songs.size(), page * limit); i < len; i++) {
                    Element song = songs.get(i);

                    Elements a = song.select(".subject.break-all a");
                    Element span = song.select(".username.text-grey.mr-1").first();

                    String songId = ReUtil.get("thread-(.*?)\\.htm", a.attr("href"), 1);
                    String songName = a.text();
                    String artist = span.text();
                    String artistId = span.attr("uid");

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setSource(NetMusicSource.HF);
                    musicInfo.setId(songId);
                    musicInfo.setName(songName);
                    musicInfo.setArtist(artist);
                    musicInfo.setArtistId(artistId);

                    res.add(musicInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 咕咕咕音乐
        Callable<CommonResult<NetMusicInfo>> getRecommendNewSongGg = () -> {
            LinkedList<NetMusicInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[5])) {
                String musicInfoBody = HttpRequest.get(String.format(RECOMMEND_NEW_MUSIC_GG_API, s[5], page))
                        .execute()
                        .body();
                Document doc = Jsoup.parse(musicInfoBody);
                Elements songs = doc.select(".media.thread.tap");
                Elements ap = doc.select("a.page-link");
                String ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 1).text(), 1);
                if (StringUtil.isEmpty(ts))
                    ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 2).text(), 1);
                boolean hasTs = StringUtil.isNotEmpty(ts);
                if (hasTs) t = Integer.parseInt(ts) * limit;
                else t = songs.size();
                for (int i = hasTs ? 0 : (page - 1) * limit, len = hasTs ? songs.size() : Math.min(songs.size(), page * limit); i < len; i++) {
                    Element song = songs.get(i);

                    Elements a = song.select(".subject.break-all a");

                    String songId = ReUtil.get("thread-(.*?)\\.htm", a.attr("href"), 1);
                    String songName = a.text();

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setSource(NetMusicSource.GG);
                    musicInfo.setId(songId);
                    musicInfo.setName(songName);

                    res.add(musicInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        List<Future<CommonResult<NetMusicInfo>>> taskList = new LinkedList<>();

        boolean dt = defaultTag.equals(tag);

        if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendNewSong));
            taskList.add(GlobalExecutors.requestExecutor.submit(getFastNewSong));
            if (!dt) taskList.add(GlobalExecutors.requestExecutor.submit(getStyleNewSong));
        }

        if (src == NetMusicSource.KG || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendNewSongKg));
        }

        if (src == NetMusicSource.QQ || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendNewSongQq));
        }

        if (src == NetMusicSource.KW || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendNewSongKw));
        }

        if (src == NetMusicSource.MG || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendNewSongMg));
        }

        if (src == NetMusicSource.QI || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendNewSongQi));
        }

        if (src == NetMusicSource.HF || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendNewSongHf));
        }

        if (src == NetMusicSource.GG || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendNewSongGg));
        }

        List<List<NetMusicInfo>> rl = new LinkedList<>();
        taskList.forEach(task -> {
            try {
                CommonResult<NetMusicInfo> result = task.get();
                rl.add(result.data);
                total.set(Math.max(total.get(), result.total));
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
        musicInfos.addAll(ListUtil.joinAll(rl));

        return new CommonResult<>(musicInfos, total.get());
    }

    /**
     * 获取新碟上架
     */
    public static CommonResult<NetAlbumInfo> getNewAlbums(int src, String tag, int limit, int page) {
        AtomicInteger total = new AtomicInteger();
        List<NetAlbumInfo> albumInfos = new LinkedList<>();

        final String defaultTag = "默认";
        String[] s = Tags.newAlbumTag.get(tag);

        // 网易云(程序分页)
        // 新蹀上架
        Callable<CommonResult<NetAlbumInfo>> getNewAlbums = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[0])) {
                String albumInfoBody = HttpRequest.get(String.format(NEW_ALBUM_API, s[0]))
                        .execute()
                        .body();
                JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
                JSONArray albumArray = albumInfoJson.optJSONArray("weekData");
                JSONArray monthData = albumInfoJson.getJSONArray("monthData");
                if (albumArray == null) albumArray = monthData;
                else albumArray.addAll(monthData);
                t = albumArray.size();
                for (int i = (page - 1) * limit, len = Math.min(albumArray.size(), page * limit); i < len; i++) {
                    JSONObject albumJson = albumArray.getJSONObject(i);

                    String albumId = albumJson.getString("id");
                    String albumName = albumJson.getString("name");
                    String artist = parseArtists(albumJson, NetMusicSource.NET_CLOUD);
                    String artistId = albumJson.getJSONArray("artists").getJSONObject(0).getString("id");
                    String publishTime = TimeUtil.msToDate(albumJson.getLong("publishTime"));
                    Integer songNum = albumJson.getInt("size");
                    String coverImgThumbUrl = albumJson.getString("picUrl");

                    NetAlbumInfo albumInfo = new NetAlbumInfo();
                    albumInfo.setId(albumId);
                    albumInfo.setName(albumName);
                    albumInfo.setArtist(artist);
                    albumInfo.setArtistId(artistId);
                    albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    albumInfo.setPublishTime(publishTime);
                    albumInfo.setSongNum(songNum);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        albumInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(albumInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 新碟上架(热门)
//        Callable<CommonResult<NetAlbumInfo>> getHotAlbums = () -> {
//            LinkedList<NetAlbumInfo> res = new LinkedList<>();
//            Integer t = 0;
//
//            if (StringUtils.isNotEmpty(s[0])) {
//                String albumInfoBody = HttpRequest.get(String.format(HOT_ALBUM_API, s[0]))
//                        .execute()
//                        .body();
//                JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
//                JSONArray albumArray = albumInfoJson.optJSONArray("weekData");
//                JSONArray monthData = albumInfoJson.getJSONArray("monthData");
//                if (albumArray == null) albumArray = monthData;
//                else albumArray.addAll(monthData);
//                t = albumArray.size();
//                for (int i = (page - 1) * limit, len = Math.min(albumArray.size(), page * limit); i < len; i++) {
//                    JSONObject albumJson = albumArray.getJSONObject(i);
//
//                    String albumId = albumJson.getString("id");
//                    String albumName = albumJson.getString("name");
//                    String artist = parseArtists(albumJson, NetMusicSource.NET_CLOUD);
//                    String publishTime = TimeUtils.msToDate(albumJson.getLong("publishTime"));
//                    Integer songNum = albumJson.getInt("size");
//                    String coverImgThumbUrl = albumJson.getString("picUrl");
//
//                    NetAlbumInfo albumInfo = new NetAlbumInfo();
//                    albumInfo.setId(albumId);
//                    albumInfo.setName(albumName);
//                    albumInfo.setArtist(artist);
//                    albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
//                    albumInfo.setPublishTime(publishTime);
//                    albumInfo.setSongNum(songNum);
//                    GlobalExecutors.imageExecutor.execute(() -> {
//                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
//                        albumInfo.setCoverImgThumb(coverImgThumb);
//                    });
//
//                    res.add(albumInfo);
//                }
//            }
//            return new CommonResult<>(res, t);
//        };
        // 全部新碟(接口分页，与上面两个分开处理)
        Callable<CommonResult<NetAlbumInfo>> getAllNewAlbums = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[0])) {
                String albumInfoBody = HttpRequest.get(String.format(ALL_NEW_ALBUM_API, s[0], (page - 1) * limit, limit))
                        .execute()
                        .body();
                JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
                t = albumInfoJson.getInt("total");
                JSONArray albumArray = albumInfoJson.getJSONArray("albums");
                for (int i = 0, len = albumArray.size(); i < len; i++) {
                    JSONObject albumJson = albumArray.getJSONObject(i);

                    String albumId = albumJson.getString("id");
                    String albumName = albumJson.getString("name");
                    String artist = parseArtists(albumJson, NetMusicSource.NET_CLOUD);
                    String artistId = albumJson.getJSONArray("artists").getJSONObject(0).getString("id");
                    String publishTime = TimeUtil.msToDate(albumJson.getLong("publishTime"));
                    Integer songNum = albumJson.getInt("size");
                    String coverImgThumbUrl = albumJson.getString("picUrl");

                    NetAlbumInfo albumInfo = new NetAlbumInfo();
                    albumInfo.setId(albumId);
                    albumInfo.setName(albumName);
                    albumInfo.setArtist(artist);
                    albumInfo.setArtistId(artistId);
                    albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    albumInfo.setPublishTime(publishTime);
                    albumInfo.setSongNum(songNum);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        albumInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(albumInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 最新专辑
        Callable<CommonResult<NetAlbumInfo>> getNewestAlbums = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            String albumInfoBody = HttpRequest.get(String.format(NEWEST_ALBUM_API))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONArray albumArray = albumInfoJson.getJSONArray("albums");
            t = albumArray.size();
            for (int i = (page - 1) * limit, len = Math.min(albumArray.size(), page * limit); i < len; i++) {
                JSONObject albumJson = albumArray.getJSONObject(i);

                String albumId = albumJson.getString("id");
                String albumName = albumJson.getString("name");
                String artist = parseArtists(albumJson, NetMusicSource.NET_CLOUD);
                String artistId = albumJson.getJSONArray("artists").getJSONObject(0).getString("id");
                String publishTime = TimeUtil.msToDate(albumJson.getLong("publishTime"));
                Integer songNum = albumJson.getInt("size");
                String coverImgThumbUrl = albumJson.getString("picUrl");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(albumInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 数字新碟上架
        Callable<CommonResult<NetAlbumInfo>> getNewestDiAlbums = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            String albumInfoBody = HttpRequest.get(String.format(NEWEST_DI_ALBUM_API))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONArray albumArray = albumInfoJson.getJSONArray("products");
            t = albumArray.size();
            for (int i = (page - 1) * limit, len = Math.min(albumArray.size(), page * limit); i < len; i++) {
                JSONObject albumJson = albumArray.getJSONObject(i);

                String albumId = albumJson.getString("albumId");
                String albumName = albumJson.getString("albumName");
                String artist = albumJson.getString("artistName");
                String publishTime = TimeUtil.msToDate(albumJson.getLong("pubTime"));
                String coverImgThumbUrl = albumJson.getString("coverUrl");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setPublishTime(publishTime);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(albumInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 数字专辑语种风格馆
        Callable<CommonResult<NetAlbumInfo>> getLangDiAlbums = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[1])) {
                String albumInfoBody = HttpRequest.get(String.format(LANG_DI_ALBUM_API, s[1]))
                        .execute()
                        .body();
                JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
                JSONArray albumArray = albumInfoJson.getJSONArray("albumProducts");
                t = albumArray.size();
                for (int i = (page - 1) * limit, len = Math.min(albumArray.size(), page * limit); i < len; i++) {
                    JSONObject albumJson = albumArray.getJSONObject(i);

                    String albumId = albumJson.getString("albumId");
                    String albumName = albumJson.getString("albumName");
                    String artist = albumJson.getString("artistName");
                    String coverImgThumbUrl = albumJson.getString("coverUrl");

                    NetAlbumInfo albumInfo = new NetAlbumInfo();
                    albumInfo.setId(albumId);
                    albumInfo.setName(albumName);
                    albumInfo.setArtist(artist);
                    albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        albumInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(albumInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 曲风专辑
        Callable<CommonResult<NetAlbumInfo>> getStyleAlbums = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[2])) {
                String albumInfoBody = HttpRequest.get(String.format(STYLE_ALBUM_API, s[2], (page - 1) * limit, limit))
                        .execute()
                        .body();
                JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
                JSONObject data = albumInfoJson.getJSONObject("data");
                JSONArray albumArray = data.getJSONArray("albums");
                t = data.getJSONObject("page").getInt("total");
                for (int i = 0, len = albumArray.size(); i < len; i++) {
                    JSONObject albumJson = albumArray.getJSONObject(i);

                    String albumId = albumJson.getString("id");
                    String albumName = albumJson.getString("name");
                    String artist = parseArtists(albumJson, NetMusicSource.NET_CLOUD);
                    String artistId = albumJson.getJSONArray("artists").getJSONObject(0).getString("id");
                    String publishTime = TimeUtil.msToDate(albumJson.getLong("publishTime"));
                    Integer songNum = albumJson.getInt("size");
                    String coverImgThumbUrl = albumJson.getString("picUrl");

                    NetAlbumInfo albumInfo = new NetAlbumInfo();
                    albumInfo.setId(albumId);
                    albumInfo.setName(albumName);
                    albumInfo.setArtist(artist);
                    albumInfo.setArtistId(artistId);
                    albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    albumInfo.setPublishTime(publishTime);
                    albumInfo.setSongNum(songNum);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        albumInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(albumInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // QQ(程序分页)
        Callable<CommonResult<NetAlbumInfo>> getNewAlbumsQq = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[3])) {
                String albumInfoBody = HttpRequest.get(String.format(NEW_ALBUM_QQ_API, s[3]))
                        .execute()
                        .body();
                JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
                JSONArray albumArray = albumInfoJson.getJSONObject("data").getJSONArray("list");
                t = albumArray.size();
                for (int i = (page - 1) * limit, len = Math.min(albumArray.size(), page * limit); i < len; i++) {
                    JSONObject albumJson = albumArray.getJSONObject(i);

                    String albumId = albumJson.getString("mid");
                    String albumName = albumJson.getString("name");
                    String artist = parseArtists(albumJson, NetMusicSource.QQ);
                    String artistId = albumJson.getJSONArray("singers").getJSONObject(0).getString("mid");
                    String publishTime = albumJson.getString("release_time");
//            Integer songNum = albumJson.getJSONObject("ex").getInt("track_nums");
                    String coverImgThumbUrl = String.format(SINGLE_SONG_IMG_QQ_API, albumId);

                    NetAlbumInfo albumInfo = new NetAlbumInfo();
                    albumInfo.setSource(NetMusicSource.QQ);
                    albumInfo.setId(albumId);
                    albumInfo.setName(albumName);
                    albumInfo.setArtist(artist);
                    albumInfo.setArtistId(artistId);
                    albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    albumInfo.setPublishTime(publishTime);
//            albumInfo.setSongNum(songNum);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        albumInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(albumInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 咪咕
        // 新碟推荐(接口分页)
        Callable<CommonResult<NetAlbumInfo>> getNewAlbumsMg = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            String albumInfoBody = HttpRequest.get(String.format(NEW_ALBUM_MG_API, page, limit))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray albumArray = data.getJSONArray("list");
            for (int i = 0, len = albumArray.size(); i < len; i++) {
                JSONObject albumJson = albumArray.getJSONObject(i);

                String albumId = albumJson.getString("id");
                String albumName = albumJson.getString("name");
                String artist = parseArtists(albumJson, NetMusicSource.MG);
                String artistId = albumJson.getJSONArray("artists").getJSONObject(0).getString("id");
                String publishTime = albumJson.getString("publishTime");
                Integer songNum = albumJson.getInt("songCount");
                String coverImgThumbUrl = albumJson.getString("picUrl");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.MG);
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(albumInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 新专辑榜(程序分页)
        Callable<CommonResult<NetAlbumInfo>> getNewAlbumsRankingMg = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            String albumInfoBody = HttpRequest.get(String.format(NEW_ALBUM_RANKING_MG_API))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("columnInfo");
            t = data.getInt("contentsCount");
            JSONArray albumArray = data.getJSONArray("contents");
            for (int i = (page - 1) * limit, len = Math.min(albumArray.size(), page * limit); i < len; i++) {
                JSONObject albumJson = albumArray.getJSONObject(i).getJSONObject("objectInfo");

                String albumId = albumJson.getString("albumId");
                String albumName = albumJson.getString("title");
                String artist = albumJson.getString("singer").replace("|", "、");
                String artistId = albumJson.getString("singerId").split("\\|")[0];
                String publishTime = albumJson.getString("publishTime");
                Integer songNum = albumJson.getInt("totalCount");
                String coverImgThumbUrl = albumJson.getJSONArray("imgItems").getJSONObject(0).getString("img");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.MG);
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(albumInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 千千
        // 首页新专辑
        Callable<CommonResult<NetAlbumInfo>> getIndexNewAlbumsQi = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            String albumInfoBody = HttpRequest.get(buildQianUrl(String.format(INDEX_NEW_ALBUM_QI_API, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONArray("data").getJSONObject(3);
            JSONArray albumArray = data.getJSONArray("result");
            t = albumArray.size();
            for (int i = 0, len = albumArray.size(); i < len; i++) {
                JSONObject albumJson = albumArray.getJSONObject(i);

                String albumId = albumJson.getString("albumAssetCode");
                String albumName = albumJson.getString("title");
                String artist = parseArtists(albumJson, NetMusicSource.QI);
                JSONArray artistArray = albumJson.optJSONArray("artist");
                String artistId = artistArray != null && !artistArray.isEmpty() ? artistArray.getJSONObject(0).getString("artistCode") : "";
                String coverImgThumbUrl = albumJson.getString("pic");
                String releaseDate = albumJson.optString("releaseDate");
                if (StringUtil.isEmpty(releaseDate)) releaseDate = albumJson.getString("pushTime");
                String publishTime = releaseDate.split("T")[0];
                Integer songNum = albumJson.getJSONArray("trackList").size();

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.QI);
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(albumInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 秀动发行
        Callable<CommonResult<NetAlbumInfo>> getXDAlbumsQi = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            String albumInfoBody = HttpRequest.get(buildQianUrl(String.format(XD_ALBUM_QI_API, page, limit, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.optJSONObject("data");
            t = data.optInt("total");
            JSONArray albumArray = data.getJSONArray("result");
            for (int i = 0, len = albumArray.size(); i < len; i++) {
                JSONObject albumJson = albumArray.getJSONObject(i);

                String albumId = albumJson.getString("albumAssetCode");
                String albumName = albumJson.getString("title");
                String artist = parseArtists(albumJson, NetMusicSource.QI);
                JSONArray artistArray = albumJson.optJSONArray("artist");
                String artistId = artistArray != null && !artistArray.isEmpty() ? artistArray.getJSONObject(0).getString("artistCode") : "";
                String coverImgThumbUrl = albumJson.getString("pic");
                String publishTime = albumJson.getString("releaseDate").split("T")[0];
                Integer songNum = albumJson.getInt("trackCount");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.QI);
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(albumInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 新专辑推荐
        Callable<CommonResult<NetAlbumInfo>> getNewAlbumsQi = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            String albumInfoBody = HttpRequest.get(buildQianUrl(String.format(NEW_ALBUM_QI_API, page, limit, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");
            t = data.optInt("total");
            JSONArray albumArray = data.getJSONArray("result");
            for (int i = 0, len = albumArray.size(); i < len; i++) {
                JSONObject albumJson = albumArray.getJSONObject(i);

                String albumId = albumJson.getString("albumAssetCode");
                String albumName = albumJson.getString("title");
                String artist = parseArtists(albumJson, NetMusicSource.QI);
                JSONArray artistArray = albumJson.optJSONArray("artist");
                String artistId = artistArray != null && !artistArray.isEmpty() ? artistArray.getJSONObject(0).getString("artistCode") : "";
                String coverImgThumbUrl = albumJson.getString("pic");
                String publishTime = albumJson.getString("releaseDate").split("T")[0];
                Integer songNum = albumJson.getInt("trackCount");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.QI);
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(albumInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 堆糖
        // 推荐专辑
        Callable<CommonResult<NetAlbumInfo>> getRecAlbumsDt = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            HttpResponse resp = HttpRequest.get(String.format(REC_ALBUM_DT_API, (page - 1) * limit, limit, System.currentTimeMillis())).execute();
            String albumInfoBody = resp.body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray albumArray = data.getJSONArray("object_list");
            for (int i = 0, len = albumArray.size(); i < len; i++) {
                JSONObject mainJson = albumArray.getJSONObject(i);
                JSONObject albumJson = mainJson.getJSONObject("album");

                String albumId = albumJson.getString("id");
                String albumName = albumJson.getString("name");
                String artist = mainJson.getJSONObject("sender").getString("username");
                String artistId = mainJson.getJSONObject("sender").getString("id");
//                String publishTime = TimeUtils.msToDate(mainJson.getLong("add_datetime_ts") * 1000);
                String coverImgThumbUrl = albumJson.getJSONArray("covers").getString(0);
                Integer songNum = albumJson.getInt("count");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.DT);
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
//                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(albumInfo);
            }

            return new CommonResult<>(res, t);
        };
        // 分类专辑
        Callable<CommonResult<NetAlbumInfo>> getCatAlbumsDt = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[5])) {
                HttpResponse resp = HttpRequest.get(String.format(CAT_ALBUM_DT_API, s[5], (page - 1) * limit, limit, System.currentTimeMillis())).execute();
                String albumInfoBody = resp.body();
                JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
                JSONObject data = albumInfoJson.getJSONObject("data");
                t = data.getInt("total");
                JSONArray albumArray = data.getJSONArray("object_list");
                for (int i = 0, len = albumArray.size(); i < len; i++) {
                    JSONObject mainJson = albumArray.getJSONObject(i);
                    JSONObject albumJson = mainJson.getJSONObject("album");

                    String albumId = albumJson.getString("id");
                    String albumName = albumJson.getString("name");
                    String artist = mainJson.getJSONObject("sender").getString("username");
                    String artistId = mainJson.getJSONObject("sender").getString("id");
                    String publishTime = TimeUtil.msToDate(mainJson.getLong("add_datetime_ts") * 1000);
                    String coverImgThumbUrl = albumJson.getJSONArray("covers").getString(0);
                    Integer songNum = albumJson.getInt("count");

                    NetAlbumInfo albumInfo = new NetAlbumInfo();
                    albumInfo.setSource(NetMusicSource.DT);
                    albumInfo.setId(albumId);
                    albumInfo.setName(albumName);
                    albumInfo.setArtist(artist);
                    albumInfo.setArtistId(artistId);
                    albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    albumInfo.setPublishTime(publishTime);
                    albumInfo.setSongNum(songNum);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        albumInfo.setCoverImgThumb(coverImgThumb);
                    });
                    res.add(albumInfo);
                }
            }

            return new CommonResult<>(res, t);
        };

        // 豆瓣
        // Top 250
        Callable<CommonResult<NetAlbumInfo>> getTopAlbumsDb = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;
            final int rn = 25;

            String radioInfoBody = HttpRequest.get(String.format(TOP_ALBUM_DB_API, (page - 1) * rn))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(radioInfoBody);
            Elements as = doc.select("tr.item");
            t -= 250 / rn * 5;
            for (int i = 0, len = as.size(); i < len; i++) {
                Element album = as.get(i);
                Elements a = album.select("div.pl2 a");
                Elements pl = album.select("div.pl2 p.pl");
                Elements img = album.select("td img");

                String albumId = ReUtil.get("/subject/(\\d+)/", a.attr("href"), 1);
                String albumName = a.text().trim();
                String[] sp = pl.text().split(" / ");
                String artist = sp[0];
                String pubTime = sp[1];
                String coverImgThumbUrl = img.attr("src");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.DB);
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setPublishTime(pubTime);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(albumInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 分类专辑
        Callable<CommonResult<NetAlbumInfo>> getCatAlbumsDb = () -> {
            LinkedList<NetAlbumInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[4])) {
                String radioInfoBody = HttpRequest.get(String.format(CAT_ALBUM_DB_API, s[4], (page - 1) * limit))
                        .execute()
                        .body();
                Document doc = Jsoup.parse(radioInfoBody);
                Elements as = doc.select("tr.item");
                Element te = doc.select("div.paginator > a").last();
                String ts = te == null ? "" : te.text();
                t = StringUtil.isNotEmpty(ts) ? Integer.parseInt(ts) * limit : limit;
                for (int i = 0, len = as.size(); i < len; i++) {
                    Element album = as.get(i);
                    Elements a = album.select("div.pl2 a");
                    Elements pl = album.select("div.pl2 p.pl");
                    Elements img = album.select("td img");

                    String albumId = ReUtil.get("/subject/(\\d+)/", a.attr("href"), 1);
                    String albumName = a.text().trim();
                    String[] sp = pl.text().split(" / ");
                    String artist = sp[0];
                    String pubTime = sp[1];
                    String coverImgThumbUrl = img.attr("src");

                    NetAlbumInfo albumInfo = new NetAlbumInfo();
                    albumInfo.setSource(NetMusicSource.DB);
                    albumInfo.setId(albumId);
                    albumInfo.setName(albumName);
                    albumInfo.setArtist(artist);
                    albumInfo.setPublishTime(pubTime);
                    albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        albumInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(albumInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        List<Future<CommonResult<NetAlbumInfo>>> taskList = new LinkedList<>();

        boolean dt = defaultTag.equals(tag);

        if (dt) {
            if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getNewAlbums));
                taskList.add(GlobalExecutors.requestExecutor.submit(getNewestAlbums));
                taskList.add(GlobalExecutors.requestExecutor.submit(getNewestDiAlbums));
                taskList.add(GlobalExecutors.requestExecutor.submit(getAllNewAlbums));
            }

            if (src == NetMusicSource.QQ || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getNewAlbumsQq));
            }

            if (src == NetMusicSource.MG || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getNewAlbumsMg));
                taskList.add(GlobalExecutors.requestExecutor.submit(getNewAlbumsRankingMg));
            }

            if (src == NetMusicSource.QI || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getIndexNewAlbumsQi));
                taskList.add(GlobalExecutors.requestExecutor.submit(getNewAlbumsQi));
                taskList.add(GlobalExecutors.requestExecutor.submit(getXDAlbumsQi));
            }

            if (src == NetMusicSource.DT || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getRecAlbumsDt));
            }

            if (src == NetMusicSource.DB || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getTopAlbumsDb));
            }
        } else {
            if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getNewAlbums));
                taskList.add(GlobalExecutors.requestExecutor.submit(getAllNewAlbums));
                taskList.add(GlobalExecutors.requestExecutor.submit(getLangDiAlbums));
                taskList.add(GlobalExecutors.requestExecutor.submit(getStyleAlbums));
            }

            if (src == NetMusicSource.QQ || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getNewAlbumsQq));
            }

            if (src == NetMusicSource.DT || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getCatAlbumsDt));
            }

            if (src == NetMusicSource.DB || src == NetMusicSource.ALL) {
                taskList.add(GlobalExecutors.requestExecutor.submit(getCatAlbumsDb));
            }
        }
//        taskList.add(GlobalExecutors.requestExecutor.submit(getHotAlbums));

        List<List<NetAlbumInfo>> rl = new LinkedList<>();
        taskList.forEach(task -> {
            try {
                CommonResult<NetAlbumInfo> result = task.get();
                rl.add(result.data);
                total.set(Math.max(total.get(), result.total));
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
        albumInfos.addAll(ListUtil.joinAll(rl));

        return new CommonResult<>(albumInfos, total.get());
    }

    /**
     * 获取 MV 排行 + 最新 MV + 推荐 MV
     */
    public static CommonResult<NetMvInfo> getRecommendMvs(int src, String tag, int limit, int page) {
        AtomicInteger total = new AtomicInteger();
        List<NetMvInfo> mvInfos = new LinkedList<>();

        final String defaultTag = "默认";
        String[] s = Tags.mvTag.get(tag);

        // 网易云(程序分页)
        // MV 排行
        Callable<CommonResult<NetMvInfo>> getMvRanking = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[0])) {
                String mvInfoBody = HttpRequest.get(String.format(TOP_MV_API, s[0].replace("全部", ""), (page - 1) * limit, limit))
                        .execute()
                        .body();
                JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
                JSONArray mvArray = mvInfoJson.getJSONArray("data");
                t = mvArray.size();
                for (int i = 0, len = mvArray.size(); i < len; i++) {
                    JSONObject mvJson = mvArray.getJSONObject(i);

                    String mvId = mvJson.getString("id");
                    String mvName = mvJson.getString("name").trim();
                    String artistName = parseArtists(mvJson, NetMusicSource.NET_CLOUD);
                    String creatorId = mvJson.getJSONArray("artists").getJSONObject(0).getString("id");
                    Long playCount = mvJson.getLong("playCount");
                    Double duration = mvJson.getJSONObject("mv").getJSONArray("videos").getJSONObject(0).getDouble("duration") / 1000;
                    String pubTime = mvJson.getJSONObject("mv").getString("publishTime");
                    String coverImgUrl = mvJson.getString("cover");

                    NetMvInfo mvInfo = new NetMvInfo();
                    mvInfo.setId(mvId);
                    mvInfo.setName(mvName);
                    mvInfo.setArtist(artistName);
                    mvInfo.setCreatorId(creatorId);
                    mvInfo.setPlayCount(playCount);
                    mvInfo.setDuration(duration);
                    mvInfo.setPubTime(pubTime);
                    mvInfo.setCoverImgUrl(coverImgUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                        mvInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(mvInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 最新 MV
        Callable<CommonResult<NetMvInfo>> getNewMv = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[0])) {
                String mvInfoBody = HttpRequest.get(String.format(NEW_MV_API, s[0]))
                        .execute()
                        .body();
                JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
                JSONArray mvArray = mvInfoJson.getJSONArray("data");
                t = mvArray.size();
                for (int i = (page - 1) * limit, len = Math.min(mvArray.size(), page * limit); i < len; i++) {
                    JSONObject mvJson = mvArray.getJSONObject(i);
                    String mvId = mvJson.getString("id");
                    String mvName = mvJson.getString("name").trim();
                    String artistName = parseArtists(mvJson, NetMusicSource.NET_CLOUD);
                    String creatorId = mvJson.getJSONArray("artists").getJSONObject(0).getString("id");
                    Long playCount = mvJson.getLong("playCount");
                    String coverImgUrl = mvJson.getString("cover");

                    NetMvInfo mvInfo = new NetMvInfo();
                    mvInfo.setId(mvId);
                    mvInfo.setName(mvName);
                    mvInfo.setArtist(artistName);
                    mvInfo.setCreatorId(creatorId);
                    mvInfo.setPlayCount(playCount);
                    mvInfo.setCoverImgUrl(coverImgUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                        mvInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(mvInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 全部 MV
        Callable<CommonResult<NetMvInfo>> getAllMv = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[0]) || StringUtil.isNotEmpty(s[1])) {
                String mvInfoBody = HttpRequest.get(String.format(ALL_MV_API, s[0], s[1], (page - 1) * limit, limit))
                        .execute()
                        .body();
                JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
                JSONArray mvArray = mvInfoJson.getJSONArray("data");
                t = mvArray.size();
                for (int i = 0, len = mvArray.size(); i < len; i++) {
                    JSONObject mvJson = mvArray.getJSONObject(i);
                    String mvId = mvJson.getString("id");
                    String mvName = mvJson.getString("name").trim();
                    String artistName = parseArtists(mvJson, NetMusicSource.NET_CLOUD);
                    String creatorId = mvJson.getJSONArray("artists").getJSONObject(0).getString("id");
                    Long playCount = mvJson.getLong("playCount");
                    Double duration = mvJson.getDouble("duration") / 1000;
                    String coverImgUrl = mvJson.getString("cover");

                    NetMvInfo mvInfo = new NetMvInfo();
                    mvInfo.setId(mvId);
                    mvInfo.setName(mvName);
                    mvInfo.setArtist(artistName);
                    mvInfo.setCreatorId(creatorId);
                    mvInfo.setPlayCount(playCount);
                    mvInfo.setDuration(duration);
                    mvInfo.setCoverImgUrl(coverImgUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                        mvInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(mvInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 推荐 MV
        Callable<CommonResult<NetMvInfo>> getRecommendMv = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            String mvInfoBody = HttpRequest.get(RECOMMEND_MV_API)
                    .execute()
                    .body();
            JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
            JSONArray mvArray = mvInfoJson.getJSONArray("result");
            t = mvArray.size();
            for (int i = (page - 1) * limit, len = Math.min(mvArray.size(), page * limit); i < len; i++) {
                JSONObject mvJson = mvArray.getJSONObject(i);
                String mvId = mvJson.getString("id");
                String mvName = mvJson.getString("name").trim();
                String artistName = parseArtists(mvJson, NetMusicSource.NET_CLOUD);
                String creatorId = mvJson.getJSONArray("artists").getJSONObject(0).getString("id");
                Long playCount = mvJson.getLong("playCount");
                Double duration = mvJson.getDouble("duration") / 1000;
                String coverImgUrl = mvJson.getString("picUrl");

                NetMvInfo mvInfo = new NetMvInfo();
                mvInfo.setId(mvId);
                mvInfo.setName(mvName);
                mvInfo.setArtist(artistName);
                mvInfo.setCreatorId(creatorId);
                mvInfo.setPlayCount(playCount);
                mvInfo.setDuration(duration);
                mvInfo.setCoverImgUrl(coverImgUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                    mvInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(mvInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 网易出品 MV
        Callable<CommonResult<NetMvInfo>> getExclusiveMv = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            String mvInfoBody = HttpRequest.get(String.format(EXCLUSIVE_MV_API, (page - 1) * limit, limit))
                    .execute()
                    .body();
            JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
            JSONArray mvArray = mvInfoJson.getJSONArray("data");
            t = mvArray.size();
            for (int i = 0, len = mvArray.size(); i < len; i++) {
                JSONObject mvJson = mvArray.getJSONObject(i);
                String mvId = mvJson.getString("id");
                String mvName = mvJson.getString("name").trim();
                String artistName = parseArtists(mvJson, NetMusicSource.NET_CLOUD);
                String creatorId = mvJson.getJSONArray("artists").getJSONObject(0).getString("id");
                Long playCount = mvJson.getLong("playCount");
//                Double duration = mvJson.getJSONObject("mv").getJSONArray("videos").getJSONObject(0).getDouble("duration") / 1000;
                String coverImgUrl = mvJson.getString("cover");

                NetMvInfo mvInfo = new NetMvInfo();
                mvInfo.setId(mvId);
                mvInfo.setName(mvName);
                mvInfo.setArtist(artistName);
                mvInfo.setCreatorId(creatorId);
                mvInfo.setPlayCount(playCount);
//                mvInfo.setDuration(duration);
                mvInfo.setCoverImgUrl(coverImgUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                    mvInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(mvInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 酷狗(接口分页)
        Callable<CommonResult<NetMvInfo>> getRecommendMvKg = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[2])) {
                String mvInfoBody = HttpRequest.get(String.format(RECOMMEND_MV_KG_API, s[2], page, limit))
                        .execute()
                        .body();
                JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
                JSONObject data = mvInfoJson.getJSONObject("data");
                t = data.getInt("total");
                JSONArray mvArray = data.getJSONArray("info");
                for (int i = 0, len = mvArray.size(); i < len; i++) {
                    JSONObject mvJson = mvArray.getJSONObject(i);

                    String mvId = mvJson.getString("mvhash");
                    String mvName = mvJson.getString("videoname");
                    String artistName = mvJson.getString("singername");
                    JSONArray artistArray = mvJson.optJSONArray("authors");
                    String creatorId = artistArray != null && !artistArray.isEmpty() ? artistArray.getJSONObject(0).getString("singerid") : "";
                    Long playCount = mvJson.getLong("playcount");
                    Double duration = mvJson.getDouble("duration") / 1000;
                    String pubTime = mvJson.getString("publish").split(" ")[0];
                    String coverImgUrl = mvJson.getString("img").replace("/{size}", "");

                    NetMvInfo mvInfo = new NetMvInfo();
                    mvInfo.setSource(NetMusicSource.KG);
                    mvInfo.setId(mvId);
                    mvInfo.setName(mvName);
                    mvInfo.setArtist(artistName);
                    mvInfo.setCreatorId(creatorId);
                    mvInfo.setPlayCount(playCount);
                    mvInfo.setDuration(duration);
                    mvInfo.setPubTime(pubTime);
                    mvInfo.setCoverImgUrl(coverImgUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                        mvInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(mvInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // QQ
        // 推荐 MV (接口分页)
        Callable<CommonResult<NetMvInfo>> getRecommendMvQq = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[3])) {
                String mvInfoBody = HttpRequest.get(String.format(RECOMMEND_MV_QQ_API, s[3], s[4], page, limit))
                        .execute()
                        .body();
                JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
                JSONObject data = mvInfoJson.getJSONObject("data");
                t = data.getInt("total");
                JSONArray mvArray = data.getJSONArray("list");
                for (int i = 0, len = mvArray.size(); i < len; i++) {
                    JSONObject mvJson = mvArray.getJSONObject(i);

                    String mvId = mvJson.getString("vid");
                    String mvName = mvJson.getString("title").trim();
                    String artistName = parseArtists(mvJson, NetMusicSource.QQ);
                    String creatorId = mvJson.getJSONArray("singers").getJSONObject(0).getString("mid");
                    Long playCount = mvJson.getLong("playcnt");
                    Double duration = mvJson.getDouble("duration");
                    String pubTime = TimeUtil.msToDate(mvJson.getLong("pubdate") * 1000);
                    String coverImgUrl = mvJson.getString("picurl");

                    NetMvInfo mvInfo = new NetMvInfo();
                    mvInfo.setSource(NetMusicSource.QQ);
                    mvInfo.setId(mvId);
                    mvInfo.setName(mvName);
                    mvInfo.setArtist(artistName);
                    mvInfo.setCreatorId(creatorId);
                    mvInfo.setPlayCount(playCount);
                    mvInfo.setDuration(duration);
                    mvInfo.setPubTime(pubTime);
                    mvInfo.setCoverImgUrl(coverImgUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                        mvInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(mvInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 最新 MV (程序分页)
        Callable<CommonResult<NetMvInfo>> getNewMvQq = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[5])) {
                String mvInfoBody = HttpRequest.get(String.format(NEW_MV_QQ_API, s[5]))
                        .execute()
                        .body();
                JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
                JSONArray mvArray = mvInfoJson.getJSONObject("data").getJSONArray("list");
                t = mvArray.size();
                for (int i = (page - 1) * limit, len = Math.min(mvArray.size(), page * limit); i < len; i++) {
                    JSONObject mvJson = mvArray.getJSONObject(i);

                    String mvId = mvJson.getString("vid");
                    String mvName = mvJson.getString("mvtitle").trim();
                    String artistName = parseArtists(mvJson, NetMusicSource.QQ);
                    String creatorId = mvJson.getJSONArray("singers").getJSONObject(0).getString("mid");
                    Long playCount = mvJson.getLong("listennum");
                    String pubTime = mvJson.getString("pub_date");
                    String coverImgUrl = mvJson.getString("picurl");

                    NetMvInfo mvInfo = new NetMvInfo();
                    mvInfo.setSource(NetMusicSource.QQ);
                    mvInfo.setId(mvId);
                    mvInfo.setName(mvName);
                    mvInfo.setArtist(artistName);
                    mvInfo.setCreatorId(creatorId);
                    mvInfo.setPlayCount(playCount);
                    mvInfo.setPubTime(pubTime);
                    mvInfo.setCoverImgUrl(coverImgUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                        mvInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(mvInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 酷我
        Callable<CommonResult<NetMvInfo>> getRecommendMvKw = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[6])) {
                HttpResponse resp = kwRequest(String.format(RECOMMEND_MV_KW_API, s[6], page, limit)).execute();
                if (resp.getStatus() == HttpStatus.HTTP_OK) {
                    String mvInfoBody = resp.body();
                    JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
                    JSONObject data = mvInfoJson.getJSONObject("data");
                    t = data.getInt("total");
                    JSONArray mvArray = data.getJSONArray("mvlist");
                    for (int i = 0, len = mvArray.size(); i < len; i++) {
                        JSONObject mvJson = mvArray.getJSONObject(i);

                        String mvId = mvJson.getString("id");
                        String mvName = mvJson.getString("name");
                        String artistName = mvJson.getString("artist");
                        String creatorId = mvJson.getString("artistid");
                        Long playCount = mvJson.getLong("mvPlayCnt");
                        Double duration = mvJson.getDouble("duration");
                        String coverImgUrl = mvJson.getString("pic");

                        NetMvInfo mvInfo = new NetMvInfo();
                        mvInfo.setSource(NetMusicSource.KW);
                        mvInfo.setId(mvId);
                        mvInfo.setName(mvName);
                        mvInfo.setArtist(artistName);
                        mvInfo.setCreatorId(creatorId);
                        mvInfo.setPlayCount(playCount);
                        mvInfo.setDuration(duration);
                        mvInfo.setCoverImgUrl(coverImgUrl);
                        GlobalExecutors.imageExecutor.execute(() -> {
                            BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                            mvInfo.setCoverImgThumb(coverImgThumb);
                        });

                        res.add(mvInfo);
                    }
                }
            }
            return new CommonResult<>(res, t);
        };

        // 千千
        // 推荐 MV
        Callable<CommonResult<NetMvInfo>> getRecommendMvQi = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            String mvInfoBody = HttpRequest.get(buildQianUrl(String.format(RECOMMEND_MV_QI_API, page, limit, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
            JSONObject data = mvInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray mvArray = data.getJSONArray("result");
            for (int i = 0, len = mvArray.size(); i < len; i++) {
                JSONObject mvJson = mvArray.getJSONObject(i);

                String mvId = mvJson.getString("assetCode");
                String mvName = mvJson.getString("title").trim();
                String artistName = parseArtists(mvJson, NetMusicSource.QI);
                String creatorId = mvJson.getJSONArray("artist").getJSONObject(0).getString("artistCode");
                Long playCount = mvJson.getLong("playnum");
                String coverImgUrl = mvJson.getString("pic");
                Double duration = mvJson.getDouble("duration") / 1000;
                String pubTime = mvJson.getString("originalReleaseDate").split("T")[0];

                NetMvInfo mvInfo = new NetMvInfo();
                mvInfo.setSource(NetMusicSource.QI);
                mvInfo.setId(mvId);
                mvInfo.setName(mvName);
                mvInfo.setArtist(artistName);
                mvInfo.setCreatorId(creatorId);
                mvInfo.setPlayCount(playCount);
                mvInfo.setDuration(duration);
                mvInfo.setPubTime(pubTime);
                mvInfo.setCoverImgUrl(coverImgUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                    mvInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(mvInfo);
            }
            return new CommonResult<>(res, t);
        };

        // 好看
        // 猜你喜欢视频
        Callable<CommonResult<NetMvInfo>> getGuessVideoHk = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            String mvInfoBody = HttpRequest.get(String.format(GUESS_VIDEO_HK_API, System.currentTimeMillis()))
                    .execute()
                    .body();
            JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
            JSONObject data = mvInfoJson.getJSONObject("data");
            JSONArray mvArray = data.getJSONArray("apiData");
            t = mvArray.size();
            for (int i = 0, len = mvArray.size(); i < len; i++) {
                JSONObject mvJson = mvArray.getJSONObject(i);

                String mvId = mvJson.getString("id");
                String mvName = mvJson.getString("title");
                String artistName = mvJson.getString("author");
//                String creatorId = mvJson.getString("author_id");
                Long playCount = StringUtil.parseNumber(mvJson.getString("fmplaycnt"));
                String coverImgUrl = "https:" + mvJson.getString("poster");
                Double duration = TimeUtil.toSeconds(mvJson.getString("time_length"));
                String pubTime = TimeUtil.msToDate(mvJson.getLong("publish_time") * 1000);

                NetMvInfo mvInfo = new NetMvInfo();
                mvInfo.setSource(NetMusicSource.HK);
                mvInfo.setId(mvId);
                mvInfo.setName(mvName);
                mvInfo.setArtist(artistName);
//                mvInfo.setCreatorId(creatorId);
                mvInfo.setPlayCount(playCount);
                mvInfo.setDuration(duration);
                mvInfo.setPubTime(pubTime);
                mvInfo.setCoverImgUrl(coverImgUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                    mvInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(mvInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 榜单视频
        Callable<CommonResult<NetMvInfo>> getTopVideoHk = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            String mvInfoBody = HttpRequest.get(String.format(TOP_VIDEO_HK_API, page, limit))
                    .execute()
                    .body();
            JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
            JSONObject data = mvInfoJson.getJSONObject("apiData").getJSONObject("response");
            t = data.getInt("total_page") * limit;
            JSONArray mvArray = data.getJSONArray("video");
            for (int i = 0, len = mvArray.size(); i < len; i++) {
                JSONObject mvJson = mvArray.getJSONObject(i);

                String mvId = mvJson.getString("vid");
                String mvName = mvJson.getString("title");
                String artistName = mvJson.getString("author");
                String creatorId = mvJson.getString("third_id");
                Long playCount = mvJson.getLong("hot");
                String coverImgUrl = mvJson.getString("poster");
                Double duration = mvJson.getDouble("duration");
                String pubTime = mvJson.getString("publish_time").replaceAll("[发布时间：日]", "").replaceAll("年|月", "-");

                NetMvInfo mvInfo = new NetMvInfo();
                mvInfo.setSource(NetMusicSource.HK);
                mvInfo.setId(mvId);
                mvInfo.setName(mvName);
                mvInfo.setArtist(artistName);
                mvInfo.setCreatorId(creatorId);
                mvInfo.setPlayCount(playCount);
                mvInfo.setDuration(duration);
                mvInfo.setPubTime(pubTime);
                mvInfo.setCoverImgUrl(coverImgUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                    mvInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(mvInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 分类推荐视频
        Callable<CommonResult<NetMvInfo>> getRecommendVideoHk = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[7])) {
                String mvInfoBody = HttpRequest.get(String.format(RECOMMEND_VIDEO_HK_API, s[7], limit))
                        .header(Header.COOKIE, HK_COOKIE)
                        .execute()
                        .body();
                JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
                JSONObject data = mvInfoJson.getJSONObject("data").getJSONObject("response");
                JSONArray mvArray = data.getJSONArray("videos");
                t = limit;
                for (int i = 0, len = mvArray.size(); i < len; i++) {
                    JSONObject mvJson = mvArray.getJSONObject(i);

                    String mvId = mvJson.getString("id");
                    String mvName = mvJson.getString("title");
                    String artistName = mvJson.getString("source_name");
                    String creatorId = mvJson.getString("third_id");
                    Long playCount = mvJson.getLong("playcnt");
                    String coverImgUrl = mvJson.getString("poster_pc");
                    Double duration = TimeUtil.toSeconds(mvJson.getString("duration"));
                    String pubTime = mvJson.getString("publish_time").replaceAll("年|月", "-").replace("日", "");

                    NetMvInfo mvInfo = new NetMvInfo();
                    mvInfo.setSource(NetMusicSource.HK);
                    mvInfo.setId(mvId);
                    mvInfo.setName(mvName);
                    mvInfo.setArtist(artistName);
                    mvInfo.setCreatorId(creatorId);
                    mvInfo.setPlayCount(playCount);
                    mvInfo.setDuration(duration);
                    mvInfo.setPubTime(pubTime);
                    mvInfo.setCoverImgUrl(coverImgUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                        mvInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(mvInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        // 哔哩哔哩
        // 热门视频
        Callable<CommonResult<NetMvInfo>> getHotVideoBi = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            String mvInfoBody = HttpRequest.get(String.format(HOT_VIDEO_BI_API, page, limit))
                    .cookie(BI_COOKIE)
                    .execute()
                    .body();
            JSONObject data = JSONObject.fromObject(mvInfoBody).getJSONObject("data");
            t = data.getBoolean("no_more") ? page * limit : page * limit + 1;
            JSONArray mvArray = data.getJSONArray("list");
            for (int i = 0, len = mvArray.size(); i < len; i++) {
                JSONObject mvJson = mvArray.getJSONObject(i);

                String id = mvJson.getString("cid");
                String bvId = mvJson.getString("bvid");
                String mvName = mvJson.getString("title");
                String artistName = mvJson.getJSONObject("owner").getString("name");
                String creatorId = mvJson.getJSONObject("owner").getString("mid");
                String coverImgUrl = mvJson.getString("pic");
                Long playCount = mvJson.getJSONObject("stat").getLong("view");
                Double duration = mvJson.getDouble("duration");
                String pubTime = TimeUtil.msToDate(mvJson.getLong("pubdate") * 1000);

                NetMvInfo mvInfo = new NetMvInfo();
                mvInfo.setSource(NetMusicSource.BI);
                mvInfo.setId(id);
                mvInfo.setBvid(bvId);
                mvInfo.setName(mvName);
                mvInfo.setArtist(artistName);
                mvInfo.setCreatorId(creatorId);
                mvInfo.setCoverImgUrl(coverImgUrl);
                mvInfo.setPlayCount(playCount);
                mvInfo.setDuration(duration);
                mvInfo.setPubTime(pubTime);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                    mvInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(mvInfo);
            }
            return new CommonResult<>(res, t);
        };
        // 分区排行榜视频
        Callable<CommonResult<NetMvInfo>> getCatRankVideoBi = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[8])) {
                String mvInfoBody = HttpRequest.get(String.format(CAT_RANK_VIDEO_BI_API, s[8]))
                        .cookie(BI_COOKIE)
                        .execute()
                        .body();
                JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
                JSONArray mvArray = mvInfoJson.getJSONArray("data");
                t = mvArray.size();
                for (int i = (page - 1) * limit, len = Math.min(page * limit, mvArray.size()); i < len; i++) {
                    JSONObject mvJson = mvArray.getJSONObject(i);

//                    String id = mvJson.getString("cid");
                    String bvId = mvJson.getString("bvid");
                    String mvName = mvJson.getString("title");
                    String artistName = mvJson.getString("author");
                    String creatorId = mvJson.getString("mid");
                    String coverImgUrl = mvJson.getString("pic");
                    Long playCount = mvJson.getLong("play");
                    Double duration = TimeUtil.toSeconds(mvJson.getString("duration"));
                    String pubTime = mvJson.getString("create").split(" ")[0];

                    NetMvInfo mvInfo = new NetMvInfo();
                    mvInfo.setSource(NetMusicSource.BI);
//                    mvInfo.setId(id);
                    mvInfo.setBvid(bvId);
                    mvInfo.setName(mvName);
                    mvInfo.setArtist(artistName);
                    mvInfo.setCreatorId(creatorId);
                    mvInfo.setCoverImgUrl(coverImgUrl);
                    mvInfo.setPlayCount(playCount);
                    mvInfo.setDuration(duration);
                    mvInfo.setPubTime(pubTime);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                        mvInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(mvInfo);
                }
            }
            return new CommonResult<>(res, t);
        };
        // 分区最新视频
        Callable<CommonResult<NetMvInfo>> getCatNewVideoBi = () -> {
            LinkedList<NetMvInfo> res = new LinkedList<>();
            Integer t = 0;

            if (StringUtil.isNotEmpty(s[8])) {
                String mvInfoBody = HttpRequest.get(String.format(CAT_NEW_VIDEO_BI_API, s[8], page, limit))
                        .cookie(BI_COOKIE)
                        .execute()
                        .body();
                JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
                JSONObject data = mvInfoJson.getJSONObject("data");
                t = data.getJSONObject("page").getInt("count");
                JSONArray mvArray = data.getJSONArray("archives");
                for (int i = 0, len = mvArray.size(); i < len; i++) {
                    JSONObject mvJson = mvArray.getJSONObject(i);

                    String id = mvJson.getString("cid");
                    String bvId = mvJson.getString("bvid");
                    String mvName = mvJson.getString("title");
                    String artistName = mvJson.getJSONObject("owner").getString("name");
                    String creatorId = mvJson.getJSONObject("owner").getString("mid");
                    String coverImgUrl = mvJson.getString("pic");
                    Long playCount = mvJson.getJSONObject("stat").getLong("view");
                    Double duration = mvJson.getDouble("duration");
                    String pubTime = TimeUtil.msToDate(mvJson.getLong("pubdate") * 1000);

                    NetMvInfo mvInfo = new NetMvInfo();
                    mvInfo.setSource(NetMusicSource.BI);
                    mvInfo.setId(id);
                    mvInfo.setBvid(bvId);
                    mvInfo.setName(mvName);
                    mvInfo.setArtist(artistName);
                    mvInfo.setCreatorId(creatorId);
                    mvInfo.setCoverImgUrl(coverImgUrl);
                    mvInfo.setPlayCount(playCount);
                    mvInfo.setDuration(duration);
                    mvInfo.setPubTime(pubTime);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                        mvInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(mvInfo);
                }
            }
            return new CommonResult<>(res, t);
        };

        List<Future<CommonResult<NetMvInfo>>> taskList = new LinkedList<>();

        boolean dt = defaultTag.equals(tag);

        if (src == NetMusicSource.NET_CLOUD || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendMv));
            taskList.add(GlobalExecutors.requestExecutor.submit(getMvRanking));
            taskList.add(GlobalExecutors.requestExecutor.submit(getNewMv));
            taskList.add(GlobalExecutors.requestExecutor.submit(getAllMv));
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getExclusiveMv));
        }

        if (src == NetMusicSource.KG || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendMvKg));
        }

        if (src == NetMusicSource.QQ || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendMvQq));
            taskList.add(GlobalExecutors.requestExecutor.submit(getNewMvQq));
        }

        if (src == NetMusicSource.KW || src == NetMusicSource.ALL) {
            taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendMvKw));
        }

        if (src == NetMusicSource.QI || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendMvQi));
        }

        if (src == NetMusicSource.HK || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getGuessVideoHk));
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getTopVideoHk));
            taskList.add(GlobalExecutors.requestExecutor.submit(getRecommendVideoHk));
        }

        if (src == NetMusicSource.BI || src == NetMusicSource.ALL) {
            if (dt) taskList.add(GlobalExecutors.requestExecutor.submit(getHotVideoBi));
            taskList.add(GlobalExecutors.requestExecutor.submit(getCatRankVideoBi));
            taskList.add(GlobalExecutors.requestExecutor.submit(getCatNewVideoBi));
        }

        List<List<NetMvInfo>> rl = new LinkedList<>();
        taskList.forEach(task -> {
            try {
                CommonResult<NetMvInfo> result = task.get();
                rl.add(result.data);
                total.set(Math.max(total.get(), result.total));
            } catch (InterruptedException e) {
                e.printStackTrace();
            } catch (ExecutionException e) {
                e.printStackTrace();
            }
        });
        mvInfos.addAll(ListUtil.joinAll(rl));

        return new CommonResult<>(mvInfos, total.get());
    }

    /**
     * 根据歌单 id 和 source 预加载歌单信息
     */
    public static void preloadPlaylistInfo(NetPlaylistInfo playlistInfo) {
        // 信息完整直接跳过
        if (playlistInfo.isIntegrated()) return;

        GlobalExecutors.imageExecutor.submit(() -> playlistInfo.setCoverImgThumb(extractProfile(playlistInfo.getCoverImgThumbUrl())));
    }

    /**
     * 根据歌单 id 获取歌单
     */
    public static CommonResult<NetPlaylistInfo> getPlaylistInfo(int source, String id) {
        List<NetPlaylistInfo> res = new LinkedList<>();
        Integer t = 1;

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String playlistInfoBody = HttpRequest.get(String.format(PLAYLIST_DETAIL_API, id))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject playlistJson = playlistInfoJson.optJSONObject("playlist");
            if (playlistJson != null && !playlistJson.isEmpty()) {
                JSONObject ct = playlistJson.optJSONObject("creator");

                String playlistId = playlistJson.getString("id");
                String name = playlistJson.getString("name");
                String creator = ct != null ? ct.getString("nickname") : "";
                String creatorId = ct != null ? ct.getString("userId") : "";
                Integer trackCount = playlistJson.getInt("trackCount");
                Long playCount = playlistJson.getLong("playCount");
                String coverImgThumbUrl = playlistJson.getString("coverImgUrl");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setId(playlistId);
                playlistInfo.setName(name);
                playlistInfo.setCreator(creator);
                playlistInfo.setCreatorId(creatorId);
                playlistInfo.setTrackCount(trackCount);
                playlistInfo.setPlayCount(playCount);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
        }

        // 酷狗
        else if (source == NetMusicSource.KG) {
            HttpResponse resp = HttpRequest.get(String.format(PLAYLIST_DETAIL_KG_API, id,
                            StringUtil.toMD5("NVPh5oo715z5DIWAeQlhMDsWXXQV4hwtappid=1058clienttime=1586163242519clientver=20000dfid=-format=jsonpglobal_specialid="
                                    + id + "mid=1586163242519specialid=0srcappid=2919uuid=1586163242519NVPh5oo715z5DIWAeQlhMDsWXXQV4hwt")))
                    .header("mid", "1586163242519")
                    .header("Referer", "https://m3ws.kugou.com/share/index.php")
                    .header("User-Agent", "Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1")
                    .header("dfid", "-")
                    .header("clienttime", "1586163242519")
                    .execute();
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                String playlistInfoBody = resp.body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                JSONObject playlistJson = playlistInfoJson.optJSONObject("data");
                if (playlistJson != null && !playlistJson.isEmpty()) {
                    String playlistId = playlistJson.getString("specialid");
                    String name = playlistJson.getString("specialname");
                    String creator = playlistJson.getString("nickname");
                    Integer trackCount = playlistJson.getInt("songcount");
                    Long playCount = playlistJson.getLong("playcount");
                    String coverImgThumbUrl = playlistJson.getString("imgurl").replace("/{size}", "");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.KG);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(name);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setTrackCount(trackCount);
                    playlistInfo.setPlayCount(playCount);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(playlistInfo);
                }
            }
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            String playlistInfoBody = HttpRequest.get(String.format(PLAYLIST_DETAIL_QQ_API, id))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject playlistJson = playlistInfoJson.optJSONObject("data");
            if (playlistJson != null && !playlistJson.isEmpty()) {
                String playlistId = playlistJson.getString("disstid");
                String name = playlistJson.getString("dissname");
                String creator = playlistJson.getString("nickname");
                Long playCount = playlistJson.getLong("visitnum");
                Integer trackCount = playlistJson.getInt("songnum");
                String coverImgThumbUrl = playlistJson.getString("logo");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setSource(NetMusicSource.QQ);
                playlistInfo.setId(playlistId);
                playlistInfo.setName(name);
                playlistInfo.setCreator(creator);
                playlistInfo.setTrackCount(trackCount);
                playlistInfo.setPlayCount(playCount);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
        }

        // 酷我
        else if (source == NetMusicSource.KW) {
            String playlistInfoBody = kwRequest(String.format(PLAYLIST_DETAIL_KW_API, id, 1, 1))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject playlistJson = playlistInfoJson.optJSONObject("data");
            if (playlistJson != null && !playlistJson.isEmpty()) {
                String playlistId = playlistJson.getString("id");
                String name = playlistJson.getString("name");
                String creator = playlistJson.getString("userName");
                Long playCount = playlistJson.getLong("listencnt");
                Integer trackCount = playlistJson.getInt("total");
                String coverImgThumbUrl = playlistJson.getString("img");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setSource(NetMusicSource.KW);
                playlistInfo.setId(playlistId);
                playlistInfo.setName(name);
                playlistInfo.setCreator(creator);
                playlistInfo.setTrackCount(trackCount);
                playlistInfo.setPlayCount(playCount);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
        }

        // 咪咕
        else if (source == NetMusicSource.MG) {
            String playlistInfoBody = HttpRequest.get(String.format(PLAYLIST_DETAIL_MG_API, id))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONArray resource = playlistInfoJson.optJSONArray("resource");
            if (resource != null) {
                JSONObject playlistJson = resource.getJSONObject(0);

                String playlistId = playlistJson.getString("musicListId");
                String name = playlistJson.getString("title");
                String creator = playlistJson.getString("ownerName");
                String creatorId = playlistJson.getString("ownerId");
                Long playCount = playlistJson.getJSONObject("opNumItem").getLong("playNum");
                Integer trackCount = playlistJson.getInt("musicNum");
                String coverImgThumbUrl = playlistJson.getJSONObject("imgItem").getString("img");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setSource(NetMusicSource.MG);
                playlistInfo.setId(playlistId);
                playlistInfo.setName(name);
                playlistInfo.setCreator(creator);
                playlistInfo.setCreatorId(creatorId);
                playlistInfo.setTrackCount(trackCount);
                playlistInfo.setPlayCount(playCount);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
        }

        // 千千
        else if (source == NetMusicSource.QI) {
            String playlistInfoBody = HttpRequest.get(buildQianUrl(String.format(PLAYLIST_DETAIL_QI_API, id, 1, 1, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject playlistJson = playlistInfoJson.optJSONObject("data");
            if (playlistJson != null && !playlistJson.isEmpty()) {
                String playlistId = playlistJson.getString("id");
                String name = playlistJson.getString("title");
                Integer trackCount = playlistJson.getInt("trackCount");
                String coverImgThumbUrl = playlistJson.getString("pic");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setSource(NetMusicSource.QI);
                playlistInfo.setId(playlistId);
                playlistInfo.setName(name);
                playlistInfo.setTrackCount(trackCount);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
        }

        // 猫耳
        else if (source == NetMusicSource.ME) {
            String playlistInfoBody = HttpRequest.get(String.format(PLAYLIST_DETAIL_ME_API, id))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject playlistJson = playlistInfoJson.optJSONObject("info");
            if (playlistJson != null && !playlistJson.isEmpty()) {
                JSONObject album = playlistJson.getJSONObject("album");

                String playlistId = album.getString("id");
                String name = album.getString("title");
                String creator = album.getString("username");
                String creatorId = album.getString("user_id");
                Integer trackCount = album.getInt("music_count");
                Long playCount = album.getLong("view_count");
                String coverImgThumbUrl = album.getString("front_cover");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setSource(NetMusicSource.ME);
                playlistInfo.setId(playlistId);
                playlistInfo.setName(name);
                playlistInfo.setCreator(creator);
                playlistInfo.setCreatorId(creatorId);
                playlistInfo.setTrackCount(trackCount);
                playlistInfo.setPlayCount(playCount);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
        }

        // 哔哩哔哩
        else if (source == NetMusicSource.BI) {
            String playlistInfoBody = HttpRequest.get(String.format(PLAYLIST_DETAIL_BI_API, id))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject playlistJson = playlistInfoJson.optJSONObject("data");
            if (playlistJson != null && !playlistJson.isEmpty()) {
                JSONObject stat = playlistJson.getJSONObject("statistic");

                String playlistId = playlistJson.getString("menuId");
                String name = playlistJson.getString("title");
                String creator = playlistJson.getString("uname");
                String creatorId = playlistJson.getString("uid");
                Integer trackCount = playlistJson.optInt("snum", -1);
                Long playCount = stat.getLong("play");
                String coverImgThumbUrl = playlistJson.getString("cover");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setSource(NetMusicSource.BI);
                playlistInfo.setId(playlistId);
                playlistInfo.setName(name);
                playlistInfo.setCreator(creator);
                playlistInfo.setCreatorId(creatorId);
                playlistInfo.setTrackCount(trackCount);
                playlistInfo.setPlayCount(playCount);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 根据歌单 id 补全歌单信息(包括封面图、描述)
     */
    public static void fillPlaylistInfo(NetPlaylistInfo playlistInfo) {
        // 信息完整直接跳过
        if (playlistInfo.isIntegrated()) return;

        int source = playlistInfo.getSource();
        String id = playlistInfo.getId();

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String playlistInfoBody = HttpRequest.get(String.format(PLAYLIST_DETAIL_API, id))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject playlistJson = playlistInfoJson.getJSONObject("playlist");
            JSONObject ct = playlistJson.optJSONObject("creator");

            String coverImgUrl = playlistJson.getString("coverImgUrl");
            String description = playlistJson.getString("description");

            if (!playlistInfo.hasCoverImgUrl()) playlistInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> playlistInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            playlistInfo.setDescription(description.equals("null") ? "" : description);
            if (!playlistInfo.hasCreator())
                playlistInfo.setCreator(ct != null ? ct.getString("nickname") : "");
            if (!playlistInfo.hasCreatorId())
                playlistInfo.setCreatorId(ct != null ? ct.getString("userId") : "");
            if (!playlistInfo.hasTag())
                playlistInfo.setTag(parseTags(playlistJson, NetMusicSource.NET_CLOUD));
            if (!playlistInfo.hasTrackCount())
                playlistInfo.setTrackCount(playlistJson.getInt("trackCount"));
        }

        // 酷狗
        else if (source == NetMusicSource.KG) {
            String playlistInfoBody = HttpRequest.get(String.format(PLAYLIST_DETAIL_KG_API, id,
                            StringUtil.toMD5("NVPh5oo715z5DIWAeQlhMDsWXXQV4hwtappid=1058clienttime=1586163242519clientver=20000dfid=-format=jsonpglobal_specialid="
                                    + id + "mid=1586163242519specialid=0srcappid=2919uuid=1586163242519NVPh5oo715z5DIWAeQlhMDsWXXQV4hwt")))
                    .header("mid", "1586163242519")
                    .header("Referer", "https://m3ws.kugou.com/share/index.php")
                    .header("User-Agent", "Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1")
                    .header("dfid", "-")
                    .header("clienttime", "1586163242519")
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONObject("data");

            String coverImgUrl = data.getString("imgurl").replace("/{size}", "");
            String description = data.getString("intro");

            if (!playlistInfo.hasCoverImgUrl()) playlistInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> playlistInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            playlistInfo.setDescription(description);
            playlistInfo.setTag("");
            if (!playlistInfo.hasTrackCount()) playlistInfo.setTrackCount(data.getInt("songcount"));
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            String playlistInfoBody = HttpRequest.get(String.format(PLAYLIST_DETAIL_QQ_API, id))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONObject("data");

            String coverImgUrl = data.getString("logo");
            String description = data.getString("desc").replace("<br>", "\n");

            if (!playlistInfo.hasCoverImgUrl()) playlistInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> playlistInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            playlistInfo.setDescription(description);
            if (!playlistInfo.hasTag()) playlistInfo.setTag(parseTags(data, NetMusicSource.QQ));
            if (!playlistInfo.hasTrackCount()) playlistInfo.setTrackCount(data.getInt("songnum"));
        }

        // 酷我
        else if (source == NetMusicSource.KW) {
            String playlistInfoBody = kwRequest(String.format(PLAYLIST_DETAIL_KW_API, id, 1, 1))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONObject("data");

            String coverImgUrl = data.getString("img500");
            String description = data.getString("info");

            if (!playlistInfo.hasCoverImgUrl()) playlistInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> playlistInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            playlistInfo.setDescription(description);
            if (!playlistInfo.hasTag()) playlistInfo.setTag(data.getString("tag").replace(",", "、"));
        }

        // 咪咕
        else if (source == NetMusicSource.MG) {
            String playlistInfoBody = HttpRequest.get(String.format(PLAYLIST_DETAIL_MG_API, id))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONArray("resource").getJSONObject(0);

            String coverImgUrl = data.getJSONObject("imgItem").getString("img");
            String description = data.getString("summary");

            if (!playlistInfo.hasCoverImgUrl()) playlistInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> playlistInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            playlistInfo.setDescription(description);
            if (!playlistInfo.hasTag()) playlistInfo.setTag(parseTags(data, NetMusicSource.MG));
        }

        // 千千
        else if (source == NetMusicSource.QI) {
            String playlistInfoBody = HttpRequest.get(buildQianUrl(String.format(PLAYLIST_DETAIL_QI_API, id, 1, 1, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject playlistJson = playlistInfoJson.getJSONObject("data");

            String coverImgUrl = playlistJson.getString("pic");
            String description = playlistJson.getString("desc");

            if (!playlistInfo.hasCoverImgUrl()) playlistInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> playlistInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            playlistInfo.setDescription(description);
            if (!playlistInfo.hasTag()) playlistInfo.setTag(parseTags(playlistJson, NetMusicSource.QI));
            if (!playlistInfo.hasTrackCount()) playlistInfo.setTrackCount(playlistJson.getInt("trackCount"));
        }

        // 猫耳
        else if (source == NetMusicSource.ME) {
            String playlistInfoBody = HttpRequest.get(String.format(PLAYLIST_DETAIL_ME_API, id))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject info = playlistInfoJson.optJSONObject("info");
            if (info == null) return;
            JSONObject album = info.getJSONObject("album");

            String coverImgUrl = album.getString("front_cover");
            String description = StringUtil.removeHTMLLabel(album.getString("intro"));

            if (!playlistInfo.hasCoverImgUrl()) playlistInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> playlistInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            playlistInfo.setDescription(description);
            if (!playlistInfo.hasTag()) playlistInfo.setTag(parseTags(info, NetMusicSource.ME));
            if (!playlistInfo.hasTrackCount()) playlistInfo.setTrackCount(album.getInt("music_count"));
        }

        // 哔哩哔哩
        else if (source == NetMusicSource.BI) {
            String playlistInfoBody = HttpRequest.get(String.format(PLAYLIST_DETAIL_BI_API, id))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONObject("data");

            String coverImgUrl = data.getString("cover");
            String description = data.getString("intro");

            if (!playlistInfo.hasCoverImgUrl()) playlistInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> playlistInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            playlistInfo.setDescription(description);
            playlistInfo.setTag("");
        }
    }

    /**
     * 根据专辑 id 预加载专辑信息
     */
    public static void preloadAlbumInfo(NetAlbumInfo albumInfo) {
        // 信息完整直接跳过
        if (albumInfo.isIntegrated()) return;

        GlobalExecutors.imageExecutor.submit(() -> albumInfo.setCoverImgThumb(extractProfile(albumInfo.getCoverImgThumbUrl())));
    }

    /**
     * 根据专辑 id 获取专辑
     */
    public static CommonResult<NetAlbumInfo> getAlbumInfo(String id, int source) {
        LinkedList<NetAlbumInfo> res = new LinkedList<>();
        Integer t = 1;

        if (!"0".equals(id) && !"null".equals(id) && StringUtil.isNotEmpty(id)) {
            // 网易云
            if (source == NetMusicSource.NET_CLOUD) {
                String albumInfoBody = HttpRequest.get(String.format(ALBUM_DETAIL_API, id))
                        .execute()
                        .body();
                JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
                JSONObject albumJson = albumInfoJson.getJSONObject("album");

                String albumId = albumJson.getString("id");
                String name = albumJson.getString("name");
                String artist = parseArtists(albumJson, NetMusicSource.NET_CLOUD);
                String artistId = albumJson.getJSONArray("artists").getJSONObject(0).getString("id");
                String publishTime = TimeUtil.msToDate(albumJson.getLong("publishTime"));
                String coverImgThumbUrl = albumJson.getString("picUrl");
                Integer songNum = albumJson.getInt("size");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setId(albumId);
                albumInfo.setName(name);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(albumInfo);
            }

            // 酷狗
            else if (source == NetMusicSource.KG) {
                String albumInfoBody = HttpRequest.get(String.format(ALBUM_DETAIL_KG_API, id))
                        .execute()
                        .body();
                JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
                JSONObject albumJson = albumInfoJson.getJSONObject("data");

                String albumId = albumJson.getString("albumid");
                String name = albumJson.getString("albumname");
                String artist = albumJson.getString("singername");
                String artistId = albumJson.getString("singerid");
                String publishTime = albumJson.getString("publishtime").split(" ")[0];
                String coverImgThumbUrl = albumJson.getString("imgurl").replace("/{size}", "");
//                Integer songNum = albumJson.getInt("songcount");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.KG);
                albumInfo.setId(albumId);
                albumInfo.setName(name);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
//                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(albumInfo);
            }

            // QQ
            else if (source == NetMusicSource.QQ) {
                String albumInfoBody = HttpRequest.get(String.format(ALBUM_DETAIL_QQ_API, id))
                        .execute()
                        .body();
                JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
                JSONObject albumJson = albumInfoJson.getJSONObject("data");

                String albumId = albumJson.getString("mid");
                String name = albumJson.getString("albumName");
                String artist = parseArtists(albumJson, NetMusicSource.QQ);
                String artistId = albumJson.getJSONArray("ar").getJSONObject(0).getString("mid");
                String publishTime = albumJson.getString("publishTime");
                String coverImgThumbUrl = String.format(SINGLE_SONG_IMG_QQ_API, albumId);
//                Integer songNum = albumJson.getInt("songcount");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.QQ);
                albumInfo.setId(albumId);
                albumInfo.setName(name);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
//                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(albumInfo);
            }

            // 酷我
            else if (source == NetMusicSource.KW) {
                String albumInfoBody = kwRequest(String.format(ALBUM_DETAIL_KW_API, id, 1, 1))
                        .execute()
                        .body();
                JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
                JSONObject albumJson = albumInfoJson.getJSONObject("data");

                String albumId = albumJson.getString("albumid");
                String name = albumJson.getString("album");
                String artist = albumJson.getString("artist");
                String artistId = albumJson.getString("artistid");
                String publishTime = albumJson.getString("releaseDate");
                String coverImgThumbUrl = albumJson.getString("pic");
                Integer songNum = albumJson.getInt("total");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.KW);
                albumInfo.setId(albumId);
                albumInfo.setName(name);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(albumInfo);
            }

            // 咪咕
            else if (source == NetMusicSource.MG) {
                String albumInfoBody = HttpRequest.get(String.format(ALBUM_DETAIL_MG_API, id))
                        .execute()
                        .body();
                JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
                JSONObject albumJson = albumInfoJson.getJSONObject("data");

                String albumId = albumJson.getString("id");
                String name = albumJson.getString("name");
                String artist = parseArtists(albumJson, NetMusicSource.MG);
                String artistId = albumJson.getJSONArray("artists").getJSONObject(0).getString("id");
                String publishTime = albumJson.getString("publishTime");
                String coverImgThumbUrl = "https:" + albumJson.getString("picUrl");
                Integer songNum = albumJson.getJSONArray("songList").size();

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.MG);
                albumInfo.setId(albumId);
                albumInfo.setName(name);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(albumInfo);
            }

            // 千千
            else if (source == NetMusicSource.QI) {
                String albumInfoBody = HttpRequest.get(buildQianUrl(String.format(ALBUM_DETAIL_QI_API, id, System.currentTimeMillis())))
                        .execute()
                        .body();
                JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
                JSONObject albumJson = albumInfoJson.getJSONObject("data");

                String albumId = albumJson.getString("albumAssetCode");
                String name = albumJson.getString("title");
                String artist = parseArtists(albumJson, NetMusicSource.QI);
                JSONArray artistArray = albumJson.optJSONArray("artist");
                String artistId = artistArray != null && !artistArray.isEmpty() ? artistArray.getJSONObject(0).getString("artistCode") : "";
                String publishTime = albumJson.getString("releaseDate").split("T")[0];
                String coverImgThumbUrl = albumJson.getString("pic");
                Integer songNum = albumJson.getJSONArray("trackList").size();

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.QI);
                albumInfo.setId(albumId);
                albumInfo.setName(name);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(albumInfo);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 根据专辑 id 补全专辑信息(包括封面图、描述)
     */
    public static void fillAlbumInfo(NetAlbumInfo albumInfo) {
        // 信息完整直接跳过
        if (albumInfo.isIntegrated()) return;

        int source = albumInfo.getSource();

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String albumInfoBody = HttpRequest.get(String.format(ALBUM_DETAIL_API, albumInfo.getId()))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject albumJson = albumInfoJson.getJSONObject("album");

            String coverImgUrl = albumJson.getString("picUrl");
            String description = albumJson.getString("description");
            if (!albumInfo.hasSongNum()) albumInfo.setSongNum(albumJson.getInt("size"));
            if (!albumInfo.hasPublishTime())
                albumInfo.setPublishTime(TimeUtil.msToDate(albumJson.getLong("publishTime")));

            if (!albumInfo.hasCoverImgUrl()) albumInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> albumInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            albumInfo.setDescription(description.equals("null") ? "" : description);
        }

        // 酷狗
        else if (source == NetMusicSource.KG) {
            String albumInfoBody = HttpRequest.get(String.format(ALBUM_DETAIL_KG_API, albumInfo.getId()))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");

            String coverImgUrl = data.getString("imgurl").replace("/{size}", "");
            String description = data.getString("intro").replace("\\n", "\n");

            if (!albumInfo.hasCoverImgUrl()) albumInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> albumInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            albumInfo.setDescription(description);
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            String albumInfoBody = HttpRequest.get(String.format(ALBUM_DETAIL_QQ_API, albumInfo.getId()))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");

            // QQ 专辑封面图片 url 获取方式与歌曲相同
            String coverImgUrl = String.format(SINGLE_SONG_IMG_QQ_API, albumInfo.getId());
            String description = data.getString("desc");

            if (!albumInfo.hasCoverImgUrl()) albumInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> albumInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            albumInfo.setDescription(description);
        }

        // 酷我
        else if (source == NetMusicSource.KW) {
            String albumInfoBody = kwRequest(String.format(ALBUM_DETAIL_KW_API, albumInfo.getId(), 1, 1))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.optJSONObject("data");

            if (data != null) {
                String coverImgUrl = data.getString("pic");
                String description = data.getString("albuminfo");
                Integer songNum = data.getInt("total");

                if (!albumInfo.hasCoverImgUrl()) albumInfo.setCoverImgUrl(coverImgUrl);
                GlobalExecutors.imageExecutor.submit(() -> albumInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
                albumInfo.setDescription(description);
                albumInfo.setSongNum(songNum);
            }
        }

        // 咪咕
        else if (source == NetMusicSource.MG) {
            String albumInfoBody = HttpRequest.get(String.format(ALBUM_DETAIL_MG_API, albumInfo.getId()))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");

            String coverImgUrl = "https:" + data.getString("picUrl");
            String description = data.getString("desc");

            if (!albumInfo.hasCoverImgUrl()) albumInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> albumInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            albumInfo.setDescription(description);
        }

        // 千千
        else if (source == NetMusicSource.QI) {
            String albumInfoBody = HttpRequest.get(buildQianUrl(String.format(ALBUM_DETAIL_QI_API, albumInfo.getId(), System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject albumJson = albumInfoJson.getJSONObject("data");

            String coverImgUrl = albumJson.getString("pic");
            String description = albumJson.getString("introduce");
            if (!albumInfo.hasSongNum()) albumInfo.setSongNum(albumJson.getJSONArray("trackList").size());
            if (!albumInfo.hasPublishTime())
                albumInfo.setPublishTime(albumJson.getString("releaseDate").split("T")[0]);

            if (!albumInfo.hasCoverImgUrl()) albumInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> albumInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            albumInfo.setDescription(description);
        }

        // 豆瓣
        else if (source == NetMusicSource.DB) {
            String albumInfoBody = HttpRequest.get(String.format(ALBUM_DETAIL_DB_API, albumInfo.getId()))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(albumInfoBody);
            String info = StringUtil.getPrettyText(doc.select("div#info").first()) + "\n";
            Element re = doc.select("div#link-report").first();
            Elements span = re.select("span");
            String desc = StringUtil.getPrettyText(span.isEmpty() ? re : span.last()) + "\n";
            String tracks = StringUtil.getPrettyText(doc.select("div.track-list div div").first());
            String coverImgUrl = doc.select("div#mainpic img").attr("src");

            albumInfo.setDescription(info + desc + "\n曲目：\n" + tracks);
            if (!albumInfo.hasCoverImgUrl()) albumInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> albumInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
        }

        // 堆糖
        else if (source == NetMusicSource.DT) {
            String albumInfoBody = HttpRequest.get(String.format(ALBUM_DETAIL_DT_API, albumInfo.getId()))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject albumJson = albumInfoJson.getJSONObject("data");

            String coverImgUrl = albumJson.getJSONArray("covers").getString(0);
            String description = albumJson.getString("desc");
            if (!albumInfo.hasSongNum()) albumInfo.setSongNum(albumJson.getInt("count"));
            if (!albumInfo.hasPublishTime())
                albumInfo.setPublishTime(TimeUtil.msToDate(albumJson.getLong("updated_at_ts") * 1000));

            if (!albumInfo.hasCoverImgUrl()) albumInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> albumInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            albumInfo.setDescription(description);
        }
    }

    /**
     * 根据歌手 id 预加载歌手信息
     */
    public static void preloadArtistInfo(NetArtistInfo artistInfo) {
        // 信息完整直接跳过
        if (artistInfo.isIntegrated()) return;

        int source = artistInfo.getSource();

        // 酷我
        if (source == NetMusicSource.KW) {
            GlobalExecutors.imageExecutor.submit(() -> {
                BufferedImage coverImgThumb = extractProfile(artistInfo.getCoverImgThumbUrl());
                if (coverImgThumb == null)
                    coverImgThumb = extractProfile(artistInfo.getCoverImgUrl().replaceFirst("/300/", "/0/"));
                artistInfo.setCoverImgThumb(coverImgThumb);
            });
        } else {
            GlobalExecutors.imageExecutor.submit(() -> artistInfo.setCoverImgThumb(extractProfile(artistInfo.getCoverImgThumbUrl())));
        }
    }

    /**
     * 根据歌手 id 获取歌手
     */
    public static CommonResult<NetArtistInfo> getArtistInfo(String id, int source) {
        LinkedList<NetArtistInfo> res = new LinkedList<>();
        Integer t = 1;

        if (!"0".equals(id) && !"null".equals(id) && StringUtil.isNotEmpty(id)) {
            // 网易云
            if (source == NetMusicSource.NET_CLOUD) {
                String artistInfoBody = HttpRequest.get(String.format(ARTIST_DETAIL_API, id))
                        .execute()
                        .body();
                JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                JSONObject artistJson = artistInfoJson.getJSONObject("artist");

                String artistId = artistJson.getString("id");
                String name = artistJson.getString("name");
                String coverImgThumbUrl = artistJson.getString("img1v1Url");
                Integer songNum = artistJson.getInt("musicSize");
                Integer albumNum = artistJson.getInt("albumSize");
                Integer mvNum = artistJson.getInt("mvSize");

                NetArtistInfo artistInfo = new NetArtistInfo();
                artistInfo.setId(artistId);
                artistInfo.setName(name);
                artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                artistInfo.setSongNum(songNum);
                artistInfo.setAlbumNum(albumNum);
                artistInfo.setMvNum(mvNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    artistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(artistInfo);
            }

            // 酷狗
            else if (source == NetMusicSource.KG) {
                String artistInfoBody = HttpRequest.get(String.format(ARTIST_DETAIL_KG_API, id))
                        .execute()
                        .body();
                JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                JSONObject artistJson = artistInfoJson.getJSONObject("data");

                String artistId = artistJson.getString("singerid");
                String name = artistJson.getString("singername");
                String coverImgThumbUrl = artistJson.getString("imgurl").replace("{size}", "240");
                Integer songNum = artistJson.getInt("songcount");
                Integer albumNum = artistJson.getInt("albumcount");
                Integer mvNum = artistJson.getInt("mvcount");

                NetArtistInfo artistInfo = new NetArtistInfo();
                artistInfo.setSource(NetMusicSource.KG);
                artistInfo.setId(artistId);
                artistInfo.setName(name);
                artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                artistInfo.setSongNum(songNum);
                artistInfo.setAlbumNum(albumNum);
                artistInfo.setMvNum(mvNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    artistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(artistInfo);
            }

            // QQ
            else if (source == NetMusicSource.QQ) {
                String artistInfoBody = HttpRequest.get(String.format(ARTIST_DETAIL_QQ_API, id))
                        .execute()
                        .body();
                JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                JSONObject artistJson = artistInfoJson.getJSONObject("data");

                String name = artistJson.getString("singername");
                String coverImgThumbUrl = String.format(ARTIST_IMG_QQ_API, id);

                NetArtistInfo artistInfo = new NetArtistInfo();
                artistInfo.setSource(NetMusicSource.QQ);
                artistInfo.setId(id);
                artistInfo.setName(name);
                artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    artistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(artistInfo);
            }

            // 酷我
            else if (source == NetMusicSource.KW) {
                String artistInfoBody = kwRequest(String.format(ARTIST_DETAIL_KW_API, id))
                        .execute()
                        .body();
                JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                JSONObject artistJson = artistInfoJson.getJSONObject("data");

                String artistId = artistJson.getString("id");
                String name = artistJson.getString("name");
                String coverImgThumbUrl = artistJson.getString("pic300");
                Integer songNum = artistJson.getInt("musicNum");
                Integer albumNum = artistJson.getInt("albumNum");
                Integer mvNum = artistJson.getInt("mvNum");

                NetArtistInfo artistInfo = new NetArtistInfo();
                artistInfo.setSource(NetMusicSource.KW);
                artistInfo.setId(artistId);
                artistInfo.setName(name);
                artistInfo.setSongNum(songNum);
                artistInfo.setAlbumNum(albumNum);
                artistInfo.setMvNum(mvNum);
                artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    artistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(artistInfo);
            }

            // 咪咕
            else if (source == NetMusicSource.MG) {
                String artistInfoBody = HttpRequest.get(String.format(ARTIST_DETAIL_MG_API, id))
                        .execute()
                        .body();
                JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                JSONObject artistJson = artistInfoJson.getJSONObject("data");

                String artistId = artistJson.getString("id");
                String name = artistJson.getString("name");
                String coverImgThumbUrl = "https:" + artistJson.getString("picUrl");

                NetArtistInfo artistInfo = new NetArtistInfo();
                artistInfo.setSource(NetMusicSource.MG);
                artistInfo.setId(artistId);
                artistInfo.setName(name);
                artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    artistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(artistInfo);
            }

            // 千千
            else if (source == NetMusicSource.QI) {
                String artistInfoBody = HttpRequest.get(buildQianUrl(String.format(ARTIST_DETAIL_QI_API, id, System.currentTimeMillis())))
                        .execute()
                        .body();
                JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                JSONObject artistJson = artistInfoJson.getJSONObject("data");

                String artistId = artistJson.getString("artistCode");
                String name = artistJson.getString("name");
                String coverImgThumbUrl = artistJson.getString("pic");
                Integer songNum = artistJson.getInt("trackTotal");
                Integer albumNum = artistJson.getInt("albumTotal");
                Integer mvNum = artistJson.getInt("videoTotal");

                NetArtistInfo artistInfo = new NetArtistInfo();
                artistInfo.setSource(NetMusicSource.QI);
                artistInfo.setId(artistId);
                artistInfo.setName(name);
                artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                artistInfo.setSongNum(songNum);
                artistInfo.setAlbumNum(albumNum);
                artistInfo.setMvNum(mvNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    artistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(artistInfo);
            }

            // 豆瓣
//            else if (source == NetMusicSource.DB) {
//                String artistInfoBody = HttpRequest.get(String.format(ARTIST_DETAIL_DB_API, id))
//                        .execute()
//                        .body();
//                Document doc = Jsoup.parse(artistInfoBody);
//                Element h1 = doc.select("#content > h1").first();
//                Element img = doc.select(".nbg img").first();
//
//                String name = h1.text();
//                String coverImgThumbUrl = img.attr("src");
//
//                NetArtistInfo artistInfo = new NetArtistInfo();
//                artistInfo.setSource(NetMusicSource.DB);
//                artistInfo.setId(id);
//                artistInfo.setName(name);
//                artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
//                GlobalExecutors.imageExecutor.execute(() -> {
//                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
//                    artistInfo.setCoverImgThumb(coverImgThumb);
//                });
//
//                res.add(artistInfo);
//            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 根据歌手 id 补全歌手信息(包括封面图、描述)
     */
    public static void fillArtistInfo(NetArtistInfo artistInfo) {
        // 信息完整直接跳过
        if (artistInfo.isIntegrated()) return;

        int source = artistInfo.getSource();
        String id = artistInfo.getId();

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String artistInfoBody = HttpRequest.get(String.format(ARTIST_DETAIL_API, id))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject artistJson = artistInfoJson.getJSONObject("artist");

            String coverImgUrl = artistJson.getString("img1v1Url");
            String description = artistJson.getString("briefDesc");

            if (!artistInfo.hasCoverImgUrl()) artistInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> artistInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            artistInfo.setDescription(description.equals("null") ? "" : description);
            if (!artistInfo.hasSongNum()) artistInfo.setSongNum(artistJson.getInt("musicSize"));
            if (!artistInfo.hasMvNum()) artistInfo.setMvNum(artistJson.getInt("mvSize"));
        }

        // 酷狗
        else if (source == NetMusicSource.KG) {
            String artistInfoBody = HttpRequest.get(String.format(ARTIST_DETAIL_KG_API, id))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject data = artistInfoJson.getJSONObject("data");

            String description = data.getString("intro");
            String coverImgUrl = data.getString("imgurl").replace("{size}", "240");

            if (!artistInfo.hasCoverImgUrl()) artistInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> artistInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            artistInfo.setDescription(description);
            if (!artistInfo.hasSongNum()) artistInfo.setSongNum(data.getInt("songcount"));
            if (!artistInfo.hasAlbumNum()) artistInfo.setAlbumNum(data.getInt("albumcount"));
            if (!artistInfo.hasMvNum()) artistInfo.setMvNum(data.getInt("mvcount"));
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            String artistInfoBody = HttpRequest.get(String.format(ARTIST_DETAIL_QQ_API, id))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject data = artistInfoJson.getJSONObject("data");

            String coverImgUrl = String.format(ARTIST_IMG_QQ_API, id);
            String description = data.optString("desc");

            if (!artistInfo.hasCoverImgUrl()) artistInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> artistInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            artistInfo.setDescription(description);
        }

        // 酷我
        else if (source == NetMusicSource.KW) {
            String artistInfoBody = kwRequest(String.format(ARTIST_DETAIL_KW_API, id))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject data = artistInfoJson.getJSONObject("data");

            String description = StringUtil.removeHTMLLabel(data.getString("info"));
            String coverImgUrl = data.getString("pic300");

            if (!artistInfo.hasCoverImgUrl()) artistInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> artistInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            artistInfo.setDescription(description);
            if (!artistInfo.hasSongNum()) artistInfo.setSongNum(data.getInt("musicNum"));
            if (!artistInfo.hasAlbumNum()) artistInfo.setAlbumNum(data.getInt("albumNum"));
            if (!artistInfo.hasMvNum()) artistInfo.setMvNum(data.getInt("mvNum"));
        }

        // 咪咕
        else if (source == NetMusicSource.MG) {
            String artistInfoBody = HttpRequest.get(String.format(ARTIST_DETAIL_MG_API, id))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject data = artistInfoJson.getJSONObject("data");

            String coverImgUrl = "https:" + data.getString("picUrl");
            String description = data.getString("desc");

            if (!artistInfo.hasCoverImgUrl()) artistInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> artistInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            artistInfo.setDescription(description);
        }

        // 千千
        else if (source == NetMusicSource.QI) {
            String artistInfoBody = HttpRequest.get(buildQianUrl(String.format(ARTIST_DETAIL_QI_API, id, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject data = artistInfoJson.getJSONObject("data");

            String description = data.getString("introduce");
            String coverImgUrl = data.getString("pic");

            if (!artistInfo.hasCoverImgUrl()) artistInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> artistInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            artistInfo.setDescription(description);
            if (!artistInfo.hasSongNum()) artistInfo.setSongNum(data.getInt("trackTotal"));
            if (!artistInfo.hasAlbumNum()) artistInfo.setAlbumNum(data.getInt("albumTotal"));
            if (!artistInfo.hasMvNum()) artistInfo.setMvNum(data.getInt("videoTotal"));
        }

        // 猫耳
        else if (source == NetMusicSource.ME) {
            if (artistInfo.isOrganization()) {
                String artistInfoBody = HttpRequest.get(String.format(ORGANIZATION_DETAIL_ME_API, id))
                        .execute()
                        .body();
                JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                JSONObject data = artistInfoJson.getJSONObject("info").getJSONObject("organization");

                String coverImgUrl = data.getString("avatar");
                String intro = StringUtil.removeHTMLLabel(data.getString("intro"));
                String announcement = StringUtil.removeHTMLLabel(data.getString("announcement"));

                if (!artistInfo.hasDescription()) artistInfo.setDescription(intro + "\n\n" + announcement);

                if (!artistInfo.hasCoverImgUrl()) artistInfo.setCoverImgUrl(coverImgUrl);
                GlobalExecutors.imageExecutor.submit(() -> artistInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            } else {
                String artistInfoBody = HttpRequest.get(String.format(CV_DETAIL_ME_API, id, 1, 1))
                        .execute()
                        .body();
                JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
                JSONObject data = artistInfoJson.getJSONObject("info");
                JSONObject cv = data.getJSONObject("cv");
                JSONObject dramas = data.getJSONObject("dramas");

                if (!artistInfo.hasGender()) {
                    Integer gen = cv.getInt("gender");
                    String gender = gen == 1 ? "♂ 男" : gen == 2 ? "♀ 女" : "保密";
                    artistInfo.setGender(gender);
                }
                if (!artistInfo.hasCareer()) {
                    Integer ca = cv.getInt("career");
                    String career = ca == 1 ? "中文 CV" : ca == 0 ? "日文 CV" : "";
                    artistInfo.setCareer(career);
                }
                if (!artistInfo.hasBloodType()) {
                    Integer bt = cv.getInt("bloodtype");
                    String bloodType = bt == 1 ? "A" : bt == 2 ? "B" : bt == 3 ? "O" : "保密";
                    artistInfo.setBloodType(bloodType);
                }
                if (!artistInfo.hasAlias()) artistInfo.setAlias(cv.getString("seiyalias"));
                if (!artistInfo.hasGroup()) artistInfo.setGroup(cv.getString("group"));
                if (!artistInfo.hasBirthday()) {
                    int year = cv.getInt("birthyear"), month = cv.getInt("birthmonth"), day = cv.getInt("birthday");
                    artistInfo.setBirthday(year <= 0 ? month <= 0 ? null : month + "-" + day : year + "-" + month + "-" + day);
                }
                if (!artistInfo.hasDescription()) artistInfo.setDescription(cv.getString("profile"));
                if (!artistInfo.hasSongNum())
                    artistInfo.setSongNum(dramas.getJSONObject("pagination").getInt("count"));

                String coverImgUrl = cv.getString("icon");
                if (!artistInfo.hasCoverImgUrl()) artistInfo.setCoverImgUrl(coverImgUrl);
                GlobalExecutors.imageExecutor.submit(() -> artistInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            }
        }

        // 豆瓣
        else if (source == NetMusicSource.DB) {
            String artistInfoBody = HttpRequest.get(String.format(ARTIST_DETAIL_DB_API, id))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(artistInfoBody);
            String info = StringUtil.getPrettyText(doc.select("#headline div.info").first()) + "\n";
            Element bd = doc.select("#intro div.bd").first();
            Elements span = bd.select("span");
            String desc = StringUtil.getPrettyText(span.isEmpty() ? bd : span.last());
            String coverImgUrl = doc.select("div.nbg img").attr("src");

            artistInfo.setDescription(info + desc);
            if (!artistInfo.hasCoverImgUrl()) artistInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> artistInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
        }
    }

    /**
     * 根据电台 id 预加载电台信息
     */
    public static void preloadRadioInfo(NetRadioInfo radioInfo) {
        // 信息完整直接跳过
        if (radioInfo.isIntegrated()) return;

        GlobalExecutors.imageExecutor.submit(() -> radioInfo.setCoverImgThumb(extractProfile(radioInfo.getCoverImgThumbUrl())));
    }

    /**
     * 根据电台 id 获取电台
     */
    public static CommonResult<NetRadioInfo> getRadioInfo(String id, int source) {
        LinkedList<NetRadioInfo> res = new LinkedList<>();
        Integer t = 1;

        if (!"0".equals(id) && !"null".equals(id) && StringUtil.isNotEmpty(id)) {
            // 网易云
            if (source == NetMusicSource.NET_CLOUD) {
                String radioInfoBody = HttpRequest.get(String.format(RADIO_DETAIL_API, id))
                        .execute()
                        .body();
                JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
                JSONObject radioJson = radioInfoJson.getJSONObject("data");

                String radioId = radioJson.getString("id");
                String radioName = radioJson.getString("name");
                String dj = radioJson.getJSONObject("dj").getString("nickname");
                String djId = radioJson.getJSONObject("dj").getString("userId");
//                Long playCount = radioJson.getLong("playCount");
                Integer trackCount = radioJson.getInt("programCount");
                String category = radioJson.getString("category");
                if (!category.isEmpty()) category += "、" + radioJson.getString("secondCategory");
                String coverImgThumbUrl = radioJson.getString("picUrl");

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                radioInfo.setDj(dj);
                radioInfo.setDjId(djId);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
//                radioInfo.setPlayCount(playCount);
                radioInfo.setTrackCount(trackCount);
                radioInfo.setCategory(category);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }

            // 喜马拉雅
            else if (source == NetMusicSource.XM) {
                String radioInfoBody = HttpRequest.get(String.format(RADIO_DETAIL_XM_API, id))
                        .execute()
                        .body();
                JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
                JSONObject data = radioInfoJson.getJSONObject("data");
                JSONObject radioJson = data.getJSONObject("albumPageMainInfo");

                String radioId = data.getString("albumId");
                String radioName = radioJson.getString("albumTitle");
//                String dj = radioJson.getString("nickname");
                String djId = radioJson.getString("anchorUid");
                Long playCount = radioJson.getLong("playCount");
//                Integer trackCount = radioJson.getInt("programCount");
                String coverImgThumbUrl = "https:" + radioJson.getString("cover");

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setSource(NetMusicSource.XM);
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
//                radioInfo.setDj(dj);
                radioInfo.setDjId(djId);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                radioInfo.setPlayCount(playCount);
//                radioInfo.setTrackCount(trackCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }

            // 猫耳
            else if (source == NetMusicSource.ME) {
                String radioInfoBody = HttpRequest.get(String.format(RADIO_DETAIL_ME_API, id))
                        .execute()
                        .body();
                JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
                JSONObject info = radioInfoJson.getJSONObject("info");
                JSONObject drama = info.getJSONObject("drama");
                JSONObject episodes = info.getJSONObject("episodes");

                String radioId = drama.getString("id");
                String radioName = drama.getString("name");
                String dj = drama.getString("author");
                String djId = drama.getString("user_id");
                Long playCount = drama.getLong("view_count");
                // 猫耳的电台可能有多种类型！
                int episodeSize = episodes.getJSONArray("episode").size();
                int ftSize = episodes.getJSONArray("ft").size();
                int musicSize = episodes.getJSONArray("music").size();
                Integer trackCount = episodeSize + ftSize + musicSize;
                String category = drama.getString("catalog_name");
                String coverImgThumbUrl = drama.getString("cover");

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setSource(NetMusicSource.ME);
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                if (!"null".equals(dj)) radioInfo.setDj(dj);
                radioInfo.setDjId(djId);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                radioInfo.setPlayCount(playCount);
                radioInfo.setTrackCount(trackCount);
                radioInfo.setCategory(category);

                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 根据电台 id 补全电台信息(包括封面图、描述)
     */
    public static void fillRadioInfo(NetRadioInfo radioInfo) {
        // 信息完整直接跳过
        if (radioInfo.isIntegrated()) return;

        int source = radioInfo.getSource();
        String id = radioInfo.getId();
        boolean isBook = radioInfo.isBook();
        boolean isGame = radioInfo.isGame();

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String radioInfoBody = HttpRequest.get(String.format(RADIO_DETAIL_API, id))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONObject radioJson = radioInfoJson.getJSONObject("data");

            String coverImgUrl = radioJson.getString("picUrl");
            String description = radioJson.getString("desc");

            if (!radioInfo.hasCoverImgUrl()) radioInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> radioInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            radioInfo.setDescription(description.equals("null") ? "" : description);
            if (!radioInfo.hasDj()) radioInfo.setDj(radioJson.getJSONObject("dj").getString("nickname"));
            if (!radioInfo.hasDjId()) radioInfo.setDjId(radioJson.getJSONObject("dj").getString("userId"));
            String category = radioJson.getString("category");
            if (!category.isEmpty()) category += "、" + radioJson.getString("secondCategory");
            if (!radioInfo.hasCategory()) radioInfo.setCategory(category);
            if (!radioInfo.hasTag()) radioInfo.setTag(category);
            if (!radioInfo.hasTrackCount()) radioInfo.setTrackCount(radioJson.getInt("programCount"));
            if (!radioInfo.hasPlayCount()) radioInfo.setPlayCount(radioJson.getLong("playCount"));
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            GlobalExecutors.imageExecutor.submit(() -> radioInfo.setCoverImg(getImageFromUrl(radioInfo.getCoverImgUrl())));
            radioInfo.setDescription("");
        }

        // 喜马拉雅
        else if (source == NetMusicSource.XM) {
            if (!radioInfo.hasTrackCount()) {
                GlobalExecutors.requestExecutor.submit(() -> {
                    String radioInfoBody = HttpRequest.get(String.format(BRIEF_RADIO_DETAIL_XM_API, id))
                            .execute()
                            .body();
                    JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
                    JSONObject radioJson = radioInfoJson.getJSONObject("data");

                    radioInfo.setTrackCount(radioJson.getInt("trackCount"));
                });
            }
            String radioInfoBody = HttpRequest.get(String.format(RADIO_DETAIL_XM_API, id))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONObject radioJson = radioInfoJson.getJSONObject("data").getJSONObject("albumPageMainInfo");

            String coverImgUrl = "https:" + radioJson.getString("cover");
            String tag = parseTags(radioJson, NetMusicSource.XM);
            String description = radioJson.getString("shortIntro");

            if (!radioInfo.hasCoverImgUrl()) radioInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> radioInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            if (!radioInfo.hasTag()) radioInfo.setTag(tag);
            if (!radioInfo.hasDescription()) radioInfo.setDescription(description);
        }

        // 猫耳
        else if (source == NetMusicSource.ME) {
            String radioInfoBody = HttpRequest.get(String.format(RADIO_DETAIL_ME_API, id))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONObject info = radioInfoJson.getJSONObject("info");
            JSONObject drama = info.getJSONObject("drama");
            JSONObject episodes = info.getJSONObject("episodes");

            String coverImgUrl = drama.getString("cover");
            String description = drama.getString("abstract");

            if (!radioInfo.hasCoverImgUrl()) radioInfo.setCoverImgUrl(coverImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> radioInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            if (!radioInfo.hasTag()) radioInfo.setTag(parseTags(drama, NetMusicSource.ME));
            if (!radioInfo.hasDescription()) radioInfo.setDescription(StringUtil.removeHTMLLabel(description));
            if (!radioInfo.hasDj()) {
                String dj = drama.getString("author");
                if (!"null".equals(dj)) radioInfo.setDj(dj);
            }
            if (!radioInfo.hasDjId()) radioInfo.setDjId(drama.getString("user_id"));
            if (!radioInfo.hasCategory()) radioInfo.setCategory(drama.getString("catalog_name"));
            if (!radioInfo.hasTrackCount()) {
                // 猫耳的电台可能有多种类型！
                int episodeSize = episodes.getJSONArray("episode").size();
                int ftSize = episodes.getJSONArray("ft").size();
                int musicSize = episodes.getJSONArray("music").size();
                Integer trackCount = episodeSize + ftSize + musicSize;
                radioInfo.setTrackCount(trackCount);
            }
            if (!radioInfo.hasPlayCount()) radioInfo.setPlayCount(drama.getLong("view_count"));
        }

        // 豆瓣
        else if (source == NetMusicSource.DB) {
            if (isBook) {
                String radioInfoBody = HttpRequest.get(String.format(BOOK_RADIO_DETAIL_DB_API, id))
                        .execute()
                        .body();
                Document doc = Jsoup.parse(radioInfoBody);
                String info = StringUtil.getPrettyText(doc.select("div#info").first()) + "\n";
                Elements re = doc.select("div#link-report");
                Elements span = re.select("span");
                Element intro = doc.select("div.intro").last();
                Element cata = doc.select(String.format("div#dir_%s_full", id)).first();
                Element tr = doc.select("div.subject_show.block5:not(#rec-ebook-section) div").first();

                String desc = StringUtil.getPrettyText(span.isEmpty() ? re.first() : span.last()) + "\n";
                String authorIntro = StringUtil.getPrettyText(intro) + "\n";
                String catalog = StringUtil.getPrettyText(cata) + "\n\n";
                String trace = StringUtil.getPrettyText(tr);
                String coverImgUrl = doc.select("div#mainpic img").attr("src");

                radioInfo.setDescription(info + desc + "作者简介：\n" + authorIntro + "目录：\n" + catalog + "丛书信息：\n" + trace);
                if (!radioInfo.hasCoverImgUrl()) radioInfo.setCoverImgUrl(coverImgUrl);
                GlobalExecutors.imageExecutor.submit(() -> radioInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            } else if (isGame) {
                String radioInfoBody = HttpRequest.get(String.format(GAME_RADIO_DETAIL_DB_API, id))
                        .execute()
                        .body();
                Document doc = Jsoup.parse(radioInfoBody);
                String info = StringUtil.getPrettyText(doc.select("dl.game-attr").first()) + "\n";
                Element p = doc.select("div#link-report p").first();

                String desc = StringUtil.getPrettyText(p) + "\n";
                String coverImgUrl = doc.select("div.pic img").attr("src");

                radioInfo.setDescription(info + desc);
                if (!radioInfo.hasCoverImgUrl()) radioInfo.setCoverImgUrl(coverImgUrl);
                GlobalExecutors.imageExecutor.submit(() -> radioInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            } else {
                String radioInfoBody = HttpRequest.get(String.format(RADIO_DETAIL_DB_API, id))
                        .execute()
                        .body();
                Document doc = Jsoup.parse(radioInfoBody);
                String info = StringUtil.getPrettyText(doc.select("div#info").first()) + "\n";
                Elements re = doc.select("div#link-report");
                Elements span = re.select("span");

                String desc = StringUtil.getPrettyText(span.isEmpty() ? re.first() : span.last()) + "\n";
                String coverImgUrl = doc.select("div#mainpic img").attr("src");

                radioInfo.setDescription(info + desc);
                if (!radioInfo.hasCoverImgUrl()) radioInfo.setCoverImgUrl(coverImgUrl);
                GlobalExecutors.imageExecutor.submit(() -> radioInfo.setCoverImg(getImageFromUrl(coverImgUrl)));
            }
        }
    }

    /**
     * 根据 MV id 预加载 MV 信息
     */
    public static void preloadMvInfo(NetMvInfo mvInfo) {
        // 信息完整直接跳过
        if (mvInfo.isIntegrated()) return;

        GlobalExecutors.imageExecutor.submit(() -> mvInfo.setCoverImgThumb(extractMvCover(mvInfo.getCoverImgUrl())));
    }

    /**
     * 根据 MV id 补全 MV 信息(只包含 url)
     */
    public static void fillMvInfo(NetMvInfo mvInfo) {
        // 信息完整直接跳过
        if (mvInfo.isIntegrated()) return;

        mvInfo.setUrl(fetchMvUrl(mvInfo));
    }

    /**
     * 根据 MV id 补全 MV 基本信息
     */
    public static void fillMvDetail(NetMvInfo netMvInfo) {
        int source = netMvInfo.getSource();
        String mvId = netMvInfo.getId();

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String mvBody = HttpRequest.get(String.format(MV_DETAIL_API, mvId))
                    .execute()
                    .body();
            JSONObject mvJson = JSONObject.fromObject(mvBody);
            JSONObject data = mvJson.getJSONObject("data");
            String name = data.getString("name").trim();
            String artists = parseArtists(data, NetMusicSource.NET_CLOUD);
            String creatorId = data.getJSONArray("artists").getJSONObject(0).getString("id");
            Long playCount = data.getLong("playCount");
            Double duration = data.getDouble("duration") / 1000;
            String pubTime = data.getString("publishTime");
            String coverImgUrl = data.getString("cover");

            netMvInfo.setName(name);
            netMvInfo.setArtist(artists);
            netMvInfo.setCreatorId(creatorId);
            netMvInfo.setPlayCount(playCount);
            netMvInfo.setDuration(duration);
            netMvInfo.setPubTime(pubTime);
            netMvInfo.setCoverImgUrl(coverImgUrl);

            GlobalExecutors.imageExecutor.submit(() -> {
                BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                netMvInfo.setCoverImgThumb(coverImgThumb);
            });
        }

        // 酷狗
        else if (source == NetMusicSource.KG) {
            String mvBody = HttpRequest.get(String.format(MV_DETAIL_KG_API, mvId))
                    .execute()
                    .body();
            JSONObject mvJson = JSONObject.fromObject(mvBody);
            JSONObject data = mvJson.getJSONObject("data").getJSONObject("info");
            String[] s = data.getString("filename").split(" - ");
            String name = s[1];
            String artists = s[0];
            JSONArray artistArray = mvJson.optJSONArray("authors");
            String creatorId = artistArray != null && !artistArray.isEmpty() ? artistArray.getJSONObject(0).getString("singerid") : "";
            Long playCount = data.getLong("history_heat");
            Double duration = data.getDouble("mv_timelength") / 1000;
            String pubTime = data.getString("update");
            String coverImgUrl = data.getString("imgurl").replace("/{size}", "");

            netMvInfo.setName(name);
            netMvInfo.setArtist(artists);
            netMvInfo.setCreatorId(creatorId);
            netMvInfo.setPlayCount(playCount);
            netMvInfo.setDuration(duration);
            netMvInfo.setPubTime(pubTime);
            netMvInfo.setCoverImgUrl(coverImgUrl);

            GlobalExecutors.imageExecutor.submit(() -> {
                BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                netMvInfo.setCoverImgThumb(coverImgThumb);
            });
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            String mvBody = HttpRequest.get(String.format(MV_DETAIL_QQ_API, mvId))
                    .execute()
                    .body();
            JSONObject mvJson = JSONObject.fromObject(mvBody);
            JSONObject data = mvJson.getJSONObject("data").getJSONObject("info");
            String name = data.getString("name");
            String artists = parseArtists(data, NetMusicSource.QQ);
            String creatorId = data.getJSONArray("singers").getJSONObject(0).getString("mid");
            Long playCount = data.getLong("playcnt");
            Double duration = data.getDouble("duration");
            String pubTime = TimeUtil.msToDate(data.getLong("pubdate") * 1000);
            String coverImgUrl = data.getString("cover_pic");

            netMvInfo.setName(name);
            netMvInfo.setArtist(artists);
            netMvInfo.setCreatorId(creatorId);
            netMvInfo.setPlayCount(playCount);
            netMvInfo.setDuration(duration);
            netMvInfo.setPubTime(pubTime);
            netMvInfo.setCoverImgUrl(coverImgUrl);

            GlobalExecutors.imageExecutor.submit(() -> {
                BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                netMvInfo.setCoverImgThumb(coverImgThumb);
            });
        }

        // 酷我
        else if (source == NetMusicSource.KW) {
            String mvBody = kwRequest(String.format(MV_DETAIL_KW_API, mvId))
                    .execute()
                    .body();
            JSONObject mvJson = JSONObject.fromObject(mvBody);
            JSONObject data = mvJson.getJSONObject("data");

            String name = data.getString("name");
            String artist = data.getString("artist");
            String creatorId = data.getString("artistid");
            Long playCount = data.getLong("mvPlayCnt");
            Double duration = data.getDouble("duration");
            String pubTime = data.getString("releaseDate");
            String coverImgUrl = data.getString("pic");

            netMvInfo.setName(name);
            netMvInfo.setArtist(artist);
            netMvInfo.setCreatorId(creatorId);
            netMvInfo.setPlayCount(playCount);
            netMvInfo.setDuration(duration);
            netMvInfo.setPubTime(pubTime);
            netMvInfo.setCoverImgUrl(coverImgUrl);

            GlobalExecutors.imageExecutor.submit(() -> {
                BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                netMvInfo.setCoverImgThumb(coverImgThumb);
            });
        }
    }

    /**
     * 根据榜单 id 预加载榜单信息(包括封面图)
     */
    public static void preloadRankingInfo(NetRankingInfo rankingInfo) {
        // 信息完整直接跳过
        if (rankingInfo.isIntegrated()) return;

        GlobalExecutors.imageExecutor.submit(() -> rankingInfo.setCoverImgThumb(extractProfile(rankingInfo.getCoverImgUrl())));
    }

    /**
     * 根据榜单 id 补全榜单信息(包括封面图)
     */
    public static void fillRankingInfo(NetRankingInfo rankingInfo) {
        // 信息完整直接跳过
        if (rankingInfo.isIntegrated()) return;

        int source = rankingInfo.getSource();
        String id = rankingInfo.getId();

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            GlobalExecutors.imageExecutor.submit(() -> rankingInfo.setCoverImg(getImageFromUrl(rankingInfo.getCoverImgUrl())));
        }

        // 酷狗
        else if (source == NetMusicSource.KG) {
            GlobalExecutors.imageExecutor.submit(() -> rankingInfo.setCoverImg(getImageFromUrl(rankingInfo.getCoverImgUrl())));
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            String rankingInfoBody = HttpRequest.get(String.format(RANKING_DETAIL_QQ_API, id, 1))
                    .execute()
                    .body();
            JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
            JSONObject data = rankingInfoJson.getJSONObject("data");

            GlobalExecutors.imageExecutor.submit(() -> rankingInfo.setCoverImg(getImageFromUrl(rankingInfo.getCoverImgUrl())));
            // QQ 需要额外补全榜单描述
            rankingInfo.setDescription(data.getJSONObject("info").getString("desc").replace("<br>", "\n"));
        }

        // 酷我
        else if (source == NetMusicSource.KW) {
            GlobalExecutors.imageExecutor.submit(() -> rankingInfo.setCoverImg(getImageFromUrl(rankingInfo.getCoverImgUrl())));
        }

        // 咪咕
        else if (source == NetMusicSource.MG) {
            String rankingInfoBody = HttpRequest.get(String.format(RANKING_DETAIL_MG_API, id))
                    .execute()
                    .body();
            JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
            JSONObject data = rankingInfoJson.getJSONObject("columnInfo");

            if (!rankingInfo.hasPlayCount())
                rankingInfo.setPlayCount(data.getJSONObject("opNumItem").getLong("playNum"));
            if (!rankingInfo.hasUpdateTime()) rankingInfo.setUpdateTime(data.optString("columnUpdateTime"));
            GlobalExecutors.imageExecutor.submit(() -> rankingInfo.setCoverImg(getImageFromUrl(rankingInfo.getCoverImgUrl())));
            // 咪咕需要额外补全榜单描述
            rankingInfo.setDescription(data.getString("columnDes"));
        }

        // 千千
        else if (source == NetMusicSource.QI) {
            GlobalExecutors.imageExecutor.submit(() -> rankingInfo.setCoverImg(getImageFromUrl(rankingInfo.getCoverImgUrl())));
        }

        // 猫耳
        else if (source == NetMusicSource.ME) {
            String rankingInfoBody = HttpRequest.get(String.format(RANKING_DETAIL_ME_API, id))
                    .execute()
                    .body();
            JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
            JSONObject data = rankingInfoJson.getJSONObject("info").getJSONObject("album");

            String description = StringUtil.removeHTMLLabel(data.getString("intro"));

            GlobalExecutors.imageExecutor.submit(() -> rankingInfo.setCoverImg(getImageFromUrl(rankingInfo.getCoverImgUrl())));
            rankingInfo.setDescription(description);
        }
    }

    /**
     * 根据用户 id 预加载用户信息
     */
    public static void preloadUserInfo(NetUserInfo userInfo) {
        // 信息完整直接跳过
        if (userInfo.isIntegrated()) return;

        GlobalExecutors.imageExecutor.submit(() -> userInfo.setAvatarThumb(extractProfile(userInfo.getAvatarThumbUrl())));
    }

    /**
     * 根据用户 id 补全用户信息(包括封面图、描述)
     */
    public static void fillUserInfo(NetUserInfo userInfo) {
        // 信息完整直接跳过
        if (userInfo.isIntegrated()) return;

        int source = userInfo.getSource();
        String uid = userInfo.getId();

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String userInfoBody = HttpRequest.get(String.format(USER_DETAIL_API, uid))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject profileJson = userInfoJson.getJSONObject("profile");
            if (!userInfo.hasLevel()) userInfo.setLevel(userInfoJson.getInt("level"));
            if (!userInfo.hasAccAge()) userInfo.setAccAge(TimeUtil.getAccAge(profileJson.getLong("createTime")));
            if (!userInfo.hasBirthday()) userInfo.setBirthday(TimeUtil.msToDate(profileJson.getLong("birthday")));
            if (!userInfo.hasArea())
                userInfo.setArea(AreaUtil.getArea(profileJson.getInt("province"), profileJson.getInt("city")));
            if (!userInfo.hasSign()) userInfo.setSign(profileJson.getString("signature"));
            if (!userInfo.hasFollow()) userInfo.setFollow(profileJson.getInt("follows"));
            if (!userInfo.hasFollowed()) userInfo.setFollowed(profileJson.getInt("followeds"));
            if (!userInfo.hasPlaylistCount()) userInfo.setPlaylistCount(profileJson.getInt("playlistCount"));

            String avatarUrl = profileJson.getString("avatarUrl");
            if (!userInfo.hasAvatarUrl()) userInfo.setAvatarUrl(avatarUrl);
            GlobalExecutors.imageExecutor.submit(() -> userInfo.setAvatar(getImageFromUrl(avatarUrl)));

            String bgImgUrl = profileJson.getString("backgroundUrl");
            if (!userInfo.hasBgImgUrl()) userInfo.setBgImgUrl(bgImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> userInfo.setBgImg(getImageFromUrl(bgImgUrl)));
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            userInfo.setSign("");
            GlobalExecutors.imageExecutor.submit(() -> userInfo.setAvatar(getImageFromUrl(userInfo.getAvatarUrl())));
        }

        // 喜马拉雅
        else if (source == NetMusicSource.XM) {
            String userInfoBody = HttpRequest.get(String.format(USER_DETAIL_XM_API, uid))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject data = userInfoJson.getJSONObject("data");
            if (!userInfo.hasLevel()) userInfo.setLevel(data.getInt("anchorGrade"));
            if (!userInfo.hasGender()) {
                Integer gen = data.getInt("gender");
                String gender = gen == 0 ? "保密" : gen == 1 ? "♂ 男" : "♀ 女";
                userInfo.setGender(gender);
            }
            if (!userInfo.hasBirthday())
                userInfo.setBirthday(data.getInt("birthMonth") <= 0 ? null : data.getString("birthMonth") + "-" + data.getString("birthDay"));
            if (!userInfo.hasArea()) {
                String area = (data.has("province") ? data.getString("province") : "") + (data.has("city") ? " - " + data.getString("city") : "");
                userInfo.setArea(area.isEmpty() ? "未知" : area);
            }
            if (!userInfo.hasSign()) userInfo.setSign(data.optString("personalSignature"));
            if (!userInfo.hasFollow()) userInfo.setFollow(data.getInt("followingCount"));
            if (!userInfo.hasFollowed()) userInfo.setFollowed(data.getInt("fansCount"));
            if (!userInfo.hasRadioCount()) userInfo.setRadioCount(data.getInt("albumsCount"));
            if (!userInfo.hasProgramCount()) userInfo.setProgramCount(data.getInt("tracksCount"));

            String avatarUrl = "http:" + data.getString("cover");
            if (!userInfo.hasAvatarUrl()) userInfo.setAvatarUrl(avatarUrl);
            GlobalExecutors.imageExecutor.submit(() -> userInfo.setAvatar(getImageFromUrl(avatarUrl)));

            String bgImgUrl = "http:" + data.getString("background");
            if (!userInfo.hasBgImgUrl()) userInfo.setBgImgUrl(bgImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> userInfo.setBgImg(getImageFromUrl(bgImgUrl)));
        }

        // 音乐磁场
        else if (source == NetMusicSource.HF) {
            userInfo.setSign("");
            GlobalExecutors.imageExecutor.submit(() -> userInfo.setAvatar(getImageFromUrl(userInfo.getAvatarUrl())));
        }

        // 咕咕咕音乐
        else if (source == NetMusicSource.GG) {
            userInfo.setSign("");
            GlobalExecutors.imageExecutor.submit(() -> userInfo.setAvatar(getImageFromUrl(userInfo.getAvatarUrl())));
        }

        // 猫耳
        else if (source == NetMusicSource.ME) {
            Runnable getProgramCount = () -> {
                // 用户节目数
                if (!userInfo.hasProgramCount()) {
                    GlobalExecutors.requestExecutor.submit(() -> {
                        String programCountBody = HttpRequest.get(String.format(USER_PROGRAMS_ME_API, 0, uid, 1, 1))
                                .execute()
                                .body();
                        Integer programCount = JSONObject.fromObject(programCountBody).getJSONObject("info").getJSONObject("pagination").getInt("count");
                        userInfo.setProgramCount(programCount);
                    });
                }
            };
            Runnable fillUserInfo = () -> {
                String userInfoBody = HttpRequest.get(String.format(USER_DETAIL_ME_API, uid))
                        .execute()
                        .body();
                Document doc = Jsoup.parse(userInfoBody);

                if (!userInfo.hasLevel())
                    userInfo.setLevel(Integer.parseInt(doc.select("span.level").first().text().replace("LV", "")));
                if (!userInfo.hasGender()) userInfo.setGender("保密");
                if (!userInfo.hasSign())
                    userInfo.setSign(doc.select("#t_u_n_a").first().text());
                if (!userInfo.hasFollow())
                    userInfo.setFollow(Integer.parseInt(doc.select(".home-follow span").first().text()));
                if (!userInfo.hasFollowed())
                    userInfo.setFollowed(Integer.parseInt(doc.select(".home-fans span").first().text()));

                String avatarUrl = "https:" + doc.select("div#topusermainicon img").attr("src");
                if (!userInfo.hasAvatarUrl()) userInfo.setAvatarUrl(avatarUrl);
                GlobalExecutors.imageExecutor.submit(() -> userInfo.setAvatar(getImageFromUrl(avatarUrl)));

                String bgUrl = ReUtil.get("background-image: url\\([\"'](.*?)[\"']\\)", userInfoBody, 1);
                String bgImgUrl = (bgUrl.startsWith("//static") ? "https:" : "https://www.missevan.com") + bgUrl;
                if (!userInfo.hasBgImgUrl()) userInfo.setBgImgUrl(bgImgUrl);
                GlobalExecutors.imageExecutor.submit(() -> userInfo.setBgImg(getImageFromUrl(bgImgUrl)));
            };

            List<Future<?>> taskList = new LinkedList<>();

            taskList.add(GlobalExecutors.requestExecutor.submit(fillUserInfo));
            taskList.add(GlobalExecutors.requestExecutor.submit(getProgramCount));

            taskList.forEach(task -> {
                try {
                    task.get();
                } catch (InterruptedException e) {
                    e.printStackTrace();
                } catch (ExecutionException e) {
                    e.printStackTrace();
                }
            });
        }

        // 好看
        else if (source == NetMusicSource.HK) {
            String userInfoBody = HttpRequest.get(String.format(USER_DETAIL_HK_API, uid))
                    .header(Header.COOKIE, HK_COOKIE)
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(ReUtil.get("\"author_info\":(\\{.*?\\})", userInfoBody, 1));

            if (!userInfo.hasSign()) userInfo.setSign(userInfoJson.getString("wishes"));
            if (!userInfo.hasFollowed()) userInfo.setFollowed(userInfoJson.getInt("fansCnt"));
            if (!userInfo.hasProgramCount()) userInfo.setProgramCount(userInfoJson.getInt("videoCnt"));

            String avatarUrl = userInfoJson.getString("avatar");
            if (!userInfo.hasAvatarUrl()) userInfo.setAvatarUrl(avatarUrl);
            GlobalExecutors.imageExecutor.submit(() -> userInfo.setAvatar(getImageFromUrl(avatarUrl)));
        }

        // 豆瓣
        else if (source == NetMusicSource.DB) {
            String userInfoBody = HttpRequest.get(String.format(USER_DETAIL_DB_API, uid))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(userInfoBody);

            if (!userInfo.hasAccAge()) {
                String dt = ReUtil.get("(\\d+\\-\\d+\\-\\d+)加入", doc.select("div.pl").text(), 1);
                userInfo.setAccAge(TimeUtil.getAccAge(TimeUtil.dateToMs(dt)));
            }
            if (!userInfo.hasGender()) userInfo.setGender("保密");
            if (!userInfo.hasArea()) userInfo.setArea(doc.select("div.user-info a").text());
            if (!userInfo.hasSign())
                userInfo.setSign(StringUtil.getPrettyText(doc.select("span#intro_display").first()));
//            if (!userInfo.hasFollow())
//                userInfo.setFollow(Integer.parseInt(doc.select(".home-follow span").first().text()));
//            if (!userInfo.hasFollowed())
//                userInfo.setFollowed(Integer.parseInt(doc.select(".home-fans span").first().text()));

            String avatarUrl = doc.select("div.basic-info img").attr("src");
            if (!userInfo.hasAvatarUrl()) userInfo.setAvatarUrl(avatarUrl);
            GlobalExecutors.imageExecutor.submit(() -> userInfo.setAvatar(getImageFromUrl(avatarUrl)));
        }

        // 堆糖
        else if (source == NetMusicSource.DT) {
            String userInfoBody = HttpRequest.get(String.format(USER_DETAIL_DT_API, uid))
                    .setFollowRedirects(true)
                    .execute()
                    .body();
            Document doc = Jsoup.parse(userInfoBody);
            Elements a = doc.select("div.people-funs a");

            if (!userInfo.hasGender()) userInfo.setGender("保密");
            if (!userInfo.hasSign())
                userInfo.setSign(doc.select("div.people-desc").text().trim());
            if (!userInfo.hasProgramCount()) {
                String s = doc.select("ul.people-nav li a").get(1).select("u").text().trim();
                if (StringUtil.isNotEmpty(s)) userInfo.setProgramCount(Integer.parseInt(s));
            }
            if (!userInfo.hasFollow())
                userInfo.setFollow(Integer.parseInt(ReUtil.get("(\\d+)", a.first().text(), 1)));
            if (!userInfo.hasFollowed())
                userInfo.setFollowed(Integer.parseInt(ReUtil.get("(\\d+)", a.last().text(), 1)));

            String avatarUrl = doc.select("a.people-avatar img").attr("src").replaceFirst("\\.thumb\\.\\d+_\\d+_\\w+", "");
            if (!userInfo.hasAvatarUrl()) userInfo.setAvatarUrl(avatarUrl);
            GlobalExecutors.imageExecutor.submit(() -> userInfo.setAvatar(getImageFromUrl(avatarUrl)));

            String bgImgUrl = doc.select("img.header-bg").attr("src");
            if (!userInfo.hasBgImgUrl()) userInfo.setBgImgUrl(bgImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> userInfo.setBgImg(getImageFromUrl(bgImgUrl)));
        }

        // 哔哩哔哩
        else if (source == NetMusicSource.BI) {
            String userInfoBody = HttpRequest.get(String.format(USER_DETAIL_BI_API, uid))
                    .cookie(BI_COOKIE)
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject data = userInfoJson.getJSONObject("data");
            JSONObject card = data.getJSONObject("card");

            if (!userInfo.hasLevel()) userInfo.setLevel(card.getJSONObject("level_info").getInt("current_level"));
            if (!userInfo.hasGender()) userInfo.setGender(card.getString("sex"));
            if (!userInfo.hasBirthday()) userInfo.setBirthday(card.getString("birthday"));
            if (!userInfo.hasSign()) userInfo.setSign(card.getString("sign"));
            if (!userInfo.hasFollow()) userInfo.setFollow(card.getInt("attention"));
            if (!userInfo.hasFollowed()) userInfo.setFollowed(card.getInt("fans"));
            if (!userInfo.hasProgramCount()) userInfo.setProgramCount(data.getInt("archive_count"));

            String avatarUrl = card.getString("face");
            if (!userInfo.hasAvatarUrl()) userInfo.setAvatarUrl(avatarUrl);
            GlobalExecutors.imageExecutor.submit(() -> userInfo.setAvatar(getImageFromUrl(avatarUrl)));

            String bgImgUrl = data.getJSONObject("space").getString("s_img");
            if (!userInfo.hasBgImgUrl()) userInfo.setBgImgUrl(bgImgUrl);
            GlobalExecutors.imageExecutor.submit(() -> userInfo.setBgImg(getImageFromUrl(bgImgUrl)));
        }
    }

    /**
     * 根据歌单 id 获取里面歌曲的 id 并获取每首歌曲粗略信息，分页，返回 NetMusicInfo
     */
    public static CommonResult<NetMusicInfo> getMusicInfoInPlaylist(String playlistId, int source, int limit, int page) {
        AtomicInteger total = new AtomicInteger();
        List<NetMusicInfo> netMusicInfos = new LinkedList<>();

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            LinkedList<Future<?>> taskList = new LinkedList<>();

            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
                String playlistInfoBody = HttpRequest.get(String.format(PLAYLIST_SONGS_API, playlistId, (page - 1) * limit, limit))
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                JSONArray songArray = playlistInfoJson.getJSONArray("songs");
                for (int i = 0, len = songArray.size(); i < len; i++) {
                    JSONObject songJson = songArray.getJSONObject(i);

                    String songId = songJson.getString("id");
                    String name = songJson.getString("name").trim();
                    String artists = parseArtists(songJson, NetMusicSource.NET_CLOUD);
                    String artistId = songJson.getJSONArray("ar").getJSONObject(0).getString("id");
                    String albumName = songJson.getJSONObject("al").getString("name");
                    String albumId = songJson.getJSONObject("al").getString("id");
                    Double duration = songJson.getDouble("dt") / 1000;
                    String mvId = songJson.getString("mv");

                    NetMusicInfo netMusicInfo = new NetMusicInfo();
                    netMusicInfo.setId(songId);
                    netMusicInfo.setName(name);
                    netMusicInfo.setArtist(artists);
                    netMusicInfo.setArtistId(artistId);
                    netMusicInfo.setAlbumName(albumName);
                    netMusicInfo.setAlbumId(albumId);
                    netMusicInfo.setDuration(duration);
                    netMusicInfo.setMvId(mvId);

                    netMusicInfos.add(netMusicInfo);
                }
            }));

            taskList.add(GlobalExecutors.requestExecutor.submit(() -> {
                // 网易云获取歌单歌曲总数需要额外请求歌单详情接口！
                String playlistInfoBody = HttpRequest.get(String.format(PLAYLIST_DETAIL_API, playlistId))
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                total.set(playlistInfoJson.getJSONObject("playlist").getInt("trackCount"));
            }));

            taskList.forEach(task -> {
                try {
                    task.get();
                } catch (InterruptedException e) {
                    e.printStackTrace();
                } catch (ExecutionException e) {
                    e.printStackTrace();
                }
            });
        }

        // 酷狗
        else if (source == NetMusicSource.KG) {
            String playlistInfoBody = HttpRequest.get(String.format(PLAYLIST_SONGS_KG_API, playlistId, page, limit,
                            StringUtil.toMD5("NVPh5oo715z5DIWAeQlhMDsWXXQV4hwtappid=1058clienttime=1586163263991" +
                                    "clientver=20000dfid=-global_specialid=" + playlistId + "mid=1586163263991page=" + page + "pagesize=" + limit +
                                    "plat=0specialid=0srcappid=2919uuid=1586163263991version=8000NVPh5oo715z5DIWAeQlhMDsWXXQV4hwt")))
                    .header("mid", "1586163263991")
                    .header("Referer", "https://m3ws.kugou.com/share/index.php")
                    .header("User-Agent", "Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1")
                    .header("dfid", "-")
                    .header("clienttime", "1586163263991")
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONObject("data");
            total.set(data.getInt("total"));
            JSONArray songArray = data.getJSONArray("info");
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String hash = songJson.getString("hash");
                String songId = songJson.getString("album_audio_id");
                String[] s = songJson.getString("filename").split(" - ");
                String name = s[1];
                String artists = s[0];
//                String albumName = songJson.getString("remark");
                String albumId = songJson.getString("album_id");
                Double duration = songJson.getDouble("duration");
                String mvId = songJson.getString("mvhash");

                NetMusicInfo netMusicInfo = new NetMusicInfo();
                netMusicInfo.setSource(NetMusicSource.KG);
                netMusicInfo.setHash(hash);
                netMusicInfo.setId(songId);
                netMusicInfo.setName(name);
                netMusicInfo.setArtist(artists);
//                netMusicInfo.setAlbumName(albumName);
                netMusicInfo.setAlbumId(albumId);
                netMusicInfo.setDuration(duration);
                netMusicInfo.setMvId(mvId);

                netMusicInfos.add(netMusicInfo);
            }
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            String playlistInfoBody = HttpRequest.get(String.format(PLAYLIST_DETAIL_QQ_API, playlistId))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONObject("data");
            total.set(data.getInt("songnum"));
            JSONArray songArray = data.getJSONArray("songlist");
            for (int i = (page - 1) * limit, len = Math.min(songArray.size(), page * limit); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("songmid");
                String name = songJson.getString("songname");
                String artists = parseArtists(songJson, NetMusicSource.QQ);
                String artistId = songJson.getJSONArray("singer").getJSONObject(0).getString("mid");
                String albumName = songJson.getString("albumname");
                String albumId = songJson.getString("albummid");
                Double duration = songJson.getDouble("interval");
                String mvId = songJson.getString("vid");

                NetMusicInfo netMusicInfo = new NetMusicInfo();
                netMusicInfo.setSource(NetMusicSource.QQ);
                netMusicInfo.setId(songId);
                netMusicInfo.setName(name);
                netMusicInfo.setArtist(artists);
                netMusicInfo.setArtistId(artistId);
                netMusicInfo.setAlbumName(albumName);
                netMusicInfo.setAlbumId(albumId);
                netMusicInfo.setDuration(duration);
                netMusicInfo.setMvId(mvId);

                netMusicInfos.add(netMusicInfo);
            }
        }

        // 酷我
        else if (source == NetMusicSource.KW) {
            String playlistInfoBody = kwRequest(String.format(PLAYLIST_DETAIL_KW_API, playlistId, page, limit))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONObject("data");
            JSONArray songArray = data.getJSONArray("musicList");
            total.set(data.getInt("total"));
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("rid");
                String name = songJson.getString("name");
                String artists = songJson.getString("artist");
                String artistId = songJson.getString("artistid");
                String albumName = songJson.getString("album");
                String albumId = songJson.getString("albumid");
                Double duration = songJson.getDouble("duration");
                String mvId = songJson.getInt("hasmv") == 0 ? "" : songId;

                NetMusicInfo netMusicInfo = new NetMusicInfo();
                netMusicInfo.setSource(NetMusicSource.KW);
                netMusicInfo.setId(songId);
                netMusicInfo.setName(name);
                netMusicInfo.setArtist(artists);
                netMusicInfo.setArtistId(artistId);
                netMusicInfo.setAlbumName(albumName);
                netMusicInfo.setAlbumId(albumId);
                netMusicInfo.setDuration(duration);
                netMusicInfo.setMvId(mvId);

                netMusicInfos.add(netMusicInfo);
            }
        }

        // 咪咕
        else if (source == NetMusicSource.MG) {
            String playlistInfoBody = HttpRequest.get(String.format(PLAYLIST_SONGS_MG_API, playlistId, page, limit))
                    .header(Header.USER_AGENT, "Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1")
                    .header(Header.REFERER, "https://m.music.migu.cn/")
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONArray songArray = playlistInfoJson.getJSONArray("list");
            total.set(playlistInfoJson.getInt("totalCount"));
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("copyrightId");
                String name = songJson.getString("songName");
                String artists = parseArtists(songJson, NetMusicSource.MG);
                String artistId = songJson.getJSONArray("artists").getJSONObject(0).getString("id");
                String albumName = songJson.getString("album");
                String albumId = songJson.getString("albumId");
                Double duration = TimeUtil.toSeconds(songJson.getString("length"));
                // 咪咕音乐没有 mv 时，该字段不存在！
                String mvId = songJson.optString("mvId");

                NetMusicInfo netMusicInfo = new NetMusicInfo();
                netMusicInfo.setSource(NetMusicSource.MG);
                netMusicInfo.setId(songId);
                netMusicInfo.setName(name);
                netMusicInfo.setArtist(artists);
                netMusicInfo.setArtistId(artistId);
                netMusicInfo.setAlbumName(albumName);
                netMusicInfo.setAlbumId(albumId);
                netMusicInfo.setDuration(duration);
                netMusicInfo.setMvId(mvId);

                netMusicInfos.add(netMusicInfo);
            }
        }

        // 千千
        else if (source == NetMusicSource.QI) {
            String playlistInfoBody = HttpRequest.get(buildQianUrl(String.format(PLAYLIST_DETAIL_QI_API, playlistId, page, limit, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONObject("data");
            total.set(data.getInt("trackCount"));
            JSONArray songArray = data.getJSONArray("trackList");
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("TSID");
                String name = songJson.getString("title");
                String artists = parseArtists(songJson, NetMusicSource.QI);
                JSONArray artistArray = songJson.optJSONArray("artist");
                String artistId = artistArray != null && !artistArray.isEmpty() ? artistArray.getJSONObject(0).getString("artistCode") : "";
                String albumName = songJson.getString("albumTitle");
                String albumId = songJson.getString("albumAssetCode");
                Double duration = songJson.getDouble("duration");

                NetMusicInfo netMusicInfo = new NetMusicInfo();
                netMusicInfo.setSource(NetMusicSource.QI);
                netMusicInfo.setId(songId);
                netMusicInfo.setName(name);
                netMusicInfo.setArtist(artists);
                netMusicInfo.setArtistId(artistId);
                netMusicInfo.setAlbumName(albumName);
                netMusicInfo.setAlbumId(albumId);
                netMusicInfo.setDuration(duration);

                netMusicInfos.add(netMusicInfo);
            }
        }

        // 猫耳
        else if (source == NetMusicSource.ME) {
            String playlistInfoBody = HttpRequest.get(String.format(PLAYLIST_DETAIL_ME_API, playlistId))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONObject("info");
            JSONArray songArray = data.getJSONArray("sounds");
            total.set(songArray.size());
            for (int i = (page - 1) * limit, len = Math.min(songArray.size(), page * limit); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("id");
                String name = songJson.getString("soundstr");
                Double duration = songJson.getDouble("duration") / 1000;

                NetMusicInfo netMusicInfo = new NetMusicInfo();
                netMusicInfo.setSource(NetMusicSource.ME);
                netMusicInfo.setId(songId);
                netMusicInfo.setName(name);
                netMusicInfo.setDuration(duration);

                netMusicInfos.add(netMusicInfo);
            }
        }

        // 哔哩哔哩
        else if (source == NetMusicSource.BI) {
            String playlistInfoBody = HttpRequest.get(String.format(PLAYLIST_SONGS_BI_API, playlistId, page, limit))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONObject data = playlistInfoJson.getJSONObject("data");
            total.set(data.getInt("totalSize"));
            JSONArray songArray = data.getJSONArray("data");
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("id");
                String name = songJson.getString("title");
                String artist = songJson.getString("uname");
                String artistId = songJson.getString("uid");
                Double duration = songJson.getDouble("duration");

                NetMusicInfo netMusicInfo = new NetMusicInfo();
                netMusicInfo.setSource(NetMusicSource.BI);
                netMusicInfo.setId(songId);
                netMusicInfo.setName(name);
                netMusicInfo.setArtist(artist);
                netMusicInfo.setArtistId(artistId);
                netMusicInfo.setDuration(duration);

                netMusicInfos.add(netMusicInfo);
            }
        }

        return new CommonResult<>(netMusicInfos, total.get());
    }

    /**
     * 根据专辑 id 获取里面歌曲的粗略信息，分页，返回 NetMusicInfo
     */
    public static CommonResult<NetMusicInfo> getMusicInfoInAlbum(String albumId, int source, int limit, int page) {
        int total = 0;
        List<NetMusicInfo> netMusicInfos = new LinkedList<>();

        // 网易云 (程序分页)
        if (source == NetMusicSource.NET_CLOUD) {
            String albumInfoBody = HttpRequest.get(String.format(ALBUM_DETAIL_API, albumId))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONArray songArray = albumInfoJson.getJSONArray("songs");
            total = songArray.size();
            for (int i = (page - 1) * limit, len = Math.min(songArray.size(), page * limit); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("id");
                String name = songJson.getString("name").trim();
                String artists = parseArtists(songJson, NetMusicSource.NET_CLOUD);
                String artistId = songJson.getJSONArray("ar").getJSONObject(0).getString("id");
                String albumName = songJson.getJSONObject("al").getString("name");
                String alId = songJson.getJSONObject("al").getString("id");
                Double duration = songJson.getDouble("dt") / 1000;
                String mvId = songJson.getString("mv");

                NetMusicInfo netMusicInfo = new NetMusicInfo();
                netMusicInfo.setId(songId);
                netMusicInfo.setName(name);
                netMusicInfo.setArtist(artists);
                netMusicInfo.setArtistId(artistId);
                netMusicInfo.setAlbumName(albumName);
                netMusicInfo.setAlbumId(alId);
                netMusicInfo.setDuration(duration);
                netMusicInfo.setMvId(mvId);

                netMusicInfos.add(netMusicInfo);
            }
        }

        // 酷狗 (接口分页)
        else if (source == NetMusicSource.KG) {
            String albumInfoBody = HttpRequest.get(String.format(ALBUM_SONGS_KG_API, albumId, page, limit))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");
            total = data.getInt("total");
            JSONArray songArray = data.getJSONArray("info");
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String hash = songJson.getString("hash");
                String songId = songJson.getString("album_audio_id");
                String[] s = songJson.getString("filename").split(" - ");
                String name = s[1];
                String artists = s[0];
//                String albumName = songJson.getString("remark");
                String alId = songJson.getString("album_id");
                Double duration = songJson.getDouble("duration");
                String mvId = songJson.getString("mvhash");

                NetMusicInfo netMusicInfo = new NetMusicInfo();
                netMusicInfo.setSource(NetMusicSource.KG);
                netMusicInfo.setHash(hash);
                netMusicInfo.setId(songId);
                netMusicInfo.setName(name);
                netMusicInfo.setArtist(artists);
//                netMusicInfo.setAlbumName(albumName);
                netMusicInfo.setAlbumId(alId);
                netMusicInfo.setDuration(duration);
                netMusicInfo.setMvId(mvId);

                netMusicInfos.add(netMusicInfo);
            }
        }

        // QQ (程序分页)
        else if (source == NetMusicSource.QQ) {
            String albumInfoBody = HttpRequest.get(String.format(ALBUM_SONGS_QQ_API, albumId))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");
            total = data.getInt("total");
            JSONArray songArray = data.getJSONArray("list");
            for (int i = (page - 1) * limit, len = Math.min(songArray.size(), page * limit); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("mid");
                String name = songJson.getString("name");
                String artists = parseArtists(songJson, NetMusicSource.QQ);
                String artistId = songJson.getJSONArray("singer").getJSONObject(0).getString("mid");
                String albumName = songJson.getJSONObject("album").getString("name");
                String alId = songJson.getJSONObject("album").getString("mid");
                Double duration = songJson.getDouble("interval");
                String mvId = songJson.getJSONObject("mv").getString("vid");

                NetMusicInfo netMusicInfo = new NetMusicInfo();
                netMusicInfo.setSource(NetMusicSource.QQ);
                netMusicInfo.setId(songId);
                netMusicInfo.setName(name);
                netMusicInfo.setArtist(artists);
                netMusicInfo.setArtistId(artistId);
                netMusicInfo.setAlbumName(albumName);
                netMusicInfo.setAlbumId(alId);
                netMusicInfo.setDuration(duration);
                netMusicInfo.setMvId(mvId);

                netMusicInfos.add(netMusicInfo);
            }
        }

        // 酷我 (接口分页)
        else if (source == NetMusicSource.KW) {
            String albumInfoBody = kwRequest(String.format(ALBUM_DETAIL_KW_API, albumId, page, limit))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");
            total = data.getInt("total");
            JSONArray songArray = data.getJSONArray("musicList");
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("rid");
                String name = songJson.getString("name");
                String artists = songJson.getString("artist");
                String artistId = songJson.getString("artistid");
                String albumName = songJson.getString("album");
                String alId = songJson.getString("albumid");
                Double duration = songJson.getDouble("duration");
                String mvId = songJson.getInt("hasmv") == 0 ? "" : songId;

                NetMusicInfo netMusicInfo = new NetMusicInfo();
                netMusicInfo.setSource(NetMusicSource.KW);
                netMusicInfo.setId(songId);
                netMusicInfo.setName(name);
                netMusicInfo.setArtist(artists);
                netMusicInfo.setArtistId(artistId);
                netMusicInfo.setAlbumName(albumName);
                netMusicInfo.setAlbumId(alId);
                netMusicInfo.setDuration(duration);
                netMusicInfo.setMvId(mvId);

                netMusicInfos.add(netMusicInfo);
            }
        }

        // 咪咕 (程序分页)
        else if (source == NetMusicSource.MG) {
            String albumInfoBody = HttpRequest.get(String.format(ALBUM_DETAIL_MG_API, albumId))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");
            JSONArray songArray = data.getJSONArray("songList");
            total = songArray.size();
            for (int i = (page - 1) * limit, len = Math.min(songArray.size(), page * limit); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("cid");
                String name = songJson.getString("name");
                String artists = parseArtists(songJson, NetMusicSource.MG);
                String artistId = songJson.getJSONArray("artists").getJSONObject(0).getString("id");
                String albumName = songJson.getJSONObject("album").getString("name");
                String alId = songJson.getJSONObject("album").getString("id");
                // 咪咕音乐可能没有 mvId
                String mvId = songJson.optString("mvId");

                NetMusicInfo netMusicInfo = new NetMusicInfo();
                netMusicInfo.setSource(NetMusicSource.MG);
                netMusicInfo.setId(songId);
                netMusicInfo.setName(name);
                netMusicInfo.setArtist(artists);
                netMusicInfo.setArtistId(artistId);
                netMusicInfo.setAlbumName(albumName);
                netMusicInfo.setAlbumId(alId);
                netMusicInfo.setMvId(mvId);

                netMusicInfos.add(netMusicInfo);
            }
        }

        // 千千
        else if (source == NetMusicSource.QI) {
            String albumInfoBody = HttpRequest.get(buildQianUrl(String.format(ALBUM_DETAIL_QI_API, albumId, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");
            JSONArray songArray = data.getJSONArray("trackList");
            total = songArray.size();
            for (int i = (page - 1) * limit, len = Math.min(songArray.size(), page * limit); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("assetId");
                String name = songJson.getString("title");
                String artists = parseArtists(songJson, NetMusicSource.QI);
                JSONArray artistArray = songJson.optJSONArray("artist");
                String artistId = artistArray != null && !artistArray.isEmpty() ? artistArray.getJSONObject(0).getString("artistCode") : "";
                String albumName = data.getString("title");
                String alId = data.getString("albumAssetCode");
                Double duration = songJson.getDouble("duration");

                NetMusicInfo netMusicInfo = new NetMusicInfo();
                netMusicInfo.setSource(NetMusicSource.QI);
                netMusicInfo.setId(songId);
                netMusicInfo.setName(name);
                netMusicInfo.setArtist(artists);
                netMusicInfo.setArtistId(artistId);
                netMusicInfo.setAlbumName(albumName);
                netMusicInfo.setAlbumId(alId);
                netMusicInfo.setDuration(duration);

                netMusicInfos.add(netMusicInfo);
            }
        }

        return new CommonResult<>(netMusicInfos, total);
    }

    /**
     * 根据歌手 id 获取里面歌曲的粗略信息，分页，返回 NetMusicInfo
     */
    public static CommonResult<NetMusicInfo> getMusicInfoInArtist(String artistId, int source, int limit, int page) {
        int total = 0;
        List<NetMusicInfo> netMusicInfos = new LinkedList<>();

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String artistInfoBody = HttpRequest.get(String.format(ARTIST_SONGS_API, artistId, (page - 1) * limit, limit))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            total = artistInfoJson.getInt("total");
            JSONArray songArray = artistInfoJson.getJSONArray("songs");
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("id");
                String name = songJson.getString("name").trim();
                String artists = parseArtists(songJson, NetMusicSource.NET_CLOUD);
                String arId = songJson.getJSONArray("ar").getJSONObject(0).getString("id");
                String albumName = songJson.getJSONObject("al").getString("name");
                String albumId = songJson.getJSONObject("al").getString("id");
                Double duration = songJson.getDouble("dt") / 1000;
                String mvId = songJson.getString("mv");

                NetMusicInfo netMusicInfo = new NetMusicInfo();
                netMusicInfo.setId(songId);
                netMusicInfo.setName(name);
                netMusicInfo.setArtist(artists);
                netMusicInfo.setArtistId(arId);
                netMusicInfo.setAlbumName(albumName);
                netMusicInfo.setAlbumId(albumId);
                netMusicInfo.setDuration(duration);
                netMusicInfo.setMvId(mvId);

                netMusicInfos.add(netMusicInfo);
            }
        }

        // 酷狗
        else if (source == NetMusicSource.KG) {
            String artistInfoBody = HttpRequest.get(String.format(ARTIST_SONGS_KG_API, artistId, page, limit))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject data = artistInfoJson.getJSONObject("data");
            total = data.getInt("total");
            JSONArray songArray = data.getJSONArray("info");
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String hash = songJson.getString("hash");
                String songId = songJson.getString("album_audio_id");
                String[] s = songJson.getString("filename").split(" - ");
                String name = s[1];
                String artists = s[0];
                String albumName = songJson.getString("album_name");
                String albumId = songJson.getString("album_id");
                Double duration = songJson.getDouble("duration");
                String mvHash = songJson.getString("mvhash");
                String mvId = StringUtil.isEmpty(mvHash) ? "" : songJson.getJSONArray("mvdata").getJSONObject(0).getString("hash");

                NetMusicInfo netMusicInfo = new NetMusicInfo();
                netMusicInfo.setSource(NetMusicSource.KG);
                netMusicInfo.setHash(hash);
                netMusicInfo.setId(songId);
                netMusicInfo.setName(name);
                netMusicInfo.setArtist(artists);
                netMusicInfo.setAlbumName(albumName);
                netMusicInfo.setAlbumId(albumId);
                netMusicInfo.setDuration(duration);
                netMusicInfo.setMvId(mvId);

                netMusicInfos.add(netMusicInfo);
            }
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            String artistInfoBody = HttpRequest.get(String.format(ARTIST_SONGS_QQ_API, artistId, page, limit))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject data = artistInfoJson.getJSONObject("data");
            total = data.getInt("total");
            JSONArray songArray = data.getJSONArray("list");
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("mid");
                String name = songJson.getString("name");
                String artists = parseArtists(songJson, NetMusicSource.QQ);
                String arId = songJson.getJSONArray("singer").getJSONObject(0).getString("mid");
                String albumName = songJson.getJSONObject("album").getString("name");
                String albumId = songJson.getJSONObject("album").getString("mid");
                Double duration = songJson.getDouble("interval");
                String mvId = songJson.getJSONObject("mv").getString("vid");

                NetMusicInfo netMusicInfo = new NetMusicInfo();
                netMusicInfo.setSource(NetMusicSource.QQ);
                netMusicInfo.setId(songId);
                netMusicInfo.setName(name);
                netMusicInfo.setArtist(artists);
                netMusicInfo.setArtistId(arId);
                netMusicInfo.setAlbumName(albumName);
                netMusicInfo.setAlbumId(albumId);
                netMusicInfo.setDuration(duration);
                netMusicInfo.setMvId(mvId);

                netMusicInfos.add(netMusicInfo);
            }
        }

        // 酷我
        else if (source == NetMusicSource.KW) {
            String artistInfoBody = kwRequest(String.format(ARTIST_SONGS_KW_API, artistId, page, limit))
                    .header(Header.REFERER, "http://www.kuwo.cn/singer_detail/" + StringUtil.encode(artistId))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject data = artistInfoJson.getJSONObject("data");
            total = data.getInt("total");
            JSONArray songArray = data.getJSONArray("list");
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("rid");
                // 酷我歌名中可能含有 HTML 标签，先去除
                String name = StringUtil.removeHTMLLabel(songJson.getString("name"));
                String artists = songJson.getString("artist");
                String arId = songJson.getString("artistid");
                String albumName = songJson.getString("album");
                String albumId = songJson.getString("albumid");
                Double duration = songJson.getDouble("duration");
                String mvId = songJson.getInt("hasmv") == 0 ? "" : songId;

                NetMusicInfo netMusicInfo = new NetMusicInfo();
                netMusicInfo.setSource(NetMusicSource.KW);
                netMusicInfo.setId(songId);
                netMusicInfo.setName(name);
                netMusicInfo.setArtistId(arId);
                netMusicInfo.setArtist(artists);
                netMusicInfo.setAlbumName(albumName);
                netMusicInfo.setAlbumId(albumId);
                netMusicInfo.setDuration(duration);
                netMusicInfo.setMvId(mvId);

                netMusicInfos.add(netMusicInfo);
            }
        }

        // 咪咕
        else if (source == NetMusicSource.MG) {
            String artistInfoBody = HttpRequest.get(String.format(ARTIST_SONGS_MG_API, artistId, page))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject data = artistInfoJson.optJSONObject("data");
            // 咪咕可能接口异常，需要判空！
            if (data != null) {
                total = data.optInt("totalPage") * limit;
                JSONArray songArray = data.getJSONArray("list");
                for (int i = 0, len = songArray.size(); i < len; i++) {
                    JSONObject songJson = songArray.getJSONObject(i);

                    String songId = songJson.getString("cid");
                    String name = songJson.getString("name");
                    String artists = parseArtists(songJson, NetMusicSource.MG);
                    String arId = songJson.getJSONArray("artists").getJSONObject(0).getString("id");
                    String albumName = songJson.getJSONObject("album").getString("name");
                    String albumId = songJson.getJSONObject("album").getString("id");
                    // 咪咕音乐可能没有 MV 字段！
                    String mvId = songJson.optString("mvId");

                    NetMusicInfo netMusicInfo = new NetMusicInfo();
                    netMusicInfo.setSource(NetMusicSource.MG);
                    netMusicInfo.setId(songId);
                    netMusicInfo.setName(name);
                    netMusicInfo.setArtist(artists);
                    netMusicInfo.setArtistId(arId);
                    netMusicInfo.setAlbumName(albumName);
                    netMusicInfo.setAlbumId(albumId);
                    netMusicInfo.setMvId(mvId);

                    netMusicInfos.add(netMusicInfo);
                }
            }
        }

        // 千千
        else if (source == NetMusicSource.QI) {
            String artistInfoBody = HttpRequest.get(buildQianUrl(String.format(ARTIST_SONGS_QI_API, artistId, page, limit, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject data = artistInfoJson.getJSONObject("data");
            total = data.getInt("total");
            JSONArray songArray = data.getJSONArray("result");
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("TSID");
                String name = songJson.getString("title");
                String artists = parseArtists(songJson, NetMusicSource.QI);
                JSONArray artistArray = songJson.optJSONArray("artist");
                String arId = artistArray != null && !artistArray.isEmpty() ? artistArray.getJSONObject(0).getString("artistCode") : "";
                String albumName = songJson.getString("albumTitle");
                String albumId = songJson.getString("albumAssetCode");
                Double duration = songJson.getDouble("duration");

                NetMusicInfo netMusicInfo = new NetMusicInfo();
                netMusicInfo.setSource(NetMusicSource.QI);
                netMusicInfo.setId(songId);
                netMusicInfo.setName(name);
                netMusicInfo.setArtist(artists);
                netMusicInfo.setArtistId(arId);
                netMusicInfo.setAlbumName(albumName);
                netMusicInfo.setAlbumId(albumId);
                netMusicInfo.setDuration(duration);

                netMusicInfos.add(netMusicInfo);
            }
        }

        // 猫耳
        else if (source == NetMusicSource.ME) {
            String artistInfoBody = HttpRequest.get(String.format(CV_PROGRAMS_ME_API, artistId))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(artistInfoBody);
            Elements programs = doc.select(".pld-sound-title.cv-title a");
            total = programs.size();
//            Elements a = doc.select("a.share-personage-name.show_album_ower_name");
            for (int i = (page - 1) * limit, len = Math.min(page * limit, programs.size()); i < len; i++) {
                Element program = programs.get(i);

                String songId = ReUtil.get("id=(\\d+)", program.attr("href"), 1);
                String name = program.text().trim();
                // 部分音频的艺术家不一致，干脆先不记录！
//                String artist = a.text();
//                String artistId = a.attr("href").replaceFirst("/", "");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.ME);
                musicInfo.setId(songId);
                musicInfo.setName(name);
//                musicInfo.setArtist(artist);
//                musicInfo.setArtistId(artistId);
                netMusicInfos.add(musicInfo);
            }
        }

        return new CommonResult<>(netMusicInfos, total);
    }

    /**
     * 根据歌手 id 获取里面专辑的粗略信息，分页，返回 NetAlbumInfo
     */
    public static CommonResult<NetAlbumInfo> getAlbumInfoInArtist(NetArtistInfo netArtistInfo, int limit, int page) {
        int total = 0;
        List<NetAlbumInfo> albumInfos = new LinkedList<>();

        String artistId = netArtistInfo.getId();
        int source = netArtistInfo.getSource();

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String albumInfoBody = HttpRequest.get(String.format(ARTIST_ALBUMS_API, artistId, (page - 1) * limit, limit))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            total = albumInfoJson.getJSONObject("artist").getInt("albumSize");
            JSONArray albumArray = albumInfoJson.getJSONArray("hotAlbums");
            for (int i = 0, len = albumArray.size(); i < len; i++) {
                JSONObject albumJson = albumArray.getJSONObject(i);

                String id = albumJson.getString("id");
                String name = albumJson.getString("name");
                String artists = parseArtists(albumJson, NetMusicSource.NET_CLOUD);
                String arId = albumJson.getJSONArray("artists").getJSONObject(0).getString("id");
                String publishTime = TimeUtil.msToDate(albumJson.getLong("publishTime"));
                Integer songNum = albumJson.getInt("size");
                String coverImgThumbUrl = albumJson.getString("picUrl");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setId(id);
                albumInfo.setName(name);
                albumInfo.setArtist(artists);
                albumInfo.setArtistId(arId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });
                albumInfos.add(albumInfo);
            }
        }

        // 酷狗
        else if (source == NetMusicSource.KG) {
            String albumInfoBody = HttpRequest.get(String.format(ARTIST_ALBUMS_KG_API, artistId, page, limit))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");
            total = data.getInt("total");
            JSONArray albumArray = data.getJSONArray("info");
            for (int i = 0, len = albumArray.size(); i < len; i++) {
                JSONObject albumJson = albumArray.getJSONObject(i);

                String albumId = albumJson.getString("albumid");
                String albumName = albumJson.getString("albumname");
                String artist = albumJson.getString("singername");
                String arId = albumJson.getString("singerid");
                String coverImgThumbUrl = albumJson.getString("imgurl").replace("/{size}", "");
                String description = albumJson.getString("intro");
                String publishTime = albumJson.getString("publishtime").replace(" 00:00:00", "");
                Integer songNum = albumJson.getInt("songcount");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.KG);
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(arId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setDescription(description);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });
                albumInfos.add(albumInfo);
            }
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            String albumInfoBody = HttpRequest.get(String.format(ARTIST_ALBUMS_QQ_API, artistId, page, limit))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");
            total = Math.max(total, data.getInt("total"));
            JSONArray albumArray = data.getJSONArray("list");
            for (int i = 0, len = albumArray.size(); i < len; i++) {
                JSONObject albumJson = albumArray.getJSONObject(i);

                String albumId = albumJson.getString("album_mid");
                String albumName = albumJson.getString("album_name");
                String artist = parseArtists(albumJson, NetMusicSource.QQ);
                String arId = albumJson.getJSONArray("singers").getJSONObject(0).getString("singer_mid");
                String publishTime = albumJson.getString("pub_time");
                Integer songNum = albumJson.getJSONObject("latest_song").getInt("song_count");
                String coverImgThumbUrl = String.format(SINGLE_SONG_IMG_QQ_API, albumId);

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.QQ);
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(arId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });
                albumInfos.add(albumInfo);
            }
        }

        // 酷我
        else if (source == NetMusicSource.KW) {
            HttpResponse resp = kwRequest(String.format(ARTIST_ALBUMS_KW_API, artistId, page, limit))
                    .header(Header.REFERER, "http://www.kuwo.cn/singer_detail/" + StringUtil.encode(artistId) + "/album")
                    .execute();
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                String albumInfoBody = resp.body();
                JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
                JSONObject data = albumInfoJson.getJSONObject("data");
                total = data.getInt("total");
                JSONArray albumArray = data.getJSONArray("albumList");
                for (int i = 0, len = albumArray.size(); i < len; i++) {
                    JSONObject albumJson = albumArray.getJSONObject(i);

                    String albumId = albumJson.getString("albumid");
                    String albumName = StringUtil.removeHTMLLabel(albumJson.getString("album"));
                    String artist = StringUtil.removeHTMLLabel(albumJson.getString("artist"));
                    String arId = albumJson.getString("artistid");
                    String publishTime = albumJson.getString("releaseDate");
                    String coverImgThumbUrl = albumJson.getString("pic");

                    NetAlbumInfo albumInfo = new NetAlbumInfo();
                    albumInfo.setSource(NetMusicSource.KW);
                    albumInfo.setId(albumId);
                    albumInfo.setName(albumName);
                    albumInfo.setArtist(artist);
                    albumInfo.setArtistId(arId);
                    albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    albumInfo.setPublishTime(publishTime);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        albumInfo.setCoverImgThumb(coverImgThumb);
                    });
                    albumInfos.add(albumInfo);
                }
            }
        }

        // 咪咕
        else if (source == NetMusicSource.MG) {
            String albumInfoBody = HttpRequest.get(String.format(ARTIST_ALBUMS_MG_API, artistId, page))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            // 咪咕可能接口异常，需要判空！
            JSONObject data = albumInfoJson.optJSONObject("data");
            if (data != null) {
                total = data.optInt("total");
                JSONArray albumArray = data.getJSONArray("list");
                for (int i = 0, len = albumArray.size(); i < len; i++) {
                    JSONObject albumJson = albumArray.getJSONObject(i);

                    String albumId = albumJson.getString("id");
                    String albumName = albumJson.getString("name");
                    String artist = parseArtists(albumJson, NetMusicSource.MG);
                    String arId = albumJson.getJSONArray("artists").getJSONObject(0).getString("id");
                    String coverImgThumbUrl = "http:" + albumJson.getString("picUrl");
//                    String publishTime = albumJson.getString("publishTime");
//                    Integer songNum = albumJson.getInt("songCount");

                    NetAlbumInfo albumInfo = new NetAlbumInfo();
                    albumInfo.setSource(NetMusicSource.MG);
                    albumInfo.setId(albumId);
                    albumInfo.setName(albumName);
                    albumInfo.setArtist(artist);
                    albumInfo.setArtistId(arId);
                    albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
//                    albumInfo.setPublishTime(publishTime);
//                    albumInfo.setSongNum(songNum);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        albumInfo.setCoverImgThumb(coverImgThumb);
                    });
                    albumInfos.add(albumInfo);
                }
            }
        }

        // 千千
        else if (source == NetMusicSource.QI) {
            String albumInfoBody = HttpRequest.get(buildQianUrl(String.format(ARTIST_ALBUMS_QI_API, artistId, page, limit, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.optJSONObject("data");
            total = data.optInt("total");
            JSONArray albumArray = data.getJSONArray("result");
            for (int i = 0, len = albumArray.size(); i < len; i++) {
                JSONObject albumJson = albumArray.getJSONObject(i);

                String albumId = albumJson.getString("albumAssetCode");
                String albumName = albumJson.getString("title");
                String artist = parseArtists(albumJson, NetMusicSource.QI);
                JSONArray artistArray = albumJson.optJSONArray("artist");
                String arId = artistArray != null && !artistArray.isEmpty() ? artistArray.getJSONObject(0).getString("artistCode") : "";
                String coverImgThumbUrl = albumJson.getString("pic");
                String publishTime = albumJson.getString("releaseDate").split("T")[0];
                Integer songNum = albumJson.getJSONArray("trackList").size();

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.QI);
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(arId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });
                albumInfos.add(albumInfo);
            }
        }

        return new CommonResult<>(albumInfos, total);
    }

    /**
     * 根据歌手 id 获取里面 MV 的粗略信息，分页，返回 NetMvInfo
     */
    public static CommonResult<NetMvInfo> getMvInfoInArtist(NetArtistInfo netArtistInfo, int limit, int page) {
        int total = 0;
        List<NetMvInfo> mvInfos = new LinkedList<>();

        String artistId = netArtistInfo.getId();
        int source = netArtistInfo.getSource();

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            // 歌手 MV
            String mvInfoBody = HttpRequest.get(String.format(ARTIST_MVS_API, artistId, (page - 1) * limit, limit))
                    .execute()
                    .body();
            JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
            JSONArray mvArray = mvInfoJson.getJSONArray("mvs");
            total = netArtistInfo.getMvNum();
            for (int i = 0, len = mvArray.size(); i < len; i++) {
                JSONObject mvJson = mvArray.getJSONObject(i);

                String mvId = mvJson.getString("id");
                String mvName = mvJson.getString("name").trim();
                String artistName = mvJson.getString("artistName");
                String creatorId = mvJson.getJSONObject("artist").getString("id");
                Long playCount = mvJson.getLong("playCount");
                Double duration = mvJson.getDouble("duration") / 1000;
                String coverImgUrl = mvJson.getString("imgurl");

                NetMvInfo mvInfo = new NetMvInfo();
                mvInfo.setId(mvId);
                mvInfo.setName(mvName);
                mvInfo.setArtist(artistName);
                mvInfo.setCreatorId(creatorId);
                mvInfo.setCoverImgUrl(coverImgUrl);
                mvInfo.setPlayCount(playCount);
                mvInfo.setDuration(duration);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                    mvInfo.setCoverImgThumb(coverImgThumb);
                });

                mvInfos.add(mvInfo);
            }
            // 歌手视频
//            Callable<CommonResult<NetMvInfo>> getArtistVideo = ()->{
//                List<NetMvInfo> res = new LinkedList<>();
//                int t = 0;
//
//                String mvInfoBody = HttpRequest.get(String.format(ARTIST_VIDEOS_API, artistId, (page - 1) * limit, limit))
//                        .execute()
//                        .body();
//                JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
//                JSONArray mvArray = mvInfoJson.getJSONObject("data").getJSONArray("records");
//                t = netArtistInfo.getMvNum();
//                for (int i = 0, len = mvArray.size(); i < len; i++) {
//                    JSONObject mvJson = mvArray.getJSONObject(i);
//
//                    String mvId = mvJson.getString("id");
//                    String mvName = mvJson.getString("name");
//                    String artistName = mvJson.getString("artistName");
//                    Long playCount = mvJson.getLong("playCount");
//                    Double duration = mvJson.getDouble("duration") / 1000;
//                    String coverImgUrl = mvJson.getString("imgurl");
//
//                    NetMvInfo mvInfo = new NetMvInfo();
//                    mvInfo.setId(mvId);
//                    mvInfo.setName(mvName.trim());
//                    mvInfo.setArtist(artistName);
//                    mvInfo.setCoverImgUrl(coverImgUrl);
//                    mvInfo.setPlayCount(playCount);
//                    mvInfo.setDuration(duration);
//                    GlobalExecutors.imageExecutor.execute(() -> {
//                        BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
//                        mvInfo.setCoverImgThumb(coverImgThumb);
//                    });
//
//                    res.add(mvInfo);
//                }
//
//                return new CommonResult<>(res, t);
//            };
        }

        // 酷狗
        else if (source == NetMusicSource.KG) {
            String mvInfoBody = HttpRequest.get(String.format(ARTIST_MVS_KG_API, artistId, page, limit))
                    .execute()
                    .body();
            JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
            JSONObject data = mvInfoJson.getJSONObject("data");
            total = data.getInt("total");
            JSONArray mvArray = data.getJSONArray("info");
            for (int i = 0, len = mvArray.size(); i < len; i++) {
                JSONObject mvJson = mvArray.getJSONObject(i);

                String mvId = mvJson.getString("hash");
                // 酷狗返回的名称含有 HTML 标签，需要去除
                String mvName = StringUtil.removeHTMLLabel(mvJson.getString("filename"));
                String artistName = StringUtil.removeHTMLLabel(mvJson.getString("singername"));
                String coverImgUrl = mvJson.getString("imgurl");

                NetMvInfo mvInfo = new NetMvInfo();
                mvInfo.setSource(NetMusicSource.KG);
                mvInfo.setId(mvId);
                mvInfo.setName(mvName);
                mvInfo.setArtist(artistName);
                mvInfo.setCoverImgUrl(coverImgUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                    mvInfo.setCoverImgThumb(coverImgThumb);
                });

                mvInfos.add(mvInfo);
            }
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            String mvInfoBody = HttpRequest.get(String.format(ARTIST_MVS_QQ_API, artistId, page, limit))
                    .execute()
                    .body();
            JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
            JSONObject data = mvInfoJson.getJSONObject("data");
            total = data.getInt("total");
            JSONArray mvArray = data.getJSONArray("list");
            for (int i = 0, len = mvArray.size(); i < len; i++) {
                JSONObject mvJson = mvArray.getJSONObject(i);

                String mvId = mvJson.getString("vid");
                String mvName = mvJson.getString("title").trim();
                String artistName = mvJson.getString("singer_name");
                String creatorId = mvJson.getString("singer_id");
                String coverImgUrl = mvJson.getString("pic");
                Long playCount = mvJson.getLong("listenCount");

                NetMvInfo mvInfo = new NetMvInfo();
                mvInfo.setSource(NetMusicSource.QQ);
                mvInfo.setId(mvId);
                mvInfo.setName(mvName);
                mvInfo.setArtist(artistName);
                mvInfo.setCreatorId(creatorId);
                mvInfo.setCoverImgUrl(coverImgUrl);
                mvInfo.setPlayCount(playCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                    mvInfo.setCoverImgThumb(coverImgThumb);
                });

                mvInfos.add(mvInfo);
            }
        }

        // 酷我
        else if (source == NetMusicSource.KW) {
            HttpResponse resp = kwRequest(String.format(ARTIST_MVS_KW_API, artistId, page, limit))
                    .header(Header.REFERER, "http://www.kuwo.cn/singer_detail/" + StringUtil.encode(artistId) + "/mv")
                    .execute();
            if (resp.getStatus() == HttpStatus.HTTP_OK) {
                String mvInfoBody = resp.body();
                JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
                JSONObject data = mvInfoJson.getJSONObject("data");
                total = data.getInt("total");
                JSONArray mvArray = data.getJSONArray("mvlist");
                for (int i = 0, len = mvArray.size(); i < len; i++) {
                    JSONObject mvJson = mvArray.getJSONObject(i);

                    String mvId = mvJson.getString("id");
                    String mvName = mvJson.getString("name").trim();
                    String artistName = mvJson.getString("artist");
                    String creatorId = mvJson.getString("artistid");
                    String coverImgUrl = mvJson.getString("pic");
                    Long playCount = mvJson.getLong("mvPlayCnt");
                    Double duration = mvJson.getDouble("duration");

                    NetMvInfo mvInfo = new NetMvInfo();
                    mvInfo.setSource(NetMusicSource.KW);
                    mvInfo.setId(mvId);
                    mvInfo.setName(mvName);
                    mvInfo.setArtist(artistName);
                    mvInfo.setCreatorId(creatorId);
                    mvInfo.setCoverImgUrl(coverImgUrl);
                    mvInfo.setPlayCount(playCount);
                    mvInfo.setDuration(duration);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                        mvInfo.setCoverImgThumb(coverImgThumb);
                    });

                    mvInfos.add(mvInfo);
                }
            }
        }

        return new CommonResult<>(mvInfos, total);
    }

//    /**
//     * 根据电台 id 获取电台歌曲总数
//     */
//    public static Integer findMusicCountInRadio(long radioId) {
//        String radioInfoBody = HttpRequest.get(String.format(RADIO_DETAIL_API, radioId))
//                .execute()
//                .body();
//        JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
//        return radioInfoJson.getJSONObject("data").getInt("programCount");
//    }

    /**
     * 根据电台 id 获取里面歌曲的 id 并获取每首歌曲粗略信息，分页，返回 NetMusicInfo
     */
    public static CommonResult<NetMusicInfo> getMusicInfoInRadio(NetRadioInfo radioInfo, int sortType, int limit, int page) {
        AtomicInteger total = new AtomicInteger();
        List<NetMusicInfo> musicInfos = new LinkedList<>();

        int source = radioInfo.getSource();
        String radioId = radioInfo.getId();

        // 网易云(接口分页)
        if (source == NetMusicSource.NET_CLOUD) {
            String radioInfoBody = HttpRequest.get(String.format(RADIO_PROGRAM_DETAIL_API, radioId, (page - 1) * limit, limit))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            total.set(radioInfoJson.getInt("count"));
            JSONArray songArray = radioInfoJson.getJSONArray("programs");
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject programJson = songArray.getJSONObject(i);
                JSONObject mainSongJson = programJson.getJSONObject("mainSong");
                JSONObject djJson = programJson.getJSONObject("dj");
                JSONObject radioJson = programJson.getJSONObject("radio");

                String programId = programJson.getString("id");
                String songId = mainSongJson.getString("id");
                String name = mainSongJson.getString("name");
                String artist = djJson.getString("nickname");
                String artistId = djJson.getString("userId");
                String albumName = radioJson.getString("name");
                String albumId = radioJson.getString("id");
                String albumImgUrl = programJson.getString("coverUrl");
                Double duration = mainSongJson.getDouble("duration") / 1000;

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setProgramId(programId);
                musicInfo.setId(songId);
                musicInfo.setName(name);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);
                musicInfos.add(musicInfo);
            }
        }

        // QQ(程序分页)
        else if (source == NetMusicSource.QQ) {
            String radioInfoBody = HttpRequest.get(String.format(RADIO_DETAIL_QQ_API, radioId))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONArray songArray = radioInfoJson.getJSONObject("data").optJSONArray("tracks");
            if (songArray != null) {
                total.set(songArray.size());
                for (int i = (page - 1) * limit, len = Math.min(songArray.size(), page * limit); i < len; i++) {
                    JSONObject songJson = songArray.getJSONObject(i);

                    String songId = songJson.getString("mid");
                    String name = songJson.getString("name");
                    String artist = parseArtists(songJson, NetMusicSource.QQ);
                    String artistId = songJson.getJSONObject("singer").getString("mid");
                    String albumName = songJson.getJSONObject("album").getString("name");
                    String albumId = songJson.getJSONObject("album").getString("mid");
                    Double duration = songJson.getDouble("interval");

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setSource(NetMusicSource.QQ);
                    musicInfo.setId(songId);
                    musicInfo.setName(name);
                    musicInfo.setArtist(artist);
                    musicInfo.setArtistId(artistId);
                    musicInfo.setAlbumName(albumName);
                    musicInfo.setAlbumId(albumId);
                    musicInfo.setDuration(duration);
                    musicInfos.add(musicInfo);
                }
            }
        }

        // 喜马拉雅(接口分页)
        else if (source == NetMusicSource.XM) {
            String radioInfoBody = HttpRequest.get(String.format(RADIO_PROGRAM_XM_API, radioId, sortType, page, limit))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONObject data = radioInfoJson.getJSONObject("data");
            total.set(data.getInt("trackTotalCount"));
            JSONArray songArray = data.getJSONArray("tracks");
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String id = songJson.getString("trackId");
                String name = songJson.getString("title");
                String artist = songJson.getString("anchorName");
                String artistId = songJson.getString("anchorId");
                Double duration = songJson.getDouble("duration");
                String albumName = songJson.getString("albumTitle");
                String albumId = songJson.getString("albumId");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.XM);
                musicInfo.setId(id);
                musicInfo.setName(name);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setDuration(duration);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfos.add(musicInfo);
            }
        }

        // 猫耳
        else if (source == NetMusicSource.ME) {
            String radioInfoBody = HttpRequest.get(String.format(RADIO_DETAIL_ME_API, radioId))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONObject info = radioInfoJson.getJSONObject("info");
            // 猫耳的电台可能有多种类型！
            JSONObject episodes = info.getJSONObject("episodes");
            JSONArray songArray = episodes.getJSONArray("episode");
            songArray.addAll(episodes.getJSONArray("ft"));
            songArray.addAll(episodes.getJSONArray("music"));
            total.set(songArray.size());
            for (int i = (page - 1) * limit, len = Math.min(songArray.size(), page * limit); i < len; i++) {
                JSONObject programJson = songArray.getJSONObject(i);

                String songId = programJson.getString("sound_id");
                String name = programJson.getString("name");
                // 艺术家与电台作者不一致！
//                String artist = radioInfo.getDj();
//                String artistId = radioInfo.getDjId();
                String albumName = radioInfo.getName();
                String albumId = radioInfo.getId();
                Double duration = programJson.getDouble("duration") / 1000;

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.ME);
                musicInfo.setId(songId);
                musicInfo.setName(name);
//                musicInfo.setArtist(artist);
//                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);

                musicInfos.add(musicInfo);
            }
        }

        return new CommonResult<>(musicInfos, total.get());
    }

    /**
     * 根据榜单 id 获取里面歌曲的 id 并获取每首歌曲粗略信息，分页，返回 NetMusicInfo
     */
    public static CommonResult<NetMusicInfo> getMusicInfoInRanking(String rankingId, int source, int limit, int page) {
        int total = 0;
        List<NetMusicInfo> musicInfos = new LinkedList<>();

        // 网易云(榜单就是歌单，接口分页)
        if (source == NetMusicSource.NET_CLOUD) {
            return getMusicInfoInPlaylist(rankingId, source, limit, page);
        }

        // 酷狗
        else if (source == NetMusicSource.KG) {
            String rankingInfoBody = HttpRequest.get(String.format(RANKING_DETAIL_KG_API, rankingId, page, limit))
                    .execute()
                    .body();
            JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
            JSONObject data = rankingInfoJson.getJSONObject("data");
            total = data.getInt("total");
            JSONArray songArray = data.getJSONArray("info");
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String hash = songJson.getString("hash");
                String songId = songJson.getString("album_audio_id");
                String name = songJson.getString("songname");
                String artists = parseArtists(songJson, NetMusicSource.KG);
                JSONArray artistArray = songJson.optJSONArray("authors");
                String artistId = artistArray != null && !artistArray.isEmpty() ? artistArray.getJSONObject(0).getString("author_id") : "";
//                String albumName = songJson.getString("remark");
                String albumId = songJson.getString("album_id");
                Double duration = songJson.getDouble("duration");
                String mvHash = songJson.getString("mvhash");
                String mvId = StringUtil.isEmpty(mvHash) ? "" : songJson.getJSONArray("mvdata").getJSONObject(0).getString("hash");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.KG);
                musicInfo.setHash(hash);
                musicInfo.setId(songId);
                musicInfo.setName(name);
                musicInfo.setArtist(artists);
                musicInfo.setArtistId(artistId);
//                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);
                musicInfo.setMvId(mvId);

                musicInfos.add(musicInfo);
            }
        }

        // QQ(程序分页)
        else if (source == NetMusicSource.QQ) {
            String rankingInfoBody = HttpRequest.get(String.format(RANKING_DETAIL_QQ_API, rankingId, 1000))
                    .execute()
                    .body();
            JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
            JSONObject data = rankingInfoJson.getJSONObject("data");
            total = data.getInt("total");
            JSONArray songArray = data.getJSONArray("list");
            for (int i = (page - 1) * limit, len = Math.min(songArray.size(), page * limit); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("mid");
                String name = songJson.getString("name");
                String artists = parseArtists(songJson, NetMusicSource.QQ);
                String artistId = songJson.getJSONArray("singer").getJSONObject(0).getString("mid");
                String albumName = songJson.getJSONObject("album").getString("name");
                String albumId = songJson.getJSONObject("album").getString("mid");
                Double duration = songJson.getDouble("interval");
                String mvId = songJson.getJSONObject("mv").getString("vid");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.QQ);
                musicInfo.setId(songId);
                musicInfo.setName(name);
                musicInfo.setArtist(artists);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);
                musicInfo.setMvId(mvId);

                musicInfos.add(musicInfo);
            }
        }

        // 酷我(接口分页)
        else if (source == NetMusicSource.KW) {
            String rankingInfoBody = kwRequest(String.format(RANKING_DETAIL_KW_API, rankingId, page, Math.min(30, limit)))
                    .execute()
                    .body();
            JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
            JSONObject data = rankingInfoJson.getJSONObject("data");
            total = data.getInt("num");
            JSONArray songArray = data.getJSONArray("musicList");
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("rid");
                String name = songJson.getString("name");
                String artist = songJson.getString("artist");
                String artistId = songJson.getString("artistid");
                String albumName = songJson.getString("album");
                String albumId = songJson.getString("albumid");
                Double duration = songJson.getDouble("duration");
                String mvId = songJson.getInt("hasmv") == 0 ? "" : songId;

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.KW);
                musicInfo.setId(songId);
                musicInfo.setName(name);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);
                musicInfo.setMvId(mvId);

                musicInfos.add(musicInfo);
            }
        }

        // 咪咕(程序分页)
        else if (source == NetMusicSource.MG) {
            String rankingInfoBody = HttpRequest.get(String.format(RANKING_DETAIL_MG_API, rankingId))
                    .execute()
                    .body();
            JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
            JSONObject data = rankingInfoJson.getJSONObject("columnInfo");
            total = data.getInt("contentsCount");
            JSONArray songArray = data.getJSONArray("contents");
            for (int i = (page - 1) * limit, len = Math.min(songArray.size(), page * limit); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i).getJSONObject("objectInfo");

                String songId = songJson.optString("copyrightId");
                // 过滤掉不是歌曲的 objectInfo
                if (StringUtil.isEmpty(songId)) continue;
                String name = songJson.getString("songName");
                String artists = songJson.getString("singer");
                String artistId = songJson.getString("singerId");
                String albumName = songJson.getString("album");
                String albumId = songJson.getString("albumId");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.MG);
                musicInfo.setId(songId);
                musicInfo.setName(name);
                musicInfo.setArtist(artists);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);

                musicInfos.add(musicInfo);
            }
        }

        // 千千(程序分页)
        else if (source == NetMusicSource.QI) {
            String rankingInfoBody = HttpRequest.get(buildQianUrl(String.format(RANKING_DETAIL_QI_API, rankingId, page, limit, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
            JSONObject data = rankingInfoJson.getJSONObject("data");
            total = data.getInt("total");
            JSONArray songArray = data.getJSONArray("result");
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("TSID");
                String name = songJson.getString("title");
                String artist = parseArtists(songJson, NetMusicSource.QI);
                JSONArray artistArray = songJson.optJSONArray("artist");
                String artistId = artistArray != null && !artistArray.isEmpty() ? artistArray.getJSONObject(0).getString("artistCode") : "";
                String albumName = songJson.getString("albumTitle");
                String albumId = songJson.getString("albumAssetCode");
                Double duration = songJson.getDouble("duration");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.QI);
                musicInfo.setId(songId);
                musicInfo.setName(name);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);

                musicInfos.add(musicInfo);
            }
        }

        // 猫耳(程序分页)
        else if (source == NetMusicSource.ME) {
            String rankingInfoBody = HttpRequest.get(String.format(RANKING_DETAIL_ME_API, rankingId))
                    .execute()
                    .body();
            JSONObject rankingInfoJson = JSONObject.fromObject(rankingInfoBody);
            JSONObject data = rankingInfoJson.getJSONObject("info");
            JSONArray songArray = data.getJSONArray("sounds");
            total = songArray.size();
            for (int i = (page - 1) * limit, len = Math.min(page * limit, songArray.size()); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("id");
                String name = songJson.getString("soundstr");
                String artist = songJson.getString("username");
                String artistId = songJson.getString("user_id");
                Double duration = songJson.getDouble("duration") / 1000;

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.ME);
                musicInfo.setId(songId);
                musicInfo.setName(name);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setDuration(duration);

                musicInfos.add(musicInfo);
            }
        }

        return new CommonResult<>(musicInfos, total);
    }

    /**
     * 根据用户 id 获取里面歌曲的 id 并获取每首歌曲粗略信息，分页，返回 NetMusicInfo
     */
    public static CommonResult<NetMusicInfo> getMusicInfoInUser(int recordType, NetUserInfo userInfo, int limit, int page) {
        AtomicInteger total = new AtomicInteger();
        List<NetMusicInfo> musicInfos = new LinkedList<>();
        boolean isAll = recordType == 1;

        int source = userInfo.getSource();
        String userId = userInfo.getId();

        // 网易云(程序分页)
        if (source == NetMusicSource.NET_CLOUD) {
            String userInfoBody = HttpRequest.get(String.format(USER_SONGS_API, recordType ^ 1, userId))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONArray songArray = userInfoJson.optJSONArray(isAll ? "allData" : "weekData");
            if (songArray != null) {
                total.set(songArray.size());
                for (int i = (page - 1) * limit, len = Math.min(songArray.size(), page * limit); i < len; i++) {
                    JSONObject songJson = songArray.getJSONObject(i).getJSONObject("song");

                    String songId = songJson.getString("id");
                    String name = songJson.getString("name").trim();
                    String artist = parseArtists(songJson, NetMusicSource.NET_CLOUD);
                    String artistId = songJson.getJSONArray("ar").getJSONObject(0).getString("id");
                    String albumName = songJson.getJSONObject("al").getString("name");
                    String albumId = songJson.getJSONObject("al").getString("id");
                    String albumImgUrl = songJson.getJSONObject("al").getString("picUrl");
                    Double duration = songJson.getDouble("dt") / 1000;

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setId(songId);
                    musicInfo.setName(name);
                    musicInfo.setArtist(artist);
                    musicInfo.setArtistId(artistId);
                    musicInfo.setAlbumName(albumName);
                    musicInfo.setAlbumId(albumId);
                    musicInfo.setDuration(duration);
                    musicInfos.add(musicInfo);
                }
            }
        }

        // 喜马拉雅
        else if (source == NetMusicSource.XM) {
            String userInfoBody = HttpRequest.get(String.format(USER_PROGRAMS_XM_API, userId, recordType + 1, page, limit))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject data = userInfoJson.getJSONObject("data");
            JSONArray songArray = data.getJSONArray("trackList");
            total.set(data.getInt("totalCount"));
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("trackId");
                String name = songJson.getString("title");
                String artist = songJson.getString("nickname");
                String artistId = songJson.getString("anchorUid");
                String albumName = songJson.getString("albumTitle");
                String albumId = songJson.getString("albumId");
                Double duration = songJson.getDouble("length");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.XM);
                musicInfo.setId(songId);
                musicInfo.setName(name);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);
                musicInfos.add(musicInfo);
            }
        }

        // 音乐磁场
        else if (source == NetMusicSource.HF) {
            String userInfoBody = HttpRequest.get(String.format(USER_PROGRAMS_HF_API, userId, page))
                    .cookie(HF_COOKIE)
                    .execute()
                    .body();
            Document doc = Jsoup.parse(userInfoBody);
            Elements songs = doc.select(".media.thread.tap");
            Elements ap = doc.select("a.page-link");
            String ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 1).text(), 1);
            if (StringUtil.isEmpty(ts))
                ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 2).text(), 1);
            boolean hasTs = StringUtil.isNotEmpty(ts);
            if (hasTs) total.set(Integer.parseInt(ts) * limit);
            else total.set(songs.size());
            for (int i = 0, len = songs.size(); i < len; i++) {
                Element song = songs.get(i);

                Elements a = song.select(".subject.break-all a");
                // 用户没有帖子直接跳过
                if (a.isEmpty()) continue;
                Element span = song.select(".username.text-grey.mr-1").first();

                String songId = ReUtil.get("thread-(.*?)\\.htm", a.attr("href"), 1);
                String songName = a.text();
                String artist = span.text();
                String artistId = span.attr("uid");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.HF);
                musicInfo.setId(songId);
                musicInfo.setName(songName);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);

                musicInfos.add(musicInfo);
            }
        }

        // 咕咕咕音乐
        else if (source == NetMusicSource.GG) {
            String userInfoBody = HttpRequest.get(String.format(USER_PROGRAMS_GG_API, userId, page))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(userInfoBody);
            Elements songs = doc.select(".media.thread.tap");
            Elements ap = doc.select("a.page-link");
            String ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 1).text(), 1);
            if (StringUtil.isEmpty(ts))
                ts = ReUtil.get("(\\d+)", ap.isEmpty() ? "" : ap.get(ap.size() - 2).text(), 1);
            boolean hasTs = StringUtil.isNotEmpty(ts);
            if (hasTs) total.set(Integer.parseInt(ts) * limit);
            else total.set(songs.size());
            for (int i = 0, len = songs.size(); i < len; i++) {
                Element song = songs.get(i);

                Elements a = song.select(".subject.break-all a");
                // 用户没有帖子直接跳过
                if (a.isEmpty()) continue;

                String songId = ReUtil.get("thread-(.*?)\\.htm", a.attr("href"), 1);
                String songName = a.text();

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.GG);
                musicInfo.setId(songId);
                musicInfo.setName(songName);

                musicInfos.add(musicInfo);
            }
        }

        // 猫耳
        else if (source == NetMusicSource.ME) {
            String userInfoBody = HttpRequest.get(String.format(USER_PROGRAMS_ME_API, recordType, userId, page, limit))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject data = userInfoJson.getJSONObject("info");
            JSONArray songArray = data.getJSONArray("Datas");
            total.set(data.getJSONObject("pagination").getInt("count"));
            for (int i = 0, len = songArray.size(); i < len; i++) {
                JSONObject songJson = songArray.getJSONObject(i);

                String songId = songJson.getString("id");
                String name = songJson.getString("soundstr");
                String artist = userInfo.getName();
                String artistId = userInfo.getId();
                Double duration = songJson.getDouble("duration") / 1000;

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.ME);
                musicInfo.setId(songId);
                musicInfo.setName(name);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setDuration(duration);
                musicInfos.add(musicInfo);
            }
        }

        // 哔哩哔哩
        else if (source == NetMusicSource.BI) {
            String userInfoBody = HttpRequest.get(String.format(USER_AUDIO_BI_API, recordType + 1, userId, page, limit))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject data = userInfoJson.getJSONObject("data");
            total.set(data.getInt("totalSize"));
            JSONArray songArray = data.optJSONArray("data");
            if (songArray != null) {
                for (int i = 0, len = songArray.size(); i < len; i++) {
                    JSONObject songJson = songArray.getJSONObject(i);

                    String songId = songJson.getString("id");
                    String name = songJson.getString("title");
                    String artist = songJson.getString("uname");
                    String artistId = songJson.getString("uid");
                    Double duration = songJson.getDouble("duration");

                    NetMusicInfo musicInfo = new NetMusicInfo();
                    musicInfo.setSource(NetMusicSource.BI);
                    musicInfo.setId(songId);
                    musicInfo.setName(name);
                    musicInfo.setArtist(artist);
                    musicInfo.setArtistId(artistId);
                    musicInfo.setDuration(duration);
                    musicInfos.add(musicInfo);
                }
            }
        }

        return new CommonResult<>(musicInfos, total.get());
    }

    /**
     * 获取相似歌曲
     *
     * @return
     */
    public static CommonResult<NetMusicInfo> getSimilarSongs(NetMusicInfo netMusicInfo) {
        int source = netMusicInfo.getSource();
        String id = netMusicInfo.getId();

        LinkedList<NetMusicInfo> res = new LinkedList<>();
        Integer t = 0;

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String musicInfoBody = HttpRequest.get(String.format(SIMILAR_SONG_API, id))
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            JSONArray songsArray = musicInfoJson.getJSONArray("songs");
            t = songsArray.size();
            for (int i = 0, len = songsArray.size(); i < len; i++) {
                JSONObject songJson = songsArray.getJSONObject(i);

                String songId = songJson.getString("id");
                String songName = songJson.getString("name").trim();
                String artist = parseArtists(songJson, NetMusicSource.NET_CLOUD);
                String artistId = songJson.getJSONArray("artists").getJSONObject(0).getString("id");
                String albumName = songJson.getJSONObject("album").getString("name");
                String albumId = songJson.getJSONObject("album").getString("id");
                Double duration = songJson.getDouble("duration") / 1000;
                String mvId = songJson.getString("mvid");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setId(songId);
                musicInfo.setName(songName);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);
                musicInfo.setMvId(mvId);

                res.add(musicInfo);
            }
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            // 先根据 mid 获取 id
            String musicInfoBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_QQ_API, id))
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            id = musicInfoJson.getJSONObject("data").getJSONObject("track_info").getString("id");

            musicInfoBody = HttpRequest.get(String.format(SIMILAR_SONG_QQ_API, id))
                    .execute()
                    .body();
            musicInfoJson = JSONObject.fromObject(musicInfoBody);
            JSONArray songsArray = musicInfoJson.getJSONArray("data");
            t = songsArray.size();
            for (int i = 0, len = songsArray.size(); i < len; i++) {
                JSONObject songJson = songsArray.getJSONObject(i);

                String songId = songJson.getString("mid");
                String songName = songJson.getString("name");
                String artist = parseArtists(songJson, NetMusicSource.QQ);
                String artistId = songJson.getJSONArray("singer").getJSONObject(0).getString("mid");
                String albumName = songJson.getJSONObject("album").getString("name");
                String albumId = songJson.getJSONObject("album").getString("mid");
                Double duration = songJson.getDouble("interval");
                String mvId = songJson.getJSONObject("mv").getString("vid");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.QQ);
                musicInfo.setId(songId);
                musicInfo.setName(songName);
                musicInfo.setArtist(artist);
                musicInfo.setArtistId(artistId);
                musicInfo.setAlbumName(albumName);
                musicInfo.setAlbumId(albumId);
                musicInfo.setDuration(duration);
                musicInfo.setMvId(mvId);

                res.add(musicInfo);
            }
        }

        // 音乐磁场
        else if (source == NetMusicSource.HF) {
            String musicInfoBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_HF_API, id))
                    .cookie(HF_COOKIE)
                    .execute()
                    .body();
            Document doc = Jsoup.parse(musicInfoBody);
            Elements songs = doc.select(".relate_post a");
            t = songs.size();
            for (int i = 0, len = songs.size(); i < len; i++) {
                Element song = songs.get(i);

                String songId = ReUtil.get("thread-(.*?)\\.htm", song.attr("href"), 1);
                String songName = song.text();

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.HF);
                musicInfo.setId(songId);
                musicInfo.setName(songName);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        }

        // 咕咕咕音乐
        else if (source == NetMusicSource.GG) {
            String musicInfoBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_GG_API, id))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(musicInfoBody);
            Elements songs = doc.select("ul.text-middle.break-all li a");
            t = songs.size();
            for (int i = 0, len = songs.size(); i < len; i++) {
                Element song = songs.get(i);

                String songId = ReUtil.get("thread-(.*?)\\.htm", song.attr("href"), 1);
                String songName = song.text();

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.GG);
                musicInfo.setId(songId);
                musicInfo.setName(songName);

                res.add(musicInfo);
            }
            return new CommonResult<>(res, t);
        }

        // 猫耳
        else if (source == NetMusicSource.ME) {
            String musicInfoBody = HttpRequest.get(String.format(SIMILAR_SONG_ME_API, id))
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            JSONArray songsArray = musicInfoJson.getJSONObject("info").getJSONArray("sounds");
            t = songsArray.size();
            for (int i = 0, len = songsArray.size(); i < len; i++) {
                JSONObject songJson = songsArray.getJSONObject(i);

                String songId = songJson.getString("id");
                String songName = songJson.getString("soundstr");

                NetMusicInfo musicInfo = new NetMusicInfo();
                musicInfo.setSource(NetMusicSource.ME);
                musicInfo.setId(songId);
                musicInfo.setName(songName);

                res.add(musicInfo);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 获取用户歌单（通过评论）
     *
     * @return
     */
    public static CommonResult<NetPlaylistInfo> getUserPlaylists(NetCommentInfo netCommentInfo, int limit, int page) {
        int source = netCommentInfo.getSource();
        String uid = StringUtil.encode(netCommentInfo.getUserId());

        LinkedList<NetPlaylistInfo> res = new LinkedList<>();
        AtomicInteger total = new AtomicInteger();

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String playlistInfoBody = HttpRequest.get(String.format(USER_PLAYLIST_API, uid))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONArray playlistArray = playlistInfoJson.getJSONArray("playlist");
            total.set(playlistArray.size());
            for (int i = (page - 1) * limit, len = Math.min(playlistArray.size(), page * limit); i < len; i++) {
                JSONObject playlistJson = playlistArray.getJSONObject(i);

                String playlistId = playlistJson.getString("id");
                String playlistName = playlistJson.getString("name");
                String creator = playlistJson.getJSONObject("creator").getString("nickname");
                String creatorId = playlistJson.getJSONObject("creator").getString("userId");
                Long playCount = playlistJson.getLong("playCount");
                Integer trackCount = playlistJson.getInt("trackCount");
                String coverImgThumbUrl = playlistJson.getString("coverImgUrl");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setId(playlistId);
                playlistInfo.setName(playlistName);
                playlistInfo.setCreator(creator);
                playlistInfo.setCreatorId(creatorId);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                playlistInfo.setPlayCount(playCount);
                playlistInfo.setTrackCount(trackCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            Callable<CommonResult<NetPlaylistInfo>> getCreatedPlaylists = () -> {
                LinkedList<NetPlaylistInfo> r = new LinkedList<>();
                Integer t = 0;

                String playlistInfoBody = HttpRequest.get(String.format(USER_CREATED_PLAYLIST_QQ_API, uid))
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                JSONArray playlistArray = playlistInfoJson.getJSONObject("data").getJSONArray("list");
                t = playlistArray.size();
                for (int i = (page - 1) * limit, len = Math.min(playlistArray.size(), page * limit); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("tid");
                    if ("0".equals(playlistId)) continue;
                    String playlistName = playlistJson.getString("diss_name");
                    String creator = netCommentInfo.getUsername();
                    Long playCount = playlistJson.getLong("listen_num");
                    Integer trackCount = playlistJson.getInt("song_cnt");
                    String coverImgThumbUrl = playlistJson.getString("diss_cover");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.QQ);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    playlistInfo.setTrackCount(trackCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    r.add(playlistInfo);
                }

                return new CommonResult<>(r, t);
            };

            Callable<CommonResult<NetPlaylistInfo>> getCollectedPlaylists = () -> {
                LinkedList<NetPlaylistInfo> r = new LinkedList<>();
                Integer t = 0;

                String playlistInfoBody = HttpRequest.get(String.format(USER_COLLECTED_PLAYLIST_QQ_API, uid, page, limit))
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                JSONObject data = playlistInfoJson.getJSONObject("data");
                JSONArray playlistArray = data.getJSONArray("list");
                t = data.getInt("total");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("dissid");
                    if ("0".equals(playlistId)) continue;
                    String playlistName = playlistJson.getString("dissname");
                    String creator = playlistJson.getString("nickname");
                    Long playCount = playlistJson.getLong("listennum");
                    Integer trackCount = playlistJson.getInt("songnum");
                    String coverImgThumbUrl = playlistJson.getString("logo");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.QQ);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    playlistInfo.setTrackCount(trackCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    r.add(playlistInfo);
                }

                return new CommonResult<>(r, t);
            };

            List<Future<CommonResult<NetPlaylistInfo>>> taskList = new LinkedList<>();

            taskList.add(GlobalExecutors.requestExecutor.submit(getCreatedPlaylists));
            taskList.add(GlobalExecutors.requestExecutor.submit(getCollectedPlaylists));

            List<List<NetPlaylistInfo>> rl = new LinkedList<>();
            taskList.forEach(task -> {
                try {
                    CommonResult<NetPlaylistInfo> result = task.get();
                    rl.add(result.data);
                    total.set(Math.max(total.get(), result.total));
                } catch (InterruptedException e) {
                    e.printStackTrace();
                } catch (ExecutionException e) {
                    e.printStackTrace();
                }
            });
            res.addAll(ListUtil.joinAll(rl));
        }

        return new CommonResult<>(res, total.get());
    }

    /**
     * 获取用户专辑（通过评论）
     *
     * @return
     */
    public static CommonResult<NetAlbumInfo> getUserAlbums(NetCommentInfo netCommentInfo, int limit, int page) {
        int source = netCommentInfo.getSource();
        String uid = StringUtil.encode(netCommentInfo.getUserId());

        LinkedList<NetAlbumInfo> res = new LinkedList<>();
        Integer total = 0;

        // QQ
        if (source == NetMusicSource.QQ) {
            String albumInfoBody = HttpRequest.get(String.format(USER_COLLECTED_ALBUM_QQ_API, uid, page, limit))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");
            total = data.getInt("total");
            JSONArray albumArray = data.getJSONArray("list");
            for (int i = 0, len = albumArray.size(); i < len; i++) {
                JSONObject albumJson = albumArray.getJSONObject(i);

                String albumId = albumJson.getString("albummid");
                String albumName = albumJson.getString("albumname");
                String artist = parseArtists(albumJson, NetMusicSource.QQ);
                String artistId = albumJson.getJSONArray("singer").getJSONObject(0).getString("mid");
                String publishTime = TimeUtil.msToDate(albumJson.getLong("pubtime") * 1000);
                Integer songNum = albumJson.getInt("songnum");
                String coverImgThumbUrl = String.format(SINGLE_SONG_IMG_QQ_API, albumId);

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.QQ);
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(albumInfo);
            }
        }

        // 豆瓣
        else if (source == NetMusicSource.DB) {
            final int rn = 15;
            String albumInfoBody = HttpRequest.get(String.format(USER_ALBUM_DB_API, uid, (page - 1) * rn))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(albumInfoBody);
            Elements rs = doc.select("div.item");
            String ts = ReUtil.get("\\((\\d+)\\)", doc.select("div#db-usr-profile div.info h1").text(), 1);
            total = StringUtil.isEmpty(ts) ? rs.size() : Integer.parseInt(ts);
            total += total / rn * 5;
            for (int i = 0, len = rs.size(); i < len; i++) {
                Element radio = rs.get(i);
                Element a = radio.select("li.title a").first();
                Element intro = radio.select("li.intro").first();
                Element img = radio.select("div.pic img").first();

                String radioId = ReUtil.get("subject/(\\d+)/", a.attr("href"), 1);
                String radioName = a.text();
                String coverImgThumbUrl = img.attr("src");
                String[] sp = intro.text().split(" / ");
                String artist = sp[0];
                String pubTime = sp[1];

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.DB);
                albumInfo.setId(radioId);
                albumInfo.setName(radioName);
                albumInfo.setArtist(artist);
                albumInfo.setPublishTime(pubTime);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(albumInfo);
            }
        }

        return new CommonResult<>(res, total);
    }

    /**
     * 获取用户歌单（通过用户）
     *
     * @return
     */
    public static CommonResult<NetPlaylistInfo> getUserPlaylists(NetUserInfo netUserInfo, int limit, int page) {
        int source = netUserInfo.getSource();
        String uid = netUserInfo.getId();

        LinkedList<NetPlaylistInfo> res = new LinkedList<>();
        AtomicInteger total = new AtomicInteger();

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String playlistInfoBody = HttpRequest.get(String.format(USER_PLAYLIST_API, uid))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONArray playlistArray = playlistInfoJson.getJSONArray("playlist");
            total.set(playlistArray.size());
            for (int i = (page - 1) * limit, len = Math.min(playlistArray.size(), page * limit); i < len; i++) {
                JSONObject playlistJson = playlistArray.getJSONObject(i);

                String playlistId = playlistJson.getString("id");
                String playlistName = playlistJson.getString("name");
                String creator = playlistJson.getJSONObject("creator").getString("nickname");
                String creatorId = playlistJson.getJSONObject("creator").getString("userId");
                Long playCount = playlistJson.getLong("playCount");
                Integer trackCount = playlistJson.getInt("trackCount");
                String coverImgThumbUrl = playlistJson.getString("coverImgUrl");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setId(playlistId);
                playlistInfo.setName(playlistName);
                playlistInfo.setCreator(creator);
                playlistInfo.setCreatorId(creatorId);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                playlistInfo.setPlayCount(playCount);
                playlistInfo.setTrackCount(trackCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            Callable<CommonResult<NetPlaylistInfo>> getCreatedPlaylists = () -> {
                LinkedList<NetPlaylistInfo> r = new LinkedList<>();
                Integer t = 0;

                String playlistInfoBody = HttpRequest.get(String.format(USER_CREATED_PLAYLIST_QQ_API, uid))
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                JSONArray playlistArray = playlistInfoJson.getJSONObject("data").getJSONArray("list");
                t = playlistArray.size();
                for (int i = (page - 1) * limit, len = Math.min(playlistArray.size(), page * limit); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("tid");
                    if ("0".equals(playlistId)) continue;
                    String playlistName = playlistJson.getString("diss_name");
                    String creator = netUserInfo.getName();
                    Long playCount = playlistJson.getLong("listen_num");
                    Integer trackCount = playlistJson.getInt("song_cnt");
                    String coverImgThumbUrl = playlistJson.getString("diss_cover");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.QQ);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    playlistInfo.setTrackCount(trackCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    r.add(playlistInfo);
                }

                return new CommonResult<>(r, t);
            };

            Callable<CommonResult<NetPlaylistInfo>> getCollectedPlaylists = () -> {
                LinkedList<NetPlaylistInfo> r = new LinkedList<>();
                Integer t = 0;

                String playlistInfoBody = HttpRequest.get(String.format(USER_COLLECTED_PLAYLIST_QQ_API, uid, page, limit))
                        .execute()
                        .body();
                JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
                JSONObject data = playlistInfoJson.getJSONObject("data");
                JSONArray playlistArray = data.getJSONArray("list");
                t = data.getInt("total");
                for (int i = 0, len = playlistArray.size(); i < len; i++) {
                    JSONObject playlistJson = playlistArray.getJSONObject(i);

                    String playlistId = playlistJson.getString("dissid");
                    if ("0".equals(playlistId)) continue;
                    String playlistName = playlistJson.getString("dissname");
                    String creator = playlistJson.getString("nickname");
                    Long playCount = playlistJson.getLong("listennum");
                    Integer trackCount = playlistJson.getInt("songnum");
                    String coverImgThumbUrl = playlistJson.getString("logo");

                    NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                    playlistInfo.setSource(NetMusicSource.QQ);
                    playlistInfo.setId(playlistId);
                    playlistInfo.setName(playlistName);
                    playlistInfo.setCreator(creator);
                    playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    playlistInfo.setPlayCount(playCount);
                    playlistInfo.setTrackCount(trackCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        playlistInfo.setCoverImgThumb(coverImgThumb);
                    });

                    r.add(playlistInfo);
                }

                return new CommonResult<>(r, t);
            };

            List<Future<CommonResult<NetPlaylistInfo>>> taskList = new LinkedList<>();

            taskList.add(GlobalExecutors.requestExecutor.submit(getCreatedPlaylists));
            taskList.add(GlobalExecutors.requestExecutor.submit(getCollectedPlaylists));

            List<List<NetPlaylistInfo>> rl = new LinkedList<>();
            taskList.forEach(task -> {
                try {
                    CommonResult<NetPlaylistInfo> result = task.get();
                    rl.add(result.data);
                    total.set(Math.max(total.get(), result.total));
                } catch (InterruptedException e) {
                    e.printStackTrace();
                } catch (ExecutionException e) {
                    e.printStackTrace();
                }
            });
            res.addAll(ListUtil.joinAll(rl));
        }

        return new CommonResult<>(res, total.get());
    }

    /**
     * 获取用户专辑（通过用户）
     *
     * @return
     */
    public static CommonResult<NetAlbumInfo> getUserAlbums(NetUserInfo netUserInfo, int limit, int page) {
        int source = netUserInfo.getSource();
        String uid = netUserInfo.getId();

        LinkedList<NetAlbumInfo> res = new LinkedList<>();
        Integer t = 0;

        // QQ
        if (source == NetMusicSource.QQ) {
            String albumInfoBody = HttpRequest.get(String.format(USER_COLLECTED_ALBUM_QQ_API, uid, page, limit))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray albumArray = data.getJSONArray("list");
            for (int i = 0, len = albumArray.size(); i < len; i++) {
                JSONObject albumJson = albumArray.getJSONObject(i);

                String albumId = albumJson.getString("albummid");
                String albumName = albumJson.getString("albumname");
                String artist = parseArtists(albumJson, NetMusicSource.QQ);
                String artistId = albumJson.getJSONArray("singer").getJSONObject(0).getString("mid");
                String publishTime = TimeUtil.msToDate(albumJson.getLong("pubtime") * 1000);
                Integer songNum = albumJson.getInt("songnum");
                String coverImgThumbUrl = String.format(SINGLE_SONG_IMG_QQ_API, albumId);

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.QQ);
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(albumInfo);
            }
        }

        // 豆瓣
        else if (source == NetMusicSource.DB) {
            final int rn = 15;
            String albumInfoBody = HttpRequest.get(String.format(USER_ALBUM_DB_API, uid, (page - 1) * rn))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(albumInfoBody);
            Elements rs = doc.select("div.item");
            String ts = ReUtil.get("\\((\\d+)\\)", doc.select("div#db-usr-profile div.info h1").text(), 1);
            t = StringUtil.isEmpty(ts) ? rs.size() : Integer.parseInt(ts);
            t += t / rn * 5;
            for (int i = 0, len = rs.size(); i < len; i++) {
                Element radio = rs.get(i);
                Element a = radio.select("li.title a").first();
                Element intro = radio.select("li.intro").first();
                Element img = radio.select("div.pic img").first();

                String radioId = ReUtil.get("subject/(\\d+)/", a.attr("href"), 1);
                String radioName = a.text();
                String coverImgThumbUrl = img.attr("src");
                String[] sp = intro.text().split(" / ");
                String artist = sp[0];
                String pubTime = sp[1];

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.DB);
                albumInfo.setId(radioId);
                albumInfo.setName(radioName);
                albumInfo.setArtist(artist);
                albumInfo.setPublishTime(pubTime);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(albumInfo);
            }
        }

        // 堆糖
        else if (source == NetMusicSource.DT) {
            String albumInfoBody = HttpRequest.get(String.format(USER_ALBUM_DT_API, uid, (page - 1) * limit, limit))
                    .execute()
                    .body();
            JSONObject albumInfoJson = JSONObject.fromObject(albumInfoBody);
            JSONObject data = albumInfoJson.getJSONObject("data");
            JSONArray albumArray = data.getJSONArray("object_list");
            t = page * limit;
            if (data.getInt("more") == 1) t++;
            for (int i = 0, len = albumArray.size(); i < len; i++) {
                JSONObject albumJson = albumArray.getJSONObject(i);

                String albumId = albumJson.getString("id");
                String albumName = albumJson.getString("name");
                String artist = albumJson.getJSONObject("user").getString("username");
                String artistId = albumJson.getJSONObject("user").getString("id");
                String publishTime = TimeUtil.msToDate(albumJson.getLong("updated_at_ts") * 1000);
                String coverImgThumbUrl = albumJson.getJSONArray("covers").getString(0);
                Integer songNum = albumJson.getInt("count");

                NetAlbumInfo albumInfo = new NetAlbumInfo();
                albumInfo.setSource(NetMusicSource.DT);
                albumInfo.setId(albumId);
                albumInfo.setName(albumName);
                albumInfo.setArtist(artist);
                albumInfo.setArtistId(artistId);
                albumInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                albumInfo.setPublishTime(publishTime);
                albumInfo.setSongNum(songNum);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    albumInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(albumInfo);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 获取用户电台（通过用户）
     *
     * @return
     */
    public static CommonResult<NetRadioInfo> getUserRadios(NetUserInfo netUserInfo, int limit, int page) {
        int source = netUserInfo.getSource();
        String uid = netUserInfo.getId();

        LinkedList<NetRadioInfo> res = new LinkedList<>();
        AtomicInteger total = new AtomicInteger();

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String radioInfoBody = HttpRequest.get(String.format(USER_RADIO_API, uid))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONArray radioArray = radioInfoJson.getJSONArray("djRadios");
            total.set(radioInfoJson.getInt("count"));
            for (int i = (page - 1) * limit, len = Math.min(radioArray.size(), page * limit); i < len; i++) {
                JSONObject radioJson = radioArray.getJSONObject(i);

                String radioId = radioJson.getString("id");
                String radioName = radioJson.getString("name");
                String dj = radioJson.getJSONObject("dj").getString("nickname");
                String djId = radioJson.getJSONObject("dj").getString("userId");
                Long playCount = radioJson.getLong("playCount");
                Integer trackCount = radioJson.getInt("programCount");
                String category = radioJson.getString("category");
                if (!category.isEmpty()) category += "、" + radioJson.getString("secondCategory");
                String coverImgThumbUrl = radioJson.getString("picUrl");
//                String createTime = TimeUtils.msToDate(radioJson.getLong("createTime"));

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                radioInfo.setDj(dj);
                radioInfo.setDjId(djId);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                radioInfo.setPlayCount(playCount);
                radioInfo.setTrackCount(trackCount);
                radioInfo.setCategory(category);
//                radioInfo.setCreateTime(createTime);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }
        }

        // 喜马拉雅
        else if (source == NetMusicSource.XM) {
            Callable<CommonResult<NetRadioInfo>> getCreatedRadios = () -> {
                LinkedList<NetRadioInfo> r = new LinkedList<>();
                Integer t = 0;

                String radioInfoBody = HttpRequest.get(String.format(USER_RADIO_XM_API, uid, page, limit))
                        .execute()
                        .body();
                JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
                JSONObject data = radioInfoJson.getJSONObject("data");
                JSONArray radioArray = data.getJSONArray("albumList");
                t = data.getInt("totalCount");
                for (int i = 0, len = radioArray.size(); i < len; i++) {
                    JSONObject radioJson = radioArray.getJSONObject(i);

                    String radioId = radioJson.getString("id");
                    String radioName = radioJson.getString("title");
                    String dj = radioJson.getString("anchorNickName");
                    String djId = radioJson.getString("anchorUid");
                    Long playCount = radioJson.getLong("playCount");
                    Integer trackCount = radioJson.getInt("trackCount");
//                String category = radioJson.getString("category");
                    String coverImgThumbUrl = "https:" + radioJson.getString("coverPath");

                    NetRadioInfo radioInfo = new NetRadioInfo();
                    radioInfo.setSource(NetMusicSource.XM);
                    radioInfo.setId(radioId);
                    radioInfo.setName(radioName);
                    radioInfo.setDj(dj);
                    radioInfo.setDjId(djId);
                    radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    radioInfo.setPlayCount(playCount);
                    radioInfo.setTrackCount(trackCount);
//                radioInfo.setCategory(category);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        radioInfo.setCoverImgThumb(coverImgThumb);
                    });

                    r.add(radioInfo);
                }

                return new CommonResult<>(r, t);
            };

            Callable<CommonResult<NetRadioInfo>> getSubRadios = () -> {
                LinkedList<NetRadioInfo> r = new LinkedList<>();
                Integer t = 0;

                String radioInfoBody = HttpRequest.get(String.format(USER_SUB_RADIO_XM_API, uid, page, limit))
                        .execute()
                        .body();
                JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
                JSONObject data = radioInfoJson.getJSONObject("data");
                JSONArray radioArray = data.getJSONArray("albumsInfo");
                t = data.getInt("totalCount");
                for (int i = 0, len = radioArray.size(); i < len; i++) {
                    JSONObject radioJson = radioArray.getJSONObject(i);

                    String radioId = radioJson.getString("id");
                    String radioName = radioJson.getString("title");
                    String dj = radioJson.getJSONObject("anchor").getString("anchorNickName");
                    String djId = radioJson.getJSONObject("anchor").getString("anchorUid");
                    Long playCount = radioJson.getLong("playCount");
                    Integer trackCount = radioJson.getInt("trackCount");
                    String category = radioJson.getString("categoryTitle");
                    String coverImgThumbUrl = "https://imagev2.xmcdn.com/" + radioJson.getString("coverPath");

                    NetRadioInfo radioInfo = new NetRadioInfo();
                    radioInfo.setSource(NetMusicSource.XM);
                    radioInfo.setId(radioId);
                    radioInfo.setName(radioName);
                    radioInfo.setDj(dj);
                    radioInfo.setDjId(djId);
                    radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    radioInfo.setPlayCount(playCount);
                    radioInfo.setTrackCount(trackCount);
                    radioInfo.setCategory(category);

                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        radioInfo.setCoverImgThumb(coverImgThumb);
                    });

                    r.add(radioInfo);
                }

                return new CommonResult<>(r, t);
            };

            List<Future<CommonResult<NetRadioInfo>>> taskList = new LinkedList<>();

            taskList.add(GlobalExecutors.requestExecutor.submit(getCreatedRadios));
            taskList.add(GlobalExecutors.requestExecutor.submit(getSubRadios));

            List<List<NetRadioInfo>> rl = new LinkedList<>();
            taskList.forEach(task -> {
                try {
                    CommonResult<NetRadioInfo> result = task.get();
                    rl.add(result.data);
                    total.set(Math.max(total.get(), result.total));
                } catch (InterruptedException e) {
                    e.printStackTrace();
                } catch (ExecutionException e) {
                    e.printStackTrace();
                }
            });
            res.addAll(ListUtil.joinAll(rl));
        }

        // 猫耳
        else if (source == NetMusicSource.ME) {
            Callable<CommonResult<NetRadioInfo>> getCreatedRadios = () -> {
                LinkedList<NetRadioInfo> r = new LinkedList<>();
                Integer t = 0;

                String radioInfoBody = HttpRequest.get(String.format(USER_RADIO_ME_API, uid, page, limit))
                        .execute()
                        .body();
                JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
                JSONObject data = radioInfoJson.getJSONObject("info");
                JSONArray radioArray = data.getJSONArray("Datas");
                t = data.getJSONObject("pagination").getInt("count");
                for (int i = 0, len = radioArray.size(); i < len; i++) {
                    JSONObject radioJson = radioArray.getJSONObject(i);

                    String radioId = radioJson.getString("id");
                    String radioName = radioJson.getString("name");
//                    String category = radioJson.getString("type_name");
                    String dj = netUserInfo.getName();
                    Long playCount = radioJson.getLong("view_count");
                    String coverImgThumbUrl = radioJson.getString("cover");

                    NetRadioInfo radioInfo = new NetRadioInfo();
                    radioInfo.setSource(NetMusicSource.ME);
                    radioInfo.setId(radioId);
                    radioInfo.setName(radioName);
                    radioInfo.setDj(dj);
                    radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    radioInfo.setPlayCount(playCount);
//                    radioInfo.setCategory(category);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        radioInfo.setCoverImgThumb(coverImgThumb);
                    });

                    r.add(radioInfo);
                }

                return new CommonResult<>(r, t);
            };

            Callable<CommonResult<NetRadioInfo>> getSubRadios = () -> {
                LinkedList<NetRadioInfo> r = new LinkedList<>();
                Integer t = 0;

                String radioInfoBody = HttpRequest.get(String.format(USER_SUB_RADIO_ME_API, uid, page, limit))
                        .execute()
                        .body();
                JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
                JSONObject data = radioInfoJson.getJSONObject("info");
                JSONArray radioArray = data.optJSONArray("Datas");
                if (radioArray != null) {
                    t = data.getJSONObject("pagination").getInt("count");
                    for (int i = 0, len = radioArray.size(); i < len; i++) {
                        JSONObject radioJson = radioArray.getJSONObject(i);

                        String radioId = radioJson.getString("id");
                        String radioName = radioJson.getString("name");
//                    String category = radioJson.getString("type");
                        String coverImgThumbUrl = radioJson.getString("cover");

                        NetRadioInfo radioInfo = new NetRadioInfo();
                        radioInfo.setSource(NetMusicSource.ME);
                        radioInfo.setId(radioId);
                        radioInfo.setName(radioName);
                        radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
//                    radioInfo.setCategory(category);
                        GlobalExecutors.imageExecutor.execute(() -> {
                            BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                            radioInfo.setCoverImgThumb(coverImgThumb);
                        });

                        r.add(radioInfo);
                    }
                }
                return new CommonResult<>(r, t);
            };

            List<Future<CommonResult<NetRadioInfo>>> taskList = new LinkedList<>();

            taskList.add(GlobalExecutors.requestExecutor.submit(getCreatedRadios));
            taskList.add(GlobalExecutors.requestExecutor.submit(getSubRadios));

            List<List<NetRadioInfo>> rl = new LinkedList<>();
            taskList.forEach(task -> {
                try {
                    CommonResult<NetRadioInfo> result = task.get();
                    rl.add(result.data);
                    total.set(Math.max(total.get(), result.total));
                } catch (InterruptedException e) {
                    e.printStackTrace();
                } catch (ExecutionException e) {
                    e.printStackTrace();
                }
            });
            res.addAll(ListUtil.joinAll(rl));
        }

        // 豆瓣
        else if (source == NetMusicSource.DB) {
            Callable<CommonResult<NetRadioInfo>> getRadios = () -> {
                LinkedList<NetRadioInfo> r = new LinkedList<>();
                Integer t = 0;

                final int rn = 15;
                String radioInfoBody = HttpRequest.get(String.format(USER_RADIO_DB_API, uid, (page - 1) * rn))
                        .execute()
                        .body();
                Document doc = Jsoup.parse(radioInfoBody);
                Elements rs = doc.select("div.item");
                String ts = ReUtil.get("\\((\\d+)\\)", doc.select("div#db-usr-profile div.info h1").text(), 1);
                t = StringUtil.isEmpty(ts) ? rs.size() : Integer.parseInt(ts);
                t += t / rn * 5;
                for (int i = 0, len = rs.size(); i < len; i++) {
                    Element radio = rs.get(i);
                    Element a = radio.select("li.title a").first();
                    Element intro = radio.select("li.intro").first();
                    Element img = radio.select("div.pic img").first();

                    String radioId = ReUtil.get("subject/(\\d+)/", a.attr("href"), 1);
                    String radioName = a.text();
                    String dj = StringUtil.shorten(intro.text(), 100);
                    String coverImgThumbUrl = img.attr("src");
                    String category = "电影";

                    NetRadioInfo radioInfo = new NetRadioInfo();
                    radioInfo.setSource(NetMusicSource.DB);
                    radioInfo.setId(radioId);
                    radioInfo.setName(radioName);
                    radioInfo.setDj(dj);
                    radioInfo.setCategory(category);
                    radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        radioInfo.setCoverImgThumb(coverImgThumb);
                    });
                    r.add(radioInfo);
                }
                return new CommonResult<>(r, t);
            };

            // 图书电台
            Callable<CommonResult<NetRadioInfo>> getBookRadios = () -> {
                LinkedList<NetRadioInfo> r = new LinkedList<>();
                Integer t = 0;

                final int rn = 15;
                String radioInfoBody = HttpRequest.get(String.format(USER_BOOK_RADIO_DB_API, uid, (page - 1) * rn))
                        .execute()
                        .body();
                Document doc = Jsoup.parse(radioInfoBody);
                Elements rs = doc.select("li.subject-item");
                String ts = ReUtil.get("\\((\\d+)\\)", doc.select("div#db-usr-profile div.info h1").text(), 1);
                t = StringUtil.isEmpty(ts) ? rs.size() : Integer.parseInt(ts);
                t += t / rn * 5;
                for (int i = 0, len = rs.size(); i < len; i++) {
                    Element radio = rs.get(i);
                    Element a = radio.select("div.info a").first();
                    Element pub = radio.select("div.pub").first();
                    Element img = radio.select("div.pic img").first();

                    String radioId = ReUtil.get("subject/(\\d+)/", a.attr("href"), 1);
                    String radioName = a.text();
                    String dj = pub.text().trim();
                    String coverImgThumbUrl = img.attr("src");
                    String category = "书籍";

                    NetRadioInfo radioInfo = new NetRadioInfo();
                    radioInfo.setType(RadioType.BOOK);
                    radioInfo.setSource(NetMusicSource.DB);
                    radioInfo.setId(radioId);
                    radioInfo.setName(radioName);
                    radioInfo.setDj(dj);
                    radioInfo.setCategory(category);
                    radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        radioInfo.setCoverImgThumb(coverImgThumb);
                    });
                    r.add(radioInfo);
                }
                return new CommonResult<>(r, t);
            };

            List<Future<CommonResult<NetRadioInfo>>> taskList = new LinkedList<>();

            taskList.add(GlobalExecutors.requestExecutor.submit(getRadios));
            taskList.add(GlobalExecutors.requestExecutor.submit(getBookRadios));

            List<List<NetRadioInfo>> rl = new LinkedList<>();
            taskList.forEach(task -> {
                try {
                    CommonResult<NetRadioInfo> result = task.get();
                    rl.add(result.data);
                    total.set(Math.max(total.get(), result.total));
                } catch (InterruptedException e) {
                    e.printStackTrace();
                } catch (ExecutionException e) {
                    e.printStackTrace();
                }
            });
            res.addAll(ListUtil.joinAll(rl));
        }

        return new CommonResult<>(res, total.get());
    }

    /**
     * 获取用户视频 (通过用户)
     *
     * @return
     */
    public static CommonResult<NetMvInfo> getUserVideos(NetUserInfo netUserInfo, int sortType, int page, int limit, String cursor) {
        int source = netUserInfo.getSource();
        String uid = netUserInfo.getId();

        LinkedList<NetMvInfo> res = new LinkedList<>();
        AtomicInteger total = new AtomicInteger();
        AtomicReference<String> cur = new AtomicReference<>();

        String[] orders = {"pubdate", "click", "stow"};

        // 好看
        if (source == NetMusicSource.HK) {
            // 普通视频
            Callable<CommonResult<NetMvInfo>> getNormalVideos = () -> {
                LinkedList<NetMvInfo> r = new LinkedList<>();
                Integer t = 0;

                String mvInfoBody = HttpRequest.get(String.format(USER_VIDEO_HK_API, uid, cursor))
                        .header(Header.COOKIE, HK_COOKIE)
                        .execute()
                        .body();
                JSONObject data = JSONObject.fromObject(mvInfoBody).getJSONObject("data");
                String cs = data.getString("ctime");
                t = data.getInt("has_more") == 0 ? page * limit : (page + 1) * limit;
                JSONArray mvArray = data.getJSONArray("results");
                for (int i = 0, len = mvArray.size(); i < len; i++) {
                    JSONObject mvJson = mvArray.getJSONObject(i).getJSONObject("content");

                    String mvId = mvJson.getString("vid");
                    String mvName = mvJson.getString("title");
                    String artistName = netUserInfo.getName();
                    String creatorId = netUserInfo.getId();
                    String coverImgUrl = mvJson.getString("poster");
                    Long playCount = mvJson.getLong("playcnt");
                    Double duration = TimeUtil.toSeconds(mvJson.getString("duration"));
                    String pubTime = mvJson.getString("publish_time").replaceAll("年|月", "-").replace("日", "");

                    NetMvInfo mvInfo = new NetMvInfo();
                    mvInfo.setSource(NetMusicSource.HK);
                    mvInfo.setId(mvId);
                    mvInfo.setName(mvName);
                    mvInfo.setArtist(artistName);
                    mvInfo.setCreatorId(creatorId);
                    mvInfo.setCoverImgUrl(coverImgUrl);
                    mvInfo.setPlayCount(playCount);
                    mvInfo.setDuration(duration);
                    mvInfo.setPubTime(pubTime);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                        mvInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(mvInfo);
                }

                return new CommonResult<>(r, t, cs);
            };
            // 小视频
            Callable<CommonResult<NetMvInfo>> getSmallVideos = () -> {
                LinkedList<NetMvInfo> r = new LinkedList<>();
                Integer t = 0;

                String mvInfoBody = HttpRequest.get(String.format(USER_SMALL_VIDEO_HK_API, uid))
                        .header(Header.COOKIE, HK_COOKIE)
                        .execute()
                        .body();
                JSONObject data = JSONObject.fromObject(mvInfoBody).getJSONObject("data");
                String cs = data.getString("ctime");
                t = data.getBoolean("has_more") ? (page + 1) * limit : page * limit;
                JSONArray mvArray = data.getJSONArray("results");
                for (int i = 0, len = mvArray.size(); i < len; i++) {
                    JSONObject mvJson = mvArray.getJSONObject(i).getJSONObject("content");

                    String mvId = mvJson.getString("vid");
                    String mvName = mvJson.getString("title");
                    String artistName = netUserInfo.getName();
                    String creatorId = netUserInfo.getId();
                    String coverImgUrl = mvJson.getString("poster");
                    Long playCount = mvJson.getLong("playcnt");
                    Double duration = TimeUtil.toSeconds(mvJson.getString("duration"));
                    String pubTime = mvJson.getString("publish_time").replaceAll("年|月", "-").replace("日", "");

                    NetMvInfo mvInfo = new NetMvInfo();
                    mvInfo.setSource(NetMusicSource.HK);
                    mvInfo.setId(mvId);
                    mvInfo.setName(mvName);
                    mvInfo.setArtist(artistName);
                    mvInfo.setCreatorId(creatorId);
                    mvInfo.setCoverImgUrl(coverImgUrl);
                    mvInfo.setPlayCount(playCount);
                    mvInfo.setDuration(duration);
                    mvInfo.setPubTime(pubTime);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                        mvInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(mvInfo);
                }

                return new CommonResult<>(r, t, cs);
            };
            List<Future<CommonResult<NetMvInfo>>> taskList = new LinkedList<>();

            taskList.add(GlobalExecutors.requestExecutor.submit(getNormalVideos));
            taskList.add(GlobalExecutors.requestExecutor.submit(getSmallVideos));

            List<List<NetMvInfo>> rl = new LinkedList<>();
            taskList.forEach(task -> {
                try {
                    CommonResult<NetMvInfo> result = task.get();
                    rl.add(result.data);
                    total.set(Math.max(total.get(), result.total));
                    // 用普通视频的 cursor
                    if (ListUtil.search(taskList, task) == 0) cur.set(result.cursor);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                } catch (ExecutionException e) {
                    e.printStackTrace();
                }
            });
            res.addAll(ListUtil.joinAll(rl));
        }

        // 哔哩哔哩
        else if (source == NetMusicSource.BI) {
            String mvInfoBody = HttpRequest.get(String.format(USER_VIDEO_BI_API, orders[sortType], uid, page, limit))
                    .cookie(BI_COOKIE)
                    .execute()
                    .body();
            JSONObject data = JSONObject.fromObject(mvInfoBody).getJSONObject("data");
            total.set(data.getJSONObject("page").getInt("count"));
            JSONArray mvArray = data.getJSONObject("list").getJSONArray("vlist");
            for (int i = 0, len = mvArray.size(); i < len; i++) {
                JSONObject mvJson = mvArray.getJSONObject(i);

                String bvId = mvJson.getString("bvid");
                String mvName = mvJson.getString("title");
                String artistName = mvJson.getString("author");
                String creatorId = mvJson.getString("mid");
                String coverImgUrl = mvJson.getString("pic");
                Long playCount = mvJson.getLong("play");
                Double duration = TimeUtil.toSeconds(mvJson.getString("length"));
                String pubTime = TimeUtil.msToDate(mvJson.getLong("created") * 1000);

                NetMvInfo mvInfo = new NetMvInfo();
                mvInfo.setSource(NetMusicSource.BI);
                mvInfo.setBvid(bvId);
                mvInfo.setName(mvName);
                mvInfo.setArtist(artistName);
                mvInfo.setCreatorId(creatorId);
                mvInfo.setCoverImgUrl(coverImgUrl);
                mvInfo.setPlayCount(playCount);
                mvInfo.setDuration(duration);
                mvInfo.setPubTime(pubTime);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                    mvInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(mvInfo);
            }
        }

        return new CommonResult<>(res, total.get(), cur.get());
    }

    /**
     * 获取相关歌单（通过歌曲）
     *
     * @return
     */
    public static CommonResult<NetPlaylistInfo> getRelatedPlaylists(NetMusicInfo netMusicInfo) {
        int source = netMusicInfo.getSource();
        String id = netMusicInfo.getId();

        LinkedList<NetPlaylistInfo> res = new LinkedList<>();
        Integer t = 0;

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String playlistInfoBody = HttpRequest.get(String.format(RELATED_PLAYLIST_API, id))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONArray playlistArray = playlistInfoJson.getJSONArray("playlists");
            t = playlistArray.size();
            for (int i = 0, len = playlistArray.size(); i < len; i++) {
                JSONObject playlistJson = playlistArray.getJSONObject(i);

                String playlistId = playlistJson.getString("id");
                String playlistName = playlistJson.getString("name");
                String creator = playlistJson.getJSONObject("creator").getString("nickname");
                String creatorId = playlistJson.getJSONObject("creator").getString("userId");
                Long playCount = playlistJson.getLong("playCount");
                Integer trackCount = playlistJson.getInt("trackCount");
                String coverImgThumbUrl = playlistJson.getString("coverImgUrl");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setId(playlistId);
                playlistInfo.setName(playlistName);
                playlistInfo.setCreator(creator);
                playlistInfo.setCreatorId(creatorId);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                playlistInfo.setPlayCount(playCount);
                playlistInfo.setTrackCount(trackCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            // 先根据 mid 获取 id
            String musicInfoBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_QQ_API, id))
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            id = musicInfoJson.getJSONObject("data").getJSONObject("track_info").getString("id");

            String playlistInfoBody = HttpRequest.get(String.format(RELATED_PLAYLIST_QQ_API, id))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONArray playlistArray = playlistInfoJson.getJSONArray("data");
            t = playlistArray.size();
            for (int i = 0, len = playlistArray.size(); i < len; i++) {
                JSONObject playlistJson = playlistArray.getJSONObject(i);

                String playlistId = playlistJson.getString("tid");
                String playlistName = playlistJson.getString("dissname");
                String creator = playlistJson.getString("creator");
                Long playCount = playlistJson.getLong("listen_num");
                Integer trackCount = playlistJson.getInt("song_num");
                String coverImgThumbUrl = playlistJson.getString("imgurl");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setSource(NetMusicSource.QQ);
                playlistInfo.setId(playlistId);
                playlistInfo.setName(playlistName);
                playlistInfo.setCreator(creator);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                playlistInfo.setPlayCount(playCount);
                playlistInfo.setTrackCount(trackCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 获取相关歌单（通过歌单）
     *
     * @return
     */
    public static CommonResult<NetPlaylistInfo> getSimilarPlaylists(NetPlaylistInfo netPlaylistInfo) {
        int source = netPlaylistInfo.getSource();
        String id = netPlaylistInfo.getId();

        LinkedList<NetPlaylistInfo> res = new LinkedList<>();
        Integer t = 0;

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String playlistInfoBody = HttpRequest.get(String.format(SIMILAR_PLAYLIST_API, id))
                    .execute()
                    .body();
            JSONObject playlistInfoJson = JSONObject.fromObject(playlistInfoBody);
            JSONArray playlistArray = playlistInfoJson.getJSONArray("playlists");
            t = playlistArray.size();
            for (int i = 0, len = playlistArray.size(); i < len; i++) {
                JSONObject playlistJson = playlistArray.getJSONObject(i);

                String playlistId = playlistJson.getString("id");
                String playlistName = playlistJson.getString("name");
                String creator = playlistJson.getJSONObject("creator").getString("nickname");
                String creatorId = playlistJson.getJSONObject("creator").getString("userId");
//                Long playCount = playlistJson.getLong("playCount");
//                Integer trackCount = playlistJson.getInt("trackCount");
                String coverImgThumbUrl = playlistJson.getString("coverImgUrl");

                NetPlaylistInfo playlistInfo = new NetPlaylistInfo();
                playlistInfo.setId(playlistId);
                playlistInfo.setName(playlistName);
                playlistInfo.setCreator(creator);
                playlistInfo.setCreatorId(creatorId);
                playlistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
//                playlistInfo.setPlayCount(playCount);
//                playlistInfo.setTrackCount(trackCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    playlistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(playlistInfo);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 获取相关 MV (通过歌曲)
     *
     * @return
     */
    public static CommonResult<NetMvInfo> getRelatedMvs(NetMusicInfo netMusicInfo, int limit, int page) {
        int source = netMusicInfo.getSource();
        String id = netMusicInfo.getId();

        LinkedList<NetMvInfo> res = new LinkedList<>();
        Integer t = 0;

        // 网易云(程序分页)
        if (source == NetMusicSource.NET_CLOUD) {
            String mvInfoBody = HttpRequest.get(String.format(RELATED_MLOG_API, id))
                    .execute()
                    .body();
            JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
            JSONArray mvArray = mvInfoJson.getJSONObject("data").getJSONArray("feeds");
            t = mvArray.size();
            for (int i = (page - 1) * limit, len = Math.min(mvArray.size(), page * limit); i < len; i++) {
                JSONObject resource = mvArray.getJSONObject(i).getJSONObject("resource");
                JSONObject mlogBaseData = resource.getJSONObject("mlogBaseData");

                String mvId = mlogBaseData.getString("id");
                String mvName = mlogBaseData.getString("originalTitle").trim();
                if ("null".equals(mvName)) mvName = mlogBaseData.getString("text");
                String artistName = resource.getJSONObject("userProfile").getString("nickname");
                String creatorId = resource.getJSONObject("userProfile").getString("userId");
                String coverImgUrl = mlogBaseData.getString("coverUrl");
                Long playCount = resource.getJSONObject("mlogExtVO").getLong("playCount");
                Double duration = mlogBaseData.getDouble("duration") / 1000;
                String pubTime = TimeUtil.msToDate(mlogBaseData.getLong("pubTime"));

                NetMvInfo mvInfo = new NetMvInfo();
                mvInfo.setType(MvInfoType.MLOG);
                mvInfo.setId(mvId);
                mvInfo.setName(mvName);
                mvInfo.setArtist(artistName);
                mvInfo.setCreatorId(creatorId);
                mvInfo.setCoverImgUrl(coverImgUrl);
                mvInfo.setPlayCount(playCount);
                mvInfo.setDuration(duration);
                mvInfo.setPubTime(pubTime);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                    mvInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(mvInfo);
            }
        }

        // QQ(程序分页)
        else if (source == NetMusicSource.QQ) {
            // 先根据 mid 获取 id
            String musicInfoBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_QQ_API, id))
                    .execute()
                    .body();
            JSONObject musicInfoJson = JSONObject.fromObject(musicInfoBody);
            id = musicInfoJson.getJSONObject("data").getJSONObject("track_info").getString("id");

            String mvInfoBody = HttpRequest.get(String.format(RELATED_MV_QQ_API, id))
                    .execute()
                    .body();
            JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
            JSONArray mvArray = mvInfoJson.getJSONArray("data");
            t = mvArray.size();
            for (int i = (page - 1) * limit, len = Math.min(mvArray.size(), page * limit); i < len; i++) {
                JSONObject mvJson = mvArray.getJSONObject(i);

                String mvId = mvJson.getString("vid");
                String mvName = mvJson.getString("title");
                String artistName = parseArtists(mvJson, NetMusicSource.QQ);
                String creatorId = mvJson.getJSONArray("singers").getJSONObject(0).getString("mid");
                String coverImgUrl = mvJson.getString("picurl");
                Long playCount = mvJson.getLong("playcnt");

                NetMvInfo mvInfo = new NetMvInfo();
                mvInfo.setSource(NetMusicSource.QQ);
                mvInfo.setId(mvId);
                mvInfo.setName(mvName.trim());
                mvInfo.setArtist(artistName);
                mvInfo.setCreatorId(creatorId);
                mvInfo.setCoverImgUrl(coverImgUrl);
                mvInfo.setPlayCount(playCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                    mvInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(mvInfo);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 获取相似 MV (通过 MV)
     *
     * @return
     */
    public static CommonResult<NetMvInfo> getSimilarMvs(NetMvInfo netMvInfo) {
        int source = netMvInfo.getSource();
        String id = netMvInfo.getId();
        String bvid = netMvInfo.getBvid();
        String name = StringUtil.encode(netMvInfo.getName());
        boolean isVideo = netMvInfo.isVideo();
        boolean isMlog = netMvInfo.isMlog();

        LinkedList<NetMvInfo> res = new LinkedList<>();
        Integer t = 0;

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            // 视频
            if (isVideo || isMlog) {
                // Mlog 需要先获取视频 id，并转为视频类型
                if (isMlog) {
                    String body = HttpRequest.get(String.format(MLOG_TO_VIDEO_API, id))
                            .execute()
                            .body();
                    id = JSONObject.fromObject(body).getString("data");
                    netMvInfo.setId(id);
                    netMvInfo.setType(MvInfoType.VIDEO);
                }

                String mvInfoBody = HttpRequest.get(String.format(RELATED_VIDEO_API, id))
                        .execute()
                        .body();
                JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
                JSONArray mvArray = mvInfoJson.getJSONArray("data");
                t = mvArray.size();
                for (int i = 0, len = mvArray.size(); i < len; i++) {
                    JSONObject mvJson = mvArray.getJSONObject(i);

                    String mvId = mvJson.getString("vid");
                    String mvName = mvJson.getString("title");
                    String artistName = parseCreators(mvJson);
                    String creatorId = mvJson.getJSONArray("creator").getJSONObject(0).getString("userId");
                    String coverImgUrl = mvJson.getString("coverUrl");
                    Long playCount = mvJson.getLong("playTime");
                    Double duration = mvJson.getDouble("durationms") / 1000;

                    NetMvInfo mvInfo = new NetMvInfo();
                    mvInfo.setType(MvInfoType.VIDEO);
                    mvInfo.setId(mvId);
                    mvInfo.setName(mvName.trim());
                    mvInfo.setArtist(artistName);
                    mvInfo.setCreatorId(creatorId);
                    mvInfo.setCoverImgUrl(coverImgUrl);
                    mvInfo.setPlayCount(playCount);
                    mvInfo.setDuration(duration);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                        mvInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(mvInfo);
                }
            }
            // MV
            else {
                String mvInfoBody = HttpRequest.get(String.format(SIMILAR_MV_API, id))
                        .execute()
                        .body();
                JSONObject mvInfoJson = JSONObject.fromObject(mvInfoBody);
                JSONArray mvArray = mvInfoJson.getJSONArray("mvs");
                t = mvArray.size();
                for (int i = 0, len = mvArray.size(); i < len; i++) {
                    JSONObject mvJson = mvArray.getJSONObject(i);

                    String mvId = mvJson.getString("id");
                    String mvName = mvJson.getString("name").trim();
                    String artistName = parseArtists(mvJson, NetMusicSource.NET_CLOUD);
                    String creatorId = mvJson.getJSONArray("artists").getJSONObject(0).getString("id");
                    String coverImgUrl = mvJson.getString("cover");
                    Long playCount = mvJson.getLong("playCount");
                    Double duration = mvJson.getDouble("duration") / 1000;

                    NetMvInfo mvInfo = new NetMvInfo();
                    mvInfo.setId(mvId);
                    mvInfo.setName(mvName);
                    mvInfo.setArtist(artistName);
                    mvInfo.setCreatorId(creatorId);
                    mvInfo.setCoverImgUrl(coverImgUrl);
                    mvInfo.setPlayCount(playCount);
                    mvInfo.setDuration(duration);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                        mvInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(mvInfo);
                }
            }
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            String mvInfoBody = HttpRequest.get(String.format(SIMILAR_MV_QQ_API, id))
                    .execute()
                    .body();
            JSONObject data = JSONObject.fromObject(mvInfoBody).getJSONObject("data");
            JSONArray mvArray = data.getJSONArray("recommend");
            t = mvArray.size();
            for (int i = 0, len = mvArray.size(); i < len; i++) {
                JSONObject mvJson = mvArray.getJSONObject(i);

                String mvId = mvJson.getString("vid");
                String mvName = mvJson.getString("name");
                String artistName = mvJson.getString("uploader_nick");
                String creatorId = mvJson.getString("uploader_uin");
                String coverImgUrl = mvJson.getString("cover_pic");
                Long playCount = mvJson.getLong("playcnt");
                Double duration = mvJson.getDouble("duration");
                String pubTime = TimeUtil.msToDate(mvJson.getLong("pubdate") * 1000);

                NetMvInfo mvInfo = new NetMvInfo();
                mvInfo.setSource(NetMusicSource.QQ);
                mvInfo.setId(mvId);
                mvInfo.setName(mvName);
                mvInfo.setArtist(artistName);
                mvInfo.setCreatorId(creatorId);
                mvInfo.setCoverImgUrl(coverImgUrl);
                mvInfo.setPlayCount(playCount);
                mvInfo.setDuration(duration);
                mvInfo.setPubTime(pubTime);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                    mvInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(mvInfo);
            }
        }

        // 好看
        else if (source == NetMusicSource.HK) {
            String mvInfoBody = HttpRequest.get(String.format(SIMILAR_VIDEO_HK_API, name, id))
                    .header(Header.REFERER, String.format("https://haokan.baidu.com/v?vid=%s", id))
                    .execute()
                    .body();
            JSONObject data = JSONObject.fromObject(mvInfoBody).getJSONObject("data").getJSONObject("response");
            JSONArray mvArray = data.getJSONArray("videos");
            t = mvArray.size();
            for (int i = 0, len = mvArray.size(); i < len; i++) {
                JSONObject mvJson = mvArray.getJSONObject(i);

                String mvId = mvJson.getString("id");
                String mvName = mvJson.getString("title");
                String artistName = mvJson.getString("source_name");
                String creatorId = mvJson.getString("mthid");
                String coverImgUrl = mvJson.getString("poster");
                Long playCount = mvJson.getLong("playcnt");
                Double duration = TimeUtil.toSeconds(mvJson.getString("duration"));
                String pubTime = mvJson.getString("publish_time").replaceAll("年|月", "-").replace("日", "");

                NetMvInfo mvInfo = new NetMvInfo();
                mvInfo.setSource(NetMusicSource.HK);
                mvInfo.setId(mvId);
                mvInfo.setName(mvName);
                mvInfo.setArtist(artistName);
                mvInfo.setCreatorId(creatorId);
                mvInfo.setCoverImgUrl(coverImgUrl);
                mvInfo.setPlayCount(playCount);
                mvInfo.setDuration(duration);
                mvInfo.setPubTime(pubTime);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                    mvInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(mvInfo);
            }
        }

        // 哔哩哔哩
        else if (source == NetMusicSource.BI) {
            String mvInfoBody = HttpRequest.get(String.format(SIMILAR_VIDEO_BI_API, bvid))
                    .cookie(BI_COOKIE)
                    .execute()
                    .body();
            JSONArray mvArray = JSONObject.fromObject(mvInfoBody).getJSONArray("data");
            t = mvArray.size();
            for (int i = 0, len = mvArray.size(); i < len; i++) {
                JSONObject mvJson = mvArray.getJSONObject(i);

                String mvId = mvJson.getString("cid");
                String bvId = mvJson.getString("bvid");
                String mvName = mvJson.getString("title");
                String artistName = mvJson.getJSONObject("owner").getString("name");
                String creatorId = mvJson.getJSONObject("owner").getString("mid");
                String coverImgUrl = mvJson.getString("pic");
                Long playCount = mvJson.getJSONObject("stat").getLong("view");
                Double duration = mvJson.getDouble("duration");
                String pubTime = TimeUtil.msToDate(mvJson.getLong("pubdate") * 1000);

                NetMvInfo mvInfo = new NetMvInfo();
                mvInfo.setSource(NetMusicSource.BI);
                mvInfo.setId(mvId);
                mvInfo.setBvid(bvId);
                mvInfo.setName(mvName);
                mvInfo.setArtist(artistName);
                mvInfo.setCreatorId(creatorId);
                mvInfo.setCoverImgUrl(coverImgUrl);
                mvInfo.setPlayCount(playCount);
                mvInfo.setDuration(duration);
                mvInfo.setPubTime(pubTime);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                    mvInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(mvInfo);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 获取视频分集
     *
     * @return
     */
    public static CommonResult<NetMvInfo> getVideoEpisodes(NetMvInfo netMvInfo, int page, int limit) {
        int source = netMvInfo.getSource();
        String bvid = netMvInfo.getBvid();

        LinkedList<NetMvInfo> res = new LinkedList<>();
        Integer t = 0;

        // 哔哩哔哩
        if (source == NetMusicSource.BI) {
            String mvInfoBody = HttpRequest.get(String.format(VIDEO_EPISODES_BI_API, bvid))
                    .cookie(BI_COOKIE)
                    .execute()
                    .body();
            JSONArray mvArray = JSONObject.fromObject(mvInfoBody).optJSONArray("data");
            if (mvArray != null) {
                t = mvArray.size();
                for (int i = (page - 1) * limit, len = Math.min(page * limit, mvArray.size()); i < len; i++) {
                    JSONObject mvJson = mvArray.getJSONObject(i);

                    String mvId = mvJson.getString("cid");
                    String mvName = mvJson.getString("part");
                    String artistName = netMvInfo.getArtist();
                    String creatorId = netMvInfo.getCreatorId();
                    String coverImgUrl = netMvInfo.getCoverImgUrl();
                    Long playCount = netMvInfo.getPlayCount();
                    Double duration = mvJson.getDouble("duration");
                    String pubTime = netMvInfo.getPubTime();

                    NetMvInfo mvInfo = new NetMvInfo();
                    mvInfo.setSource(NetMusicSource.BI);
                    mvInfo.setId(mvId);
                    mvInfo.setBvid(bvid);
                    mvInfo.setName(mvName);
                    mvInfo.setArtist(artistName);
                    mvInfo.setCreatorId(creatorId);
                    mvInfo.setCoverImgUrl(coverImgUrl);
                    mvInfo.setPlayCount(playCount);
                    mvInfo.setDuration(duration);
                    mvInfo.setPubTime(pubTime);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractMvCover(coverImgUrl);
                        mvInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(mvInfo);
                }
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 获取相似专辑
     *
     * @return
     */
    public static CommonResult<NetAlbumInfo> getSimilarAlbums(NetAlbumInfo albumInfo) {
        int source = albumInfo.getSource();
        String id = albumInfo.getId();

        LinkedList<NetAlbumInfo> res = new LinkedList<>();
        Integer t = 0;

        // 豆瓣
        if (source == NetMusicSource.DB) {
            String albumInfoBody = HttpRequest.get(String.format(SIMILAR_ALBUM_DB_API, id))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(albumInfoBody);
            Elements rs = doc.select("dl.subject-rec-list");
            t = rs.size();
            for (int i = 0, len = rs.size(); i < len; i++) {
                Element album = rs.get(i);
                Element a = album.select("dd a").first();
                Element img = album.select("img").first();

                String albumId = ReUtil.get("subject/(\\d+)/", a.attr("href"), 1);
                String albumName = a.text();
                String coverImgThumbUrl = img.attr("src");

                NetAlbumInfo ai = new NetAlbumInfo();
                ai.setSource(NetMusicSource.DB);
                ai.setId(albumId);
                ai.setName(albumName);
                ai.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    ai.setCoverImgThumb(coverImgThumb);
                });
                res.add(ai);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 获取相似歌手 (通过歌手)
     *
     * @return
     */
    public static CommonResult<NetArtistInfo> getSimilarArtists(NetArtistInfo netArtistInfo, int page) {
        int source = netArtistInfo.getSource();
        String id = netArtistInfo.getId();

        LinkedList<NetArtistInfo> res = new LinkedList<>();
        Integer t = 0;

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String artistInfoBody = HttpRequest.get(String.format(SIMILAR_ARTIST_API, id))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONArray artistArray = artistInfoJson.optJSONArray("artists");
            if (artistArray != null) {
                t = artistArray.size();
                for (int i = 0, len = artistArray.size(); i < len; i++) {
                    JSONObject artistJson = artistArray.getJSONObject(i);

                    String artistId = artistJson.getString("id");
                    String artistName = artistJson.getString("name");
                    Integer songNum = artistJson.getInt("musicSize");
                    Integer albumNum = artistJson.getInt("albumSize");
//                Integer mvNum = artistJson.optInt("mvSize");
                    String coverImgThumbUrl = artistJson.getString("img1v1Url");

                    NetArtistInfo artistInfo = new NetArtistInfo();
                    artistInfo.setId(artistId);
                    artistInfo.setName(artistName);
                    artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    artistInfo.setSongNum(songNum);
                    artistInfo.setAlbumNum(albumNum);
//                artistInfo.setMvNum(mvNum);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        artistInfo.setCoverImgThumb(coverImgThumb);
                    });
                    res.add(artistInfo);
                }
            }
        }

        // 酷狗
        else if (source == NetMusicSource.KG) {
            String artistInfoBody = HttpRequest.post(String.format(SIMILAR_ARTIST_KG_API))
                    .body("{\"clientver\":\"9108\",\"mid\":\"286974383886022203545511837994020015101\"," +
                            "\"clienttime\":\"1545746019\",\"key\":\"4c8b684568f03eeef985ae271561bcd8\"," +
                            "\"appid\":\"1005\",\"data\":[{\"author_id\":" + id + "}]}")
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONArray artistArray = artistInfoJson.getJSONArray("data").getJSONArray(0);
            t = artistArray.size();
            for (int i = 0, len = artistArray.size(); i < len; i++) {
                JSONObject artistJson = artistArray.getJSONObject(i);

                String artistId = artistJson.getString("author_id");
                String artistName = artistJson.getString("author_name");
                String coverImgThumbUrl = artistJson.getString("sizable_avatar").replace("{size}", "240");

                NetArtistInfo artistInfo = new NetArtistInfo();
                artistInfo.setSource(NetMusicSource.KG);
                artistInfo.setId(artistId);
                artistInfo.setName(artistName);
                artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    artistInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(artistInfo);
            }
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            String artistInfoBody = HttpRequest.get(String.format(SIMILAR_ARTIST_QQ_API, id))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONArray artistArray = artistInfoJson.getJSONObject("data").optJSONArray("list");
            if (artistArray != null) {
                t = artistArray.size();
                for (int i = 0, len = artistArray.size(); i < len; i++) {
                    JSONObject artistJson = artistArray.getJSONObject(i);

                    String artistId = artistJson.getString("mid");
                    String artistName = artistJson.getString("name");
                    String coverImgThumbUrl = String.format(ARTIST_IMG_QQ_API, artistId);

                    NetArtistInfo artistInfo = new NetArtistInfo();
                    artistInfo.setSource(NetMusicSource.QQ);
                    artistInfo.setId(artistId);
                    artistInfo.setName(artistName);
                    artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        artistInfo.setCoverImgThumb(coverImgThumb);
                    });
                    res.add(artistInfo);
                }
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 获取歌单收藏者
     *
     * @return
     */
    public static CommonResult<NetUserInfo> getPlaylistSubscribers(NetPlaylistInfo netPlaylistInfo, int limit,
                                                                   int page) {
        int source = netPlaylistInfo.getSource();
        String id = netPlaylistInfo.getId();

        LinkedList<NetUserInfo> res = new LinkedList<>();
        Integer t = 0;

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String userInfoBody = HttpRequest.get(String.format(PLAYLIST_SUBSCRIBERS_API, id, (page - 1) * limit, limit))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONArray userArray = userInfoJson.getJSONArray("subscribers");
            t = userInfoJson.getInt("total");
            for (int i = 0, len = userArray.size(); i < len; i++) {
                JSONObject userJson = userArray.getJSONObject(i);

                String userId = userJson.getString("userId");
                String userName = userJson.getString("nickname");
                Integer gen = userJson.getInt("gender");
                String gender = gen == 0 ? "保密" : gen == 1 ? "♂ 男" : "♀ 女";
//                String sign = userJson.getString("signature");
                String avatarThumbUrl = userJson.getString("avatarUrl");
//                Integer follow = userJson.getInt("follows");
//                Integer followed = userJson.getInt("followeds");
//                Integer playlistCount = userJson.getInt("playlistCount");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
//                userInfo.setSign(sign);
//                userInfo.setFollow(follow);
//                userInfo.setFollowed(followed);
//                userInfo.setPlaylistCount(playlistCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(avatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 获取歌手粉丝
     *
     * @return
     */
    public static CommonResult<NetUserInfo> getArtistFans(NetArtistInfo netArtistInfo, int limit, int page) {
        int source = netArtistInfo.getSource();
        String id = netArtistInfo.getId();

        LinkedList<NetUserInfo> res = new LinkedList<>();
        AtomicReference<Integer> t = new AtomicReference<>(0);

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            Runnable getFans = () -> {
                String userInfoBody = HttpRequest.get(String.format(ARTIST_FANS_API, id, (page - 1) * limit, limit))
                        .execute()
                        .body();
                JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
                JSONArray userArray = userInfoJson.getJSONArray("data");
                for (int i = 0, len = userArray.size(); i < len; i++) {
                    JSONObject userJson = userArray.getJSONObject(i).getJSONObject("userProfile");

                    String userId = userJson.getString("userId");
                    String userName = userJson.getString("nickname");
                    Integer gen = userJson.getInt("gender");
                    String gender = gen == 0 ? "保密" : gen == 1 ? "♂ 男" : "♀ 女";
//                    String sign = userJson.getString("signature");
                    String avatarThumbUrl = userJson.getString("avatarUrl");
//                    Integer follow = userJson.getInt("follows");
//                    Integer followed = userJson.getInt("followeds");
//                    Integer playlistCount = userJson.getInt("playlistCount");

                    NetUserInfo userInfo = new NetUserInfo();
                    userInfo.setId(userId);
                    userInfo.setName(userName);
                    userInfo.setGender(gender);
                    userInfo.setAvatarThumbUrl(avatarThumbUrl);
//                    userInfo.setSign(sign);
//                    userInfo.setFollow(follow);
//                    userInfo.setFollowed(followed);
//                    userInfo.setPlaylistCount(playlistCount);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage avatarThumb = extractProfile(avatarThumbUrl);
                        userInfo.setAvatarThumb(avatarThumb);
                    });

                    res.add(userInfo);
                }
            };

            Runnable getFansCnt = () -> {
                String tBody = HttpRequest.get(String.format(ARTIST_FANS_TOTAL_API, id))
                        .execute()
                        .body();
                t.set(JSONObject.fromObject(tBody).getJSONObject("data").getInt("fansCnt"));
            };

            List<Future<?>> taskList = new LinkedList<>();

            taskList.add(GlobalExecutors.requestExecutor.submit(getFans));
            taskList.add(GlobalExecutors.requestExecutor.submit(getFansCnt));

            taskList.forEach(task -> {
                try {
                    task.get();
                } catch (InterruptedException e) {
                    e.printStackTrace();
                } catch (ExecutionException e) {
                    e.printStackTrace();
                }
            });
        }

        // 猫耳
        else if (source == NetMusicSource.ME) {
            String userInfoBody = HttpRequest.get(String.format(ORGANIZATION_STAFFS_ME_API, id, page))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject data = userInfoJson.getJSONObject("info");
            JSONArray userArray = data.getJSONArray("staff");
            t.set(data.getJSONObject("pagination").getInt("count"));
            for (int i = (page - 1) * limit, len = Math.min(page * limit, userArray.size()); i < len; i++) {
                JSONObject userJson = userArray.getJSONObject(i);

                String userId = userJson.getString("id");
                String userName = userJson.getString("name");
                String gender = "保密";
                String avatarThumbUrl = userJson.getString("avatar");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setSource(NetMusicSource.ME);
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);

                String finalAvatarThumbUrl = avatarThumbUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }
        }

        // 豆瓣
        else if (source == NetMusicSource.DB) {
            final int rn = 35;
            String userInfoBody = HttpRequest.get(String.format(ARTIST_FANS_DB_API, id, (page - 1) * rn))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(userInfoBody);
            String ts = ReUtil.get("（(\\d+)）", doc.select("div#content > h1").text(), 1);
            int tn = Integer.parseInt(ts);
            t.set(tn -= tn / rn * 15);
            Elements us = doc.select("dl.obu");
            for (int i = 0, len = us.size(); i < len; i++) {
                Element user = us.get(i);
                Elements a = user.select("dd a");
                Elements img = user.select("img");

                String userId = ReUtil.get("/people/(.*?)/", a.attr("href"), 1);
                String userName = a.text();
                String gender = "保密";
                String src = img.attr("src");
                String avatarThumbUrl = src.contains("/user") ? src.replaceFirst("normal", "large") : src.replaceFirst("/u", "/ul");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setSource(NetMusicSource.DB);
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(avatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }
        }

        return new CommonResult<>(res, t.get());
    }

    /**
     * 获取歌手合作人
     *
     * @return
     */
    public static CommonResult<NetArtistInfo> getArtistBuddies(NetArtistInfo netArtistInfo, int page, int limit) {
        int source = netArtistInfo.getSource();
        String id = netArtistInfo.getId();

        LinkedList<NetArtistInfo> res = new LinkedList<>();
        Integer t = 0;
        final int dbLimit = 10;

        // 猫耳
        if (source == NetMusicSource.ME) {
            String artistInfoBody = HttpRequest.get(String.format(ORGANIZATION_CVS_ME_API, id, page))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject info = artistInfoJson.optJSONObject("info");
            t = info.getJSONObject("pagination").getInt("count");
            JSONArray artistArray = info.getJSONArray("cast");
            for (int i = (page - 1) * limit, len = Math.min(page * limit, artistArray.size()); i < len; i++) {
                JSONObject artistJson = artistArray.getJSONObject(i);

                String artistId = artistJson.getString("id");
                String artistName = artistJson.getString("name");
                String coverImgThumbUrl = artistJson.getString("avatar");

                NetArtistInfo artistInfo = new NetArtistInfo();
                artistInfo.setSource(NetMusicSource.ME);
                artistInfo.setId(artistId);
                artistInfo.setName(artistName);
                artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);

                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    artistInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(artistInfo);
            }
        }

        // 豆瓣
        else if (source == NetMusicSource.DB) {
            String artistInfoBody = HttpRequest.get(String.format(ARTIST_BUDDY_DB_API, id, (page - 1) * dbLimit))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(artistInfoBody);
            Elements cs = doc.select("div.partners.item");
            String ts = ReUtil.get("共(\\d+)条", doc.select("span.count").text(), 1);
            t = StringUtil.isEmpty(ts) ? cs.size() : Integer.parseInt(ts);
            t += t / limit * 10;
            for (int i = 0, len = cs.size(); i < len; i++) {
                Element artist = cs.get(i);
                Element a = artist.select("div.info a").first();
                Element img = artist.select("div.pic img").first();

                String artistId = ReUtil.get("celebrity/(\\d+)/", a.attr("href"), 1);
                String artistName = a.text();
                String coverImgThumbUrl = img.attr("src");

                NetArtistInfo artistInfo = new NetArtistInfo();
                artistInfo.setSource(NetMusicSource.DB);
                artistInfo.setId(artistId);
                artistInfo.setName(artistName);
                artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    artistInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(artistInfo);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 获取歌手电台
     *
     * @return
     */
    public static CommonResult<NetRadioInfo> getArtistRadios(NetArtistInfo netArtistInfo, int page, int limit) {
        int source = netArtistInfo.getSource();
        String id = netArtistInfo.getId();

        LinkedList<NetRadioInfo> res = new LinkedList<>();
        Integer t = 0;
        final int dbLimit = 10;

        // 猫耳
        if (source == NetMusicSource.ME) {
            if (netArtistInfo.isOrganization()) {
                String radioInfoBody = HttpRequest.get(String.format(ORGANIZATION_RADIOS_ME_API, id, page))
                        .execute()
                        .body();
                JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
                JSONObject data = radioInfoJson.getJSONObject("info");
                t = data.getJSONObject("pagination").getInt("count");
                JSONArray radioArray = data.getJSONArray("drama");
                for (int i = (page - 1) * limit, len = Math.min(page * limit, radioArray.size()); i < len; i++) {
                    JSONObject radioJson = radioArray.getJSONObject(i);

                    String radioId = radioJson.getString("id");
                    String radioName = radioJson.getString("name");
                    String dj = netArtistInfo.getName();
                    String coverImgThumbUrl = "https:" + radioJson.getString("cover");

                    NetRadioInfo radioInfo = new NetRadioInfo();
                    radioInfo.setSource(NetMusicSource.ME);
                    radioInfo.setId(radioId);
                    radioInfo.setName(radioName);
                    radioInfo.setDj(dj);
                    radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        radioInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(radioInfo);
                }
            } else {
                String radioInfoBody = HttpRequest.get(String.format(CV_DETAIL_ME_API, id, page, limit))
                        .execute()
                        .body();
                JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
                JSONObject data = radioInfoJson.getJSONObject("info").getJSONObject("dramas");
                JSONArray radioArray = data.getJSONArray("Datas");
                t = data.getJSONObject("pagination").getInt("count");
                for (int i = 0, len = radioArray.size(); i < len; i++) {
                    JSONObject radioJson = radioArray.getJSONObject(i).getJSONObject("drama");

                    String radioId = radioJson.getString("id");
                    String radioName = radioJson.getString("name");
                    String category = radioJson.getString("catalog_name");
                    String dj = netArtistInfo.getName();
                    Long playCount = radioJson.getLong("view_count");
                    String coverImgThumbUrl = radioJson.getString("cover");

                    NetRadioInfo radioInfo = new NetRadioInfo();
                    radioInfo.setSource(NetMusicSource.ME);
                    radioInfo.setId(radioId);
                    radioInfo.setName(radioName);
                    radioInfo.setDj(dj);
                    radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                    radioInfo.setPlayCount(playCount);
                    radioInfo.setCategory(category);
                    GlobalExecutors.imageExecutor.execute(() -> {
                        BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                        radioInfo.setCoverImgThumb(coverImgThumb);
                    });

                    res.add(radioInfo);
                }
            }
        }

        // 豆瓣
        else if (source == NetMusicSource.DB) {
            String artistInfoBody = HttpRequest.get(String.format(ARTIST_RADIO_DB_API, id, (page - 1) * dbLimit))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(artistInfoBody);
            Elements rs = doc.select("div.grid_view > ul > li > dl");
            String ts = ReUtil.get("共(\\d+)条", doc.select("span.count").text(), 1);
            t = StringUtil.isEmpty(ts) ? rs.size() : Integer.parseInt(ts);
            t += t / limit * 10;
            for (int i = 0, len = rs.size(); i < len; i++) {
                Element radio = rs.get(i);
                Element a = radio.select("h6 a").first();
                Element span = radio.select("h6 span").first();
                Element img = radio.select("img").first();
                Elements dl = radio.select("dl > dd > dl");

                String radioId = ReUtil.get("subject/(\\d+)/", a.attr("href"), 1);
                String radioName = a.text();
                String dj = dl.text().trim();
                String coverImgThumbUrl = img.attr("src");
                String category = ReUtil.get("(\\d+)", span.text(), 1);

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setSource(NetMusicSource.DB);
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                radioInfo.setDj(dj);
                radioInfo.setCategory(category);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(radioInfo);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 获取电台订阅者
     *
     * @return
     */
    public static CommonResult<NetUserInfo> getRadioSubscribers(NetRadioInfo netRadioInfo, int limit, int page) {
        int source = netRadioInfo.getSource();
        String id = netRadioInfo.getId();

        LinkedList<NetUserInfo> res = new LinkedList<>();
        Integer t = 0;

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String userInfoBody = HttpRequest.get(String.format(RADIO_SUBSCRIBERS_API, id))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONArray userArray = userInfoJson.getJSONArray("subscribers");
            t = userArray.size();
            for (int i = (page - 1) * limit, len = Math.min(userArray.size(), page * limit); i < len; i++) {
                JSONObject userJson = userArray.getJSONObject(i);

                String userId = userJson.getString("userId");
                String userName = userJson.getString("nickname");
                Integer gen = userJson.getInt("gender");
                String gender = gen == 0 ? "保密" : gen == 1 ? "♂ 男" : "♀ 女";
//                String sign = userJson.getString("signature");
                String avatarThumbUrl = userJson.getString("avatarUrl");
//                Integer follow = userJson.getInt("follows");
//                Integer followed = userJson.getInt("followeds");
//                Integer playlistCount = userJson.getInt("playlistCount");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
//                userInfo.setSign(sign);
//                userInfo.setFollow(follow);
//                userInfo.setFollowed(followed);
//                userInfo.setPlaylistCount(playlistCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(avatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 获取推荐电台
     *
     * @return
     */
    public static CommonResult<NetRadioInfo> getRecRadios(NetMusicInfo musicInfo) {
        int source = musicInfo.getSource();
        String id = musicInfo.getId();

        LinkedList<NetRadioInfo> res = new LinkedList<>();
        Integer t = 0;

        // 猫耳
        if (source == NetMusicSource.ME) {
            String radioInfoBody = HttpRequest.get(String.format(SONG_REC_RADIO_ME_API, id))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONObject data = radioInfoJson.getJSONObject("info");
            JSONArray radioArray = data.getJSONArray("dramas");
            t = radioArray.size();
            for (int i = 0, len = radioArray.size(); i < len; i++) {
                JSONObject radioJson = radioArray.getJSONObject(i);

                String radioId = radioJson.getString("id");
                String radioName = radioJson.getString("name");
                String coverImgThumbUrl = radioJson.getString("front_cover");
                Long playCount = radioJson.getLong("view_count");

                NetRadioInfo radioInfo = new NetRadioInfo();
                radioInfo.setSource(NetMusicSource.ME);
                radioInfo.setId(radioId);
                radioInfo.setName(radioName);
                radioInfo.setPlayCount(playCount);
                radioInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    radioInfo.setCoverImgThumb(coverImgThumb);
                });

                res.add(radioInfo);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 获取相似电台
     *
     * @return
     */
    public static CommonResult<NetRadioInfo> getSimilarRadios(NetRadioInfo radioInfo) {
        int source = radioInfo.getSource();
        String id = radioInfo.getId();
        boolean isBook = radioInfo.isBook();
        boolean isGame = radioInfo.isGame();

        LinkedList<NetRadioInfo> res = new LinkedList<>();
        Integer t = 0;

        // 豆瓣
        if (source == NetMusicSource.DB) {
            String artistInfoBody = HttpRequest.get(String.format(isBook ? SIMILAR_BOOK_RADIO_DB_API
                            : isGame ? SIMILAR_GAME_RADIO_DB_API : SIMILAR_RADIO_DB_API, id))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(artistInfoBody);
            Elements rs = doc.select(isBook ? "div#db-rec-section dl:not(.clear)"
                    : isGame ? "div.list.fav-list li" : "div.recommendations-bd dl");
            t = rs.size();
            for (int i = 0, len = rs.size(); i < len; i++) {
                Element radio = rs.get(i);
                Element a = radio.select(isGame ? "div.text a" : "dd a").first();
                Element img = radio.select("img").first();

                String radioId = ReUtil.get(isGame ? "game/(\\d+)/" : "subject/(\\d+)/", a.attr("href"), 1);
                String radioName = a.text().trim();
                String coverImgThumbUrl = img.attr("src");

                NetRadioInfo ri = new NetRadioInfo();
                ri.setType(isBook ? RadioType.BOOK : isGame ? RadioType.GAME : RadioType.RADIO);
                ri.setSource(NetMusicSource.DB);
                ri.setId(radioId);
                ri.setName(radioName);
                ri.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    ri.setCoverImgThumb(coverImgThumb);
                });
                res.add(ri);
            }
        }

        // 猫耳
        else if (source == NetMusicSource.ME) {
            String radioInfoBody = HttpRequest.get(String.format(SIMILAR_RADIO_ME_API, id))
                    .execute()
                    .body();
            JSONObject radioInfoJson = JSONObject.fromObject(radioInfoBody);
            JSONObject data = radioInfoJson.getJSONObject("info");
            JSONArray radioArray = data.getJSONArray("recommend");
            t = radioArray.size();
            for (int i = 0, len = radioArray.size(); i < len; i++) {
                JSONObject radioJson = radioArray.getJSONObject(i);

                String radioId = radioJson.getString("id");
                String radioName = radioJson.getString("name");
                String coverImgThumbUrl = radioJson.getString("front_cover");
                Long playCount = radioJson.getLong("view_count");

                NetRadioInfo ri = new NetRadioInfo();
                ri.setSource(NetMusicSource.ME);
                ri.setId(radioId);
                ri.setName(radioName);
                ri.setPlayCount(playCount);
                ri.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    ri.setCoverImgThumb(coverImgThumb);
                });

                res.add(ri);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 获取电台演职员
     *
     * @return
     */
    public static CommonResult<NetArtistInfo> getRadioArtists(NetRadioInfo netRadioInfo) {
        int source = netRadioInfo.getSource();
        String id = netRadioInfo.getId();
        boolean isBook = netRadioInfo.isBook();

        LinkedList<NetArtistInfo> res = new LinkedList<>();
        Integer t = 0;

        // 猫耳
        if (source == NetMusicSource.ME) {
            String artistInfoBody = HttpRequest.get(String.format(RADIO_CVS_ME_API, id))
                    .execute()
                    .body();
            JSONObject artistInfoJson = JSONObject.fromObject(artistInfoBody);
            JSONObject data = artistInfoJson.getJSONObject("info");
            JSONArray artistArray = data.getJSONArray("cvs");
            t = artistArray.size();
            for (int i = 0, len = artistArray.size(); i < len; i++) {
                JSONObject artistJson = artistArray.getJSONObject(i).getJSONObject("cv_info");

                String artistId = artistJson.getString("id");
                String artistName = artistJson.getString("name");
                String avatarThumbUrl = artistJson.getString("icon");

                NetArtistInfo artistInfo = new NetArtistInfo();
                artistInfo.setSource(NetMusicSource.ME);
                artistInfo.setId(artistId);
                artistInfo.setName(artistName);
                artistInfo.setCoverImgThumbUrl(avatarThumbUrl);

                String finalAvatarThumbUrl = avatarThumbUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                    artistInfo.setCoverImgThumb(avatarThumb);
                });

                res.add(artistInfo);
            }
        }

        // 豆瓣
        else if (source == NetMusicSource.DB && !isBook) {
            String artistInfoBody = HttpRequest.get(String.format(RADIO_ARTISTS_DB_API, id))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(artistInfoBody);
            Elements cs = doc.select("li.celebrity");
            t = cs.size();
            for (int i = 0, len = cs.size(); i < len; i++) {
                Element artist = cs.get(i);
                Element a = artist.select("span.name a").first();
                Element img = artist.select("div.avatar").first();

                String artistId = ReUtil.get("celebrity/(\\d+)/", a.attr("href"), 1);
                String artistName = a.text();
                String coverImgThumbUrl = ReUtil.get("url\\((.*?)\\)", img.attr("style"), 1);

                NetArtistInfo artistInfo = new NetArtistInfo();
                artistInfo.setSource(NetMusicSource.DB);
                artistInfo.setId(artistId);
                artistInfo.setName(artistName);
                artistInfo.setCoverImgThumbUrl(coverImgThumbUrl);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(coverImgThumbUrl);
                    artistInfo.setCoverImgThumb(coverImgThumb);
                });
                res.add(artistInfo);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 获取用户实体 (通过用户 id)
     *
     * @return
     */
    public static CommonResult<NetUserInfo> getUserInfo(String id, int source) {
        LinkedList<NetUserInfo> res = new LinkedList<>();
        Integer t = 1;

        if (!"0".equals(id) && !"null".equals(id) && StringUtil.isNotEmpty(id)) {
            // 网易云
            if (source == NetMusicSource.NET_CLOUD) {
                String userInfoBody = HttpRequest.get(String.format(USER_DETAIL_API, id))
                        .execute()
                        .body();
                JSONObject userJson = JSONObject.fromObject(userInfoBody).getJSONObject("profile");

                String userId = userJson.getString("userId");
                String userName = userJson.getString("nickname");
                Integer gen = userJson.getInt("gender");
                String gender = gen == 0 ? "保密" : gen == 1 ? "♂ 男" : "♀ 女";
                String accAge = TimeUtil.getAccAge(userJson.getLong("createTime"));
                String avatarThumbUrl = userJson.getString("avatarUrl");
                Integer follow = userJson.getInt("follows");
                Integer followed = userJson.getInt("followeds");
                Integer playlistCount = userJson.getInt("playlistCount");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setGender(gender);
                userInfo.setAccAge(accAge);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
                userInfo.setFollow(follow);
                userInfo.setFollowed(followed);
                userInfo.setPlaylistCount(playlistCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(avatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }

            // 喜马拉雅
            else if (source == NetMusicSource.XM) {
                String userInfoBody = HttpRequest.get(String.format(USER_DETAIL_XM_API, id))
                        .execute()
                        .body();
                JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
                JSONObject data = userInfoJson.getJSONObject("data");

                String userId = data.getString("uid");
                String userName = data.getString("nickName");
                Integer gen = data.getInt("gender");
                String gender = gen == 0 ? "保密" : gen == 1 ? "♂ 男" : "♀ 女";
                String avatarThumbUrl = "http:" + data.getString("cover");
                Integer follow = data.getInt("followingCount");
                Integer followed = data.getInt("fansCount");
                Integer radioCount = data.getInt("albumsCount");
                Integer programCount = data.getInt("tracksCount");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setSource(NetMusicSource.XM);
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
                userInfo.setFollow(follow);
                userInfo.setFollowed(followed);
                userInfo.setRadioCount(radioCount);
                userInfo.setProgramCount(programCount);

                String finalAvatarThumbUrl = avatarThumbUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }

            // 音乐磁场
            else if (source == NetMusicSource.HF) {
                String userInfoBody = HttpRequest.get(String.format(USER_DETAIL_HF_API, id))
                        .cookie(HF_COOKIE)
                        .execute()
                        .body();
                Document doc = Jsoup.parse(userInfoBody);

                Elements tc = doc.select(".col-md-2.col-sm-12.text-center");
                Elements b = tc.select("b");
                Elements sm = doc.select(".col-4.col-sm-5");

                String userId = id;
                String userName = b.text().trim();
                String gender = "保密";
                String avatarThumbUrl = "https://www.hifini.com/" + tc.select("img").attr("src");
                String avatarUrl = avatarThumbUrl;
                Integer programCount = Integer.parseInt(ReUtil.get("主题数：(\\d+)", sm.text(), 1));

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setSource(NetMusicSource.HF);
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
                userInfo.setAvatarUrl(avatarUrl);
                userInfo.setProgramCount(programCount);

                String finalAvatarThumbUrl = avatarThumbUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }

            // 咕咕咕音乐
            else if (source == NetMusicSource.GG) {
                String userInfoBody = HttpRequest.get(String.format(USER_DETAIL_GG_API, id))
                        .execute()
                        .body();
                Document doc = Jsoup.parse(userInfoBody);

                Elements tc = doc.select(".col-md-2.col-sm-12.text-center");
                Elements b = tc.select("b");
                Elements sm = doc.select(".col-4.col-sm-5");

                String userId = id;
                String userName = b.text().trim();
                String gender = "保密";
                String avatarThumbUrl = "http://www.gggmusic.com/" + tc.select("img").attr("src");
                String avatarUrl = avatarThumbUrl;
                Integer programCount = Integer.parseInt(ReUtil.get("主题数：(\\d+)", sm.text(), 1));

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setSource(NetMusicSource.GG);
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
                userInfo.setAvatarUrl(avatarUrl);
                userInfo.setProgramCount(programCount);

                String finalAvatarThumbUrl = avatarThumbUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }

            // 猫耳
            else if (source == NetMusicSource.ME) {
                NetUserInfo userInfo = new NetUserInfo();

                Runnable getProgramCount = () -> {
                    // 用户节目数
                    GlobalExecutors.requestExecutor.submit(() -> {
                        String programCountBody = HttpRequest.get(String.format(USER_PROGRAMS_ME_API, 0, id, 1, 1))
                                .execute()
                                .body();
                        Integer programCount = JSONObject.fromObject(programCountBody).getJSONObject("info").getJSONObject("pagination").getInt("count");
                        userInfo.setProgramCount(programCount);
                    });
                };
                Runnable fillUserInfo = () -> {
                    String userInfoBody = HttpRequest.get(String.format(USER_DETAIL_ME_API, id))
                            .execute()
                            .body();
                    Document doc = Jsoup.parse(userInfoBody);

                    userInfo.setSource(NetMusicSource.ME);
                    userInfo.setId(id);
                    Element tun = doc.getElementById("t_u_n");
                    // 判断账号是否已注销
                    if (tun != null) {
                        userInfo.setName(tun.getElementsByTag("a").first().text());
                        String avaUrl = "https:" + doc.getElementById("topusermainicon").getElementsByTag("img").first().attr("src");
                        userInfo.setAvatarThumbUrl(avaUrl);
                        userInfo.setGender("保密");
                        userInfo.setFollow(Integer.parseInt(doc.select(".home-follow span").first().text()));
                        userInfo.setFollowed(Integer.parseInt(doc.select(".home-fans span").first().text()));

                        String finalAvatarThumbUrl = avaUrl;
                        GlobalExecutors.imageExecutor.execute(() -> {
                            BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                            userInfo.setAvatarThumb(avatarThumb);
                        });

                        res.add(userInfo);
                    }
                };

                List<Future<?>> taskList = new LinkedList<>();

                taskList.add(GlobalExecutors.requestExecutor.submit(fillUserInfo));
                taskList.add(GlobalExecutors.requestExecutor.submit(getProgramCount));

                taskList.forEach(task -> {
                    try {
                        task.get();
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    } catch (ExecutionException e) {
                        e.printStackTrace();
                    }
                });
            }

            // 好看
            else if (source == NetMusicSource.HK) {
                String userInfoBody = HttpRequest.get(String.format(USER_DETAIL_HK_API, id))
                        .header(Header.COOKIE, HK_COOKIE)
                        .execute()
                        .body();
                JSONObject data = JSONObject.fromObject(ReUtil.get("\"author_info\":(\\{.*?\\})", userInfoBody, 1));

                String userId = data.getString("id");
                String userName = data.getString("name");
                String gender = "保密";
                String avatarThumbUrl = data.getString("avatar");
                Integer followed = data.getInt("fansCnt");
                Integer programCount = data.getInt("videoCnt");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setSource(NetMusicSource.HK);
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
                userInfo.setFollowed(followed);
                userInfo.setProgramCount(programCount);

                String finalAvatarThumbUrl = avatarThumbUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }

            // 豆瓣
            else if (source == NetMusicSource.DB) {
                String userInfoBody = HttpRequest.get(String.format(USER_DETAIL_DB_API, id))
                        .execute()
                        .body();
                Document doc = Jsoup.parse(userInfoBody);

                Element h1 = doc.select("div.info > h1").first();
                Elements img = doc.select("div.basic-info img");

                if (h1 != null) {
                    String userName = h1.ownText().trim();
                    if (StringUtil.isNotEmpty(userName)) {
                        String gender = "保密";
                        String avatarThumbUrl = img.attr("src");

                        NetUserInfo userInfo = new NetUserInfo();
                        userInfo.setSource(NetMusicSource.DB);
                        userInfo.setId(id);
                        userInfo.setName(userName);
                        userInfo.setGender(gender);
                        userInfo.setAvatarThumbUrl(avatarThumbUrl);
                        GlobalExecutors.imageExecutor.execute(() -> {
                            BufferedImage coverImgThumb = extractProfile(avatarThumbUrl);
                            userInfo.setAvatarThumb(coverImgThumb);
                        });

                        res.add(userInfo);
                    }
                }
            }

            // 哔哩哔哩
            else if (source == NetMusicSource.BI) {
                String userInfoBody = HttpRequest.get(String.format(USER_DETAIL_BI_API, id))
                        .cookie(BI_COOKIE)
                        .execute()
                        .body();
                JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
                JSONObject data = userInfoJson.getJSONObject("data");
                JSONObject card = data.getJSONObject("card");

                String userId = card.getString("mid");
                String userName = card.getString("name");
                String gender = card.getString("sex");
                gender = "男".equals(gender) ? "♂ " + gender : "女".equals(gender) ? "♀ " + gender : "保密";
                String avatarThumbUrl = card.getString("face");
                Integer follow = card.getInt("attention");
                Integer followed = card.getInt("fans");
                Integer programCount = data.getInt("archive_count");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setSource(NetMusicSource.BI);
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
                userInfo.setFollow(follow);
                userInfo.setFollowed(followed);
                userInfo.setProgramCount(programCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage coverImgThumb = extractProfile(avatarThumbUrl);
                    userInfo.setAvatarThumb(coverImgThumb);
                });

                res.add(userInfo);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 获取用户关注 (通过用户)
     *
     * @return
     */
    public static CommonResult<NetUserInfo> getUserFollows(NetUserInfo netUserInfo, int limit, int page) {
        int source = netUserInfo.getSource();
        String id = netUserInfo.getId();

        LinkedList<NetUserInfo> res = new LinkedList<>();
        Integer t = 0;

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String userInfoBody = HttpRequest.get(String.format(USER_FOLLOWS_API, id))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONArray userArray = userInfoJson.getJSONArray("follow");
            t = userArray.size();
            for (int i = (page - 1) * limit, len = Math.min(userArray.size(), page * limit); i < len; i++) {
                JSONObject userJson = userArray.getJSONObject(i);

                String userId = userJson.getString("userId");
                String userName = userJson.getString("nickname");
                Integer gen = userJson.getInt("gender");
                String gender = gen == 0 ? "保密" : gen == 1 ? "♂ 男" : "♀ 女";
//                String sign = userJson.getString("signature");
                String avatarThumbUrl = userJson.getString("avatarUrl");
                Integer follow = userJson.getInt("follows");
                Integer followed = userJson.getInt("followeds");
                Integer playlistCount = userJson.getInt("playlistCount");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
//                userInfo.setSign(sign);
                userInfo.setFollow(follow);
                userInfo.setFollowed(followed);
                userInfo.setPlaylistCount(playlistCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(avatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }
        }

        // 喜马拉雅
        else if (source == NetMusicSource.XM) {
            String userInfoBody = HttpRequest.get(String.format(USER_FOLLOWS_XM_API, id, page, limit))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject data = userInfoJson.getJSONObject("data");
            JSONArray userArray = data.getJSONArray("followingsPageInfo");
            t = data.getInt("totalCount");
            for (int i = 0, len = userArray.size(); i < len; i++) {
                JSONObject userJson = userArray.getJSONObject(i);

                String userId = userJson.getString("uid");
                String userName = userJson.getString("anchorNickName");
//                Integer gen = userJson.getInt("gender");
//                String gender = gen == 0 ? "保密" : gen == 1 ? "♂ 男" : "♀ 女";
                String avatarThumbUrl = "https:" + userJson.getString("coverPath");
                Integer follow = userJson.getInt("followingCount");
                Integer followed = userJson.getInt("followerCount");
                Integer radioCount = userJson.getInt("albumCount");
                Integer programCount = userJson.getInt("trackCount");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setSource(NetMusicSource.XM);
                userInfo.setId(userId);
                userInfo.setName(userName);
//                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
                userInfo.setFollow(follow);
                userInfo.setFollowed(followed);
                userInfo.setRadioCount(radioCount);
                userInfo.setProgramCount(programCount);

                String finalAvatarThumbUrl = avatarThumbUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }
        }

        // 猫耳
        else if (source == NetMusicSource.ME) {
            String userInfoBody = HttpRequest.get(String.format(USER_FOLLOWS_ME_API, id, page, limit))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject data = userInfoJson.getJSONObject("info");
            JSONArray userArray = data.getJSONArray("Datas");
            t = data.getJSONObject("pagination").getInt("count");
            for (int i = 0, len = userArray.size(); i < len; i++) {
                JSONObject userJson = userArray.getJSONObject(i);

                String userId = userJson.getString("id");
                String userName = userJson.getString("username");
                String gender = "保密";
//                String sign = userJson.getString("userintro");
                String avatarThumbUrl = userJson.getString("boardiconurl2");
                Integer followed = userJson.getInt("fansnum");
                Integer programCount = userJson.getInt("soundnumchecked");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setSource(NetMusicSource.ME);
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
                userInfo.setFollowed(followed);
                userInfo.setProgramCount(programCount);
//                userInfo.setSign(sign);

                String finalAvatarThumbUrl = avatarThumbUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }
        }

        // 堆糖
        else if (source == NetMusicSource.DT) {
            String userInfoBody = HttpRequest.get(String.format(USER_FOLLOWS_DT_API, id, (page - 1) * limit, limit))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject data = userInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray userArray = data.getJSONArray("object_list");
            for (int i = 0, len = userArray.size(); i < len; i++) {
                JSONObject userJson = userArray.getJSONObject(i);

                String userId = userJson.getString("id");
                String userName = userJson.getString("username");
                String gender = "保密";
                String avatarThumbUrl = userJson.getString("avatar");
                Integer follow = userJson.getInt("followCount");
                Integer followed = userJson.getInt("beFollowCount");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setSource(NetMusicSource.DT);
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
                userInfo.setFollow(follow);
                userInfo.setFollowed(followed);

                String finalAvatarThumbUrl = avatarThumbUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }
        }

        // 哔哩哔哩
        else if (source == NetMusicSource.BI) {
            String userInfoBody = HttpRequest.get(String.format(USER_FOLLOWS_BI_API, id, page, limit))
                    .cookie(BI_COOKIE)
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject data = userInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray userArray = data.getJSONArray("list");
            for (int i = 0, len = userArray.size(); i < len; i++) {
                JSONObject userJson = userArray.getJSONObject(i);

                String userId = userJson.getString("mid");
                String userName = userJson.getString("uname");
                String avatarThumbUrl = userJson.getString("face");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setSource(NetMusicSource.BI);
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);

                String finalAvatarThumbUrl = avatarThumbUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 获取用户粉丝 (通过用户)
     *
     * @return
     */
    public static CommonResult<NetUserInfo> getUserFolloweds(NetUserInfo netUserInfo, int limit, int page) {
        int source = netUserInfo.getSource();
        String id = netUserInfo.getId();

        LinkedList<NetUserInfo> res = new LinkedList<>();
        Integer t = 0;

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String userInfoBody = HttpRequest.get(String.format(USER_FOLLOWEDS_API, id, (page - 1) * limit, limit))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONArray userArray = userInfoJson.getJSONArray("followeds");
            t = userInfoJson.getInt("size");
            for (int i = 0, len = userArray.size(); i < len; i++) {
                JSONObject userJson = userArray.getJSONObject(i);

                String userId = userJson.getString("userId");
                String userName = userJson.getString("nickname");
                Integer gen = userJson.getInt("gender");
                String gender = gen == 0 ? "保密" : gen == 1 ? "♂ 男" : "♀ 女";
//                String sign = userJson.getString("signature");
                String avatarThumbUrl = userJson.getString("avatarUrl");
                Integer follow = userJson.getInt("follows");
                Integer followed = userJson.getInt("followeds");
                Integer playlistCount = userJson.getInt("playlistCount");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
//                userInfo.setSign(sign);
                userInfo.setFollow(follow);
                userInfo.setFollowed(followed);
                userInfo.setPlaylistCount(playlistCount);
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(avatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }
        }

        // 喜马拉雅
        else if (source == NetMusicSource.XM) {
            String userInfoBody = HttpRequest.get(String.format(USER_FOLLOWEDS_XM_API, id, page, limit))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject data = userInfoJson.getJSONObject("data");
            JSONArray userArray = data.getJSONArray("fansPageInfo");
            t = data.getInt("totalCount");
            for (int i = 0, len = userArray.size(); i < len; i++) {
                JSONObject userJson = userArray.getJSONObject(i);

                String userId = userJson.getString("uid");
                String userName = userJson.getString("anchorNickName");
//                Integer gen = userJson.getInt("gender");
//                String gender = gen == 0 ? "保密" : gen == 1 ? "♂ 男" : "♀ 女";
                String avatarThumbUrl = "https:" + userJson.getString("coverPath");
                Integer follow = userJson.getInt("followingCount");
                Integer followed = userJson.getInt("followerCount");
                Integer radioCount = userJson.getInt("albumCount");
                Integer programCount = userJson.getInt("trackCount");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setSource(NetMusicSource.XM);
                userInfo.setId(userId);
                userInfo.setName(userName);
//                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
                userInfo.setFollow(follow);
                userInfo.setFollowed(followed);
                userInfo.setRadioCount(radioCount);
                userInfo.setProgramCount(programCount);

                String finalAvatarThumbUrl = avatarThumbUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }
        }

        // 猫耳
        else if (source == NetMusicSource.ME) {
            String userInfoBody = HttpRequest.get(String.format(USER_FOLLOWEDS_ME_API, id, page, limit))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject data = userInfoJson.getJSONObject("info");
            JSONArray userArray = data.getJSONArray("Datas");
            t = data.getJSONObject("pagination").getInt("count");
            for (int i = 0, len = userArray.size(); i < len; i++) {
                JSONObject userJson = userArray.getJSONObject(i);

                String userId = userJson.getString("id");
                String userName = userJson.getString("username");
                String gender = "保密";
//                String sign = userJson.getString("userintro");
                String avatarThumbUrl = userJson.getString("boardiconurl2");
                Integer followed = userJson.getInt("fansnum");
                Integer programCount = userJson.getInt("soundnumchecked");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setSource(NetMusicSource.ME);
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
                userInfo.setFollowed(followed);
                userInfo.setProgramCount(programCount);
//                userInfo.setSign(sign);

                String finalAvatarThumbUrl = avatarThumbUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }
        }

        // 堆糖
        else if (source == NetMusicSource.DT) {
            String userInfoBody = HttpRequest.get(String.format(USER_FOLLOWEDS_DT_API, id, (page - 1) * limit, limit))
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject data = userInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray userArray = data.getJSONArray("object_list");
            for (int i = 0, len = userArray.size(); i < len; i++) {
                JSONObject userJson = userArray.getJSONObject(i);

                String userId = userJson.getString("id");
                String userName = userJson.getString("username");
                String gender = "保密";
                String avatarThumbUrl = userJson.getString("avatar");
                Integer follow = userJson.getInt("followCount");
                Integer followed = userJson.getInt("beFollowCount");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setSource(NetMusicSource.DT);
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setGender(gender);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);
                userInfo.setFollow(follow);
                userInfo.setFollowed(followed);

                String finalAvatarThumbUrl = avatarThumbUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }
        }

        // 哔哩哔哩
        else if (source == NetMusicSource.BI) {
            String userInfoBody = HttpRequest.get(String.format(USER_FOLLOWEDS_BI_API, id, page, limit))
                    .cookie(BI_COOKIE)
                    .execute()
                    .body();
            JSONObject userInfoJson = JSONObject.fromObject(userInfoBody);
            JSONObject data = userInfoJson.getJSONObject("data");
            t = data.getInt("total");
            JSONArray userArray = data.getJSONArray("list");
            for (int i = 0, len = userArray.size(); i < len; i++) {
                JSONObject userJson = userArray.getJSONObject(i);

                String userId = userJson.getString("mid");
                String userName = userJson.getString("uname");
                String avatarThumbUrl = userJson.getString("face");

                NetUserInfo userInfo = new NetUserInfo();
                userInfo.setSource(NetMusicSource.BI);
                userInfo.setId(userId);
                userInfo.setName(userName);
                userInfo.setAvatarThumbUrl(avatarThumbUrl);

                String finalAvatarThumbUrl = avatarThumbUrl;
                GlobalExecutors.imageExecutor.execute(() -> {
                    BufferedImage avatarThumb = extractProfile(finalAvatarThumbUrl);
                    userInfo.setAvatarThumb(avatarThumb);
                });

                res.add(userInfo);
            }
        }

        return new CommonResult<>(res, t);
    }

    /**
     * 根据链接获取图片
     */
    public static BufferedImage getImageFromUrl(String url) {
        return ImageUtil.read(HttpRequest.get(url).setFollowRedirects(true).execute().bodyStream());
    }

    /**
     * 解析歌曲艺术家
     */
    public static String parseArtists(JSONObject json, int source) {
        JSONArray artistsArray;
        if (source == NetMusicSource.QQ) {
            artistsArray = json.optJSONArray("singer");
            if (artistsArray == null) artistsArray = json.optJSONArray("singer_list");
            if (artistsArray == null) artistsArray = json.optJSONArray("singers");
            if (artistsArray == null) artistsArray = json.optJSONArray("ar");
        } else if (source == NetMusicSource.KG) {
            artistsArray = json.optJSONArray("authors");
        } else {
            artistsArray = json.optJSONArray("artists");
            if (artistsArray == null) artistsArray = json.optJSONArray("ar");
            if (artistsArray == null) artistsArray = json.optJSONArray("artist");
            if (artistsArray == null) artistsArray = json.optJSONArray("actors");
        }
        if (artistsArray == null) return "";

        StringJoiner sj = new StringJoiner("、");
        for (int i = 0, len = artistsArray.size(); i < len; i++) {
            JSONObject artistJson = artistsArray.getJSONObject(i);
            String name = artistJson.optString("name", null);
            if (name == null) name = artistJson.optString("singer_name", null);
            if (name == null) name = artistJson.getString("author_name");
            sj.add(name);
        }
        return sj.toString();
    }

    /**
     * 连接 Json 数组中的所有字符串
     */
    public static String joinStrings(JSONArray array, int limit) {
        StringBuffer sb = new StringBuffer();
        for (int i = 0, len = array.size(); i < len; i++) {
            sb.append(array.getString(i));
            if (i != len - 1) sb.append("、");
            if (limit > 0 && i >= limit) {
                sb.append("...");
                break;
            }
        }
        return sb.toString();
    }

    /**
     * 解析歌单标签
     */
    public static String parseTags(JSONObject json, int source) {
        JSONArray tagArray;
        StringJoiner sj = new StringJoiner("、");
        if (source == NetMusicSource.NET_CLOUD) {
            tagArray = json.getJSONArray("tags");
            for (int i = 0, len = tagArray.size(); i < len; i++) {
                sj.add(tagArray.getString(i));
            }
        } else if (source == NetMusicSource.QQ) {
            tagArray = json.getJSONArray("tags");
            for (int i = 0, len = tagArray.size(); i < len; i++) {
                JSONObject tagJson = tagArray.getJSONObject(i);
                sj.add(tagJson.getString("name"));
            }
        } else if (source == NetMusicSource.MG) {
            tagArray = json.getJSONArray("tags");
            for (int i = 0, len = tagArray.size(); i < len; i++) {
                JSONObject tagJson = tagArray.getJSONObject(i);
                sj.add(tagJson.getString("tagName"));
            }
        } else if (source == NetMusicSource.XM) {
            tagArray = json.getJSONArray("tags");
            for (int i = 0, len = tagArray.size(); i < len; i++) {
                sj.add(tagArray.getString(i));
            }
        } else if (source == NetMusicSource.QI) {
            tagArray = json.getJSONArray("tagList");
            for (int i = 0, len = tagArray.size(); i < len; i++) {
                sj.add(tagArray.getString(i));
            }
        } else if (source == NetMusicSource.ME) {
            tagArray = json.getJSONArray("tags");
            for (int i = 0, len = tagArray.size(); i < len; i++) {
                JSONObject tagJson = tagArray.getJSONObject(i);
                sj.add(tagJson.getString("name"));
            }
        }
        return sj.toString();
    }

    /**
     * 解析视频作者
     */
    public static String parseCreators(JSONObject json) {
        JSONArray artistsArray = json.getJSONArray("creator");
        StringJoiner sj = new StringJoiner("、");
        for (int i = 0, len = artistsArray.size(); i < len; i++) {
            sj.add(artistsArray.getJSONObject(i).getString("userName"));
        }
        return sj.toString();
    }

    /**
     * 歌曲换源
     *
     * @param musicInfo
     * @return
     */
    public static void fillAvailableMusicUrl(NetMusicInfo musicInfo) {
        CommonResult<NetMusicInfo> result = searchMusic(NetMusicSource.ALL, 0, "默认", musicInfo.toKeywords(), 10, 1);
        List<NetMusicInfo> data = result.data;
        for (NetMusicInfo info : data) {
            // 部分歌曲没有时长，先填充时长，准备判断
            if (!info.hasDuration()) fillDuration(info);
            // 匹配依据：歌名、歌手相似度，时长之差绝对值
            if (info.equals(musicInfo)
                    || StringUtil.similar(info.getName(), musicInfo.getName()) == 0
                    || StringUtil.similar(info.getArtist(), musicInfo.getArtist()) == 0
                    || info.hasDuration() && musicInfo.hasDuration() && Math.abs(info.getDuration() - musicInfo.getDuration()) > 3)
                continue;
            String url = fetchMusicUrl(info.getId(), info.getSource());
            if (StringUtil.isNotEmpty(url)) {
                if (url.contains(".m4a")) musicInfo.setFormat(Format.M4A);
                musicInfo.setUrl(url);
                if (!musicInfo.hasDuration()) musicInfo.setDuration(info.getDuration());
                return;
            }
        }
    }

    /**
     * 根据歌曲 id 获取歌曲地址
     */
    public static String fetchMusicUrl(String songId, int source) {
        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            // 首选高音质接口
            String songBody = HttpRequest.get(String.format(GET_SONG_URL_API_NEW, songId))
                    .execute()
                    .body();
            JSONArray data = JSONObject.fromObject(songBody).optJSONArray("data");
            // 次选普通音质
            if (data == null) {
                songBody = HttpRequest.get(String.format(GET_SONG_URL_API, songId))
                        .execute()
                        .body();
                data = JSONObject.fromObject(songBody).optJSONArray("data");
            }
            if (data != null) {
                JSONObject urlJson = data.getJSONObject(0);
                // 排除试听部分，直接换源
                if (urlJson.getJSONObject("freeTrialInfo").isNullObject()) {
                    String url = urlJson.getString("url");
                    if (!"null".equals(url)) return url;
                }
            }
        }

        // 酷狗(歌曲详情能直接请求到 url，不需要单独调用此方法)
        else if (source == NetMusicSource.KG) {
            // 酷狗接口请求需要带上 cookie ！
            String songBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_KG_API, songId))
                    .header(Header.COOKIE, COOKIE)
                    .execute()
                    .body();
            JSONObject data = JSONObject.fromObject(songBody).getJSONObject("data");
            String url = data.optString("play_url");
            if (data.optInt("is_free_part") == 0) return url;
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            String playUrlBody = HttpRequest.get(qqSearchApi + "?format=json&data=" +
                            StringUtil.encode(String.format("{\"req_0\":{\"module\":\"vkey.GetVkeyServer\",\"method\"" +
                                    ":\"CgiGetVkey\",\"param\":{\"filename\":[\"M500%s%s.mp3\"],\"guid\":\"10000\"" +
                                    ",\"songmid\":[\"%s\"],\"songtype\":[0],\"uin\":\"0\",\"loginflag\":1,\"platform\":\"20\"}}" +
                                    ",\"loginUin\":\"0\",\"comm\":{\"uin\":\"0\",\"format\":\"json\",\"ct\":24,\"cv\":0}}", songId, songId, songId)))
                    .execute()
                    .body();
            JSONObject urlJson = JSONObject.fromObject(playUrlBody);
            JSONObject data = urlJson.getJSONObject("req_0").getJSONObject("data");
            String sip = data.getJSONArray("sip").getString(0);
            String url = data.getJSONArray("midurlinfo").getJSONObject(0).getString("purl");
            return url.isEmpty() ? "" : sip + url;
        }

        // 酷我(解锁付费音乐)
        else if (source == NetMusicSource.KW) {
//            String urlBody = HttpRequest.get(String.format(GET_SONG_URL_KW_API, songId))
//                    .header(Header.REFERER, "https://www.kuwo.cn/")
//                    .execute()
//                    .body();
//            return urlBody;
            String urlBody = HttpRequest.get(String.format(GET_SONG_URL_KW_API, songId))
                    .execute()
                    .body();
            JSONObject urlJson = JSONObject.fromObject(urlBody);
            JSONObject data = urlJson.getJSONObject("data");
            return data.getString("url");
        }

        // 咪咕
        else if (source == NetMusicSource.MG) {
            String songBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_MG_API, songId))
                    .execute()
                    .body();
            JSONObject data = JSONObject.fromObject(songBody).getJSONObject("data");
            return data.getString("320");
        }

        // 千千
        else if (source == NetMusicSource.QI) {
            String playUrlBody = HttpRequest.get(buildQianUrl(String.format(GET_SONG_URL_QI_API, songId, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject urlJson = JSONObject.fromObject(playUrlBody).getJSONObject("data");
            // 排除试听部分，直接换源
            if (urlJson.getInt("isVip") == 0) {
                String url = urlJson.optString("path");
                if (url.isEmpty()) url = urlJson.getJSONObject("trail_audio_info").getString("path");
                return url;
            }
        }

        // 音乐磁场
        else if (source == NetMusicSource.HF) {
            String songBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_HF_API, songId))
                    .cookie(HF_COOKIE)
                    .execute()
                    .body();
            Document doc = Jsoup.parse(songBody);
            String dataStr = ReUtil.get("music: \\[.*?(\\{.*?\\}).*?\\]", doc.html(), 1);
            if (StringUtil.isEmpty(dataStr)) return "";
            JSONObject data = JSONObject.fromObject(dataStr);
            String url = data.getString("url").replace(" ", "%20");
            if (url.startsWith("http")) return url;
            else {
                try {
                    // 获取重定向之后的 url
                    HttpURLConnection conn = (HttpURLConnection) new URL("https://www.hifini.com/" + url).openConnection();
                    conn.setInstanceFollowRedirects(false);
                    conn.setConnectTimeout(5000);
                    return conn.getHeaderField("Location");
                } catch (IOException e) {
                    return "";
                }
            }
        }

        // 咕咕咕音乐
        else if (source == NetMusicSource.GG) {
            String songBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_GG_API, songId))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(songBody);
            String dataStr = ReUtil.get("audio: \\[.*?(\\{.*?\\}).*?\\]", doc.html(), 1);
            if (StringUtil.isEmpty(dataStr)) return "";
            JSONObject data = JSONObject.fromObject(dataStr);
            String url = data.getString("url").replace(" ", "%20");
            if (url.startsWith("http")) return url;
            else {
                try {
                    // 获取重定向之后的 url
                    String startUrl = "http://www.gggmusic.com" + url;
                    HttpURLConnection conn = (HttpURLConnection) new URL(startUrl).openConnection();
                    conn.setInstanceFollowRedirects(false);
                    conn.setConnectTimeout(5000);
                    String newUrl = conn.getHeaderField("Location");
                    return StringUtil.isEmpty(newUrl) ? startUrl : newUrl;
                } catch (IOException e) {
                    return "";
                }
            }
        }

        // 喜马拉雅
        else if (source == NetMusicSource.XM) {
            String playUrlBody = HttpRequest.get(String.format(GET_SONG_URL_XM_API, songId))
                    .execute()
                    .body();
            JSONObject urlJson = JSONObject.fromObject(playUrlBody);
            String url = urlJson.getJSONObject("data").getString("src");
            return url;
        }

        // 猫耳
        else if (source == NetMusicSource.ME) {
            String songBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_ME_API, songId))
                    .execute()
                    .body();
            JSONObject data = JSONObject.fromObject(songBody).getJSONObject("info").getJSONObject("sound");
            String url = data.optString("soundurl");
            return url;
        }

        // 哔哩哔哩
        else if (source == NetMusicSource.BI) {
            String playUrlBody = HttpRequest.get(String.format(GET_SONG_URL_BI_API, songId))
                    .cookie(BI_COOKIE)
                    .execute()
                    .body();
            JSONObject urlJson = JSONObject.fromObject(playUrlBody);
            String url = urlJson.getJSONObject("data").getJSONArray("cdns").getString(0);
            return url;
        }

        return "";
    }

    /**
     * 根据 MV id 获取 MV 视频链接
     */
    public static String fetchMvUrl(NetMvInfo netMvInfo) {
        int source = netMvInfo.getSource();
        String mvId = netMvInfo.getId();
        String bvId = netMvInfo.getBvid();
        boolean isVideo = netMvInfo.isVideo();
        boolean isMlog = netMvInfo.isMlog();

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            if (isVideo || isMlog) {
                // Mlog 需要先获取视频 id，并转为视频类型
                if (isMlog) {
                    String body = HttpRequest.get(String.format(MLOG_TO_VIDEO_API, mvId))
                            .execute()
                            .body();
                    mvId = JSONObject.fromObject(body).getString("data");
                    netMvInfo.setId(mvId);
                    netMvInfo.setType(MvInfoType.VIDEO);
                }

                String mvBody = HttpRequest.get(String.format(VIDEO_URL_API, mvId))
                        .execute()
                        .body();
                JSONObject mvJson = JSONObject.fromObject(mvBody);
                JSONArray urls = mvJson.getJSONArray("urls");
                String url = urls.getJSONObject(0).getString("url");
                if (!"null".equals(url)) return url;
            }
//            else if (isMlog) {
//                String mvBody = HttpRequest.get(String.format(MLOG_URL_API, mvId))
//                        .execute()
//                        .body();
//                JSONObject mvJson = JSONObject.fromObject(mvBody);
//                JSONArray urls = mvJson.getJSONObject("data")
//                        .getJSONObject("resource")
//                        .getJSONObject("content")
//                        .getJSONObject("video")
//                        .getJSONArray("urlInfos");
//                String url = null;
//                int r = 0;
//                for (int i = 0, s = urls.size(); i < s; i++) {
//                    JSONObject urlJson = urls.getJSONObject(i);
//                    int r1 = urlJson.getInt("r");
//                    if (r < r1) {
//                        r = r1;
//                        url = urlJson.getString("url");
//                    }
//                }
//                if (!"null".equals(url)) return url;
//            }
            else {
                String mvBody = HttpRequest.get(String.format(MV_URL_API, mvId))
                        .execute()
                        .body();
                JSONObject mvJson = JSONObject.fromObject(mvBody);
                JSONObject data = mvJson.getJSONObject("data");
                String url = data.getString("url");
                if (!"null".equals(url)) return url;
            }
        }

        // 酷狗
        else if (source == NetMusicSource.KG) {
//            long ct = System.currentTimeMillis();
//            String mvBody = HttpRequest.get(buildKgUrl(String.format(MV_URL_KG_API, ct, mvId, ct, ct)))
//                    .header("x-router", "trackermv.kugou.com")
//                    .execute()
//                    .body();
//            JSONObject data = JSONObject.fromObject(mvBody).getJSONObject("data");
//            return data.getJSONObject(mvId.toLowerCase()).getString("downurl");

            String mvBody = HttpRequest.get(String.format(MV_URL_KG_API, mvId))
                    .execute()
                    .body();
            JSONObject data = JSONObject.fromObject(mvBody).getJSONObject("mvdata");
            JSONObject mvJson;
            // 高画质优先
            mvJson = data.getJSONObject("rq");
            if (mvJson.isEmpty()) mvJson = data.getJSONObject("sq");
            if (mvJson.isEmpty()) mvJson = data.getJSONObject("sd");
            if (mvJson.isEmpty()) mvJson = data.getJSONObject("le");
            if (mvJson.isEmpty()) mvJson = data.getJSONObject("hd");
            return mvJson.optString("downurl");
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            String mvBody = HttpRequest.get(String.format(MV_URL_QQ_API, mvId))
                    .execute()
                    .body();
            JSONArray mp4Array = JSONObject.fromObject(mvBody)
                    .getJSONObject("data")
                    .getJSONArray(mvId);
            return mp4Array.getString(mp4Array.size() - 1);
        }

        // 酷我
        else if (source == NetMusicSource.KW) {
            String mvBody = kwRequest(String.format(MV_URL_KW_API, mvId))
                    .execute()
                    .body();
            JSONObject data = JSONObject.fromObject(mvBody).optJSONObject("data");
            if (data != null) return data.getString("url");
        }

        // 咪咕 (暂时没有 MV url 的获取方式)
        else if (source == NetMusicSource.MG) {
            return null;
        }

        // 千千
        else if (source == NetMusicSource.QI) {
            String mvBody = HttpRequest.get(buildQianUrl(String.format(MV_URL_QI_API, mvId, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONArray data = JSONObject.fromObject(mvBody).getJSONArray("data");
            JSONArray urls = data.getJSONObject(0).getJSONArray("allRate");
            return urls.getJSONObject(0).getString("path");
        }

        // 好看
        else if (source == NetMusicSource.HK) {
            String mvBody = HttpRequest.get(String.format(MV_URL_HK_API, mvId))
                    .execute()
                    .body();
            JSONObject data = JSONObject.fromObject(mvBody).getJSONObject("data");
            JSONArray urls = data.getJSONObject("apiData").getJSONObject("curVideoMeta").getJSONArray("clarityUrl");
            return urls.getJSONObject(urls.size() - 1).getString("url");
        }

        // 哔哩哔哩
        else if (source == NetMusicSource.BI) {
            // 先通过 bvid 获取 cid
            if (StringUtil.isEmpty(mvId)) {
                String cidBody = HttpRequest.get(String.format(VIDEO_CID_BI_API, bvId))
                        .cookie(BI_COOKIE)
                        .execute()
                        .body();
                netMvInfo.setId(mvId = JSONObject.fromObject(cidBody).getJSONArray("data").getJSONObject(0).getString("cid"));
            }

            String mvBody = HttpRequest.get(String.format(VIDEO_URL_BI_API, bvId, mvId))
                    .cookie(BI_COOKIE)
                    .execute()
                    .body();
            JSONObject data = JSONObject.fromObject(mvBody).getJSONObject("data");
            JSONArray urls = data.getJSONArray("durl");
            String url = urls.getJSONObject(0).getString("url");
            // 根据 url 判断视频的格式
            netMvInfo.setFormat(url.contains(".mp4?") ? Format.MP4 : Format.FLV);
            return url;
        }

        return null;
    }

    /**
     * 根据为 NetMusicInfo 填充歌词字符串（包括原文、翻译、罗马音），没有的部分填充 ""
     */
    public static void fillLrc(NetMusicInfo netMusicInfo) {
        if (netMusicInfo.isLrcIntegrated()) return;

        int source = netMusicInfo.getSource();
        String id = netMusicInfo.getId();
//        String hash = netMusicInfo.getHash();

        // 网易云
        if (source == NetMusicSource.NET_CLOUD) {
            String lrcBody = HttpRequest.get(String.format(LYRIC_API, id))
                    .execute()
                    .body();
            JSONObject lrcJson = JSONObject.fromObject(lrcBody);
            JSONObject lrc = lrcJson.optJSONObject("lrc");
            JSONObject tLrc = lrcJson.optJSONObject("tlyric");
            JSONObject romaLrc = lrcJson.optJSONObject("romalrc");
            if (lrc != null) netMusicInfo.setLrc(lrc.getString("lyric"));
            if (tLrc != null) netMusicInfo.setTrans(tLrc.getString("lyric"));
            if (romaLrc != null) netMusicInfo.setRoma(romaLrc.getString("lyric"));
        }

        // 酷狗
        else if (source == NetMusicSource.KG) {
//            String songBody = HttpRequest.get(String.format(LYRIC_KG_API, id, hash))
//                    .execute()
//                    .body();
//            JSONObject data = JSONObject.fromObject(songBody);
//            String lyric = StringUtils.base64Decode(data.getString("content"));
//            netMusicInfo.setLrc(lyric);
        }

        // QQ
        else if (source == NetMusicSource.QQ) {
            String lrcBody = HttpRequest.get(String.format(LYRIC_QQ_API, id))
                    .header(Header.REFERER, "https://y.qq.com/portal/player.html")
                    .execute()
                    .body();
            JSONObject lrcJson = JSONObject.fromObject(lrcBody);
            String lyric = lrcJson.optString("lyric");
            String trans = lrcJson.optString("trans");
            netMusicInfo.setLrc(StringUtil.removeHTMLLabel(StringUtil.base64Decode(lyric)));
            netMusicInfo.setTrans(StringUtil.removeHTMLLabel(StringUtil.base64Decode(trans)));
        }

        // 酷我
        else if (source == NetMusicSource.KW) {
            String lrcBody = kwRequest(String.format(LYRIC_KW_API, id))
                    .execute()
                    .body();
            JSONObject data = JSONObject.fromObject(lrcBody).getJSONObject("data");
            if (data.isNullObject()) {
                netMusicInfo.setLrc(null);
                netMusicInfo.setTrans(null);
                return;
            }
            // 酷我歌词返回的是数组，需要先处理成字符串！
            // lrclist 可能是数组也可能为 null ！
            JSONArray lrcArray = data.optJSONArray("lrclist");
            if (lrcArray != null) {
                StringBuffer sb = new StringBuffer();
                boolean hasTrans = false;
                for (int i = 0, len = lrcArray.size(); i < len; i++) {
                    JSONObject sentenceJson = lrcArray.getJSONObject(i);
                    JSONObject nextSentenceJson = lrcArray.optJSONObject(i + 1);
                    // 歌词中带有翻译时，最后一句是翻译直接跳过
                    if (hasTrans && nextSentenceJson == null) break;
                    String time = TimeUtil.formatToLrcTime(sentenceJson.getDouble("time"));
                    String nextTime = null;
                    if (nextSentenceJson != null)
                        nextTime = TimeUtil.formatToLrcTime(nextSentenceJson.getDouble("time"));
                    // 歌词中带有翻译，有多个 time 相同的歌词时取不重复的第二个
                    if (!time.equals(nextTime)) {
                        sb.append(time);
                        String lineLyric = StringUtil.removeHTMLLabel(sentenceJson.getString("lineLyric"));
                        sb.append(lineLyric);
                        sb.append("\n");
                    } else hasTrans = true;
                }
                netMusicInfo.setLrc(sb.toString());
            } else netMusicInfo.setLrc(null);

            // 酷我歌词返回的是数组，需要先处理成字符串！
            // lrclist 可能是数组也可能为 null ！
            if (lrcArray != null) {
                StringBuffer sb = new StringBuffer();
                boolean hasTrans = false;
                String lastTime = null;
                for (int i = 0, len = lrcArray.size(); i < len; i++) {
                    JSONObject sentenceJson = lrcArray.getJSONObject(i);
                    JSONObject nextSentenceJson = lrcArray.optJSONObject(i + 1);
                    String time = TimeUtil.formatToLrcTime(sentenceJson.getDouble("time"));
                    String nextTime = null;
                    if (nextSentenceJson != null)
                        nextTime = TimeUtil.formatToLrcTime(nextSentenceJson.getDouble("time"));
                    // 歌词中带有翻译，有多个 time 相同的歌词时取重复的第一个；最后一句也是翻译
                    if (hasTrans && nextTime == null || time.equals(nextTime)) {
                        sb.append(lastTime);
                        String lineLyric = StringUtil.removeHTMLLabel(sentenceJson.getString("lineLyric"));
                        sb.append(lineLyric);
                        sb.append("\n");
                        hasTrans = true;
                    }
                    lastTime = time;
                }
                netMusicInfo.setTrans(sb.toString());
            } else netMusicInfo.setTrans(null);
        }

        // 咪咕
        else if (source == NetMusicSource.MG) {
//            String songBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_MG_API, id))
//                    .execute()
//                    .body();
//            JSONObject data = JSONObject.fromObject(songBody).getJSONObject("data");
//            netMusicInfo.setLrc(data.getString("lyric"));
        }

        // 千千
        else if (source == NetMusicSource.QI) {
            String playUrlBody = HttpRequest.get(buildQianUrl(String.format(GET_SONG_URL_QI_API, id, System.currentTimeMillis())))
                    .execute()
                    .body();
            JSONObject urlJson = JSONObject.fromObject(playUrlBody);
            String lrcUrl = urlJson.getJSONObject("data").getString("lyric");
            netMusicInfo.setLrc(StringUtil.isNotEmpty(lrcUrl) ? HttpRequest.get(lrcUrl).execute().body() : "");
            netMusicInfo.setTrans("");
            netMusicInfo.setRoma("");
        }

        // 音乐磁场
        else if (source == NetMusicSource.HF) {
            String songBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_HF_API, id))
                    .cookie(HF_COOKIE)
                    .execute()
                    .body();
            Document doc = Jsoup.parse(songBody);
            Elements ps = doc.select("p:not(.text-center)");
            StringBuffer sb = new StringBuffer();
            for (Element p : ps) {
                String lrc = p.text().trim();
                if (StringUtil.isEmpty(lrc)) continue;
                sb.append(lrc);
                sb.append('\n');
            }
            netMusicInfo.setLrc(sb.toString());
            netMusicInfo.setTrans("");
            netMusicInfo.setRoma("");
        }

        // 咕咕咕音乐
        else if (source == NetMusicSource.GG) {
            String songBody = HttpRequest.get(String.format(SINGLE_SONG_DETAIL_GG_API, id))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(songBody);
            Elements ps = doc.select(".message.break-all p");
            StringBuffer sb = new StringBuffer();
            for (Element p : ps) {
                String lrc = p.text().trim();
                if (StringUtil.isEmpty(lrc)) continue;
                sb.append(lrc);
                sb.append('\n');
            }
            netMusicInfo.setLrc(sb.toString());
            netMusicInfo.setTrans("");
            netMusicInfo.setRoma("");
        }

        // 猫耳(弹幕)
        else if (source == NetMusicSource.ME) {
            String dmBody = HttpRequest.get(String.format(DM_ME_API, id))
                    .execute()
                    .body();
            Document doc = Jsoup.parse(dmBody);
            Elements elements = doc.select("d");
            // 限制弹幕数量，避免引发性能问题
            final int dmLimit = 300;
            List<Element> ds = elements.subList(0, Math.min(elements.size(), dmLimit));
            StringBuffer sb = new StringBuffer();
            for (Element d : ds) {
                Double time = Double.parseDouble(d.attr("p").split(",", 2)[0]);
                sb.append(TimeUtil.formatToLrcTime(time));
                sb.append(d.text());
                sb.append("\n");
            }
            netMusicInfo.setLrc(sb.toString());
            netMusicInfo.setTrans("");
            netMusicInfo.setRoma("");
        }

        // 哔哩哔哩
        else if (source == NetMusicSource.BI) {
            String playUrlBody = HttpRequest.get(String.format(LYRIC_BI_API, id))
                    .setFollowRedirects(true)
                    .cookie(BI_COOKIE)
                    .execute()
                    .body();
            JSONObject urlJson = JSONObject.fromObject(playUrlBody);
            netMusicInfo.setLrc(urlJson.getString("data"));
            netMusicInfo.setTrans("");
            netMusicInfo.setRoma("");
        } else {
            netMusicInfo.setLrc("");
            netMusicInfo.setTrans("");
            netMusicInfo.setRoma("");
        }
    }

    /**
     * 下载文件
     *
     * @param urlPath
     * @param dest
     * @throws Exception
     */
    public static void download(String urlPath, String dest) throws Exception {
        File file = new File(dest);
        URL url = new URL(urlPath);
        HttpURLConnection conn = (HttpURLConnection) url.openConnection();
        conn.setRequestProperty("User-Agent", USER_AGENT);
        conn.connect();
        int code = conn.getResponseCode();
        if (code != HttpURLConnection.HTTP_OK) {
            throw new Exception("文件读取失败");
        }
        InputStream fis = new BufferedInputStream(conn.getInputStream());
        OutputStream toClient = new BufferedOutputStream(new FileOutputStream(file));
        // 以流的形式下载文件
        byte[] buffer = new byte[10240];
        int read;
        // 如果没有数据了会返回 -1，如果还有会返回数据的长度
        while ((read = fis.read(buffer)) != -1) {
            //读取多少输出多少
            toClient.write(buffer, 0, read);
        }
        toClient.flush();
        toClient.close();
        fis.close();
    }

    /**
     * 下载文件，同时设置等待面板百分比
     *
     * @param loading
     * @param urlPath
     * @param dest
     * @throws Exception
     */
    public static void download(LoadingPanel loading, String urlPath, String dest) throws Exception {
        download(loading, urlPath, dest, null);
    }

    /**
     * 下载文件，同时设置等待面板百分比
     *
     * @param comp
     * @param urlPath
     * @param dest
     * @throws Exception
     */
    public static void download(Component comp, String urlPath, String dest, Map<String, Object> headers) throws
            Exception {
        File file = new File(dest);
        URL url = new URL(urlPath);
        HttpURLConnection conn = (HttpURLConnection) url.openConnection();
        conn.setRequestProperty("User-Agent", USER_AGENT);
        // 请求头
        if (headers != null) {
            for (String key : headers.keySet()) {
                conn.setRequestProperty(key, (String) headers.get(key));
            }
        }
        conn.connect();
        int code = conn.getResponseCode();
        if (code != HttpURLConnection.HTTP_OK) {
            throw new Exception("文件读取失败");
        }
        InputStream fis = new BufferedInputStream(conn.getInputStream());
        OutputStream toClient = new BufferedOutputStream(new FileOutputStream(file));
        // 以流的形式下载文件
        byte[] buffer = new byte[10240];
        // 文件大小
        long fileSize = conn.getContentLength(), hasRead = 0;
        int read;
        // 如果没有数据了会返回 -1，如果还有会返回数据的长度
        while ((read = fis.read(buffer)) != -1) {
            hasRead += read;
            if (comp instanceof LoadingPanel)
                ((LoadingPanel) comp).setText("加载歌曲文件，" + String.format("%.1f", (double) hasRead / fileSize * 100) + "%");
            //读取多少输出多少
            toClient.write(buffer, 0, read);
        }
        toClient.flush();
        toClient.close();
        fis.close();
    }

    /**
     * 通过 Task 下载文件，设置 percent
     *
     * @param task
     * @throws Exception
     */
    public static void download(Task task, Map<String, Object> headers) throws Exception {
        File file = new File(task.getDest());
        URL url = new URL(task.getUrl());
        HttpURLConnection conn = (HttpURLConnection) url.openConnection();
        conn.setRequestProperty("User-Agent", USER_AGENT);
        // 请求头
        if (headers != null) {
            for (String key : headers.keySet()) {
                conn.setRequestProperty(key, (String) headers.get(key));
            }
        }
        conn.connect();
        int code = conn.getResponseCode();
        if (code != HttpURLConnection.HTTP_OK) {
            throw new Exception("文件读取失败");
        }
        InputStream fis = new BufferedInputStream(conn.getInputStream());
        OutputStream toClient = new BufferedOutputStream(new FileOutputStream(file));
        // 以流的形式下载文件
        byte[] buffer = new byte[10240];
        // 文件大小
        long fileSize = conn.getContentLength(), hasRead = 0;
        task.setTotal(fileSize);
        int read;
        // 如果没有数据了会返回 -1，如果还有会返回数据的长度
        while ((read = fis.read(buffer)) != -1) {
            // 中断任务后跳出
            if (task.isInterrupted()) break;
            hasRead += read;
            task.setPercent((double) hasRead / fileSize * 100);
            task.setFinished(hasRead);
            // 读取多少输出多少
            toClient.write(buffer, 0, read);
        }
        toClient.flush();
        toClient.close();
        fis.close();
    }

}
